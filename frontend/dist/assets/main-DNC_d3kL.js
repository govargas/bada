var _w=Object.defineProperty;var Yv=r=>{throw TypeError(r)};var vw=(r,a,u)=>a in r?_w(r,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[a]=u;var Qv=(r,a,u)=>vw(r,typeof a!="symbol"?a+"":a,u),ky=(r,a,u)=>a.has(r)||Yv("Cannot "+u);var ye=(r,a,u)=>(ky(r,a,"read from private field"),u?u.call(r):a.get(r)),Wt=(r,a,u)=>a.has(r)?Yv("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(r):a.set(r,u),It=(r,a,u,m)=>(ky(r,a,"write to private field"),m?m.call(r,u):a.set(r,u),u),wr=(r,a,u)=>(ky(r,a,"access private method"),u);var lg=(r,a,u,m)=>({set _(b){It(r,a,b,u)},get _(){return ye(r,a,m)}});(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const b of document.querySelectorAll('link[rel="modulepreload"]'))m(b);new MutationObserver(b=>{for(const P of b)if(P.type==="childList")for(const w of P.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&m(w)}).observe(document,{childList:!0,subtree:!0});function u(b){const P={};return b.integrity&&(P.integrity=b.integrity),b.referrerPolicy&&(P.referrerPolicy=b.referrerPolicy),b.crossOrigin==="use-credentials"?P.credentials="include":b.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function m(b){if(b.ep)return;b.ep=!0;const P=u(b);fetch(b.href,P)}})();function R_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ey={exports:{}},$p={},Iy={exports:{}},Gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function xw(){if(Jv)return Gr;Jv=1;var r=Symbol.for("react.element"),a=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),w=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),V=Symbol.iterator;function ee(Ie){return Ie===null||typeof Ie!="object"?null:(Ie=V&&Ie[V]||Ie["@@iterator"],typeof Ie=="function"?Ie:null)}var q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_e=Object.assign,fe={};function Pe(Ie,Qe,jt){this.props=Ie,this.context=Qe,this.refs=fe,this.updater=jt||q}Pe.prototype.isReactComponent={},Pe.prototype.setState=function(Ie,Qe){if(typeof Ie!="object"&&typeof Ie!="function"&&Ie!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ie,Qe,"setState")},Pe.prototype.forceUpdate=function(Ie){this.updater.enqueueForceUpdate(this,Ie,"forceUpdate")};function Le(){}Le.prototype=Pe.prototype;function Me(Ie,Qe,jt){this.props=Ie,this.context=Qe,this.refs=fe,this.updater=jt||q}var Se=Me.prototype=new Le;Se.constructor=Me,_e(Se,Pe.prototype),Se.isPureReactComponent=!0;var De=Array.isArray,Ye=Object.prototype.hasOwnProperty,ot={current:null},lt={key:!0,ref:!0,__self:!0,__source:!0};function ut(Ie,Qe,jt){var tr,fr={},Kt=null,Lr=null;if(Qe!=null)for(tr in Qe.ref!==void 0&&(Lr=Qe.ref),Qe.key!==void 0&&(Kt=""+Qe.key),Qe)Ye.call(Qe,tr)&&!lt.hasOwnProperty(tr)&&(fr[tr]=Qe[tr]);var sr=arguments.length-2;if(sr===1)fr.children=jt;else if(1<sr){for(var yr=Array(sr),lr=0;lr<sr;lr++)yr[lr]=arguments[lr+2];fr.children=yr}if(Ie&&Ie.defaultProps)for(tr in sr=Ie.defaultProps,sr)fr[tr]===void 0&&(fr[tr]=sr[tr]);return{$$typeof:r,type:Ie,key:Kt,ref:Lr,props:fr,_owner:ot.current}}function Je(Ie,Qe){return{$$typeof:r,type:Ie.type,key:Qe,ref:Ie.ref,props:Ie.props,_owner:Ie._owner}}function Ke(Ie){return typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===r}function At(Ie){var Qe={"=":"=0",":":"=2"};return"$"+Ie.replace(/[=:]/g,function(jt){return Qe[jt]})}var Rt=/\/+/g;function Mt(Ie,Qe){return typeof Ie=="object"&&Ie!==null&&Ie.key!=null?At(""+Ie.key):Qe.toString(36)}function Ht(Ie,Qe,jt,tr,fr){var Kt=typeof Ie;(Kt==="undefined"||Kt==="boolean")&&(Ie=null);var Lr=!1;if(Ie===null)Lr=!0;else switch(Kt){case"string":case"number":Lr=!0;break;case"object":switch(Ie.$$typeof){case r:case a:Lr=!0}}if(Lr)return Lr=Ie,fr=fr(Lr),Ie=tr===""?"."+Mt(Lr,0):tr,De(fr)?(jt="",Ie!=null&&(jt=Ie.replace(Rt,"$&/")+"/"),Ht(fr,Qe,jt,"",function(lr){return lr})):fr!=null&&(Ke(fr)&&(fr=Je(fr,jt+(!fr.key||Lr&&Lr.key===fr.key?"":(""+fr.key).replace(Rt,"$&/")+"/")+Ie)),Qe.push(fr)),1;if(Lr=0,tr=tr===""?".":tr+":",De(Ie))for(var sr=0;sr<Ie.length;sr++){Kt=Ie[sr];var yr=tr+Mt(Kt,sr);Lr+=Ht(Kt,Qe,jt,yr,fr)}else if(yr=ee(Ie),typeof yr=="function")for(Ie=yr.call(Ie),sr=0;!(Kt=Ie.next()).done;)Kt=Kt.value,yr=tr+Mt(Kt,sr++),Lr+=Ht(Kt,Qe,jt,yr,fr);else if(Kt==="object")throw Qe=String(Ie),Error("Objects are not valid as a React child (found: "+(Qe==="[object Object]"?"object with keys {"+Object.keys(Ie).join(", ")+"}":Qe)+"). If you meant to render a collection of children, use an array instead.");return Lr}function zr(Ie,Qe,jt){if(Ie==null)return Ie;var tr=[],fr=0;return Ht(Ie,tr,"","",function(Kt){return Qe.call(jt,Kt,fr++)}),tr}function or(Ie){if(Ie._status===-1){var Qe=Ie._result;Qe=Qe(),Qe.then(function(jt){(Ie._status===0||Ie._status===-1)&&(Ie._status=1,Ie._result=jt)},function(jt){(Ie._status===0||Ie._status===-1)&&(Ie._status=2,Ie._result=jt)}),Ie._status===-1&&(Ie._status=0,Ie._result=Qe)}if(Ie._status===1)return Ie._result.default;throw Ie._result}var Zt={current:null},_t={transition:null},ft={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:_t,ReactCurrentOwner:ot};function Ct(){throw Error("act(...) is not supported in production builds of React.")}return Gr.Children={map:zr,forEach:function(Ie,Qe,jt){zr(Ie,function(){Qe.apply(this,arguments)},jt)},count:function(Ie){var Qe=0;return zr(Ie,function(){Qe++}),Qe},toArray:function(Ie){return zr(Ie,function(Qe){return Qe})||[]},only:function(Ie){if(!Ke(Ie))throw Error("React.Children.only expected to receive a single React element child.");return Ie}},Gr.Component=Pe,Gr.Fragment=u,Gr.Profiler=b,Gr.PureComponent=Me,Gr.StrictMode=m,Gr.Suspense=L,Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ft,Gr.act=Ct,Gr.cloneElement=function(Ie,Qe,jt){if(Ie==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Ie+".");var tr=_e({},Ie.props),fr=Ie.key,Kt=Ie.ref,Lr=Ie._owner;if(Qe!=null){if(Qe.ref!==void 0&&(Kt=Qe.ref,Lr=ot.current),Qe.key!==void 0&&(fr=""+Qe.key),Ie.type&&Ie.type.defaultProps)var sr=Ie.type.defaultProps;for(yr in Qe)Ye.call(Qe,yr)&&!lt.hasOwnProperty(yr)&&(tr[yr]=Qe[yr]===void 0&&sr!==void 0?sr[yr]:Qe[yr])}var yr=arguments.length-2;if(yr===1)tr.children=jt;else if(1<yr){sr=Array(yr);for(var lr=0;lr<yr;lr++)sr[lr]=arguments[lr+2];tr.children=sr}return{$$typeof:r,type:Ie.type,key:fr,ref:Kt,props:tr,_owner:Lr}},Gr.createContext=function(Ie){return Ie={$$typeof:w,_currentValue:Ie,_currentValue2:Ie,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Ie.Provider={$$typeof:P,_context:Ie},Ie.Consumer=Ie},Gr.createElement=ut,Gr.createFactory=function(Ie){var Qe=ut.bind(null,Ie);return Qe.type=Ie,Qe},Gr.createRef=function(){return{current:null}},Gr.forwardRef=function(Ie){return{$$typeof:l,render:Ie}},Gr.isValidElement=Ke,Gr.lazy=function(Ie){return{$$typeof:Z,_payload:{_status:-1,_result:Ie},_init:or}},Gr.memo=function(Ie,Qe){return{$$typeof:N,type:Ie,compare:Qe===void 0?null:Qe}},Gr.startTransition=function(Ie){var Qe=_t.transition;_t.transition={};try{Ie()}finally{_t.transition=Qe}},Gr.unstable_act=Ct,Gr.useCallback=function(Ie,Qe){return Zt.current.useCallback(Ie,Qe)},Gr.useContext=function(Ie){return Zt.current.useContext(Ie)},Gr.useDebugValue=function(){},Gr.useDeferredValue=function(Ie){return Zt.current.useDeferredValue(Ie)},Gr.useEffect=function(Ie,Qe){return Zt.current.useEffect(Ie,Qe)},Gr.useId=function(){return Zt.current.useId()},Gr.useImperativeHandle=function(Ie,Qe,jt){return Zt.current.useImperativeHandle(Ie,Qe,jt)},Gr.useInsertionEffect=function(Ie,Qe){return Zt.current.useInsertionEffect(Ie,Qe)},Gr.useLayoutEffect=function(Ie,Qe){return Zt.current.useLayoutEffect(Ie,Qe)},Gr.useMemo=function(Ie,Qe){return Zt.current.useMemo(Ie,Qe)},Gr.useReducer=function(Ie,Qe,jt){return Zt.current.useReducer(Ie,Qe,jt)},Gr.useRef=function(Ie){return Zt.current.useRef(Ie)},Gr.useState=function(Ie){return Zt.current.useState(Ie)},Gr.useSyncExternalStore=function(Ie,Qe,jt){return Zt.current.useSyncExternalStore(Ie,Qe,jt)},Gr.useTransition=function(){return Zt.current.useTransition()},Gr.version="18.3.1",Gr}var ex;function z_(){return ex||(ex=1,Iy.exports=xw()),Iy.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tx;function bw(){if(tx)return $p;tx=1;var r=z_(),a=Symbol.for("react.element"),u=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P={key:!0,ref:!0,__self:!0,__source:!0};function w(l,L,N){var Z,V={},ee=null,q=null;N!==void 0&&(ee=""+N),L.key!==void 0&&(ee=""+L.key),L.ref!==void 0&&(q=L.ref);for(Z in L)m.call(L,Z)&&!P.hasOwnProperty(Z)&&(V[Z]=L[Z]);if(l&&l.defaultProps)for(Z in L=l.defaultProps,L)V[Z]===void 0&&(V[Z]=L[Z]);return{$$typeof:a,type:l,key:ee,ref:q,props:V,_owner:b.current}}return $p.Fragment=u,$p.jsx=w,$p.jsxs=w,$p}var rx;function ww(){return rx||(rx=1,Ey.exports=bw()),Ey.exports}var Y=ww(),te=z_();const hn=R_(te);var cg={},My={exports:{}},Ta={},Ay={exports:{}},Ry={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nx;function Sw(){return nx||(nx=1,(function(r){function a(_t,ft){var Ct=_t.length;_t.push(ft);e:for(;0<Ct;){var Ie=Ct-1>>>1,Qe=_t[Ie];if(0<b(Qe,ft))_t[Ie]=ft,_t[Ct]=Qe,Ct=Ie;else break e}}function u(_t){return _t.length===0?null:_t[0]}function m(_t){if(_t.length===0)return null;var ft=_t[0],Ct=_t.pop();if(Ct!==ft){_t[0]=Ct;e:for(var Ie=0,Qe=_t.length,jt=Qe>>>1;Ie<jt;){var tr=2*(Ie+1)-1,fr=_t[tr],Kt=tr+1,Lr=_t[Kt];if(0>b(fr,Ct))Kt<Qe&&0>b(Lr,fr)?(_t[Ie]=Lr,_t[Kt]=Ct,Ie=Kt):(_t[Ie]=fr,_t[tr]=Ct,Ie=tr);else if(Kt<Qe&&0>b(Lr,Ct))_t[Ie]=Lr,_t[Kt]=Ct,Ie=Kt;else break e}}return ft}function b(_t,ft){var Ct=_t.sortIndex-ft.sortIndex;return Ct!==0?Ct:_t.id-ft.id}if(typeof performance=="object"&&typeof performance.now=="function"){var P=performance;r.unstable_now=function(){return P.now()}}else{var w=Date,l=w.now();r.unstable_now=function(){return w.now()-l}}var L=[],N=[],Z=1,V=null,ee=3,q=!1,_e=!1,fe=!1,Pe=typeof setTimeout=="function"?setTimeout:null,Le=typeof clearTimeout=="function"?clearTimeout:null,Me=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Se(_t){for(var ft=u(N);ft!==null;){if(ft.callback===null)m(N);else if(ft.startTime<=_t)m(N),ft.sortIndex=ft.expirationTime,a(L,ft);else break;ft=u(N)}}function De(_t){if(fe=!1,Se(_t),!_e)if(u(L)!==null)_e=!0,or(Ye);else{var ft=u(N);ft!==null&&Zt(De,ft.startTime-_t)}}function Ye(_t,ft){_e=!1,fe&&(fe=!1,Le(ut),ut=-1),q=!0;var Ct=ee;try{for(Se(ft),V=u(L);V!==null&&(!(V.expirationTime>ft)||_t&&!At());){var Ie=V.callback;if(typeof Ie=="function"){V.callback=null,ee=V.priorityLevel;var Qe=Ie(V.expirationTime<=ft);ft=r.unstable_now(),typeof Qe=="function"?V.callback=Qe:V===u(L)&&m(L),Se(ft)}else m(L);V=u(L)}if(V!==null)var jt=!0;else{var tr=u(N);tr!==null&&Zt(De,tr.startTime-ft),jt=!1}return jt}finally{V=null,ee=Ct,q=!1}}var ot=!1,lt=null,ut=-1,Je=5,Ke=-1;function At(){return!(r.unstable_now()-Ke<Je)}function Rt(){if(lt!==null){var _t=r.unstable_now();Ke=_t;var ft=!0;try{ft=lt(!0,_t)}finally{ft?Mt():(ot=!1,lt=null)}}else ot=!1}var Mt;if(typeof Me=="function")Mt=function(){Me(Rt)};else if(typeof MessageChannel<"u"){var Ht=new MessageChannel,zr=Ht.port2;Ht.port1.onmessage=Rt,Mt=function(){zr.postMessage(null)}}else Mt=function(){Pe(Rt,0)};function or(_t){lt=_t,ot||(ot=!0,Mt())}function Zt(_t,ft){ut=Pe(function(){_t(r.unstable_now())},ft)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(_t){_t.callback=null},r.unstable_continueExecution=function(){_e||q||(_e=!0,or(Ye))},r.unstable_forceFrameRate=function(_t){0>_t||125<_t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Je=0<_t?Math.floor(1e3/_t):5},r.unstable_getCurrentPriorityLevel=function(){return ee},r.unstable_getFirstCallbackNode=function(){return u(L)},r.unstable_next=function(_t){switch(ee){case 1:case 2:case 3:var ft=3;break;default:ft=ee}var Ct=ee;ee=ft;try{return _t()}finally{ee=Ct}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(_t,ft){switch(_t){case 1:case 2:case 3:case 4:case 5:break;default:_t=3}var Ct=ee;ee=_t;try{return ft()}finally{ee=Ct}},r.unstable_scheduleCallback=function(_t,ft,Ct){var Ie=r.unstable_now();switch(typeof Ct=="object"&&Ct!==null?(Ct=Ct.delay,Ct=typeof Ct=="number"&&0<Ct?Ie+Ct:Ie):Ct=Ie,_t){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=Ct+Qe,_t={id:Z++,callback:ft,priorityLevel:_t,startTime:Ct,expirationTime:Qe,sortIndex:-1},Ct>Ie?(_t.sortIndex=Ct,a(N,_t),u(L)===null&&_t===u(N)&&(fe?(Le(ut),ut=-1):fe=!0,Zt(De,Ct-Ie))):(_t.sortIndex=Qe,a(L,_t),_e||q||(_e=!0,or(Ye))),_t},r.unstable_shouldYield=At,r.unstable_wrapCallback=function(_t){var ft=ee;return function(){var Ct=ee;ee=ft;try{return _t.apply(this,arguments)}finally{ee=Ct}}}})(Ry)),Ry}var ix;function Tw(){return ix||(ix=1,Ay.exports=Sw()),Ay.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sx;function Pw(){if(sx)return Ta;sx=1;var r=z_(),a=Tw();function u(o){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+o,x=1;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+o+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m=new Set,b={};function P(o,d){w(o,d),w(o+"Capture",d)}function w(o,d){for(b[o]=d,o=0;o<d.length;o++)m.add(d[o])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),L=Object.prototype.hasOwnProperty,N=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z={},V={};function ee(o){return L.call(V,o)?!0:L.call(Z,o)?!1:N.test(o)?V[o]=!0:(Z[o]=!0,!1)}function q(o,d,x,C){if(x!==null&&x.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return C?!1:x!==null?!x.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function _e(o,d,x,C){if(d===null||typeof d>"u"||q(o,d,x,C))return!0;if(C)return!1;if(x!==null)switch(x.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function fe(o,d,x,C,R,O,J){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=C,this.attributeNamespace=R,this.mustUseProperty=x,this.propertyName=o,this.type=d,this.sanitizeURL=O,this.removeEmptyString=J}var Pe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){Pe[o]=new fe(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var d=o[0];Pe[d]=new fe(d,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){Pe[o]=new fe(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){Pe[o]=new fe(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){Pe[o]=new fe(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){Pe[o]=new fe(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){Pe[o]=new fe(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){Pe[o]=new fe(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){Pe[o]=new fe(o,5,!1,o.toLowerCase(),null,!1,!1)});var Le=/[\-:]([a-z])/g;function Me(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var d=o.replace(Le,Me);Pe[d]=new fe(d,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var d=o.replace(Le,Me);Pe[d]=new fe(d,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var d=o.replace(Le,Me);Pe[d]=new fe(d,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){Pe[o]=new fe(o,1,!1,o.toLowerCase(),null,!1,!1)}),Pe.xlinkHref=new fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){Pe[o]=new fe(o,1,!1,o.toLowerCase(),null,!0,!0)});function Se(o,d,x,C){var R=Pe.hasOwnProperty(d)?Pe[d]:null;(R!==null?R.type!==0:C||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(_e(d,x,R,C)&&(x=null),C||R===null?ee(d)&&(x===null?o.removeAttribute(d):o.setAttribute(d,""+x)):R.mustUseProperty?o[R.propertyName]=x===null?R.type===3?!1:"":x:(d=R.attributeName,C=R.attributeNamespace,x===null?o.removeAttribute(d):(R=R.type,x=R===3||R===4&&x===!0?"":""+x,C?o.setAttributeNS(C,d,x):o.setAttribute(d,x))))}var De=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ye=Symbol.for("react.element"),ot=Symbol.for("react.portal"),lt=Symbol.for("react.fragment"),ut=Symbol.for("react.strict_mode"),Je=Symbol.for("react.profiler"),Ke=Symbol.for("react.provider"),At=Symbol.for("react.context"),Rt=Symbol.for("react.forward_ref"),Mt=Symbol.for("react.suspense"),Ht=Symbol.for("react.suspense_list"),zr=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),Zt=Symbol.for("react.offscreen"),_t=Symbol.iterator;function ft(o){return o===null||typeof o!="object"?null:(o=_t&&o[_t]||o["@@iterator"],typeof o=="function"?o:null)}var Ct=Object.assign,Ie;function Qe(o){if(Ie===void 0)try{throw Error()}catch(x){var d=x.stack.trim().match(/\n( *(at )?)/);Ie=d&&d[1]||""}return`
`+Ie+o}var jt=!1;function tr(o,d){if(!o||jt)return"";jt=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(He){var C=He}Reflect.construct(o,[],d)}else{try{d.call()}catch(He){C=He}o.call(d.prototype)}else{try{throw Error()}catch(He){C=He}o()}}catch(He){if(He&&C&&typeof He.stack=="string"){for(var R=He.stack.split(`
`),O=C.stack.split(`
`),J=R.length-1,me=O.length-1;1<=J&&0<=me&&R[J]!==O[me];)me--;for(;1<=J&&0<=me;J--,me--)if(R[J]!==O[me]){if(J!==1||me!==1)do if(J--,me--,0>me||R[J]!==O[me]){var Ee=`
`+R[J].replace(" at new "," at ");return o.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",o.displayName)),Ee}while(1<=J&&0<=me);break}}}finally{jt=!1,Error.prepareStackTrace=x}return(o=o?o.displayName||o.name:"")?Qe(o):""}function fr(o){switch(o.tag){case 5:return Qe(o.type);case 16:return Qe("Lazy");case 13:return Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 2:case 15:return o=tr(o.type,!1),o;case 11:return o=tr(o.type.render,!1),o;case 1:return o=tr(o.type,!0),o;default:return""}}function Kt(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case lt:return"Fragment";case ot:return"Portal";case Je:return"Profiler";case ut:return"StrictMode";case Mt:return"Suspense";case Ht:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case At:return(o.displayName||"Context")+".Consumer";case Ke:return(o._context.displayName||"Context")+".Provider";case Rt:var d=o.render;return o=o.displayName,o||(o=d.displayName||d.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case zr:return d=o.displayName||null,d!==null?d:Kt(o.type)||"Memo";case or:d=o._payload,o=o._init;try{return Kt(o(d))}catch{}}return null}function Lr(o){var d=o.type;switch(o.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=d.render,o=o.displayName||o.name||"",d.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kt(d);case 8:return d===ut?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function sr(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function yr(o){var d=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function lr(o){var d=yr(o)?"checked":"value",x=Object.getOwnPropertyDescriptor(o.constructor.prototype,d),C=""+o[d];if(!o.hasOwnProperty(d)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var R=x.get,O=x.set;return Object.defineProperty(o,d,{configurable:!0,get:function(){return R.call(this)},set:function(J){C=""+J,O.call(this,J)}}),Object.defineProperty(o,d,{enumerable:x.enumerable}),{getValue:function(){return C},setValue:function(J){C=""+J},stopTracking:function(){o._valueTracker=null,delete o[d]}}}}function ci(o){o._valueTracker||(o._valueTracker=lr(o))}function ln(o){if(!o)return!1;var d=o._valueTracker;if(!d)return!0;var x=d.getValue(),C="";return o&&(C=yr(o)?o.checked?"true":"false":o.value),o=C,o!==x?(d.setValue(o),!0):!1}function Vr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Nr(o,d){var x=d.checked;return Ct({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??o._wrapperState.initialChecked})}function Cn(o,d){var x=d.defaultValue==null?"":d.defaultValue,C=d.checked!=null?d.checked:d.defaultChecked;x=sr(d.value!=null?d.value:x),o._wrapperState={initialChecked:C,initialValue:x,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function jn(o,d){d=d.checked,d!=null&&Se(o,"checked",d,!1)}function Yi(o,d){jn(o,d);var x=sr(d.value),C=d.type;if(x!=null)C==="number"?(x===0&&o.value===""||o.value!=x)&&(o.value=""+x):o.value!==""+x&&(o.value=""+x);else if(C==="submit"||C==="reset"){o.removeAttribute("value");return}d.hasOwnProperty("value")?Zn(o,d.type,x):d.hasOwnProperty("defaultValue")&&Zn(o,d.type,sr(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(o.defaultChecked=!!d.defaultChecked)}function Ri(o,d,x){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var C=d.type;if(!(C!=="submit"&&C!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+o._wrapperState.initialValue,x||d===o.value||(o.value=d),o.defaultValue=d}x=o.name,x!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,x!==""&&(o.name=x)}function Zn(o,d,x){(d!=="number"||Vr(o.ownerDocument)!==o)&&(x==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+x&&(o.defaultValue=""+x))}var xe=Array.isArray;function Be(o,d,x,C){if(o=o.options,d){d={};for(var R=0;R<x.length;R++)d["$"+x[R]]=!0;for(x=0;x<o.length;x++)R=d.hasOwnProperty("$"+o[x].value),o[x].selected!==R&&(o[x].selected=R),R&&C&&(o[x].defaultSelected=!0)}else{for(x=""+sr(x),d=null,R=0;R<o.length;R++){if(o[R].value===x){o[R].selected=!0,C&&(o[R].defaultSelected=!0);return}d!==null||o[R].disabled||(d=o[R])}d!==null&&(d.selected=!0)}}function Xe(o,d){if(d.dangerouslySetInnerHTML!=null)throw Error(u(91));return Ct({},d,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Et(o,d){var x=d.value;if(x==null){if(x=d.children,d=d.defaultValue,x!=null){if(d!=null)throw Error(u(92));if(xe(x)){if(1<x.length)throw Error(u(93));x=x[0]}d=x}d==null&&(d=""),x=d}o._wrapperState={initialValue:sr(x)}}function vt(o,d){var x=sr(d.value),C=sr(d.defaultValue);x!=null&&(x=""+x,x!==o.value&&(o.value=x),d.defaultValue==null&&o.defaultValue!==x&&(o.defaultValue=x)),C!=null&&(o.defaultValue=""+C)}function gt(o){var d=o.textContent;d===o._wrapperState.initialValue&&d!==""&&d!==null&&(o.value=d)}function Bt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _r(o,d){return o==null||o==="http://www.w3.org/1999/xhtml"?Bt(d):o==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Sr,Te=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,x,C,R){MSApp.execUnsafeLocalFunction(function(){return o(d,x,C,R)})}:o})(function(o,d){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=d;else{for(Sr=Sr||document.createElement("div"),Sr.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=Sr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;d.firstChild;)o.appendChild(d.firstChild)}});function K(o,d){if(d){var x=o.firstChild;if(x&&x===o.lastChild&&x.nodeType===3){x.nodeValue=d;return}}o.textContent=d}var X={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ne=["Webkit","ms","Moz","O"];Object.keys(X).forEach(function(o){ne.forEach(function(d){d=d+o.charAt(0).toUpperCase()+o.substring(1),X[d]=X[o]})});function ue(o,d,x){return d==null||typeof d=="boolean"||d===""?"":x||typeof d!="number"||d===0||X.hasOwnProperty(o)&&X[o]?(""+d).trim():d+"px"}function ve(o,d){o=o.style;for(var x in d)if(d.hasOwnProperty(x)){var C=x.indexOf("--")===0,R=ue(x,d[x],C);x==="float"&&(x="cssFloat"),C?o.setProperty(x,R):o[x]=R}}var Ae=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oe(o,d){if(d){if(Ae[o]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(u(137,o));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(u(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(u(61))}if(d.style!=null&&typeof d.style!="object")throw Error(u(62))}}function Re(o,d){if(o.indexOf("-")===-1)return typeof d.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qe=null;function nt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var et=null,zt=null,Ce=null;function $t(o){if(o=Zl(o)){if(typeof et!="function")throw Error(u(280));var d=o.stateNode;d&&(d=Oc(d),et(o.stateNode,o.type,d))}}function rr(o){zt?Ce?Ce.push(o):Ce=[o]:zt=o}function Dt(){if(zt){var o=zt,d=Ce;if(Ce=zt=null,$t(o),d)for(o=0;o<d.length;o++)$t(d[o])}}function Xt(o,d){return o(d)}function Cr(){}var Kr=!1;function dn(o,d,x){if(Kr)return o(d,x);Kr=!0;try{return Xt(o,d,x)}finally{Kr=!1,(zt!==null||Ce!==null)&&(Cr(),Dt())}}function Tr(o,d){var x=o.stateNode;if(x===null)return null;var C=Oc(x);if(C===null)return null;x=C[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(o=o.type,C=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!C;break e;default:o=!1}if(o)return null;if(x&&typeof x!="function")throw Error(u(231,d,typeof x));return x}var cr=!1;if(l)try{var ar={};Object.defineProperty(ar,"passive",{get:function(){cr=!0}}),window.addEventListener("test",ar,ar),window.removeEventListener("test",ar,ar)}catch{cr=!1}function en(o,d,x,C,R,O,J,me,Ee){var He=Array.prototype.slice.call(arguments,3);try{d.apply(x,He)}catch(dt){this.onError(dt)}}var st=!1,_n=null,$r=!1,vi=null,oa={onError:function(o){st=!0,_n=o}};function Pt(o,d,x,C,R,O,J,me,Ee){st=!1,_n=null,en.apply(oa,arguments)}function Dr(o,d,x,C,R,O,J,me,Ee){if(Pt.apply(this,arguments),st){if(st){var He=_n;st=!1,_n=null}else throw Error(u(198));$r||($r=!0,vi=He)}}function pr(o){var d=o,x=o;if(o.alternate)for(;d.return;)d=d.return;else{o=d;do d=o,(d.flags&4098)!==0&&(x=d.return),o=d.return;while(o)}return d.tag===3?x:null}function ri(o){if(o.tag===13){var d=o.memoizedState;if(d===null&&(o=o.alternate,o!==null&&(d=o.memoizedState)),d!==null)return d.dehydrated}return null}function oo(o){if(pr(o)!==o)throw Error(u(188))}function lo(o){var d=o.alternate;if(!d){if(d=pr(o),d===null)throw Error(u(188));return d!==o?null:o}for(var x=o,C=d;;){var R=x.return;if(R===null)break;var O=R.alternate;if(O===null){if(C=R.return,C!==null){x=C;continue}break}if(R.child===O.child){for(O=R.child;O;){if(O===x)return oo(R),o;if(O===C)return oo(R),d;O=O.sibling}throw Error(u(188))}if(x.return!==C.return)x=R,C=O;else{for(var J=!1,me=R.child;me;){if(me===x){J=!0,x=R,C=O;break}if(me===C){J=!0,C=R,x=O;break}me=me.sibling}if(!J){for(me=O.child;me;){if(me===x){J=!0,x=O,C=R;break}if(me===C){J=!0,C=O,x=R;break}me=me.sibling}if(!J)throw Error(u(189))}}if(x.alternate!==C)throw Error(u(190))}if(x.tag!==3)throw Error(u(188));return x.stateNode.current===x?o:d}function xr(o){return o=lo(o),o!==null?hc(o):null}function hc(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var d=hc(o);if(d!==null)return d;o=o.sibling}return null}var Ma=a.unstable_scheduleCallback,dc=a.unstable_cancelCallback,la=a.unstable_shouldYield,xl=a.unstable_requestPaint,kr=a.unstable_now,pu=a.unstable_getCurrentPriorityLevel,xi=a.unstable_ImmediatePriority,an=a.unstable_UserBlockingPriority,fc=a.unstable_NormalPriority,pc=a.unstable_LowPriority,mu=a.unstable_IdlePriority,Ns=null,ui=null;function _h(o){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(Ns,o,void 0,(o.current.flags&128)===128)}catch{}}var ks=Math.clz32?Math.clz32:Gd,Zd=Math.log,bl=Math.LN2;function Gd(o){return o>>>=0,o===0?32:31-(Zd(o)/bl|0)|0}var gu=64,yu=4194304;function mc(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function wl(o,d){var x=o.pendingLanes;if(x===0)return 0;var C=0,R=o.suspendedLanes,O=o.pingedLanes,J=x&268435455;if(J!==0){var me=J&~R;me!==0?C=mc(me):(O&=J,O!==0&&(C=mc(O)))}else J=x&~R,J!==0?C=mc(J):O!==0&&(C=mc(O));if(C===0)return 0;if(d!==0&&d!==C&&(d&R)===0&&(R=C&-C,O=d&-d,R>=O||R===16&&(O&4194240)!==0))return d;if((C&4)!==0&&(C|=x&16),d=o.entangledLanes,d!==0)for(o=o.entanglements,d&=C;0<d;)x=31-ks(d),R=1<<x,C|=o[x],d&=~R;return C}function Sl(o,d){switch(o){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vh(o,d){for(var x=o.suspendedLanes,C=o.pingedLanes,R=o.expirationTimes,O=o.pendingLanes;0<O;){var J=31-ks(O),me=1<<J,Ee=R[J];Ee===-1?((me&x)===0||(me&C)!==0)&&(R[J]=Sl(me,d)):Ee<=d&&(o.expiredLanes|=me),O&=~me}}function gc(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function No(){var o=gu;return gu<<=1,(gu&4194240)===0&&(gu=64),o}function yc(o){for(var d=[],x=0;31>x;x++)d.push(o);return d}function Bo(o,d,x){o.pendingLanes|=d,d!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,d=31-ks(d),o[d]=x}function Qf(o,d){var x=o.pendingLanes&~d;o.pendingLanes=d,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=d,o.mutableReadLanes&=d,o.entangledLanes&=d,d=o.entanglements;var C=o.eventTimes;for(o=o.expirationTimes;0<x;){var R=31-ks(x),O=1<<R;d[R]=0,C[R]=-1,o[R]=-1,x&=~O}}function co(o,d){var x=o.entangledLanes|=d;for(o=o.entanglements;x;){var C=31-ks(x),R=1<<C;R&d|o[C]&d&&(o[C]|=d),x&=~R}}var qr=0;function Es(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Er,Aa,Ra,ca,uo,Pr=!1,ua=[],Bs=null,$s=null,kn=null,En=new Map,Gn=new Map,fn=[],cn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xh(o,d){switch(o){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":En.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gn.delete(d.pointerId)}}function qn(o,d,x,C,R,O){return o===null||o.nativeEvent!==O?(o={blockedOn:d,domEventName:x,eventSystemFlags:C,nativeEvent:O,targetContainers:[R]},d!==null&&(d=Zl(d),d!==null&&Aa(d)),o):(o.eventSystemFlags|=C,d=o.targetContainers,R!==null&&d.indexOf(R)===-1&&d.push(R),o)}function ds(o,d,x,C,R){switch(d){case"focusin":return Bs=qn(Bs,o,d,x,C,R),!0;case"dragenter":return $s=qn($s,o,d,x,C,R),!0;case"mouseover":return kn=qn(kn,o,d,x,C,R),!0;case"pointerover":var O=R.pointerId;return En.set(O,qn(En.get(O)||null,o,d,x,C,R)),!0;case"gotpointercapture":return O=R.pointerId,Gn.set(O,qn(Gn.get(O)||null,o,d,x,C,R)),!0}return!1}function hi(o){var d=Va(o.target);if(d!==null){var x=pr(d);if(x!==null){if(d=x.tag,d===13){if(d=ri(x),d!==null){o.blockedOn=d,uo(o.priority,function(){Ra(x)});return}}else if(d===3&&x.stateNode.current.memoizedState.isDehydrated){o.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}o.blockedOn=null}function on(o){if(o.blockedOn!==null)return!1;for(var d=o.targetContainers;0<d.length;){var x=fo(o.domEventName,o.eventSystemFlags,d[0],o.nativeEvent);if(x===null){x=o.nativeEvent;var C=new x.constructor(x.type,x);qe=C,x.target.dispatchEvent(C),qe=null}else return d=Zl(x),d!==null&&Aa(d),o.blockedOn=x,!1;d.shift()}return!0}function ho(o,d,x){on(o)&&x.delete(d)}function nr(){Pr=!1,Bs!==null&&on(Bs)&&(Bs=null),$s!==null&&on($s)&&($s=null),kn!==null&&on(kn)&&(kn=null),En.forEach(ho),Gn.forEach(ho)}function ur(o,d){o.blockedOn===d&&(o.blockedOn=null,Pr||(Pr=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,nr)))}function fs(o){function d(R){return ur(R,o)}if(0<ua.length){ur(ua[0],o);for(var x=1;x<ua.length;x++){var C=ua[x];C.blockedOn===o&&(C.blockedOn=null)}}for(Bs!==null&&ur(Bs,o),$s!==null&&ur($s,o),kn!==null&&ur(kn,o),En.forEach(d),Gn.forEach(d),x=0;x<fn.length;x++)C=fn[x],C.blockedOn===o&&(C.blockedOn=null);for(;0<fn.length&&(x=fn[0],x.blockedOn===null);)hi(x),x.blockedOn===null&&fn.shift()}var Ir=De.ReactCurrentBatchConfig,bi=!0;function ha(o,d,x,C){var R=qr,O=Ir.transition;Ir.transition=null;try{qr=1,Tl(o,d,x,C)}finally{qr=R,Ir.transition=O}}function da(o,d,x,C){var R=qr,O=Ir.transition;Ir.transition=null;try{qr=4,Tl(o,d,x,C)}finally{qr=R,Ir.transition=O}}function Tl(o,d,x,C){if(bi){var R=fo(o,d,x,C);if(R===null)Ho(o,d,C,Pl,x),xh(o,C);else if(ds(R,o,d,x,C))C.stopPropagation();else if(xh(o,C),d&4&&-1<cn.indexOf(o)){for(;R!==null;){var O=Zl(R);if(O!==null&&Er(O),O=fo(o,d,x,C),O===null&&Ho(o,d,C,Pl,x),O===R)break;R=O}R!==null&&C.stopPropagation()}else Ho(o,d,C,null,x)}}var Pl=null;function fo(o,d,x,C){if(Pl=null,o=nt(C),o=Va(o),o!==null)if(d=pr(o),d===null)o=null;else if(x=d.tag,x===13){if(o=ri(d),o!==null)return o;o=null}else if(x===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;o=null}else d!==o&&(o=null);return Pl=o,null}function Cl(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pu()){case xi:return 1;case an:return 4;case fc:case pc:return 16;case mu:return 536870912;default:return 16}default:return 16}}var Us=null,kl=null,$o=null;function Is(){if($o)return $o;var o,d=kl,x=d.length,C,R="value"in Us?Us.value:Us.textContent,O=R.length;for(o=0;o<x&&d[o]===R[o];o++);var J=x-o;for(C=1;C<=J&&d[x-C]===R[O-C];C++);return $o=R.slice(o,1<C?1-C:void 0)}function Rn(o){var d=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&d===13&&(o=13)):o=d,o===10&&(o=13),32<=o||o===13?o:0}function za(){return!0}function El(){return!1}function Wn(o){function d(x,C,R,O,J){this._reactName=x,this._targetInst=R,this.type=C,this.nativeEvent=O,this.target=J,this.currentTarget=null;for(var me in o)o.hasOwnProperty(me)&&(x=o[me],this[me]=x?x(O):O[me]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?za:El,this.isPropagationStopped=El,this}return Ct(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),d}var pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_u=Wn(pn),Da=Ct({},pn,{view:0,detail:0}),bh=Wn(Da),wh,po,zn,mo=Ct({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Il,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==zn&&(zn&&o.type==="mousemove"?(wh=o.screenX-zn.screenX,po=o.screenY-zn.screenY):po=wh=0,zn=o),wh)},movementY:function(o){return"movementY"in o?o.movementY:po}}),Vs=Wn(mo),_c=Ct({},mo,{dataTransfer:0}),vc=Wn(_c),xc=Ct({},Da,{relatedTarget:0}),ni=Wn(xc),qd=Ct({},pn,{animationName:0,elapsedTime:0,pseudoElement:0}),vu=Wn(qd),Jf=Ct({},pn,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Sh=Wn(Jf),ep=Ct({},pn,{data:0}),Wd=Wn(ep),xu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ph(o){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(o):(o=Uo[o])?!!d[o]:!1}function Il(){return Ph}var Zs=Ct({},Da,{key:function(o){if(o.key){var d=xu[o.key]||o.key;if(d!=="Unidentified")return d}return o.type==="keypress"?(o=Rn(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Th[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Il,charCode:function(o){return o.type==="keypress"?Rn(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Rn(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),tp=Wn(Zs),bu=Ct({},mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ml=Wn(bu),bc=Ct({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Il}),rp=Wn(bc),wu=Ct({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0}),np=Wn(wu),Vo=Ct({},mo,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Hd=Wn(Vo),Ch=[9,13,27,32],kh=l&&"CompositionEvent"in window,Al=null;l&&"documentMode"in document&&(Al=document.documentMode);var Eh=l&&"TextEvent"in window&&!Al,Ih=l&&(!kh||Al&&8<Al&&11>=Al),wc=" ",Mh=!1;function Ah(o,d){switch(o){case"keyup":return Ch.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function go(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var yo=!1;function Rh(o,d){switch(o){case"compositionend":return go(d);case"keypress":return d.which!==32?null:(Mh=!0,wc);case"textInput":return o=d.data,o===wc&&Mh?null:o;default:return null}}function Sc(o,d){if(yo)return o==="compositionend"||!kh&&Ah(o,d)?(o=Is(),$o=kl=Us=null,yo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Ih&&d.locale!=="ko"?null:d.data;default:return null}}var ip={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rl(o){var d=o&&o.nodeName&&o.nodeName.toLowerCase();return d==="input"?!!ip[o.type]:d==="textarea"}function zh(o,d,x,C){rr(C),d=Rc(d,"onChange"),0<d.length&&(x=new _u("onChange","change",null,x,C),o.push({event:x,listeners:d}))}var Tc=null,zl=null;function Kd(o){Jd(o,0)}function Dl(o){var d=Xo(o);if(ln(d))return o}function Dh(o,d){if(o==="change")return d}var Lh=!1;if(l){var Ll;if(l){var Gs="oninput"in document;if(!Gs){var Ur=document.createElement("div");Ur.setAttribute("oninput","return;"),Gs=typeof Ur.oninput=="function"}Ll=Gs}else Ll=!1;Lh=Ll&&(!document.documentMode||9<document.documentMode)}function Su(){Tc&&(Tc.detachEvent("onpropertychange",Tu),zl=Tc=null)}function Tu(o){if(o.propertyName==="value"&&Dl(zl)){var d=[];zh(d,zl,o,nt(o)),dn(Kd,d)}}function Xd(o,d,x){o==="focusin"?(Su(),Tc=d,zl=x,Tc.attachEvent("onpropertychange",Tu)):o==="focusout"&&Su()}function Fh(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Dl(zl)}function Zo(o,d){if(o==="click")return Dl(d)}function Oh(o,d){if(o==="input"||o==="change")return Dl(d)}function sp(o,d){return o===d&&(o!==0||1/o===1/d)||o!==o&&d!==d}var qs=typeof Object.is=="function"?Object.is:sp;function Pc(o,d){if(qs(o,d))return!0;if(typeof o!="object"||o===null||typeof d!="object"||d===null)return!1;var x=Object.keys(o),C=Object.keys(d);if(x.length!==C.length)return!1;for(C=0;C<x.length;C++){var R=x[C];if(!L.call(d,R)||!qs(o[R],d[R]))return!1}return!0}function Yd(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function jh(o,d){var x=Yd(o);o=0;for(var C;x;){if(x.nodeType===3){if(C=o+x.textContent.length,o<=d&&C>=d)return{node:x,offset:d-o};o=C}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=Yd(x)}}function Qd(o,d){return o&&d?o===d?!0:o&&o.nodeType===3?!1:d&&d.nodeType===3?Qd(o,d.parentNode):"contains"in o?o.contains(d):o.compareDocumentPosition?!!(o.compareDocumentPosition(d)&16):!1:!1}function Nh(){for(var o=window,d=Vr();d instanceof o.HTMLIFrameElement;){try{var x=typeof d.contentWindow.location.href=="string"}catch{x=!1}if(x)o=d.contentWindow;else break;d=Vr(o.document)}return d}function Fl(o){var d=o&&o.nodeName&&o.nodeName.toLowerCase();return d&&(d==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||d==="textarea"||o.contentEditable==="true")}function Pu(o){var d=Nh(),x=o.focusedElem,C=o.selectionRange;if(d!==x&&x&&x.ownerDocument&&Qd(x.ownerDocument.documentElement,x)){if(C!==null&&Fl(x)){if(d=C.start,o=C.end,o===void 0&&(o=d),"selectionStart"in x)x.selectionStart=d,x.selectionEnd=Math.min(o,x.value.length);else if(o=(d=x.ownerDocument||document)&&d.defaultView||window,o.getSelection){o=o.getSelection();var R=x.textContent.length,O=Math.min(C.start,R);C=C.end===void 0?O:Math.min(C.end,R),!o.extend&&O>C&&(R=C,C=O,O=R),R=jh(x,O);var J=jh(x,C);R&&J&&(o.rangeCount!==1||o.anchorNode!==R.node||o.anchorOffset!==R.offset||o.focusNode!==J.node||o.focusOffset!==J.offset)&&(d=d.createRange(),d.setStart(R.node,R.offset),o.removeAllRanges(),O>C?(o.addRange(d),o.extend(J.node,J.offset)):(d.setEnd(J.node,J.offset),o.addRange(d)))}}for(d=[],o=x;o=o.parentNode;)o.nodeType===1&&d.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<d.length;x++)o=d[x],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Cu=l&&"documentMode"in document&&11>=document.documentMode,_o=null,La=null,Fa=null,vo=!1;function ps(o,d,x){var C=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;vo||_o==null||_o!==Vr(C)||(C=_o,"selectionStart"in C&&Fl(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),Fa&&Pc(Fa,C)||(Fa=C,C=Rc(La,"onSelect"),0<C.length&&(d=new _u("onSelect","select",null,d,x),o.push({event:d,listeners:C}),d.target=_o)))}function Cc(o,d){var x={};return x[o.toLowerCase()]=d.toLowerCase(),x["Webkit"+o]="webkit"+d,x["Moz"+o]="moz"+d,x}var Go={animationend:Cc("Animation","AnimationEnd"),animationiteration:Cc("Animation","AnimationIteration"),animationstart:Cc("Animation","AnimationStart"),transitionend:Cc("Transition","TransitionEnd")},kc={},xo={};l&&(xo=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function qo(o){if(kc[o])return kc[o];if(!Go[o])return o;var d=Go[o],x;for(x in d)if(d.hasOwnProperty(x)&&x in xo)return kc[o]=d[x];return o}var Ec=qo("animationend"),Ol=qo("animationiteration"),Ic=qo("animationstart"),Bh=qo("transitionend"),Wo=new Map,Oa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ja(o,d){Wo.set(o,d),P(d,[o])}for(var Mc=0;Mc<Oa.length;Mc++){var Mr=Oa[Mc],Ac=Mr.toLowerCase(),ap=Mr[0].toUpperCase()+Mr.slice(1);ja(Ac,"on"+ap)}ja(Ec,"onAnimationEnd"),ja(Ol,"onAnimationIteration"),ja(Ic,"onAnimationStart"),ja("dblclick","onDoubleClick"),ja("focusin","onFocus"),ja("focusout","onBlur"),ja(Bh,"onTransitionEnd"),w("onMouseEnter",["mouseout","mouseover"]),w("onMouseLeave",["mouseout","mouseover"]),w("onPointerEnter",["pointerout","pointerover"]),w("onPointerLeave",["pointerout","pointerover"]),P("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),P("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),P("onBeforeInput",["compositionend","keypress","textInput","paste"]),P("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),P("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),P("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bo=new Set("cancel close invalid load scroll toggle".split(" ").concat(jl));function $h(o,d,x){var C=o.type||"unknown-event";o.currentTarget=x,Dr(C,d,void 0,o),o.currentTarget=null}function Jd(o,d){d=(d&4)!==0;for(var x=0;x<o.length;x++){var C=o[x],R=C.event;C=C.listeners;e:{var O=void 0;if(d)for(var J=C.length-1;0<=J;J--){var me=C[J],Ee=me.instance,He=me.currentTarget;if(me=me.listener,Ee!==O&&R.isPropagationStopped())break e;$h(R,me,He),O=Ee}else for(J=0;J<C.length;J++){if(me=C[J],Ee=me.instance,He=me.currentTarget,me=me.listener,Ee!==O&&R.isPropagationStopped())break e;$h(R,me,He),O=Ee}}}if($r)throw o=vi,$r=!1,vi=null,o}function gn(o,d){var x=d[$a];x===void 0&&(x=d[$a]=new Set);var C=o+"__bubble";x.has(C)||(Bl(d,o,2,!1),x.add(C))}function Uh(o,d,x){var C=0;d&&(C|=4),Bl(x,o,C,d)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function wo(o){if(!o[Nl]){o[Nl]=!0,m.forEach(function(x){x!=="selectionchange"&&(bo.has(x)||Uh(x,!1,o),Uh(x,!0,o))});var d=o.nodeType===9?o:o.ownerDocument;d===null||d[Nl]||(d[Nl]=!0,Uh("selectionchange",!1,d))}}function Bl(o,d,x,C){switch(Cl(d)){case 1:var R=ha;break;case 4:R=da;break;default:R=Tl}x=R.bind(null,d,x,o),R=void 0,!cr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(R=!0),C?R!==void 0?o.addEventListener(d,x,{capture:!0,passive:R}):o.addEventListener(d,x,!0):R!==void 0?o.addEventListener(d,x,{passive:R}):o.addEventListener(d,x,!1)}function Ho(o,d,x,C,R){var O=C;if((d&1)===0&&(d&2)===0&&C!==null)e:for(;;){if(C===null)return;var J=C.tag;if(J===3||J===4){var me=C.stateNode.containerInfo;if(me===R||me.nodeType===8&&me.parentNode===R)break;if(J===4)for(J=C.return;J!==null;){var Ee=J.tag;if((Ee===3||Ee===4)&&(Ee=J.stateNode.containerInfo,Ee===R||Ee.nodeType===8&&Ee.parentNode===R))return;J=J.return}for(;me!==null;){if(J=Va(me),J===null)return;if(Ee=J.tag,Ee===5||Ee===6){C=O=J;continue e}me=me.parentNode}}C=C.return}dn(function(){var He=O,dt=nt(x),ct=[];e:{var at=Wo.get(o);if(at!==void 0){var Ot=_u,Vt=o;switch(o){case"keypress":if(Rn(x)===0)break e;case"keydown":case"keyup":Ot=tp;break;case"focusin":Vt="focus",Ot=ni;break;case"focusout":Vt="blur",Ot=ni;break;case"beforeblur":case"afterblur":Ot=ni;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ot=Vs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ot=vc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ot=rp;break;case Ec:case Ol:case Ic:Ot=vu;break;case Bh:Ot=np;break;case"scroll":Ot=bh;break;case"wheel":Ot=Hd;break;case"copy":case"cut":case"paste":Ot=Sh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ot=Ml}var Qt=(d&4)!==0,In=!Qt&&o==="scroll",Ve=Qt?at!==null?at+"Capture":null:at;Qt=[];for(var Fe=He,Ge;Fe!==null;){Ge=Fe;var bt=Ge.stateNode;if(Ge.tag===5&&bt!==null&&(Ge=bt,Ve!==null&&(bt=Tr(Fe,Ve),bt!=null&&Qt.push(Ko(Fe,bt,Ge)))),In)break;Fe=Fe.return}0<Qt.length&&(at=new Ot(at,Vt,null,x,dt),ct.push({event:at,listeners:Qt}))}}if((d&7)===0){e:{if(at=o==="mouseover"||o==="pointerover",Ot=o==="mouseout"||o==="pointerout",at&&x!==qe&&(Vt=x.relatedTarget||x.fromElement)&&(Va(Vt)||Vt[ma]))break e;if((Ot||at)&&(at=dt.window===dt?dt:(at=dt.ownerDocument)?at.defaultView||at.parentWindow:window,Ot?(Vt=x.relatedTarget||x.toElement,Ot=He,Vt=Vt?Va(Vt):null,Vt!==null&&(In=pr(Vt),Vt!==In||Vt.tag!==5&&Vt.tag!==6)&&(Vt=null)):(Ot=null,Vt=He),Ot!==Vt)){if(Qt=Vs,bt="onMouseLeave",Ve="onMouseEnter",Fe="mouse",(o==="pointerout"||o==="pointerover")&&(Qt=Ml,bt="onPointerLeave",Ve="onPointerEnter",Fe="pointer"),In=Ot==null?at:Xo(Ot),Ge=Vt==null?at:Xo(Vt),at=new Qt(bt,Fe+"leave",Ot,x,dt),at.target=In,at.relatedTarget=Ge,bt=null,Va(dt)===He&&(Qt=new Qt(Ve,Fe+"enter",Vt,x,dt),Qt.target=Ge,Qt.relatedTarget=In,bt=Qt),In=bt,Ot&&Vt)t:{for(Qt=Ot,Ve=Vt,Fe=0,Ge=Qt;Ge;Ge=fa(Ge))Fe++;for(Ge=0,bt=Ve;bt;bt=fa(bt))Ge++;for(;0<Fe-Ge;)Qt=fa(Qt),Fe--;for(;0<Ge-Fe;)Ve=fa(Ve),Ge--;for(;Fe--;){if(Qt===Ve||Ve!==null&&Qt===Ve.alternate)break t;Qt=fa(Qt),Ve=fa(Ve)}Qt=null}else Qt=null;Ot!==null&&$l(ct,at,Ot,Qt,!1),Vt!==null&&In!==null&&$l(ct,In,Vt,Qt,!0)}}e:{if(at=He?Xo(He):window,Ot=at.nodeName&&at.nodeName.toLowerCase(),Ot==="select"||Ot==="input"&&at.type==="file")var Gt=Dh;else if(Rl(at))if(Lh)Gt=Oh;else{Gt=Fh;var hr=Xd}else(Ot=at.nodeName)&&Ot.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(Gt=Zo);if(Gt&&(Gt=Gt(o,He))){zh(ct,Gt,x,dt);break e}hr&&hr(o,at,He),o==="focusout"&&(hr=at._wrapperState)&&hr.controlled&&at.type==="number"&&Zn(at,"number",at.value)}switch(hr=He?Xo(He):window,o){case"focusin":(Rl(hr)||hr.contentEditable==="true")&&(_o=hr,La=He,Fa=null);break;case"focusout":Fa=La=_o=null;break;case"mousedown":vo=!0;break;case"contextmenu":case"mouseup":case"dragend":vo=!1,ps(ct,x,dt);break;case"selectionchange":if(Cu)break;case"keydown":case"keyup":ps(ct,x,dt)}var dr;if(kh)e:{switch(o){case"compositionstart":var vr="onCompositionStart";break e;case"compositionend":vr="onCompositionEnd";break e;case"compositionupdate":vr="onCompositionUpdate";break e}vr=void 0}else yo?Ah(o,x)&&(vr="onCompositionEnd"):o==="keydown"&&x.keyCode===229&&(vr="onCompositionStart");vr&&(Ih&&x.locale!=="ko"&&(yo||vr!=="onCompositionStart"?vr==="onCompositionEnd"&&yo&&(dr=Is()):(Us=dt,kl="value"in Us?Us.value:Us.textContent,yo=!0)),hr=Rc(He,vr),0<hr.length&&(vr=new Wd(vr,o,null,x,dt),ct.push({event:vr,listeners:hr}),dr?vr.data=dr:(dr=go(x),dr!==null&&(vr.data=dr)))),(dr=Eh?Rh(o,x):Sc(o,x))&&(He=Rc(He,"onBeforeInput"),0<He.length&&(dt=new Wd("onBeforeInput","beforeinput",null,x,dt),ct.push({event:dt,listeners:He}),dt.data=dr))}Jd(ct,d)})}function Ko(o,d,x){return{instance:o,listener:d,currentTarget:x}}function Rc(o,d){for(var x=d+"Capture",C=[];o!==null;){var R=o,O=R.stateNode;R.tag===5&&O!==null&&(R=O,O=Tr(o,x),O!=null&&C.unshift(Ko(o,O,R)),O=Tr(o,d),O!=null&&C.push(Ko(o,O,R))),o=o.return}return C}function fa(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function $l(o,d,x,C,R){for(var O=d._reactName,J=[];x!==null&&x!==C;){var me=x,Ee=me.alternate,He=me.stateNode;if(Ee!==null&&Ee===C)break;me.tag===5&&He!==null&&(me=He,R?(Ee=Tr(x,O),Ee!=null&&J.unshift(Ko(x,Ee,me))):R||(Ee=Tr(x,O),Ee!=null&&J.push(Ko(x,Ee,me)))),x=x.return}J.length!==0&&o.push({event:d,listeners:J})}var zc=/\r\n?/g,ku=/\u0000|\uFFFD/g;function Eu(o){return(typeof o=="string"?o:""+o).replace(zc,`
`).replace(ku,"")}function pa(o,d,x){if(d=Eu(d),Eu(o)!==d&&x)throw Error(u(425))}function Ul(){}var Vl=null,Na=null;function Dc(o,d){return o==="textarea"||o==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Iu=typeof setTimeout=="function"?setTimeout:void 0,ef=typeof clearTimeout=="function"?clearTimeout:void 0,Lc=typeof Promise=="function"?Promise:void 0,Vh=typeof queueMicrotask=="function"?queueMicrotask:typeof Lc<"u"?function(o){return Lc.resolve(null).then(o).catch(op)}:Iu;function op(o){setTimeout(function(){throw o})}function Fc(o,d){var x=d,C=0;do{var R=x.nextSibling;if(o.removeChild(x),R&&R.nodeType===8)if(x=R.data,x==="/$"){if(C===0){o.removeChild(R),fs(d);return}C--}else x!=="$"&&x!=="$?"&&x!=="$!"||C++;x=R}while(x);fs(d)}function tn(o){for(;o!=null;o=o.nextSibling){var d=o.nodeType;if(d===1||d===3)break;if(d===8){if(d=o.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return o}function Ws(o){o=o.previousSibling;for(var d=0;o;){if(o.nodeType===8){var x=o.data;if(x==="$"||x==="$!"||x==="$?"){if(d===0)return o;d--}else x==="/$"&&d++}o=o.previousSibling}return null}var di=Math.random().toString(36).slice(2),ms="__reactFiber$"+di,Ba="__reactProps$"+di,ma="__reactContainer$"+di,$a="__reactEvents$"+di,Mu="__reactListeners$"+di,Ua="__reactHandles$"+di;function Va(o){var d=o[ms];if(d)return d;for(var x=o.parentNode;x;){if(d=x[ma]||x[ms]){if(x=d.alternate,d.child!==null||x!==null&&x.child!==null)for(o=Ws(o);o!==null;){if(x=o[ms])return x;o=Ws(o)}return d}o=x,x=o.parentNode}return null}function Zl(o){return o=o[ms]||o[ma],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Xo(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(u(33))}function Oc(o){return o[Ba]||null}var Au=[],Yo=-1;function ii(o){return{current:o}}function rn(o){0>Yo||(o.current=Au[Yo],Au[Yo]=null,Yo--)}function Or(o,d){Yo++,Au[Yo]=o.current,o.current=d}var gs={},si=ii(gs),zi=ii(!1),So=gs;function Hs(o,d){var x=o.type.contextTypes;if(!x)return gs;var C=o.stateNode;if(C&&C.__reactInternalMemoizedUnmaskedChildContext===d)return C.__reactInternalMemoizedMaskedChildContext;var R={},O;for(O in x)R[O]=d[O];return C&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=d,o.__reactInternalMemoizedMaskedChildContext=R),R}function wi(o){return o=o.childContextTypes,o!=null}function Za(){rn(zi),rn(si)}function Zh(o,d,x){if(si.current!==gs)throw Error(u(168));Or(si,d),Or(zi,x)}function Di(o,d,x){var C=o.stateNode;if(d=d.childContextTypes,typeof C.getChildContext!="function")return x;C=C.getChildContext();for(var R in C)if(!(R in d))throw Error(u(108,Lr(o)||"Unknown",R));return Ct({},x,C)}function Qi(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||gs,So=si.current,Or(si,o),Or(zi,zi.current),!0}function Qo(o,d,x){var C=o.stateNode;if(!C)throw Error(u(169));x?(o=Di(o,d,So),C.__reactInternalMemoizedMergedChildContext=o,rn(zi),rn(si),Or(si,o)):rn(zi),Or(zi,x)}var Hn=null,Ga=!1,Gh=!1;function Gl(o){Hn===null?Hn=[o]:Hn.push(o)}function lp(o){Ga=!0,Gl(o)}function To(){if(!Gh&&Hn!==null){Gh=!0;var o=0,d=qr;try{var x=Hn;for(qr=1;o<x.length;o++){var C=x[o];do C=C(!0);while(C!==null)}Hn=null,Ga=!1}catch(R){throw Hn!==null&&(Hn=Hn.slice(o+1)),Ma(xi,To),R}finally{qr=d,Gh=!1}}return null}var ga=[],ya=0,Ji=null,kt=0,es=[],Li=0,qa=null,ts=1,Fi="";function _a(o,d){ga[ya++]=kt,ga[ya++]=Ji,Ji=o,kt=d}function Fr(o,d,x){es[Li++]=ts,es[Li++]=Fi,es[Li++]=qa,qa=o;var C=ts;o=Fi;var R=32-ks(C)-1;C&=~(1<<R),x+=1;var O=32-ks(d)+R;if(30<O){var J=R-R%5;O=(C&(1<<J)-1).toString(32),C>>=J,R-=J,ts=1<<32-ks(d)+R|x<<R|C,Fi=O+o}else ts=1<<O|x<<R|C,Fi=o}function ql(o){o.return!==null&&(_a(o,1),Fr(o,1,0))}function qh(o){for(;o===Ji;)Ji=ga[--ya],ga[ya]=null,kt=ga[--ya],ga[ya]=null;for(;o===qa;)qa=es[--Li],es[Li]=null,Fi=es[--Li],es[Li]=null,ts=es[--Li],es[Li]=null}var Si=null,ys=null,vn=!1,_s=null;function Ru(o,d){var x=ta(5,null,null,0);x.elementType="DELETED",x.stateNode=d,x.return=o,d=o.deletions,d===null?(o.deletions=[x],o.flags|=16):d.push(x)}function Wh(o,d){switch(o.tag){case 5:var x=o.type;return d=d.nodeType!==1||x.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(o.stateNode=d,Si=o,ys=tn(d.firstChild),!0):!1;case 6:return d=o.pendingProps===""||d.nodeType!==3?null:d,d!==null?(o.stateNode=d,Si=o,ys=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(x=qa!==null?{id:ts,overflow:Fi}:null,o.memoizedState={dehydrated:d,treeContext:x,retryLane:1073741824},x=ta(18,null,null,0),x.stateNode=d,x.return=o,o.child=x,Si=o,ys=null,!0):!1;default:return!1}}function zu(o){return(o.mode&1)!==0&&(o.flags&128)===0}function jc(o){if(vn){var d=ys;if(d){var x=d;if(!Wh(o,d)){if(zu(o))throw Error(u(418));d=tn(x.nextSibling);var C=Si;d&&Wh(o,d)?Ru(C,x):(o.flags=o.flags&-4097|2,vn=!1,Si=o)}}else{if(zu(o))throw Error(u(418));o.flags=o.flags&-4097|2,vn=!1,Si=o}}}function Hh(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Si=o}function Nc(o){if(o!==Si)return!1;if(!vn)return Hh(o),vn=!0,!1;var d;if((d=o.tag!==3)&&!(d=o.tag!==5)&&(d=o.type,d=d!=="head"&&d!=="body"&&!Dc(o.type,o.memoizedProps)),d&&(d=ys)){if(zu(o))throw Ms(),Error(u(418));for(;d;)Ru(o,d),d=tn(d.nextSibling)}if(Hh(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(u(317));e:{for(o=o.nextSibling,d=0;o;){if(o.nodeType===8){var x=o.data;if(x==="/$"){if(d===0){ys=tn(o.nextSibling);break e}d--}else x!=="$"&&x!=="$!"&&x!=="$?"||d++}o=o.nextSibling}ys=null}}else ys=Si?tn(o.stateNode.nextSibling):null;return!0}function Ms(){for(var o=ys;o;)o=tn(o.nextSibling)}function Wr(){ys=Si=null,vn=!1}function Po(o){_s===null?_s=[o]:_s.push(o)}var Kh=De.ReactCurrentBatchConfig;function Wl(o,d,x){if(o=x.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(u(309));var C=x.stateNode}if(!C)throw Error(u(147,o));var R=C,O=""+o;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===O?d.ref:(d=function(J){var me=R.refs;J===null?delete me[O]:me[O]=J},d._stringRef=O,d)}if(typeof o!="string")throw Error(u(284));if(!x._owner)throw Error(u(290,o))}return o}function Hl(o,d){throw o=Object.prototype.toString.call(d),Error(u(31,o==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":o))}function Du(o){var d=o._init;return d(o._payload)}function Xh(o){function d(Ve,Fe){if(o){var Ge=Ve.deletions;Ge===null?(Ve.deletions=[Fe],Ve.flags|=16):Ge.push(Fe)}}function x(Ve,Fe){if(!o)return null;for(;Fe!==null;)d(Ve,Fe),Fe=Fe.sibling;return null}function C(Ve,Fe){for(Ve=new Map;Fe!==null;)Fe.key!==null?Ve.set(Fe.key,Fe):Ve.set(Fe.index,Fe),Fe=Fe.sibling;return Ve}function R(Ve,Fe){return Ve=sl(Ve,Fe),Ve.index=0,Ve.sibling=null,Ve}function O(Ve,Fe,Ge){return Ve.index=Ge,o?(Ge=Ve.alternate,Ge!==null?(Ge=Ge.index,Ge<Fe?(Ve.flags|=2,Fe):Ge):(Ve.flags|=2,Fe)):(Ve.flags|=1048576,Fe)}function J(Ve){return o&&Ve.alternate===null&&(Ve.flags|=2),Ve}function me(Ve,Fe,Ge,bt){return Fe===null||Fe.tag!==6?(Fe=zp(Ge,Ve.mode,bt),Fe.return=Ve,Fe):(Fe=R(Fe,Ge),Fe.return=Ve,Fe)}function Ee(Ve,Fe,Ge,bt){var Gt=Ge.type;return Gt===lt?dt(Ve,Fe,Ge.props.children,bt,Ge.key):Fe!==null&&(Fe.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===or&&Du(Gt)===Fe.type)?(bt=R(Fe,Ge.props),bt.ref=Wl(Ve,Fe,Ge),bt.return=Ve,bt):(bt=ff(Ge.type,Ge.key,Ge.props,null,Ve.mode,bt),bt.ref=Wl(Ve,Fe,Ge),bt.return=Ve,bt)}function He(Ve,Fe,Ge,bt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==Ge.containerInfo||Fe.stateNode.implementation!==Ge.implementation?(Fe=Dp(Ge,Ve.mode,bt),Fe.return=Ve,Fe):(Fe=R(Fe,Ge.children||[]),Fe.return=Ve,Fe)}function dt(Ve,Fe,Ge,bt,Gt){return Fe===null||Fe.tag!==7?(Fe=Yc(Ge,Ve.mode,bt,Gt),Fe.return=Ve,Fe):(Fe=R(Fe,Ge),Fe.return=Ve,Fe)}function ct(Ve,Fe,Ge){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return Fe=zp(""+Fe,Ve.mode,Ge),Fe.return=Ve,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case Ye:return Ge=ff(Fe.type,Fe.key,Fe.props,null,Ve.mode,Ge),Ge.ref=Wl(Ve,null,Fe),Ge.return=Ve,Ge;case ot:return Fe=Dp(Fe,Ve.mode,Ge),Fe.return=Ve,Fe;case or:var bt=Fe._init;return ct(Ve,bt(Fe._payload),Ge)}if(xe(Fe)||ft(Fe))return Fe=Yc(Fe,Ve.mode,Ge,null),Fe.return=Ve,Fe;Hl(Ve,Fe)}return null}function at(Ve,Fe,Ge,bt){var Gt=Fe!==null?Fe.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return Gt!==null?null:me(Ve,Fe,""+Ge,bt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case Ye:return Ge.key===Gt?Ee(Ve,Fe,Ge,bt):null;case ot:return Ge.key===Gt?He(Ve,Fe,Ge,bt):null;case or:return Gt=Ge._init,at(Ve,Fe,Gt(Ge._payload),bt)}if(xe(Ge)||ft(Ge))return Gt!==null?null:dt(Ve,Fe,Ge,bt,null);Hl(Ve,Ge)}return null}function Ot(Ve,Fe,Ge,bt,Gt){if(typeof bt=="string"&&bt!==""||typeof bt=="number")return Ve=Ve.get(Ge)||null,me(Fe,Ve,""+bt,Gt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case Ye:return Ve=Ve.get(bt.key===null?Ge:bt.key)||null,Ee(Fe,Ve,bt,Gt);case ot:return Ve=Ve.get(bt.key===null?Ge:bt.key)||null,He(Fe,Ve,bt,Gt);case or:var hr=bt._init;return Ot(Ve,Fe,Ge,hr(bt._payload),Gt)}if(xe(bt)||ft(bt))return Ve=Ve.get(Ge)||null,dt(Fe,Ve,bt,Gt,null);Hl(Fe,bt)}return null}function Vt(Ve,Fe,Ge,bt){for(var Gt=null,hr=null,dr=Fe,vr=Fe=0,gi=null;dr!==null&&vr<Ge.length;vr++){dr.index>vr?(gi=dr,dr=null):gi=dr.sibling;var Hr=at(Ve,dr,Ge[vr],bt);if(Hr===null){dr===null&&(dr=gi);break}o&&dr&&Hr.alternate===null&&d(Ve,dr),Fe=O(Hr,Fe,vr),hr===null?Gt=Hr:hr.sibling=Hr,hr=Hr,dr=gi}if(vr===Ge.length)return x(Ve,dr),vn&&_a(Ve,vr),Gt;if(dr===null){for(;vr<Ge.length;vr++)dr=ct(Ve,Ge[vr],bt),dr!==null&&(Fe=O(dr,Fe,vr),hr===null?Gt=dr:hr.sibling=dr,hr=dr);return vn&&_a(Ve,vr),Gt}for(dr=C(Ve,dr);vr<Ge.length;vr++)gi=Ot(dr,Ve,vr,Ge[vr],bt),gi!==null&&(o&&gi.alternate!==null&&dr.delete(gi.key===null?vr:gi.key),Fe=O(gi,Fe,vr),hr===null?Gt=gi:hr.sibling=gi,hr=gi);return o&&dr.forEach(function(ll){return d(Ve,ll)}),vn&&_a(Ve,vr),Gt}function Qt(Ve,Fe,Ge,bt){var Gt=ft(Ge);if(typeof Gt!="function")throw Error(u(150));if(Ge=Gt.call(Ge),Ge==null)throw Error(u(151));for(var hr=Gt=null,dr=Fe,vr=Fe=0,gi=null,Hr=Ge.next();dr!==null&&!Hr.done;vr++,Hr=Ge.next()){dr.index>vr?(gi=dr,dr=null):gi=dr.sibling;var ll=at(Ve,dr,Hr.value,bt);if(ll===null){dr===null&&(dr=gi);break}o&&dr&&ll.alternate===null&&d(Ve,dr),Fe=O(ll,Fe,vr),hr===null?Gt=ll:hr.sibling=ll,hr=ll,dr=gi}if(Hr.done)return x(Ve,dr),vn&&_a(Ve,vr),Gt;if(dr===null){for(;!Hr.done;vr++,Hr=Ge.next())Hr=ct(Ve,Hr.value,bt),Hr!==null&&(Fe=O(Hr,Fe,vr),hr===null?Gt=Hr:hr.sibling=Hr,hr=Hr);return vn&&_a(Ve,vr),Gt}for(dr=C(Ve,dr);!Hr.done;vr++,Hr=Ge.next())Hr=Ot(dr,Ve,vr,Hr.value,bt),Hr!==null&&(o&&Hr.alternate!==null&&dr.delete(Hr.key===null?vr:Hr.key),Fe=O(Hr,Fe,vr),hr===null?Gt=Hr:hr.sibling=Hr,hr=Hr);return o&&dr.forEach(function(dy){return d(Ve,dy)}),vn&&_a(Ve,vr),Gt}function In(Ve,Fe,Ge,bt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===lt&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case Ye:e:{for(var Gt=Ge.key,hr=Fe;hr!==null;){if(hr.key===Gt){if(Gt=Ge.type,Gt===lt){if(hr.tag===7){x(Ve,hr.sibling),Fe=R(hr,Ge.props.children),Fe.return=Ve,Ve=Fe;break e}}else if(hr.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===or&&Du(Gt)===hr.type){x(Ve,hr.sibling),Fe=R(hr,Ge.props),Fe.ref=Wl(Ve,hr,Ge),Fe.return=Ve,Ve=Fe;break e}x(Ve,hr);break}else d(Ve,hr);hr=hr.sibling}Ge.type===lt?(Fe=Yc(Ge.props.children,Ve.mode,bt,Ge.key),Fe.return=Ve,Ve=Fe):(bt=ff(Ge.type,Ge.key,Ge.props,null,Ve.mode,bt),bt.ref=Wl(Ve,Fe,Ge),bt.return=Ve,Ve=bt)}return J(Ve);case ot:e:{for(hr=Ge.key;Fe!==null;){if(Fe.key===hr)if(Fe.tag===4&&Fe.stateNode.containerInfo===Ge.containerInfo&&Fe.stateNode.implementation===Ge.implementation){x(Ve,Fe.sibling),Fe=R(Fe,Ge.children||[]),Fe.return=Ve,Ve=Fe;break e}else{x(Ve,Fe);break}else d(Ve,Fe);Fe=Fe.sibling}Fe=Dp(Ge,Ve.mode,bt),Fe.return=Ve,Ve=Fe}return J(Ve);case or:return hr=Ge._init,In(Ve,Fe,hr(Ge._payload),bt)}if(xe(Ge))return Vt(Ve,Fe,Ge,bt);if(ft(Ge))return Qt(Ve,Fe,Ge,bt);Hl(Ve,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"?(Ge=""+Ge,Fe!==null&&Fe.tag===6?(x(Ve,Fe.sibling),Fe=R(Fe,Ge),Fe.return=Ve,Ve=Fe):(x(Ve,Fe),Fe=zp(Ge,Ve.mode,bt),Fe.return=Ve,Ve=Fe),J(Ve)):x(Ve,Fe)}return In}var Oi=Xh(!0),Bc=Xh(!1),Lt=ii(null),Yt=null,Wa=null,va=null;function Kl(){va=Wa=Yt=null}function fi(o){var d=Lt.current;rn(Lt),o._currentValue=d}function Lu(o,d,x){for(;o!==null;){var C=o.alternate;if((o.childLanes&d)!==d?(o.childLanes|=d,C!==null&&(C.childLanes|=d)):C!==null&&(C.childLanes&d)!==d&&(C.childLanes|=d),o===x)break;o=o.return}}function pi(o,d){Yt=o,va=Wa=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&d)!==0&&(Ds=!0),o.firstContext=null)}function As(o){var d=o._currentValue;if(va!==o)if(o={context:o,memoizedValue:d,next:null},Wa===null){if(Yt===null)throw Error(u(308));Wa=o,Yt.dependencies={lanes:0,firstContext:o}}else Wa=Wa.next=o;return d}var Ks=null;function Yr(o){Ks===null?Ks=[o]:Ks.push(o)}function wn(o,d,x,C){var R=d.interleaved;return R===null?(x.next=x,Yr(d)):(x.next=R.next,R.next=x),d.interleaved=x,Rs(o,C)}function Rs(o,d){o.lanes|=d;var x=o.alternate;for(x!==null&&(x.lanes|=d),x=o,o=o.return;o!==null;)o.childLanes|=d,x=o.alternate,x!==null&&(x.childLanes|=d),x=o,o=o.return;return x.tag===3?x.stateNode:null}var vs=!1;function Co(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fu(o,d){o=o.updateQueue,d.updateQueue===o&&(d.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function rs(o,d){return{eventTime:o,lane:d,tag:0,payload:null,callback:null,next:null}}function ns(o,d,x){var C=o.updateQueue;if(C===null)return null;if(C=C.shared,(Br&2)!==0){var R=C.pending;return R===null?d.next=d:(d.next=R.next,R.next=d),C.pending=d,Rs(o,x)}return R=C.interleaved,R===null?(d.next=d,Yr(C)):(d.next=R.next,R.next=d),C.interleaved=d,Rs(o,x)}function ko(o,d,x){if(d=d.updateQueue,d!==null&&(d=d.shared,(x&4194240)!==0)){var C=d.lanes;C&=o.pendingLanes,x|=C,d.lanes=x,co(o,x)}}function $c(o,d){var x=o.updateQueue,C=o.alternate;if(C!==null&&(C=C.updateQueue,x===C)){var R=null,O=null;if(x=x.firstBaseUpdate,x!==null){do{var J={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};O===null?R=O=J:O=O.next=J,x=x.next}while(x!==null);O===null?R=O=d:O=O.next=d}else R=O=d;x={baseState:C.baseState,firstBaseUpdate:R,lastBaseUpdate:O,shared:C.shared,effects:C.effects},o.updateQueue=x;return}o=x.lastBaseUpdate,o===null?x.firstBaseUpdate=d:o.next=d,x.lastBaseUpdate=d}function xa(o,d,x,C){var R=o.updateQueue;vs=!1;var O=R.firstBaseUpdate,J=R.lastBaseUpdate,me=R.shared.pending;if(me!==null){R.shared.pending=null;var Ee=me,He=Ee.next;Ee.next=null,J===null?O=He:J.next=He,J=Ee;var dt=o.alternate;dt!==null&&(dt=dt.updateQueue,me=dt.lastBaseUpdate,me!==J&&(me===null?dt.firstBaseUpdate=He:me.next=He,dt.lastBaseUpdate=Ee))}if(O!==null){var ct=R.baseState;J=0,dt=He=Ee=null,me=O;do{var at=me.lane,Ot=me.eventTime;if((C&at)===at){dt!==null&&(dt=dt.next={eventTime:Ot,lane:0,tag:me.tag,payload:me.payload,callback:me.callback,next:null});e:{var Vt=o,Qt=me;switch(at=d,Ot=x,Qt.tag){case 1:if(Vt=Qt.payload,typeof Vt=="function"){ct=Vt.call(Ot,ct,at);break e}ct=Vt;break e;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Qt.payload,at=typeof Vt=="function"?Vt.call(Ot,ct,at):Vt,at==null)break e;ct=Ct({},ct,at);break e;case 2:vs=!0}}me.callback!==null&&me.lane!==0&&(o.flags|=64,at=R.effects,at===null?R.effects=[me]:at.push(me))}else Ot={eventTime:Ot,lane:at,tag:me.tag,payload:me.payload,callback:me.callback,next:null},dt===null?(He=dt=Ot,Ee=ct):dt=dt.next=Ot,J|=at;if(me=me.next,me===null){if(me=R.shared.pending,me===null)break;at=me,me=at.next,at.next=null,R.lastBaseUpdate=at,R.shared.pending=null}}while(!0);if(dt===null&&(Ee=ct),R.baseState=Ee,R.firstBaseUpdate=He,R.lastBaseUpdate=dt,d=R.shared.interleaved,d!==null){R=d;do J|=R.lane,R=R.next;while(R!==d)}else O===null&&(R.shared.lanes=0);Ql|=J,o.lanes=J,o.memoizedState=ct}}function Ou(o,d,x){if(o=d.effects,d.effects=null,o!==null)for(d=0;d<o.length;d++){var C=o[d],R=C.callback;if(R!==null){if(C.callback=null,C=x,typeof R!="function")throw Error(u(191,R));R.call(C)}}}var Jo={},xs=ii(Jo),el=ii(Jo),g=ii(Jo);function e(o){if(o===Jo)throw Error(u(174));return o}function s(o,d){switch(Or(g,d),Or(el,o),Or(xs,Jo),o=d.nodeType,o){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:_r(null,"");break;default:o=o===8?d.parentNode:d,d=o.namespaceURI||null,o=o.tagName,d=_r(d,o)}rn(xs),Or(xs,d)}function h(){rn(xs),rn(el),rn(g)}function p(o){e(g.current);var d=e(xs.current),x=_r(d,o.type);d!==x&&(Or(el,o),Or(xs,x))}function y(o){el.current===o&&(rn(xs),rn(el))}var S=ii(0);function E(o){for(var d=o;d!==null;){if(d.tag===13){var x=d.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var I=[];function z(){for(var o=0;o<I.length;o++)I[o]._workInProgressVersionPrimary=null;I.length=0}var D=De.ReactCurrentDispatcher,B=De.ReactCurrentBatchConfig,j=0,$=null,W=null,re=null,se=!1,ae=!1,oe=0,de=0;function le(){throw Error(u(321))}function ge(o,d){if(d===null)return!1;for(var x=0;x<d.length&&x<o.length;x++)if(!qs(o[x],d[x]))return!1;return!0}function we(o,d,x,C,R,O){if(j=O,$=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,D.current=o===null||o.memoizedState===null?Bn:Uc,o=x(C,R),ae){O=0;do{if(ae=!1,oe=0,25<=O)throw Error(u(301));O+=1,re=W=null,d.updateQueue=null,D.current=Xl,o=x(C,R)}while(ae)}if(D.current=Bi,d=W!==null&&W.next!==null,j=0,re=W=$=null,se=!1,d)throw Error(u(300));return o}function he(){var o=oe!==0;return oe=0,o}function ke(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return re===null?$.memoizedState=re=o:re=re.next=o,re}function $e(){if(W===null){var o=$.alternate;o=o!==null?o.memoizedState:null}else o=W.next;var d=re===null?$.memoizedState:re.next;if(d!==null)re=d,W=o;else{if(o===null)throw Error(u(310));W=o,o={memoizedState:W.memoizedState,baseState:W.baseState,baseQueue:W.baseQueue,queue:W.queue,next:null},re===null?$.memoizedState=re=o:re=re.next=o}return re}function je(o,d){return typeof d=="function"?d(o):d}function Ne(o){var d=$e(),x=d.queue;if(x===null)throw Error(u(311));x.lastRenderedReducer=o;var C=W,R=C.baseQueue,O=x.pending;if(O!==null){if(R!==null){var J=R.next;R.next=O.next,O.next=J}C.baseQueue=R=O,x.pending=null}if(R!==null){O=R.next,C=C.baseState;var me=J=null,Ee=null,He=O;do{var dt=He.lane;if((j&dt)===dt)Ee!==null&&(Ee=Ee.next={lane:0,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),C=He.hasEagerState?He.eagerState:o(C,He.action);else{var ct={lane:dt,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};Ee===null?(me=Ee=ct,J=C):Ee=Ee.next=ct,$.lanes|=dt,Ql|=dt}He=He.next}while(He!==null&&He!==O);Ee===null?J=C:Ee.next=me,qs(C,d.memoizedState)||(Ds=!0),d.memoizedState=C,d.baseState=J,d.baseQueue=Ee,x.lastRenderedState=C}if(o=x.interleaved,o!==null){R=o;do O=R.lane,$.lanes|=O,Ql|=O,R=R.next;while(R!==o)}else R===null&&(x.lanes=0);return[d.memoizedState,x.dispatch]}function Ze(o){var d=$e(),x=d.queue;if(x===null)throw Error(u(311));x.lastRenderedReducer=o;var C=x.dispatch,R=x.pending,O=d.memoizedState;if(R!==null){x.pending=null;var J=R=R.next;do O=o(O,J.action),J=J.next;while(J!==R);qs(O,d.memoizedState)||(Ds=!0),d.memoizedState=O,d.baseQueue===null&&(d.baseState=O),x.lastRenderedState=O}return[O,C]}function ht(){}function mt(o,d){var x=$,C=$e(),R=d(),O=!qs(C.memoizedState,R);if(O&&(C.memoizedState=R,Ds=!0),C=C.queue,Ln(br.bind(null,x,C,o),[o]),C.getSnapshot!==d||O||re!==null&&re.memoizedState.tag&1){if(x.flags|=2048,un(9,Ft.bind(null,x,C,R,d),void 0,null),Yn===null)throw Error(u(349));(j&30)!==0||rt(x,d,R)}return R}function rt(o,d,x){o.flags|=16384,o={getSnapshot:d,value:x},d=$.updateQueue,d===null?(d={lastEffect:null,stores:null},$.updateQueue=d,d.stores=[o]):(x=d.stores,x===null?d.stores=[o]:x.push(o))}function Ft(o,d,x,C){d.value=x,d.getSnapshot=C,Zr(d)&&nn(o)}function br(o,d,x){return x(function(){Zr(d)&&nn(o)})}function Zr(o){var d=o.getSnapshot;o=o.value;try{var x=d();return!qs(o,x)}catch{return!0}}function nn(o){var d=Rs(o,1);d!==null&&Ja(d,o,1,-1)}function Qr(o){var d=ke();return typeof o=="function"&&(o=o()),d.memoizedState=d.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:je,lastRenderedState:o},d.queue=o,o=o.dispatch=Ni.bind(null,$,o),[d.memoizedState,o]}function un(o,d,x,C){return o={tag:o,create:d,destroy:x,deps:C,next:null},d=$.updateQueue,d===null?(d={lastEffect:null,stores:null},$.updateQueue=d,d.lastEffect=o.next=o):(x=d.lastEffect,x===null?d.lastEffect=o.next=o:(C=x.next,x.next=o,o.next=C,d.lastEffect=o)),o}function xn(){return $e().memoizedState}function mr(o,d,x,C){var R=ke();$.flags|=o,R.memoizedState=un(1|d,x,void 0,C===void 0?null:C)}function Xr(o,d,x,C){var R=$e();C=C===void 0?null:C;var O=void 0;if(W!==null){var J=W.memoizedState;if(O=J.destroy,C!==null&&ge(C,J.deps)){R.memoizedState=un(d,x,O,C);return}}$.flags|=o,R.memoizedState=un(1|d,x,O,C)}function Dn(o,d){return mr(8390656,8,o,d)}function Ln(o,d){return Xr(2048,8,o,d)}function Kn(o,d){return Xr(4,2,o,d)}function Ti(o,d){return Xr(4,4,o,d)}function zs(o,d){if(typeof d=="function")return o=o(),d(o),function(){d(null)};if(d!=null)return o=o(),d.current=o,function(){d.current=null}}function Ha(o,d,x){return x=x!=null?x.concat([o]):null,Xr(4,4,zs.bind(null,d,o),x)}function ba(){}function tl(o,d){var x=$e();d=d===void 0?null:d;var C=x.memoizedState;return C!==null&&d!==null&&ge(d,C[1])?C[0]:(x.memoizedState=[o,d],o)}function rl(o,d){var x=$e();d=d===void 0?null:d;var C=x.memoizedState;return C!==null&&d!==null&&ge(d,C[1])?C[0]:(o=o(),x.memoizedState=[o,d],o)}function Eo(o,d,x){return(j&21)===0?(o.baseState&&(o.baseState=!1,Ds=!0),o.memoizedState=x):(qs(x,d)||(x=No(),$.lanes|=x,Ql|=x,o.baseState=!0),d)}function nl(o,d){var x=qr;qr=x!==0&&4>x?x:4,o(!0);var C=B.transition;B.transition={};try{o(!1),d()}finally{qr=x,B.transition=C}}function ji(){return $e().memoizedState}function Xs(o,d,x){var C=Ao(o);if(x={lane:C,action:x,hasEagerState:!1,eagerState:null,next:null},Ka(o))Fn(d,x);else if(x=wn(o,d,x,C),x!==null){var R=mi();Ja(x,o,C,R),Nn(x,d,C)}}function Ni(o,d,x){var C=Ao(o),R={lane:C,action:x,hasEagerState:!1,eagerState:null,next:null};if(Ka(o))Fn(d,R);else{var O=o.alternate;if(o.lanes===0&&(O===null||O.lanes===0)&&(O=d.lastRenderedReducer,O!==null))try{var J=d.lastRenderedState,me=O(J,x);if(R.hasEagerState=!0,R.eagerState=me,qs(me,J)){var Ee=d.interleaved;Ee===null?(R.next=R,Yr(d)):(R.next=Ee.next,Ee.next=R),d.interleaved=R;return}}catch{}finally{}x=wn(o,d,R,C),x!==null&&(R=mi(),Ja(x,o,C,R),Nn(x,d,C))}}function Ka(o){var d=o.alternate;return o===$||d!==null&&d===$}function Fn(o,d){ae=se=!0;var x=o.pending;x===null?d.next=d:(d.next=x.next,x.next=d),o.pending=d}function Nn(o,d,x){if((x&4194240)!==0){var C=d.lanes;C&=o.pendingLanes,x|=C,d.lanes=x,co(o,x)}}var Bi={readContext:As,useCallback:le,useContext:le,useEffect:le,useImperativeHandle:le,useInsertionEffect:le,useLayoutEffect:le,useMemo:le,useReducer:le,useRef:le,useState:le,useDebugValue:le,useDeferredValue:le,useTransition:le,useMutableSource:le,useSyncExternalStore:le,useId:le,unstable_isNewReconciler:!1},Bn={readContext:As,useCallback:function(o,d){return ke().memoizedState=[o,d===void 0?null:d],o},useContext:As,useEffect:Dn,useImperativeHandle:function(o,d,x){return x=x!=null?x.concat([o]):null,mr(4194308,4,zs.bind(null,d,o),x)},useLayoutEffect:function(o,d){return mr(4194308,4,o,d)},useInsertionEffect:function(o,d){return mr(4,2,o,d)},useMemo:function(o,d){var x=ke();return d=d===void 0?null:d,o=o(),x.memoizedState=[o,d],o},useReducer:function(o,d,x){var C=ke();return d=x!==void 0?x(d):d,C.memoizedState=C.baseState=d,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:d},C.queue=o,o=o.dispatch=Xs.bind(null,$,o),[C.memoizedState,o]},useRef:function(o){var d=ke();return o={current:o},d.memoizedState=o},useState:Qr,useDebugValue:ba,useDeferredValue:function(o){return ke().memoizedState=o},useTransition:function(){var o=Qr(!1),d=o[0];return o=nl.bind(null,o[1]),ke().memoizedState=o,[d,o]},useMutableSource:function(){},useSyncExternalStore:function(o,d,x){var C=$,R=ke();if(vn){if(x===void 0)throw Error(u(407));x=x()}else{if(x=d(),Yn===null)throw Error(u(349));(j&30)!==0||rt(C,d,x)}R.memoizedState=x;var O={value:x,getSnapshot:d};return R.queue=O,Dn(br.bind(null,C,O,o),[o]),C.flags|=2048,un(9,Ft.bind(null,C,O,x,d),void 0,null),x},useId:function(){var o=ke(),d=Yn.identifierPrefix;if(vn){var x=Fi,C=ts;x=(C&~(1<<32-ks(C)-1)).toString(32)+x,d=":"+d+"R"+x,x=oe++,0<x&&(d+="H"+x.toString(32)),d+=":"}else x=de++,d=":"+d+"r"+x.toString(32)+":";return o.memoizedState=d},unstable_isNewReconciler:!1},Uc={readContext:As,useCallback:tl,useContext:As,useEffect:Ln,useImperativeHandle:Ha,useInsertionEffect:Kn,useLayoutEffect:Ti,useMemo:rl,useReducer:Ne,useRef:xn,useState:function(){return Ne(je)},useDebugValue:ba,useDeferredValue:function(o){var d=$e();return Eo(d,W.memoizedState,o)},useTransition:function(){var o=Ne(je)[0],d=$e().memoizedState;return[o,d]},useMutableSource:ht,useSyncExternalStore:mt,useId:ji,unstable_isNewReconciler:!1},Xl={readContext:As,useCallback:tl,useContext:As,useEffect:Ln,useImperativeHandle:Ha,useInsertionEffect:Kn,useLayoutEffect:Ti,useMemo:rl,useReducer:Ze,useRef:xn,useState:function(){return Ze(je)},useDebugValue:ba,useDeferredValue:function(o){var d=$e();return W===null?d.memoizedState=o:Eo(d,W.memoizedState,o)},useTransition:function(){var o=Ze(je)[0],d=$e().memoizedState;return[o,d]},useMutableSource:ht,useSyncExternalStore:mt,useId:ji,unstable_isNewReconciler:!1};function Xn(o,d){if(o&&o.defaultProps){d=Ct({},d),o=o.defaultProps;for(var x in o)d[x]===void 0&&(d[x]=o[x]);return d}return d}function bs(o,d,x,C){d=o.memoizedState,x=x(C,d),x=x==null?d:Ct({},d,x),o.memoizedState=x,o.lanes===0&&(o.updateQueue.baseState=x)}var Ys={isMounted:function(o){return(o=o._reactInternals)?pr(o)===o:!1},enqueueSetState:function(o,d,x){o=o._reactInternals;var C=mi(),R=Ao(o),O=rs(C,R);O.payload=d,x!=null&&(O.callback=x),d=ns(o,O,R),d!==null&&(Ja(d,o,R,C),ko(d,o,R))},enqueueReplaceState:function(o,d,x){o=o._reactInternals;var C=mi(),R=Ao(o),O=rs(C,R);O.tag=1,O.payload=d,x!=null&&(O.callback=x),d=ns(o,O,R),d!==null&&(Ja(d,o,R,C),ko(d,o,R))},enqueueForceUpdate:function(o,d){o=o._reactInternals;var x=mi(),C=Ao(o),R=rs(x,C);R.tag=2,d!=null&&(R.callback=d),d=ns(o,R,C),d!==null&&(Ja(d,o,C,x),ko(d,o,C))}};function Yh(o,d,x,C,R,O,J){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(C,O,J):d.prototype&&d.prototype.isPureReactComponent?!Pc(x,C)||!Pc(R,O):!0}function is(o,d,x){var C=!1,R=gs,O=d.contextType;return typeof O=="object"&&O!==null?O=As(O):(R=wi(d)?So:si.current,C=d.contextTypes,O=(C=C!=null)?Hs(o,R):gs),d=new d(x,O),o.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Ys,o.stateNode=d,d._reactInternals=o,C&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=R,o.__reactInternalMemoizedMaskedChildContext=O),d}function Qh(o,d,x,C){o=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(x,C),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(x,C),d.state!==o&&Ys.enqueueReplaceState(d,d.state,null)}function Vc(o,d,x,C){var R=o.stateNode;R.props=x,R.state=o.memoizedState,R.refs={},Co(o);var O=d.contextType;typeof O=="object"&&O!==null?R.context=As(O):(O=wi(d)?So:si.current,R.context=Hs(o,O)),R.state=o.memoizedState,O=d.getDerivedStateFromProps,typeof O=="function"&&(bs(o,d,O,x),R.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(d=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),d!==R.state&&Ys.enqueueReplaceState(R,R.state,null),xa(o,x,R,C),R.state=o.memoizedState),typeof R.componentDidMount=="function"&&(o.flags|=4194308)}function Xa(o,d){try{var x="",C=d;do x+=fr(C),C=C.return;while(C);var R=x}catch(O){R=`
Error generating stack: `+O.message+`
`+O.stack}return{value:o,source:d,stack:R,digest:null}}function Yl(o,d,x){return{value:o,source:null,stack:x??null,digest:d??null}}function wa(o,d){try{console.error(d.value)}catch(x){setTimeout(function(){throw x})}}var Ya=typeof WeakMap=="function"?WeakMap:Map;function cp(o,d,x){x=rs(-1,x),x.tag=3,x.payload={element:null};var C=d.value;return x.callback=function(){of||(of=!0,Cp=C),wa(o,d)},x}function Pm(o,d,x){x=rs(-1,x),x.tag=3;var C=o.type.getDerivedStateFromError;if(typeof C=="function"){var R=d.value;x.payload=function(){return C(R)},x.callback=function(){wa(o,d)}}var O=o.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(x.callback=function(){wa(o,d),typeof C!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var J=d.stack;this.componentDidCatch(d.value,{componentStack:J!==null?J:""})}),x}function tf(o,d,x){var C=o.pingCache;if(C===null){C=o.pingCache=new Ya;var R=new Set;C.set(d,R)}else R=C.get(d),R===void 0&&(R=new Set,C.set(d,R));R.has(x)||(R.add(x),o=Wm.bind(null,o,d,x),d.then(o,o))}function up(o){do{var d;if((d=o.tag===13)&&(d=o.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return o;o=o.return}while(o!==null);return null}function Cm(o,d,x,C,R){return(o.mode&1)===0?(o===d?o.flags|=65536:(o.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(d=rs(-1,1),d.tag=2,ns(x,d,1))),x.lanes|=1),o):(o.flags|=65536,o.lanes=R,o)}var km=De.ReactCurrentOwner,Ds=!1;function $i(o,d,x,C){d.child=o===null?Bc(d,null,x,C):Oi(d,o.child,x,C)}function Em(o,d,x,C,R){x=x.render;var O=d.ref;return pi(d,R),C=we(o,d,x,C,O,R),x=he(),o!==null&&!Ds?(d.updateQueue=o.updateQueue,d.flags&=-2053,o.lanes&=~R,Qs(o,d,R)):(vn&&x&&ql(d),d.flags|=1,$i(o,d,C,R),d.child)}function rf(o,d,x,C,R){if(o===null){var O=x.type;return typeof O=="function"&&!md(O)&&O.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(d.tag=15,d.type=O,hp(o,d,O,C,R)):(o=ff(x.type,null,C,d,d.mode,R),o.ref=d.ref,o.return=d,d.child=o)}if(O=o.child,(o.lanes&R)===0){var J=O.memoizedProps;if(x=x.compare,x=x!==null?x:Pc,x(J,C)&&o.ref===d.ref)return Qs(o,d,R)}return d.flags|=1,o=sl(O,C),o.ref=d.ref,o.return=d,d.child=o}function hp(o,d,x,C,R){if(o!==null){var O=o.memoizedProps;if(Pc(O,C)&&o.ref===d.ref)if(Ds=!1,d.pendingProps=C=O,(o.lanes&R)!==0)(o.flags&131072)!==0&&(Ds=!0);else return d.lanes=o.lanes,Qs(o,d,R)}return fp(o,d,x,C,R)}function dp(o,d,x){var C=d.pendingProps,R=C.children,O=o!==null?o.memoizedState:null;if(C.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Or(Wc,Js),Js|=x;else{if((x&1073741824)===0)return o=O!==null?O.baseLanes|x:x,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:o,cachePool:null,transitions:null},d.updateQueue=null,Or(Wc,Js),Js|=o,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},C=O!==null?O.baseLanes:x,Or(Wc,Js),Js|=C}else O!==null?(C=O.baseLanes|x,d.memoizedState=null):C=x,Or(Wc,Js),Js|=C;return $i(o,d,R,x),d.child}function Zc(o,d){var x=d.ref;(o===null&&x!==null||o!==null&&o.ref!==x)&&(d.flags|=512,d.flags|=2097152)}function fp(o,d,x,C,R){var O=wi(x)?So:si.current;return O=Hs(d,O),pi(d,R),x=we(o,d,x,C,O,R),C=he(),o!==null&&!Ds?(d.updateQueue=o.updateQueue,d.flags&=-2053,o.lanes&=~R,Qs(o,d,R)):(vn&&C&&ql(d),d.flags|=1,$i(o,d,x,R),d.child)}function ju(o,d,x,C,R){if(wi(x)){var O=!0;Qi(d)}else O=!1;if(pi(d,R),d.stateNode===null)Bu(o,d),is(d,x,C),Vc(d,x,C,R),C=!0;else if(o===null){var J=d.stateNode,me=d.memoizedProps;J.props=me;var Ee=J.context,He=x.contextType;typeof He=="object"&&He!==null?He=As(He):(He=wi(x)?So:si.current,He=Hs(d,He));var dt=x.getDerivedStateFromProps,ct=typeof dt=="function"||typeof J.getSnapshotBeforeUpdate=="function";ct||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(me!==C||Ee!==He)&&Qh(d,J,C,He),vs=!1;var at=d.memoizedState;J.state=at,xa(d,C,J,R),Ee=d.memoizedState,me!==C||at!==Ee||zi.current||vs?(typeof dt=="function"&&(bs(d,x,dt,C),Ee=d.memoizedState),(me=vs||Yh(d,x,me,C,at,Ee,He))?(ct||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(d.flags|=4194308)):(typeof J.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=C,d.memoizedState=Ee),J.props=C,J.state=Ee,J.context=He,C=me):(typeof J.componentDidMount=="function"&&(d.flags|=4194308),C=!1)}else{J=d.stateNode,Fu(o,d),me=d.memoizedProps,He=d.type===d.elementType?me:Xn(d.type,me),J.props=He,ct=d.pendingProps,at=J.context,Ee=x.contextType,typeof Ee=="object"&&Ee!==null?Ee=As(Ee):(Ee=wi(x)?So:si.current,Ee=Hs(d,Ee));var Ot=x.getDerivedStateFromProps;(dt=typeof Ot=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(me!==ct||at!==Ee)&&Qh(d,J,C,Ee),vs=!1,at=d.memoizedState,J.state=at,xa(d,C,J,R);var Vt=d.memoizedState;me!==ct||at!==Vt||zi.current||vs?(typeof Ot=="function"&&(bs(d,x,Ot,C),Vt=d.memoizedState),(He=vs||Yh(d,x,He,C,at,Vt,Ee)||!1)?(dt||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(C,Vt,Ee),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(C,Vt,Ee)),typeof J.componentDidUpdate=="function"&&(d.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof J.componentDidUpdate!="function"||me===o.memoizedProps&&at===o.memoizedState||(d.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||me===o.memoizedProps&&at===o.memoizedState||(d.flags|=1024),d.memoizedProps=C,d.memoizedState=Vt),J.props=C,J.state=Vt,J.context=Ee,C=He):(typeof J.componentDidUpdate!="function"||me===o.memoizedProps&&at===o.memoizedState||(d.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||me===o.memoizedProps&&at===o.memoizedState||(d.flags|=1024),C=!1)}return Nu(o,d,x,C,O,R)}function Nu(o,d,x,C,R,O){Zc(o,d);var J=(d.flags&128)!==0;if(!C&&!J)return R&&Qo(d,x,!1),Qs(o,d,O);C=d.stateNode,km.current=d;var me=J&&typeof x.getDerivedStateFromError!="function"?null:C.render();return d.flags|=1,o!==null&&J?(d.child=Oi(d,o.child,null,O),d.child=Oi(d,null,me,O)):$i(o,d,me,O),d.memoizedState=C.state,R&&Qo(d,x,!0),d.child}function Jh(o){var d=o.stateNode;d.pendingContext?Zh(o,d.pendingContext,d.pendingContext!==d.context):d.context&&Zh(o,d.context,!1),s(o,d.containerInfo)}function pp(o,d,x,C,R){return Wr(),Po(R),d.flags|=256,$i(o,d,x,C),d.child}var nf={dehydrated:null,treeContext:null,retryLane:0};function mp(o){return{baseLanes:o,cachePool:null,transitions:null}}function Im(o,d,x){var C=d.pendingProps,R=S.current,O=!1,J=(d.flags&128)!==0,me;if((me=J)||(me=o!==null&&o.memoizedState===null?!1:(R&2)!==0),me?(O=!0,d.flags&=-129):(o===null||o.memoizedState!==null)&&(R|=1),Or(S,R&1),o===null)return jc(d),o=d.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((d.mode&1)===0?d.lanes=1:o.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(J=C.children,o=C.fallback,O?(C=d.mode,O=d.child,J={mode:"hidden",children:J},(C&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=J):O=pf(J,C,0,null),o=Yc(o,C,x,null),O.return=d,o.return=d,O.sibling=o,d.child=O,d.child.memoizedState=mp(x),d.memoizedState=nf,o):sf(d,J));if(R=o.memoizedState,R!==null&&(me=R.dehydrated,me!==null))return Mm(o,d,J,C,me,R,x);if(O){O=C.fallback,J=d.mode,R=o.child,me=R.sibling;var Ee={mode:"hidden",children:C.children};return(J&1)===0&&d.child!==R?(C=d.child,C.childLanes=0,C.pendingProps=Ee,d.deletions=null):(C=sl(R,Ee),C.subtreeFlags=R.subtreeFlags&14680064),me!==null?O=sl(me,O):(O=Yc(O,J,x,null),O.flags|=2),O.return=d,C.return=d,C.sibling=O,d.child=C,C=O,O=d.child,J=o.child.memoizedState,J=J===null?mp(x):{baseLanes:J.baseLanes|x,cachePool:null,transitions:J.transitions},O.memoizedState=J,O.childLanes=o.childLanes&~x,d.memoizedState=nf,C}return O=o.child,o=O.sibling,C=sl(O,{mode:"visible",children:C.children}),(d.mode&1)===0&&(C.lanes=x),C.return=d,C.sibling=null,o!==null&&(x=d.deletions,x===null?(d.deletions=[o],d.flags|=16):x.push(o)),d.child=C,d.memoizedState=null,C}function sf(o,d){return d=pf({mode:"visible",children:d},o.mode,0,null),d.return=o,o.child=d}function ed(o,d,x,C){return C!==null&&Po(C),Oi(d,o.child,null,x),o=sf(d,d.pendingProps.children),o.flags|=2,d.memoizedState=null,o}function Mm(o,d,x,C,R,O,J){if(x)return d.flags&256?(d.flags&=-257,C=Yl(Error(u(422))),ed(o,d,J,C)):d.memoizedState!==null?(d.child=o.child,d.flags|=128,null):(O=C.fallback,R=d.mode,C=pf({mode:"visible",children:C.children},R,0,null),O=Yc(O,R,J,null),O.flags|=2,C.return=d,O.return=d,C.sibling=O,d.child=C,(d.mode&1)!==0&&Oi(d,o.child,null,J),d.child.memoizedState=mp(J),d.memoizedState=nf,O);if((d.mode&1)===0)return ed(o,d,J,null);if(R.data==="$!"){if(C=R.nextSibling&&R.nextSibling.dataset,C)var me=C.dgst;return C=me,O=Error(u(419)),C=Yl(O,C,void 0),ed(o,d,J,C)}if(me=(J&o.childLanes)!==0,Ds||me){if(C=Yn,C!==null){switch(J&-J){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(C.suspendedLanes|J))!==0?0:R,R!==0&&R!==O.retryLane&&(O.retryLane=R,Rs(o,R),Ja(C,o,R,-1))}return hd(),C=Yl(Error(u(421))),ed(o,d,J,C)}return R.data==="$?"?(d.flags|=128,d.child=o.child,d=ly.bind(null,o),R._reactRetry=d,null):(o=O.treeContext,ys=tn(R.nextSibling),Si=d,vn=!0,_s=null,o!==null&&(es[Li++]=ts,es[Li++]=Fi,es[Li++]=qa,ts=o.id,Fi=o.overflow,qa=d),d=sf(d,C.children),d.flags|=4096,d)}function Am(o,d,x){o.lanes|=d;var C=o.alternate;C!==null&&(C.lanes|=d),Lu(o.return,d,x)}function td(o,d,x,C,R){var O=o.memoizedState;O===null?o.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:C,tail:x,tailMode:R}:(O.isBackwards=d,O.rendering=null,O.renderingStartTime=0,O.last=C,O.tail=x,O.tailMode=R)}function gp(o,d,x){var C=d.pendingProps,R=C.revealOrder,O=C.tail;if($i(o,d,C.children,x),C=S.current,(C&2)!==0)C=C&1|2,d.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=d.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Am(o,x,d);else if(o.tag===19)Am(o,x,d);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===d)break e;for(;o.sibling===null;){if(o.return===null||o.return===d)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}C&=1}if(Or(S,C),(d.mode&1)===0)d.memoizedState=null;else switch(R){case"forwards":for(x=d.child,R=null;x!==null;)o=x.alternate,o!==null&&E(o)===null&&(R=x),x=x.sibling;x=R,x===null?(R=d.child,d.child=null):(R=x.sibling,x.sibling=null),td(d,!1,R,x,O);break;case"backwards":for(x=null,R=d.child,d.child=null;R!==null;){if(o=R.alternate,o!==null&&E(o)===null){d.child=R;break}o=R.sibling,R.sibling=x,x=R,R=o}td(d,!0,x,null,O);break;case"together":td(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Bu(o,d){(d.mode&1)===0&&o!==null&&(o.alternate=null,d.alternate=null,d.flags|=2)}function Qs(o,d,x){if(o!==null&&(d.dependencies=o.dependencies),Ql|=d.lanes,(x&d.childLanes)===0)return null;if(o!==null&&d.child!==o.child)throw Error(u(153));if(d.child!==null){for(o=d.child,x=sl(o,o.pendingProps),d.child=x,x.return=d;o.sibling!==null;)o=o.sibling,x=x.sibling=sl(o,o.pendingProps),x.return=d;x.sibling=null}return d.child}function ws(o,d,x){switch(d.tag){case 3:Jh(d),Wr();break;case 5:p(d);break;case 1:wi(d.type)&&Qi(d);break;case 4:s(d,d.stateNode.containerInfo);break;case 10:var C=d.type._context,R=d.memoizedProps.value;Or(Lt,C._currentValue),C._currentValue=R;break;case 13:if(C=d.memoizedState,C!==null)return C.dehydrated!==null?(Or(S,S.current&1),d.flags|=128,null):(x&d.child.childLanes)!==0?Im(o,d,x):(Or(S,S.current&1),o=Qs(o,d,x),o!==null?o.sibling:null);Or(S,S.current&1);break;case 19:if(C=(x&d.childLanes)!==0,(o.flags&128)!==0){if(C)return gp(o,d,x);d.flags|=128}if(R=d.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Or(S,S.current),C)break;return null;case 22:case 23:return d.lanes=0,dp(o,d,x)}return Qs(o,d,x)}var yp,rd,Rm,_p;yp=function(o,d){for(var x=d.child;x!==null;){if(x.tag===5||x.tag===6)o.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===d)break;for(;x.sibling===null;){if(x.return===null||x.return===d)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},rd=function(){},Rm=function(o,d,x,C){var R=o.memoizedProps;if(R!==C){o=d.stateNode,e(xs.current);var O=null;switch(x){case"input":R=Nr(o,R),C=Nr(o,C),O=[];break;case"select":R=Ct({},R,{value:void 0}),C=Ct({},C,{value:void 0}),O=[];break;case"textarea":R=Xe(o,R),C=Xe(o,C),O=[];break;default:typeof R.onClick!="function"&&typeof C.onClick=="function"&&(o.onclick=Ul)}Oe(x,C);var J;x=null;for(He in R)if(!C.hasOwnProperty(He)&&R.hasOwnProperty(He)&&R[He]!=null)if(He==="style"){var me=R[He];for(J in me)me.hasOwnProperty(J)&&(x||(x={}),x[J]="")}else He!=="dangerouslySetInnerHTML"&&He!=="children"&&He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&He!=="autoFocus"&&(b.hasOwnProperty(He)?O||(O=[]):(O=O||[]).push(He,null));for(He in C){var Ee=C[He];if(me=R!=null?R[He]:void 0,C.hasOwnProperty(He)&&Ee!==me&&(Ee!=null||me!=null))if(He==="style")if(me){for(J in me)!me.hasOwnProperty(J)||Ee&&Ee.hasOwnProperty(J)||(x||(x={}),x[J]="");for(J in Ee)Ee.hasOwnProperty(J)&&me[J]!==Ee[J]&&(x||(x={}),x[J]=Ee[J])}else x||(O||(O=[]),O.push(He,x)),x=Ee;else He==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,me=me?me.__html:void 0,Ee!=null&&me!==Ee&&(O=O||[]).push(He,Ee)):He==="children"?typeof Ee!="string"&&typeof Ee!="number"||(O=O||[]).push(He,""+Ee):He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&(b.hasOwnProperty(He)?(Ee!=null&&He==="onScroll"&&gn("scroll",o),O||me===Ee||(O=[])):(O=O||[]).push(He,Ee))}x&&(O=O||[]).push("style",x);var He=O;(d.updateQueue=He)&&(d.flags|=4)}},_p=function(o,d,x,C){x!==C&&(d.flags|=4)};function nd(o,d){if(!vn)switch(o.tailMode){case"hidden":d=o.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?o.tail=null:x.sibling=null;break;case"collapsed":x=o.tail;for(var C=null;x!==null;)x.alternate!==null&&(C=x),x=x.sibling;C===null?d||o.tail===null?o.tail=null:o.tail.sibling=null:C.sibling=null}}function ss(o){var d=o.alternate!==null&&o.alternate.child===o.child,x=0,C=0;if(d)for(var R=o.child;R!==null;)x|=R.lanes|R.childLanes,C|=R.subtreeFlags&14680064,C|=R.flags&14680064,R.return=o,R=R.sibling;else for(R=o.child;R!==null;)x|=R.lanes|R.childLanes,C|=R.subtreeFlags,C|=R.flags,R.return=o,R=R.sibling;return o.subtreeFlags|=C,o.childLanes=x,d}function zm(o,d,x){var C=d.pendingProps;switch(qh(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(d),null;case 1:return wi(d.type)&&Za(),ss(d),null;case 3:return C=d.stateNode,h(),rn(zi),rn(si),z(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(o===null||o.child===null)&&(Nc(d)?d.flags|=4:o===null||o.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,_s!==null&&(Ep(_s),_s=null))),rd(o,d),ss(d),null;case 5:y(d);var R=e(g.current);if(x=d.type,o!==null&&d.stateNode!=null)Rm(o,d,x,C,R),o.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!C){if(d.stateNode===null)throw Error(u(166));return ss(d),null}if(o=e(xs.current),Nc(d)){C=d.stateNode,x=d.type;var O=d.memoizedProps;switch(C[ms]=d,C[Ba]=O,o=(d.mode&1)!==0,x){case"dialog":gn("cancel",C),gn("close",C);break;case"iframe":case"object":case"embed":gn("load",C);break;case"video":case"audio":for(R=0;R<jl.length;R++)gn(jl[R],C);break;case"source":gn("error",C);break;case"img":case"image":case"link":gn("error",C),gn("load",C);break;case"details":gn("toggle",C);break;case"input":Cn(C,O),gn("invalid",C);break;case"select":C._wrapperState={wasMultiple:!!O.multiple},gn("invalid",C);break;case"textarea":Et(C,O),gn("invalid",C)}Oe(x,O),R=null;for(var J in O)if(O.hasOwnProperty(J)){var me=O[J];J==="children"?typeof me=="string"?C.textContent!==me&&(O.suppressHydrationWarning!==!0&&pa(C.textContent,me,o),R=["children",me]):typeof me=="number"&&C.textContent!==""+me&&(O.suppressHydrationWarning!==!0&&pa(C.textContent,me,o),R=["children",""+me]):b.hasOwnProperty(J)&&me!=null&&J==="onScroll"&&gn("scroll",C)}switch(x){case"input":ci(C),Ri(C,O,!0);break;case"textarea":ci(C),gt(C);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(C.onclick=Ul)}C=R,d.updateQueue=C,C!==null&&(d.flags|=4)}else{J=R.nodeType===9?R:R.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Bt(x)),o==="http://www.w3.org/1999/xhtml"?x==="script"?(o=J.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof C.is=="string"?o=J.createElement(x,{is:C.is}):(o=J.createElement(x),x==="select"&&(J=o,C.multiple?J.multiple=!0:C.size&&(J.size=C.size))):o=J.createElementNS(o,x),o[ms]=d,o[Ba]=C,yp(o,d,!1,!1),d.stateNode=o;e:{switch(J=Re(x,C),x){case"dialog":gn("cancel",o),gn("close",o),R=C;break;case"iframe":case"object":case"embed":gn("load",o),R=C;break;case"video":case"audio":for(R=0;R<jl.length;R++)gn(jl[R],o);R=C;break;case"source":gn("error",o),R=C;break;case"img":case"image":case"link":gn("error",o),gn("load",o),R=C;break;case"details":gn("toggle",o),R=C;break;case"input":Cn(o,C),R=Nr(o,C),gn("invalid",o);break;case"option":R=C;break;case"select":o._wrapperState={wasMultiple:!!C.multiple},R=Ct({},C,{value:void 0}),gn("invalid",o);break;case"textarea":Et(o,C),R=Xe(o,C),gn("invalid",o);break;default:R=C}Oe(x,R),me=R;for(O in me)if(me.hasOwnProperty(O)){var Ee=me[O];O==="style"?ve(o,Ee):O==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,Ee!=null&&Te(o,Ee)):O==="children"?typeof Ee=="string"?(x!=="textarea"||Ee!=="")&&K(o,Ee):typeof Ee=="number"&&K(o,""+Ee):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(b.hasOwnProperty(O)?Ee!=null&&O==="onScroll"&&gn("scroll",o):Ee!=null&&Se(o,O,Ee,J))}switch(x){case"input":ci(o),Ri(o,C,!1);break;case"textarea":ci(o),gt(o);break;case"option":C.value!=null&&o.setAttribute("value",""+sr(C.value));break;case"select":o.multiple=!!C.multiple,O=C.value,O!=null?Be(o,!!C.multiple,O,!1):C.defaultValue!=null&&Be(o,!!C.multiple,C.defaultValue,!0);break;default:typeof R.onClick=="function"&&(o.onclick=Ul)}switch(x){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}}C&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return ss(d),null;case 6:if(o&&d.stateNode!=null)_p(o,d,o.memoizedProps,C);else{if(typeof C!="string"&&d.stateNode===null)throw Error(u(166));if(x=e(g.current),e(xs.current),Nc(d)){if(C=d.stateNode,x=d.memoizedProps,C[ms]=d,(O=C.nodeValue!==x)&&(o=Si,o!==null))switch(o.tag){case 3:pa(C.nodeValue,x,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&pa(C.nodeValue,x,(o.mode&1)!==0)}O&&(d.flags|=4)}else C=(x.nodeType===9?x:x.ownerDocument).createTextNode(C),C[ms]=d,d.stateNode=C}return ss(d),null;case 13:if(rn(S),C=d.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(vn&&ys!==null&&(d.mode&1)!==0&&(d.flags&128)===0)Ms(),Wr(),d.flags|=98560,O=!1;else if(O=Nc(d),C!==null&&C.dehydrated!==null){if(o===null){if(!O)throw Error(u(318));if(O=d.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(u(317));O[ms]=d}else Wr(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ss(d),O=!1}else _s!==null&&(Ep(_s),_s=null),O=!0;if(!O)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=x,d):(C=C!==null,C!==(o!==null&&o.memoizedState!==null)&&C&&(d.child.flags|=8192,(d.mode&1)!==0&&(o===null||(S.current&1)!==0?Tn===0&&(Tn=3):hd())),d.updateQueue!==null&&(d.flags|=4),ss(d),null);case 4:return h(),rd(o,d),o===null&&wo(d.stateNode.containerInfo),ss(d),null;case 10:return fi(d.type._context),ss(d),null;case 17:return wi(d.type)&&Za(),ss(d),null;case 19:if(rn(S),O=d.memoizedState,O===null)return ss(d),null;if(C=(d.flags&128)!==0,J=O.rendering,J===null)if(C)nd(O,!1);else{if(Tn!==0||o!==null&&(o.flags&128)!==0)for(o=d.child;o!==null;){if(J=E(o),J!==null){for(d.flags|=128,nd(O,!1),C=J.updateQueue,C!==null&&(d.updateQueue=C,d.flags|=4),d.subtreeFlags=0,C=x,x=d.child;x!==null;)O=x,o=C,O.flags&=14680066,J=O.alternate,J===null?(O.childLanes=0,O.lanes=o,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=J.childLanes,O.lanes=J.lanes,O.child=J.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=J.memoizedProps,O.memoizedState=J.memoizedState,O.updateQueue=J.updateQueue,O.type=J.type,o=J.dependencies,O.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),x=x.sibling;return Or(S,S.current&1|2),d.child}o=o.sibling}O.tail!==null&&kr()>Wu&&(d.flags|=128,C=!0,nd(O,!1),d.lanes=4194304)}else{if(!C)if(o=E(J),o!==null){if(d.flags|=128,C=!0,x=o.updateQueue,x!==null&&(d.updateQueue=x,d.flags|=4),nd(O,!0),O.tail===null&&O.tailMode==="hidden"&&!J.alternate&&!vn)return ss(d),null}else 2*kr()-O.renderingStartTime>Wu&&x!==1073741824&&(d.flags|=128,C=!0,nd(O,!1),d.lanes=4194304);O.isBackwards?(J.sibling=d.child,d.child=J):(x=O.last,x!==null?x.sibling=J:d.child=J,O.last=J)}return O.tail!==null?(d=O.tail,O.rendering=d,O.tail=d.sibling,O.renderingStartTime=kr(),d.sibling=null,x=S.current,Or(S,C?x&1|2:x&1),d):(ss(d),null);case 22:case 23:return Ap(),C=d.memoizedState!==null,o!==null&&o.memoizedState!==null!==C&&(d.flags|=8192),C&&(d.mode&1)!==0?(Js&1073741824)!==0&&(ss(d),d.subtreeFlags&6&&(d.flags|=8192)):ss(d),null;case 24:return null;case 25:return null}throw Error(u(156,d.tag))}function ay(o,d){switch(qh(d),d.tag){case 1:return wi(d.type)&&Za(),o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 3:return h(),rn(zi),rn(si),z(),o=d.flags,(o&65536)!==0&&(o&128)===0?(d.flags=o&-65537|128,d):null;case 5:return y(d),null;case 13:if(rn(S),o=d.memoizedState,o!==null&&o.dehydrated!==null){if(d.alternate===null)throw Error(u(340));Wr()}return o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 19:return rn(S),null;case 4:return h(),null;case 10:return fi(d.type._context),null;case 22:case 23:return Ap(),null;case 24:return null;default:return null}}var $u=!1,Ui=!1,Dm=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function Uu(o,d){var x=o.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(C){$n(o,d,C)}else x.current=null}function vp(o,d,x){try{x()}catch(C){$n(o,d,C)}}var af=!1;function xp(o,d){if(Vl=bi,o=Nh(),Fl(o)){if("selectionStart"in o)var x={start:o.selectionStart,end:o.selectionEnd};else e:{x=(x=o.ownerDocument)&&x.defaultView||window;var C=x.getSelection&&x.getSelection();if(C&&C.rangeCount!==0){x=C.anchorNode;var R=C.anchorOffset,O=C.focusNode;C=C.focusOffset;try{x.nodeType,O.nodeType}catch{x=null;break e}var J=0,me=-1,Ee=-1,He=0,dt=0,ct=o,at=null;t:for(;;){for(var Ot;ct!==x||R!==0&&ct.nodeType!==3||(me=J+R),ct!==O||C!==0&&ct.nodeType!==3||(Ee=J+C),ct.nodeType===3&&(J+=ct.nodeValue.length),(Ot=ct.firstChild)!==null;)at=ct,ct=Ot;for(;;){if(ct===o)break t;if(at===x&&++He===R&&(me=J),at===O&&++dt===C&&(Ee=J),(Ot=ct.nextSibling)!==null)break;ct=at,at=ct.parentNode}ct=Ot}x=me===-1||Ee===-1?null:{start:me,end:Ee}}else x=null}x=x||{start:0,end:0}}else x=null;for(Na={focusedElem:o,selectionRange:x},bi=!1,Ut=d;Ut!==null;)if(d=Ut,o=d.child,(d.subtreeFlags&1028)!==0&&o!==null)o.return=d,Ut=o;else for(;Ut!==null;){d=Ut;try{var Vt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Vt!==null){var Qt=Vt.memoizedProps,In=Vt.memoizedState,Ve=d.stateNode,Fe=Ve.getSnapshotBeforeUpdate(d.elementType===d.type?Qt:Xn(d.type,Qt),In);Ve.__reactInternalSnapshotBeforeUpdate=Fe}break;case 3:var Ge=d.stateNode.containerInfo;Ge.nodeType===1?Ge.textContent="":Ge.nodeType===9&&Ge.documentElement&&Ge.removeChild(Ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(bt){$n(d,d.return,bt)}if(o=d.sibling,o!==null){o.return=d.return,Ut=o;break}Ut=d.return}return Vt=af,af=!1,Vt}function Vu(o,d,x){var C=d.updateQueue;if(C=C!==null?C.lastEffect:null,C!==null){var R=C=C.next;do{if((R.tag&o)===o){var O=R.destroy;R.destroy=void 0,O!==void 0&&vp(d,x,O)}R=R.next}while(R!==C)}}function Io(o,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var x=d=d.next;do{if((x.tag&o)===o){var C=x.create;x.destroy=C()}x=x.next}while(x!==d)}}function Gc(o){var d=o.ref;if(d!==null){var x=o.stateNode;switch(o.tag){case 5:o=x;break;default:o=x}typeof d=="function"?d(o):d.current=o}}function Lm(o){var d=o.alternate;d!==null&&(o.alternate=null,Lm(d)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(d=o.stateNode,d!==null&&(delete d[ms],delete d[Ba],delete d[$a],delete d[Mu],delete d[Ua])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Fm(o){return o.tag===5||o.tag===3||o.tag===4}function Om(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Fm(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function bp(o,d,x){var C=o.tag;if(C===5||C===6)o=o.stateNode,d?x.nodeType===8?x.parentNode.insertBefore(o,d):x.insertBefore(o,d):(x.nodeType===8?(d=x.parentNode,d.insertBefore(o,x)):(d=x,d.appendChild(o)),x=x._reactRootContainer,x!=null||d.onclick!==null||(d.onclick=Ul));else if(C!==4&&(o=o.child,o!==null))for(bp(o,d,x),o=o.sibling;o!==null;)bp(o,d,x),o=o.sibling}function wp(o,d,x){var C=o.tag;if(C===5||C===6)o=o.stateNode,d?x.insertBefore(o,d):x.appendChild(o);else if(C!==4&&(o=o.child,o!==null))for(wp(o,d,x),o=o.sibling;o!==null;)wp(o,d,x),o=o.sibling}var Vi=null,Qa=!1;function Mo(o,d,x){for(x=x.child;x!==null;)jm(o,d,x),x=x.sibling}function jm(o,d,x){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(Ns,x)}catch{}switch(x.tag){case 5:Ui||Uu(x,d);case 6:var C=Vi,R=Qa;Vi=null,Mo(o,d,x),Vi=C,Qa=R,Vi!==null&&(Qa?(o=Vi,x=x.stateNode,o.nodeType===8?o.parentNode.removeChild(x):o.removeChild(x)):Vi.removeChild(x.stateNode));break;case 18:Vi!==null&&(Qa?(o=Vi,x=x.stateNode,o.nodeType===8?Fc(o.parentNode,x):o.nodeType===1&&Fc(o,x),fs(o)):Fc(Vi,x.stateNode));break;case 4:C=Vi,R=Qa,Vi=x.stateNode.containerInfo,Qa=!0,Mo(o,d,x),Vi=C,Qa=R;break;case 0:case 11:case 14:case 15:if(!Ui&&(C=x.updateQueue,C!==null&&(C=C.lastEffect,C!==null))){R=C=C.next;do{var O=R,J=O.destroy;O=O.tag,J!==void 0&&((O&2)!==0||(O&4)!==0)&&vp(x,d,J),R=R.next}while(R!==C)}Mo(o,d,x);break;case 1:if(!Ui&&(Uu(x,d),C=x.stateNode,typeof C.componentWillUnmount=="function"))try{C.props=x.memoizedProps,C.state=x.memoizedState,C.componentWillUnmount()}catch(me){$n(x,d,me)}Mo(o,d,x);break;case 21:Mo(o,d,x);break;case 22:x.mode&1?(Ui=(C=Ui)||x.memoizedState!==null,Mo(o,d,x),Ui=C):Mo(o,d,x);break;default:Mo(o,d,x)}}function Sp(o){var d=o.updateQueue;if(d!==null){o.updateQueue=null;var x=o.stateNode;x===null&&(x=o.stateNode=new Dm),d.forEach(function(C){var R=pd.bind(null,o,C);x.has(C)||(x.add(C),C.then(R,R))})}}function Ss(o,d){var x=d.deletions;if(x!==null)for(var C=0;C<x.length;C++){var R=x[C];try{var O=o,J=d,me=J;e:for(;me!==null;){switch(me.tag){case 5:Vi=me.stateNode,Qa=!1;break e;case 3:Vi=me.stateNode.containerInfo,Qa=!0;break e;case 4:Vi=me.stateNode.containerInfo,Qa=!0;break e}me=me.return}if(Vi===null)throw Error(u(160));jm(O,J,R),Vi=null,Qa=!1;var Ee=R.alternate;Ee!==null&&(Ee.return=null),R.return=null}catch(He){$n(R,d,He)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)Nm(d,o),d=d.sibling}function Nm(o,d){var x=o.alternate,C=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Ss(d,o),sn(o),C&4){try{Vu(3,o,o.return),Io(3,o)}catch(Qt){$n(o,o.return,Qt)}try{Vu(5,o,o.return)}catch(Qt){$n(o,o.return,Qt)}}break;case 1:Ss(d,o),sn(o),C&512&&x!==null&&Uu(x,x.return);break;case 5:if(Ss(d,o),sn(o),C&512&&x!==null&&Uu(x,x.return),o.flags&32){var R=o.stateNode;try{K(R,"")}catch(Qt){$n(o,o.return,Qt)}}if(C&4&&(R=o.stateNode,R!=null)){var O=o.memoizedProps,J=x!==null?x.memoizedProps:O,me=o.type,Ee=o.updateQueue;if(o.updateQueue=null,Ee!==null)try{me==="input"&&O.type==="radio"&&O.name!=null&&jn(R,O),Re(me,J);var He=Re(me,O);for(J=0;J<Ee.length;J+=2){var dt=Ee[J],ct=Ee[J+1];dt==="style"?ve(R,ct):dt==="dangerouslySetInnerHTML"?Te(R,ct):dt==="children"?K(R,ct):Se(R,dt,ct,He)}switch(me){case"input":Yi(R,O);break;case"textarea":vt(R,O);break;case"select":var at=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!O.multiple;var Ot=O.value;Ot!=null?Be(R,!!O.multiple,Ot,!1):at!==!!O.multiple&&(O.defaultValue!=null?Be(R,!!O.multiple,O.defaultValue,!0):Be(R,!!O.multiple,O.multiple?[]:"",!1))}R[Ba]=O}catch(Qt){$n(o,o.return,Qt)}}break;case 6:if(Ss(d,o),sn(o),C&4){if(o.stateNode===null)throw Error(u(162));R=o.stateNode,O=o.memoizedProps;try{R.nodeValue=O}catch(Qt){$n(o,o.return,Qt)}}break;case 3:if(Ss(d,o),sn(o),C&4&&x!==null&&x.memoizedState.isDehydrated)try{fs(d.containerInfo)}catch(Qt){$n(o,o.return,Qt)}break;case 4:Ss(d,o),sn(o);break;case 13:Ss(d,o),sn(o),R=o.child,R.flags&8192&&(O=R.memoizedState!==null,R.stateNode.isHidden=O,!O||R.alternate!==null&&R.alternate.memoizedState!==null||(Pp=kr())),C&4&&Sp(o);break;case 22:if(dt=x!==null&&x.memoizedState!==null,o.mode&1?(Ui=(He=Ui)||dt,Ss(d,o),Ui=He):Ss(d,o),sn(o),C&8192){if(He=o.memoizedState!==null,(o.stateNode.isHidden=He)&&!dt&&(o.mode&1)!==0)for(Ut=o,dt=o.child;dt!==null;){for(ct=Ut=dt;Ut!==null;){switch(at=Ut,Ot=at.child,at.tag){case 0:case 11:case 14:case 15:Vu(4,at,at.return);break;case 1:Uu(at,at.return);var Vt=at.stateNode;if(typeof Vt.componentWillUnmount=="function"){C=at,x=at.return;try{d=C,Vt.props=d.memoizedProps,Vt.state=d.memoizedState,Vt.componentWillUnmount()}catch(Qt){$n(C,x,Qt)}}break;case 5:Uu(at,at.return);break;case 22:if(at.memoizedState!==null){sd(ct);continue}}Ot!==null?(Ot.return=at,Ut=Ot):sd(ct)}dt=dt.sibling}e:for(dt=null,ct=o;;){if(ct.tag===5){if(dt===null){dt=ct;try{R=ct.stateNode,He?(O=R.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(me=ct.stateNode,Ee=ct.memoizedProps.style,J=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null,me.style.display=ue("display",J))}catch(Qt){$n(o,o.return,Qt)}}}else if(ct.tag===6){if(dt===null)try{ct.stateNode.nodeValue=He?"":ct.memoizedProps}catch(Qt){$n(o,o.return,Qt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===o)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===o)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===o)break e;dt===ct&&(dt=null),ct=ct.return}dt===ct&&(dt=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:Ss(d,o),sn(o),C&4&&Sp(o);break;case 21:break;default:Ss(d,o),sn(o)}}function sn(o){var d=o.flags;if(d&2){try{e:{for(var x=o.return;x!==null;){if(Fm(x)){var C=x;break e}x=x.return}throw Error(u(160))}switch(C.tag){case 5:var R=C.stateNode;C.flags&32&&(K(R,""),C.flags&=-33);var O=Om(o);wp(o,O,R);break;case 3:case 4:var J=C.stateNode.containerInfo,me=Om(o);bp(o,me,J);break;default:throw Error(u(161))}}catch(Ee){$n(o,o.return,Ee)}o.flags&=-3}d&4096&&(o.flags&=-4097)}function Zu(o,d,x){Ut=o,Tp(o)}function Tp(o,d,x){for(var C=(o.mode&1)!==0;Ut!==null;){var R=Ut,O=R.child;if(R.tag===22&&C){var J=R.memoizedState!==null||$u;if(!J){var me=R.alternate,Ee=me!==null&&me.memoizedState!==null||Ui;me=$u;var He=Ui;if($u=J,(Ui=Ee)&&!He)for(Ut=R;Ut!==null;)J=Ut,Ee=J.child,J.tag===22&&J.memoizedState!==null?Gu(R):Ee!==null?(Ee.return=J,Ut=Ee):Gu(R);for(;O!==null;)Ut=O,Tp(O),O=O.sibling;Ut=R,$u=me,Ui=He}id(o)}else(R.subtreeFlags&8772)!==0&&O!==null?(O.return=R,Ut=O):id(o)}}function id(o){for(;Ut!==null;){var d=Ut;if((d.flags&8772)!==0){var x=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ui||Io(5,d);break;case 1:var C=d.stateNode;if(d.flags&4&&!Ui)if(x===null)C.componentDidMount();else{var R=d.elementType===d.type?x.memoizedProps:Xn(d.type,x.memoizedProps);C.componentDidUpdate(R,x.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var O=d.updateQueue;O!==null&&Ou(d,O,C);break;case 3:var J=d.updateQueue;if(J!==null){if(x=null,d.child!==null)switch(d.child.tag){case 5:x=d.child.stateNode;break;case 1:x=d.child.stateNode}Ou(d,J,x)}break;case 5:var me=d.stateNode;if(x===null&&d.flags&4){x=me;var Ee=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":Ee.autoFocus&&x.focus();break;case"img":Ee.src&&(x.src=Ee.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var He=d.alternate;if(He!==null){var dt=He.memoizedState;if(dt!==null){var ct=dt.dehydrated;ct!==null&&fs(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}Ui||d.flags&512&&Gc(d)}catch(at){$n(d,d.return,at)}}if(d===o){Ut=null;break}if(x=d.sibling,x!==null){x.return=d.return,Ut=x;break}Ut=d.return}}function sd(o){for(;Ut!==null;){var d=Ut;if(d===o){Ut=null;break}var x=d.sibling;if(x!==null){x.return=d.return,Ut=x;break}Ut=d.return}}function Gu(o){for(;Ut!==null;){var d=Ut;try{switch(d.tag){case 0:case 11:case 15:var x=d.return;try{Io(4,d)}catch(Ee){$n(d,x,Ee)}break;case 1:var C=d.stateNode;if(typeof C.componentDidMount=="function"){var R=d.return;try{C.componentDidMount()}catch(Ee){$n(d,R,Ee)}}var O=d.return;try{Gc(d)}catch(Ee){$n(d,O,Ee)}break;case 5:var J=d.return;try{Gc(d)}catch(Ee){$n(d,J,Ee)}}}catch(Ee){$n(d,d.return,Ee)}if(d===o){Ut=null;break}var me=d.sibling;if(me!==null){me.return=d.return,Ut=me;break}Ut=d.return}}var Bm=Math.ceil,ad=De.ReactCurrentDispatcher,qc=De.ReactCurrentOwner,Ls=De.ReactCurrentBatchConfig,Br=0,Yn=null,Sn=null,Qn=0,Js=0,Wc=ii(0),Tn=0,od=null,Ql=0,Jl=0,ld=0,qu=null,Ts=null,Pp=0,Wu=1/0,il=null,of=!1,Cp=null,ea=null,lf=!1,ec=null,cd=0,ud=0,cf=null,uf=-1,Hu=0;function mi(){return(Br&6)!==0?kr():uf!==-1?uf:uf=kr()}function Ao(o){return(o.mode&1)===0?1:(Br&2)!==0&&Qn!==0?Qn&-Qn:Kh.transition!==null?(Hu===0&&(Hu=No()),Hu):(o=qr,o!==0||(o=window.event,o=o===void 0?16:Cl(o.type)),o)}function Ja(o,d,x,C){if(50<ud)throw ud=0,cf=null,Error(u(185));Bo(o,x,C),((Br&2)===0||o!==Yn)&&(o===Yn&&((Br&2)===0&&(Jl|=x),Tn===4&&Sa(o,Qn)),Fs(o,C),x===1&&Br===0&&(d.mode&1)===0&&(Wu=kr()+500,Ga&&To()))}function Fs(o,d){var x=o.callbackNode;vh(o,d);var C=wl(o,o===Yn?Qn:0);if(C===0)x!==null&&dc(x),o.callbackNode=null,o.callbackPriority=0;else if(d=C&-C,o.callbackPriority!==d){if(x!=null&&dc(x),d===1)o.tag===0?lp(Ip.bind(null,o)):Gl(Ip.bind(null,o)),Vh(function(){(Br&6)===0&&To()}),x=null;else{switch(Es(C)){case 1:x=xi;break;case 4:x=an;break;case 16:x=fc;break;case 536870912:x=mu;break;default:x=fc}x=df(x,kp.bind(null,o))}o.callbackPriority=d,o.callbackNode=x}}function kp(o,d){if(uf=-1,Hu=0,(Br&6)!==0)throw Error(u(327));var x=o.callbackNode;if(Ku()&&o.callbackNode!==x)return null;var C=wl(o,o===Yn?Qn:0);if(C===0)return null;if((C&30)!==0||(C&o.expiredLanes)!==0||d)d=dd(o,C);else{d=C;var R=Br;Br|=2;var O=Rp();(Yn!==o||Qn!==d)&&(il=null,Wu=kr()+500,Kc(o,d));do try{Vm();break}catch(me){$m(o,me)}while(!0);Kl(),ad.current=O,Br=R,Sn!==null?d=0:(Yn=null,Qn=0,d=Tn)}if(d!==0){if(d===2&&(R=gc(o),R!==0&&(C=R,d=hf(o,R))),d===1)throw x=od,Kc(o,0),Sa(o,C),Fs(o,kr()),x;if(d===6)Sa(o,C);else{if(R=o.current.alternate,(C&30)===0&&!oy(R)&&(d=dd(o,C),d===2&&(O=gc(o),O!==0&&(C=O,d=hf(o,O))),d===1))throw x=od,Kc(o,0),Sa(o,C),Fs(o,kr()),x;switch(o.finishedWork=R,o.finishedLanes=C,d){case 0:case 1:throw Error(u(345));case 2:Xc(o,Ts,il);break;case 3:if(Sa(o,C),(C&130023424)===C&&(d=Pp+500-kr(),10<d)){if(wl(o,0)!==0)break;if(R=o.suspendedLanes,(R&C)!==C){mi(),o.pingedLanes|=o.suspendedLanes&R;break}o.timeoutHandle=Iu(Xc.bind(null,o,Ts,il),d);break}Xc(o,Ts,il);break;case 4:if(Sa(o,C),(C&4194240)===C)break;for(d=o.eventTimes,R=-1;0<C;){var J=31-ks(C);O=1<<J,J=d[J],J>R&&(R=J),C&=~O}if(C=R,C=kr()-C,C=(120>C?120:480>C?480:1080>C?1080:1920>C?1920:3e3>C?3e3:4320>C?4320:1960*Bm(C/1960))-C,10<C){o.timeoutHandle=Iu(Xc.bind(null,o,Ts,il),C);break}Xc(o,Ts,il);break;case 5:Xc(o,Ts,il);break;default:throw Error(u(329))}}}return Fs(o,kr()),o.callbackNode===x?kp.bind(null,o):null}function hf(o,d){var x=qu;return o.current.memoizedState.isDehydrated&&(Kc(o,d).flags|=256),o=dd(o,d),o!==2&&(d=Ts,Ts=x,d!==null&&Ep(d)),o}function Ep(o){Ts===null?Ts=o:Ts.push.apply(Ts,o)}function oy(o){for(var d=o;;){if(d.flags&16384){var x=d.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var C=0;C<x.length;C++){var R=x[C],O=R.getSnapshot;R=R.value;try{if(!qs(O(),R))return!1}catch{return!1}}}if(x=d.child,d.subtreeFlags&16384&&x!==null)x.return=d,d=x;else{if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Sa(o,d){for(d&=~ld,d&=~Jl,o.suspendedLanes|=d,o.pingedLanes&=~d,o=o.expirationTimes;0<d;){var x=31-ks(d),C=1<<x;o[x]=-1,d&=~C}}function Ip(o){if((Br&6)!==0)throw Error(u(327));Ku();var d=wl(o,0);if((d&1)===0)return Fs(o,kr()),null;var x=dd(o,d);if(o.tag!==0&&x===2){var C=gc(o);C!==0&&(d=C,x=hf(o,C))}if(x===1)throw x=od,Kc(o,0),Sa(o,d),Fs(o,kr()),x;if(x===6)throw Error(u(345));return o.finishedWork=o.current.alternate,o.finishedLanes=d,Xc(o,Ts,il),Fs(o,kr()),null}function Mp(o,d){var x=Br;Br|=1;try{return o(d)}finally{Br=x,Br===0&&(Wu=kr()+500,Ga&&To())}}function Hc(o){ec!==null&&ec.tag===0&&(Br&6)===0&&Ku();var d=Br;Br|=1;var x=Ls.transition,C=qr;try{if(Ls.transition=null,qr=1,o)return o()}finally{qr=C,Ls.transition=x,Br=d,(Br&6)===0&&To()}}function Ap(){Js=Wc.current,rn(Wc)}function Kc(o,d){o.finishedWork=null,o.finishedLanes=0;var x=o.timeoutHandle;if(x!==-1&&(o.timeoutHandle=-1,ef(x)),Sn!==null)for(x=Sn.return;x!==null;){var C=x;switch(qh(C),C.tag){case 1:C=C.type.childContextTypes,C!=null&&Za();break;case 3:h(),rn(zi),rn(si),z();break;case 5:y(C);break;case 4:h();break;case 13:rn(S);break;case 19:rn(S);break;case 10:fi(C.type._context);break;case 22:case 23:Ap()}x=x.return}if(Yn=o,Sn=o=sl(o.current,null),Qn=Js=d,Tn=0,od=null,ld=Jl=Ql=0,Ts=qu=null,Ks!==null){for(d=0;d<Ks.length;d++)if(x=Ks[d],C=x.interleaved,C!==null){x.interleaved=null;var R=C.next,O=x.pending;if(O!==null){var J=O.next;O.next=R,C.next=J}x.pending=C}Ks=null}return o}function $m(o,d){do{var x=Sn;try{if(Kl(),D.current=Bi,se){for(var C=$.memoizedState;C!==null;){var R=C.queue;R!==null&&(R.pending=null),C=C.next}se=!1}if(j=0,re=W=$=null,ae=!1,oe=0,qc.current=null,x===null||x.return===null){Tn=1,od=d,Sn=null;break}e:{var O=o,J=x.return,me=x,Ee=d;if(d=Qn,me.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var He=Ee,dt=me,ct=dt.tag;if((dt.mode&1)===0&&(ct===0||ct===11||ct===15)){var at=dt.alternate;at?(dt.updateQueue=at.updateQueue,dt.memoizedState=at.memoizedState,dt.lanes=at.lanes):(dt.updateQueue=null,dt.memoizedState=null)}var Ot=up(J);if(Ot!==null){Ot.flags&=-257,Cm(Ot,J,me,O,d),Ot.mode&1&&tf(O,He,d),d=Ot,Ee=He;var Vt=d.updateQueue;if(Vt===null){var Qt=new Set;Qt.add(Ee),d.updateQueue=Qt}else Vt.add(Ee);break e}else{if((d&1)===0){tf(O,He,d),hd();break e}Ee=Error(u(426))}}else if(vn&&me.mode&1){var In=up(J);if(In!==null){(In.flags&65536)===0&&(In.flags|=256),Cm(In,J,me,O,d),Po(Xa(Ee,me));break e}}O=Ee=Xa(Ee,me),Tn!==4&&(Tn=2),qu===null?qu=[O]:qu.push(O),O=J;do{switch(O.tag){case 3:O.flags|=65536,d&=-d,O.lanes|=d;var Ve=cp(O,Ee,d);$c(O,Ve);break e;case 1:me=Ee;var Fe=O.type,Ge=O.stateNode;if((O.flags&128)===0&&(typeof Fe.getDerivedStateFromError=="function"||Ge!==null&&typeof Ge.componentDidCatch=="function"&&(ea===null||!ea.has(Ge)))){O.flags|=65536,d&=-d,O.lanes|=d;var bt=Pm(O,me,d);$c(O,bt);break e}}O=O.return}while(O!==null)}fd(x)}catch(Gt){d=Gt,Sn===x&&x!==null&&(Sn=x=x.return);continue}break}while(!0)}function Rp(){var o=ad.current;return ad.current=Bi,o===null?Bi:o}function hd(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Yn===null||(Ql&268435455)===0&&(Jl&268435455)===0||Sa(Yn,Qn)}function dd(o,d){var x=Br;Br|=2;var C=Rp();(Yn!==o||Qn!==d)&&(il=null,Kc(o,d));do try{Um();break}catch(R){$m(o,R)}while(!0);if(Kl(),Br=x,ad.current=C,Sn!==null)throw Error(u(261));return Yn=null,Qn=0,Tn}function Um(){for(;Sn!==null;)Zm(Sn)}function Vm(){for(;Sn!==null&&!la();)Zm(Sn)}function Zm(o){var d=Jn(o.alternate,o,Js);o.memoizedProps=o.pendingProps,d===null?fd(o):Sn=d,qc.current=null}function fd(o){var d=o;do{var x=d.alternate;if(o=d.return,(d.flags&32768)===0){if(x=zm(x,d,Js),x!==null){Sn=x;return}}else{if(x=ay(x,d),x!==null){x.flags&=32767,Sn=x;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Tn=6,Sn=null;return}}if(d=d.sibling,d!==null){Sn=d;return}Sn=d=o}while(d!==null);Tn===0&&(Tn=5)}function Xc(o,d,x){var C=qr,R=Ls.transition;try{Ls.transition=null,qr=1,Gm(o,d,x,C)}finally{Ls.transition=R,qr=C}return null}function Gm(o,d,x,C){do Ku();while(ec!==null);if((Br&6)!==0)throw Error(u(327));x=o.finishedWork;var R=o.finishedLanes;if(x===null)return null;if(o.finishedWork=null,o.finishedLanes=0,x===o.current)throw Error(u(177));o.callbackNode=null,o.callbackPriority=0;var O=x.lanes|x.childLanes;if(Qf(o,O),o===Yn&&(Sn=Yn=null,Qn=0),(x.subtreeFlags&2064)===0&&(x.flags&2064)===0||lf||(lf=!0,df(fc,function(){return Ku(),null})),O=(x.flags&15990)!==0,(x.subtreeFlags&15990)!==0||O){O=Ls.transition,Ls.transition=null;var J=qr;qr=1;var me=Br;Br|=4,qc.current=null,xp(o,x),Nm(x,o),Pu(Na),bi=!!Vl,Na=Vl=null,o.current=x,Zu(x),xl(),Br=me,qr=J,Ls.transition=O}else o.current=x;if(lf&&(lf=!1,ec=o,cd=R),O=o.pendingLanes,O===0&&(ea=null),_h(x.stateNode),Fs(o,kr()),d!==null)for(C=o.onRecoverableError,x=0;x<d.length;x++)R=d[x],C(R.value,{componentStack:R.stack,digest:R.digest});if(of)throw of=!1,o=Cp,Cp=null,o;return(cd&1)!==0&&o.tag!==0&&Ku(),O=o.pendingLanes,(O&1)!==0?o===cf?ud++:(ud=0,cf=o):ud=0,To(),null}function Ku(){if(ec!==null){var o=Es(cd),d=Ls.transition,x=qr;try{if(Ls.transition=null,qr=16>o?16:o,ec===null)var C=!1;else{if(o=ec,ec=null,cd=0,(Br&6)!==0)throw Error(u(331));var R=Br;for(Br|=4,Ut=o.current;Ut!==null;){var O=Ut,J=O.child;if((Ut.flags&16)!==0){var me=O.deletions;if(me!==null){for(var Ee=0;Ee<me.length;Ee++){var He=me[Ee];for(Ut=He;Ut!==null;){var dt=Ut;switch(dt.tag){case 0:case 11:case 15:Vu(8,dt,O)}var ct=dt.child;if(ct!==null)ct.return=dt,Ut=ct;else for(;Ut!==null;){dt=Ut;var at=dt.sibling,Ot=dt.return;if(Lm(dt),dt===He){Ut=null;break}if(at!==null){at.return=Ot,Ut=at;break}Ut=Ot}}}var Vt=O.alternate;if(Vt!==null){var Qt=Vt.child;if(Qt!==null){Vt.child=null;do{var In=Qt.sibling;Qt.sibling=null,Qt=In}while(Qt!==null)}}Ut=O}}if((O.subtreeFlags&2064)!==0&&J!==null)J.return=O,Ut=J;else e:for(;Ut!==null;){if(O=Ut,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Vu(9,O,O.return)}var Ve=O.sibling;if(Ve!==null){Ve.return=O.return,Ut=Ve;break e}Ut=O.return}}var Fe=o.current;for(Ut=Fe;Ut!==null;){J=Ut;var Ge=J.child;if((J.subtreeFlags&2064)!==0&&Ge!==null)Ge.return=J,Ut=Ge;else e:for(J=Fe;Ut!==null;){if(me=Ut,(me.flags&2048)!==0)try{switch(me.tag){case 0:case 11:case 15:Io(9,me)}}catch(Gt){$n(me,me.return,Gt)}if(me===J){Ut=null;break e}var bt=me.sibling;if(bt!==null){bt.return=me.return,Ut=bt;break e}Ut=me.return}}if(Br=R,To(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(Ns,o)}catch{}C=!0}return C}finally{qr=x,Ls.transition=d}}return!1}function qm(o,d,x){d=Xa(x,d),d=cp(o,d,1),o=ns(o,d,1),d=mi(),o!==null&&(Bo(o,1,d),Fs(o,d))}function $n(o,d,x){if(o.tag===3)qm(o,o,x);else for(;d!==null;){if(d.tag===3){qm(d,o,x);break}else if(d.tag===1){var C=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(ea===null||!ea.has(C))){o=Xa(x,o),o=Pm(d,o,1),d=ns(d,o,1),o=mi(),d!==null&&(Bo(d,1,o),Fs(d,o));break}}d=d.return}}function Wm(o,d,x){var C=o.pingCache;C!==null&&C.delete(d),d=mi(),o.pingedLanes|=o.suspendedLanes&x,Yn===o&&(Qn&x)===x&&(Tn===4||Tn===3&&(Qn&130023424)===Qn&&500>kr()-Pp?Kc(o,0):ld|=x),Fs(o,d)}function Hm(o,d){d===0&&((o.mode&1)===0?d=1:(d=yu,yu<<=1,(yu&130023424)===0&&(yu=4194304)));var x=mi();o=Rs(o,d),o!==null&&(Bo(o,d,x),Fs(o,x))}function ly(o){var d=o.memoizedState,x=0;d!==null&&(x=d.retryLane),Hm(o,x)}function pd(o,d){var x=0;switch(o.tag){case 13:var C=o.stateNode,R=o.memoizedState;R!==null&&(x=R.retryLane);break;case 19:C=o.stateNode;break;default:throw Error(u(314))}C!==null&&C.delete(d),Hm(o,x)}var Jn;Jn=function(o,d,x){if(o!==null)if(o.memoizedProps!==d.pendingProps||zi.current)Ds=!0;else{if((o.lanes&x)===0&&(d.flags&128)===0)return Ds=!1,ws(o,d,x);Ds=(o.flags&131072)!==0}else Ds=!1,vn&&(d.flags&1048576)!==0&&Fr(d,kt,d.index);switch(d.lanes=0,d.tag){case 2:var C=d.type;Bu(o,d),o=d.pendingProps;var R=Hs(d,si.current);pi(d,x),R=we(null,d,C,o,R,x);var O=he();return d.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,wi(C)?(O=!0,Qi(d)):O=!1,d.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,Co(d),R.updater=Ys,d.stateNode=R,R._reactInternals=d,Vc(d,C,o,x),d=Nu(null,d,C,!0,O,x)):(d.tag=0,vn&&O&&ql(d),$i(null,d,R,x),d=d.child),d;case 16:C=d.elementType;e:{switch(Bu(o,d),o=d.pendingProps,R=C._init,C=R(C._payload),d.type=C,R=d.tag=Xu(C),o=Xn(C,o),R){case 0:d=fp(null,d,C,o,x);break e;case 1:d=ju(null,d,C,o,x);break e;case 11:d=Em(null,d,C,o,x);break e;case 14:d=rf(null,d,C,Xn(C.type,o),x);break e}throw Error(u(306,C,""))}return d;case 0:return C=d.type,R=d.pendingProps,R=d.elementType===C?R:Xn(C,R),fp(o,d,C,R,x);case 1:return C=d.type,R=d.pendingProps,R=d.elementType===C?R:Xn(C,R),ju(o,d,C,R,x);case 3:e:{if(Jh(d),o===null)throw Error(u(387));C=d.pendingProps,O=d.memoizedState,R=O.element,Fu(o,d),xa(d,C,null,x);var J=d.memoizedState;if(C=J.element,O.isDehydrated)if(O={element:C,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},d.updateQueue.baseState=O,d.memoizedState=O,d.flags&256){R=Xa(Error(u(423)),d),d=pp(o,d,C,x,R);break e}else if(C!==R){R=Xa(Error(u(424)),d),d=pp(o,d,C,x,R);break e}else for(ys=tn(d.stateNode.containerInfo.firstChild),Si=d,vn=!0,_s=null,x=Bc(d,null,C,x),d.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Wr(),C===R){d=Qs(o,d,x);break e}$i(o,d,C,x)}d=d.child}return d;case 5:return p(d),o===null&&jc(d),C=d.type,R=d.pendingProps,O=o!==null?o.memoizedProps:null,J=R.children,Dc(C,R)?J=null:O!==null&&Dc(C,O)&&(d.flags|=32),Zc(o,d),$i(o,d,J,x),d.child;case 6:return o===null&&jc(d),null;case 13:return Im(o,d,x);case 4:return s(d,d.stateNode.containerInfo),C=d.pendingProps,o===null?d.child=Oi(d,null,C,x):$i(o,d,C,x),d.child;case 11:return C=d.type,R=d.pendingProps,R=d.elementType===C?R:Xn(C,R),Em(o,d,C,R,x);case 7:return $i(o,d,d.pendingProps,x),d.child;case 8:return $i(o,d,d.pendingProps.children,x),d.child;case 12:return $i(o,d,d.pendingProps.children,x),d.child;case 10:e:{if(C=d.type._context,R=d.pendingProps,O=d.memoizedProps,J=R.value,Or(Lt,C._currentValue),C._currentValue=J,O!==null)if(qs(O.value,J)){if(O.children===R.children&&!zi.current){d=Qs(o,d,x);break e}}else for(O=d.child,O!==null&&(O.return=d);O!==null;){var me=O.dependencies;if(me!==null){J=O.child;for(var Ee=me.firstContext;Ee!==null;){if(Ee.context===C){if(O.tag===1){Ee=rs(-1,x&-x),Ee.tag=2;var He=O.updateQueue;if(He!==null){He=He.shared;var dt=He.pending;dt===null?Ee.next=Ee:(Ee.next=dt.next,dt.next=Ee),He.pending=Ee}}O.lanes|=x,Ee=O.alternate,Ee!==null&&(Ee.lanes|=x),Lu(O.return,x,d),me.lanes|=x;break}Ee=Ee.next}}else if(O.tag===10)J=O.type===d.type?null:O.child;else if(O.tag===18){if(J=O.return,J===null)throw Error(u(341));J.lanes|=x,me=J.alternate,me!==null&&(me.lanes|=x),Lu(J,x,d),J=O.sibling}else J=O.child;if(J!==null)J.return=O;else for(J=O;J!==null;){if(J===d){J=null;break}if(O=J.sibling,O!==null){O.return=J.return,J=O;break}J=J.return}O=J}$i(o,d,R.children,x),d=d.child}return d;case 9:return R=d.type,C=d.pendingProps.children,pi(d,x),R=As(R),C=C(R),d.flags|=1,$i(o,d,C,x),d.child;case 14:return C=d.type,R=Xn(C,d.pendingProps),R=Xn(C.type,R),rf(o,d,C,R,x);case 15:return hp(o,d,d.type,d.pendingProps,x);case 17:return C=d.type,R=d.pendingProps,R=d.elementType===C?R:Xn(C,R),Bu(o,d),d.tag=1,wi(C)?(o=!0,Qi(d)):o=!1,pi(d,x),is(d,C,R),Vc(d,C,R,x),Nu(null,d,C,!0,o,x);case 19:return gp(o,d,x);case 22:return dp(o,d,x)}throw Error(u(156,d.tag))};function df(o,d){return Ma(o,d)}function Km(o,d,x,C){this.tag=o,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ta(o,d,x,C){return new Km(o,d,x,C)}function md(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Xu(o){if(typeof o=="function")return md(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Rt)return 11;if(o===zr)return 14}return 2}function sl(o,d){var x=o.alternate;return x===null?(x=ta(o.tag,d,o.key,o.mode),x.elementType=o.elementType,x.type=o.type,x.stateNode=o.stateNode,x.alternate=o,o.alternate=x):(x.pendingProps=d,x.type=o.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=o.flags&14680064,x.childLanes=o.childLanes,x.lanes=o.lanes,x.child=o.child,x.memoizedProps=o.memoizedProps,x.memoizedState=o.memoizedState,x.updateQueue=o.updateQueue,d=o.dependencies,x.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},x.sibling=o.sibling,x.index=o.index,x.ref=o.ref,x}function ff(o,d,x,C,R,O){var J=2;if(C=o,typeof o=="function")md(o)&&(J=1);else if(typeof o=="string")J=5;else e:switch(o){case lt:return Yc(x.children,R,O,d);case ut:J=8,R|=8;break;case Je:return o=ta(12,x,d,R|2),o.elementType=Je,o.lanes=O,o;case Mt:return o=ta(13,x,d,R),o.elementType=Mt,o.lanes=O,o;case Ht:return o=ta(19,x,d,R),o.elementType=Ht,o.lanes=O,o;case Zt:return pf(x,R,O,d);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case Ke:J=10;break e;case At:J=9;break e;case Rt:J=11;break e;case zr:J=14;break e;case or:J=16,C=null;break e}throw Error(u(130,o==null?o:typeof o,""))}return d=ta(J,x,d,R),d.elementType=o,d.type=C,d.lanes=O,d}function Yc(o,d,x,C){return o=ta(7,o,C,d),o.lanes=x,o}function pf(o,d,x,C){return o=ta(22,o,C,d),o.elementType=Zt,o.lanes=x,o.stateNode={isHidden:!1},o}function zp(o,d,x){return o=ta(6,o,null,d),o.lanes=x,o}function Dp(o,d,x){return d=ta(4,o.children!==null?o.children:[],o.key,d),d.lanes=x,d.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},d}function cy(o,d,x,C,R){this.tag=d,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yc(0),this.expirationTimes=yc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yc(0),this.identifierPrefix=C,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function Lp(o,d,x,C,R,O,J,me,Ee){return o=new cy(o,d,x,me,Ee),d===1?(d=1,O===!0&&(d|=8)):d=0,O=ta(3,null,null,d),o.current=O,O.stateNode=o,O.memoizedState={element:C,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},Co(O),o}function uy(o,d,x){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ot,key:C==null?null:""+C,children:o,containerInfo:d,implementation:x}}function Xm(o){if(!o)return gs;o=o._reactInternals;e:{if(pr(o)!==o||o.tag!==1)throw Error(u(170));var d=o;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(wi(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(u(171))}if(o.tag===1){var x=o.type;if(wi(x))return Di(o,x,d)}return d}function Ym(o,d,x,C,R,O,J,me,Ee){return o=Lp(x,C,!0,o,R,O,J,me,Ee),o.context=Xm(null),x=o.current,C=mi(),R=Ao(x),O=rs(C,R),O.callback=d??null,ns(x,O,R),o.current.lanes=R,Bo(o,R,C),Fs(o,C),o}function mf(o,d,x,C){var R=d.current,O=mi(),J=Ao(R);return x=Xm(x),d.context===null?d.context=x:d.pendingContext=x,d=rs(O,J),d.payload={element:o},C=C===void 0?null:C,C!==null&&(d.callback=C),o=ns(R,d,J),o!==null&&(Ja(o,R,J,O),ko(o,R,J)),J}function gf(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Fp(o,d){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var x=o.retryLane;o.retryLane=x!==0&&x<d?x:d}}function gd(o,d){Fp(o,d),(o=o.alternate)&&Fp(o,d)}function Qm(){return null}var al=typeof reportError=="function"?reportError:function(o){console.error(o)};function Qc(o){this._internalRoot=o}ol.prototype.render=Qc.prototype.render=function(o){var d=this._internalRoot;if(d===null)throw Error(u(409));mf(o,d,null,null)},ol.prototype.unmount=Qc.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var d=o.containerInfo;Hc(function(){mf(null,o,null,null)}),d[ma]=null}};function ol(o){this._internalRoot=o}ol.prototype.unstable_scheduleHydration=function(o){if(o){var d=ca();o={blockedOn:null,target:o,priority:d};for(var x=0;x<fn.length&&d!==0&&d<fn[x].priority;x++);fn.splice(x,0,o),x===0&&hi(o)}};function Yu(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Jc(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Jm(){}function hy(o,d,x,C,R){if(R){if(typeof C=="function"){var O=C;C=function(){var He=gf(J);O.call(He)}}var J=Ym(d,C,o,0,null,!1,!1,"",Jm);return o._reactRootContainer=J,o[ma]=J.current,wo(o.nodeType===8?o.parentNode:o),Hc(),J}for(;R=o.lastChild;)o.removeChild(R);if(typeof C=="function"){var me=C;C=function(){var He=gf(Ee);me.call(He)}}var Ee=Lp(o,0,!1,null,null,!1,!1,"",Jm);return o._reactRootContainer=Ee,o[ma]=Ee.current,wo(o.nodeType===8?o.parentNode:o),Hc(function(){mf(d,Ee,x,C)}),Ee}function yd(o,d,x,C,R){var O=x._reactRootContainer;if(O){var J=O;if(typeof R=="function"){var me=R;R=function(){var Ee=gf(J);me.call(Ee)}}mf(d,J,o,R)}else J=hy(x,d,o,R,C);return gf(J)}Er=function(o){switch(o.tag){case 3:var d=o.stateNode;if(d.current.memoizedState.isDehydrated){var x=mc(d.pendingLanes);x!==0&&(co(d,x|1),Fs(d,kr()),(Br&6)===0&&(Wu=kr()+500,To()))}break;case 13:Hc(function(){var C=Rs(o,1);if(C!==null){var R=mi();Ja(C,o,1,R)}}),gd(o,1)}},Aa=function(o){if(o.tag===13){var d=Rs(o,134217728);if(d!==null){var x=mi();Ja(d,o,134217728,x)}gd(o,134217728)}},Ra=function(o){if(o.tag===13){var d=Ao(o),x=Rs(o,d);if(x!==null){var C=mi();Ja(x,o,d,C)}gd(o,d)}},ca=function(){return qr},uo=function(o,d){var x=qr;try{return qr=o,d()}finally{qr=x}},et=function(o,d,x){switch(d){case"input":if(Yi(o,x),d=x.name,x.type==="radio"&&d!=null){for(x=o;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<x.length;d++){var C=x[d];if(C!==o&&C.form===o.form){var R=Oc(C);if(!R)throw Error(u(90));ln(C),Yi(C,R)}}}break;case"textarea":vt(o,x);break;case"select":d=x.value,d!=null&&Be(o,!!x.multiple,d,!1)}},Xt=Mp,Cr=Hc;var eg={usingClientEntryPoint:!1,Events:[Zl,Xo,Oc,rr,Dt,Mp]},_d={findFiberByHostInstance:Va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tg={bundleType:_d.bundleType,version:_d.version,rendererPackageName:_d.rendererPackageName,rendererConfig:_d.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:De.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=xr(o),o===null?null:o.stateNode},findFiberByHostInstance:_d.findFiberByHostInstance||Qm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{Ns=vd.inject(tg),ui=vd}catch{}}return Ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eg,Ta.createPortal=function(o,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yu(d))throw Error(u(200));return uy(o,d,null,x)},Ta.createRoot=function(o,d){if(!Yu(o))throw Error(u(299));var x=!1,C="",R=al;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(C=d.identifierPrefix),d.onRecoverableError!==void 0&&(R=d.onRecoverableError)),d=Lp(o,1,!1,null,null,x,!1,C,R),o[ma]=d.current,wo(o.nodeType===8?o.parentNode:o),new Qc(d)},Ta.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var d=o._reactInternals;if(d===void 0)throw typeof o.render=="function"?Error(u(188)):(o=Object.keys(o).join(","),Error(u(268,o)));return o=xr(d),o=o===null?null:o.stateNode,o},Ta.flushSync=function(o){return Hc(o)},Ta.hydrate=function(o,d,x){if(!Jc(d))throw Error(u(200));return yd(null,o,d,!0,x)},Ta.hydrateRoot=function(o,d,x){if(!Yu(o))throw Error(u(405));var C=x!=null&&x.hydratedSources||null,R=!1,O="",J=al;if(x!=null&&(x.unstable_strictMode===!0&&(R=!0),x.identifierPrefix!==void 0&&(O=x.identifierPrefix),x.onRecoverableError!==void 0&&(J=x.onRecoverableError)),d=Ym(d,null,o,1,x??null,R,!1,O,J),o[ma]=d.current,wo(o),C)for(o=0;o<C.length;o++)x=C[o],R=x._getVersion,R=R(x._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[x,R]:d.mutableSourceEagerHydrationData.push(x,R);return new ol(d)},Ta.render=function(o,d,x){if(!Jc(d))throw Error(u(200));return yd(null,o,d,!1,x)},Ta.unmountComponentAtNode=function(o){if(!Jc(o))throw Error(u(40));return o._reactRootContainer?(Hc(function(){yd(null,null,o,!1,function(){o._reactRootContainer=null,o[ma]=null})}),!0):!1},Ta.unstable_batchedUpdates=Mp,Ta.unstable_renderSubtreeIntoContainer=function(o,d,x,C){if(!Jc(x))throw Error(u(200));if(o==null||o._reactInternals===void 0)throw Error(u(38));return yd(o,d,x,!1,C)},Ta.version="18.3.1-next-f1338f8080-20240426",Ta}var ax;function Y0(){if(ax)return My.exports;ax=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(a){console.error(a)}}return r(),My.exports=Pw(),My.exports}var ox;function Cw(){if(ox)return cg;ox=1;var r=Y0();return cg.createRoot=r.createRoot,cg.hydrateRoot=r.hydrateRoot,cg}var kw=Cw();const Ew=R_(kw);/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var lx="popstate";function Iw(r={}){function a(m,b){let{pathname:P,search:w,hash:l}=m.location;return Zy("",{pathname:P,search:w,hash:l},b.state&&b.state.usr||null,b.state&&b.state.key||"default")}function u(m,b){return typeof b=="string"?b:em(b)}return Aw(a,u,null,r)}function Un(r,a){if(r===!1||r===null||typeof r>"u")throw new Error(a)}function yl(r,a){if(!r){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function Mw(){return Math.random().toString(36).substring(2,10)}function cx(r,a){return{usr:r.state,key:r.key,idx:a}}function Zy(r,a,u=null,m){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof a=="string"?Gf(a):a,state:u,key:a&&a.key||m||Mw()}}function em({pathname:r="/",search:a="",hash:u=""}){return a&&a!=="?"&&(r+=a.charAt(0)==="?"?a:"?"+a),u&&u!=="#"&&(r+=u.charAt(0)==="#"?u:"#"+u),r}function Gf(r){let a={};if(r){let u=r.indexOf("#");u>=0&&(a.hash=r.substring(u),r=r.substring(0,u));let m=r.indexOf("?");m>=0&&(a.search=r.substring(m),r=r.substring(0,m)),r&&(a.pathname=r)}return a}function Aw(r,a,u,m={}){let{window:b=document.defaultView,v5Compat:P=!1}=m,w=b.history,l="POP",L=null,N=Z();N==null&&(N=0,w.replaceState({...w.state,idx:N},""));function Z(){return(w.state||{idx:null}).idx}function V(){l="POP";let Pe=Z(),Le=Pe==null?null:Pe-N;N=Pe,L&&L({action:l,location:fe.location,delta:Le})}function ee(Pe,Le){l="PUSH";let Me=Zy(fe.location,Pe,Le);N=Z()+1;let Se=cx(Me,N),De=fe.createHref(Me);try{w.pushState(Se,"",De)}catch(Ye){if(Ye instanceof DOMException&&Ye.name==="DataCloneError")throw Ye;b.location.assign(De)}P&&L&&L({action:l,location:fe.location,delta:1})}function q(Pe,Le){l="REPLACE";let Me=Zy(fe.location,Pe,Le);N=Z();let Se=cx(Me,N),De=fe.createHref(Me);w.replaceState(Se,"",De),P&&L&&L({action:l,location:fe.location,delta:0})}function _e(Pe){return Rw(Pe)}let fe={get action(){return l},get location(){return r(b,w)},listen(Pe){if(L)throw new Error("A history only accepts one active listener");return b.addEventListener(lx,V),L=Pe,()=>{b.removeEventListener(lx,V),L=null}},createHref(Pe){return a(b,Pe)},createURL:_e,encodeLocation(Pe){let Le=_e(Pe);return{pathname:Le.pathname,search:Le.search,hash:Le.hash}},push:ee,replace:q,go(Pe){return w.go(Pe)}};return fe}function Rw(r,a=!1){let u="http://localhost";typeof window<"u"&&(u=window.location.origin!=="null"?window.location.origin:window.location.href),Un(u,"No window.location.(origin|href) available to create URL");let m=typeof r=="string"?r:em(r);return m=m.replace(/ $/,"%20"),!a&&m.startsWith("//")&&(m=u+m),new URL(m,u)}function Q0(r,a,u="/"){return zw(r,a,u,!1)}function zw(r,a,u,m){let b=typeof a=="string"?Gf(a):a,P=hu(b.pathname||"/",u);if(P==null)return null;let w=J0(r);Dw(w);let l=null;for(let L=0;l==null&&L<w.length;++L){let N=Gw(P);l=Vw(w[L],N,m)}return l}function J0(r,a=[],u=[],m="",b=!1){let P=(w,l,L=b,N)=>{let Z={relativePath:N===void 0?w.path||"":N,caseSensitive:w.caseSensitive===!0,childrenIndex:l,route:w};if(Z.relativePath.startsWith("/")){if(!Z.relativePath.startsWith(m)&&L)return;Un(Z.relativePath.startsWith(m),`Absolute route path "${Z.relativePath}" nested under path "${m}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),Z.relativePath=Z.relativePath.slice(m.length)}let V=lu([m,Z.relativePath]),ee=u.concat(Z);w.children&&w.children.length>0&&(Un(w.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${V}".`),J0(w.children,a,ee,V,L)),!(w.path==null&&!w.index)&&a.push({path:V,score:$w(V,w.index),routesMeta:ee})};return r.forEach((w,l)=>{var L;if(w.path===""||!((L=w.path)!=null&&L.includes("?")))P(w,l);else for(let N of eb(w.path))P(w,l,!0,N)}),a}function eb(r){let a=r.split("/");if(a.length===0)return[];let[u,...m]=a,b=u.endsWith("?"),P=u.replace(/\?$/,"");if(m.length===0)return b?[P,""]:[P];let w=eb(m.join("/")),l=[];return l.push(...w.map(L=>L===""?P:[P,L].join("/"))),b&&l.push(...w),l.map(L=>r.startsWith("/")&&L===""?"/":L)}function Dw(r){r.sort((a,u)=>a.score!==u.score?u.score-a.score:Uw(a.routesMeta.map(m=>m.childrenIndex),u.routesMeta.map(m=>m.childrenIndex)))}var Lw=/^:[\w-]+$/,Fw=3,Ow=2,jw=1,Nw=10,Bw=-2,ux=r=>r==="*";function $w(r,a){let u=r.split("/"),m=u.length;return u.some(ux)&&(m+=Bw),a&&(m+=Ow),u.filter(b=>!ux(b)).reduce((b,P)=>b+(Lw.test(P)?Fw:P===""?jw:Nw),m)}function Uw(r,a){return r.length===a.length&&r.slice(0,-1).every((m,b)=>m===a[b])?r[r.length-1]-a[a.length-1]:0}function Vw(r,a,u=!1){let{routesMeta:m}=r,b={},P="/",w=[];for(let l=0;l<m.length;++l){let L=m[l],N=l===m.length-1,Z=P==="/"?a:a.slice(P.length)||"/",V=kg({path:L.relativePath,caseSensitive:L.caseSensitive,end:N},Z),ee=L.route;if(!V&&N&&u&&!m[m.length-1].route.index&&(V=kg({path:L.relativePath,caseSensitive:L.caseSensitive,end:!1},Z)),!V)return null;Object.assign(b,V.params),w.push({params:b,pathname:lu([P,V.pathname]),pathnameBase:Kw(lu([P,V.pathnameBase])),route:ee}),V.pathnameBase!=="/"&&(P=lu([P,V.pathnameBase]))}return w}function kg(r,a){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[u,m]=Zw(r.path,r.caseSensitive,r.end),b=a.match(u);if(!b)return null;let P=b[0],w=P.replace(/(.)\/+$/,"$1"),l=b.slice(1);return{params:m.reduce((N,{paramName:Z,isOptional:V},ee)=>{if(Z==="*"){let _e=l[ee]||"";w=P.slice(0,P.length-_e.length).replace(/(.)\/+$/,"$1")}const q=l[ee];return V&&!q?N[Z]=void 0:N[Z]=(q||"").replace(/%2F/g,"/"),N},{}),pathname:P,pathnameBase:w,pattern:r}}function Zw(r,a=!1,u=!0){yl(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let m=[],b="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(w,l,L)=>(m.push({paramName:l,isOptional:L!=null}),L?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(m.push({paramName:"*"}),b+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):u?b+="\\/*$":r!==""&&r!=="/"&&(b+="(?:(?=\\/|$))"),[new RegExp(b,a?void 0:"i"),m]}function Gw(r){try{return r.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return yl(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),r}}function hu(r,a){if(a==="/")return r;if(!r.toLowerCase().startsWith(a.toLowerCase()))return null;let u=a.endsWith("/")?a.length-1:a.length,m=r.charAt(u);return m&&m!=="/"?null:r.slice(u)||"/"}function qw(r,a="/"){let{pathname:u,search:m="",hash:b=""}=typeof r=="string"?Gf(r):r;return{pathname:u?u.startsWith("/")?u:Ww(u,a):a,search:Xw(m),hash:Yw(b)}}function Ww(r,a){let u=a.replace(/\/+$/,"").split("/");return r.split("/").forEach(b=>{b===".."?u.length>1&&u.pop():b!=="."&&u.push(b)}),u.length>1?u.join("/"):"/"}function zy(r,a,u,m){return`Cannot include a '${r}' character in a manually specified \`to.${a}\` field [${JSON.stringify(m)}].  Please separate it out to the \`to.${u}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Hw(r){return r.filter((a,u)=>u===0||a.route.path&&a.route.path.length>0)}function D_(r){let a=Hw(r);return a.map((u,m)=>m===a.length-1?u.pathname:u.pathnameBase)}function L_(r,a,u,m=!1){let b;typeof r=="string"?b=Gf(r):(b={...r},Un(!b.pathname||!b.pathname.includes("?"),zy("?","pathname","search",b)),Un(!b.pathname||!b.pathname.includes("#"),zy("#","pathname","hash",b)),Un(!b.search||!b.search.includes("#"),zy("#","search","hash",b)));let P=r===""||b.pathname==="",w=P?"/":b.pathname,l;if(w==null)l=u;else{let V=a.length-1;if(!m&&w.startsWith("..")){let ee=w.split("/");for(;ee[0]==="..";)ee.shift(),V-=1;b.pathname=ee.join("/")}l=V>=0?a[V]:"/"}let L=qw(b,l),N=w&&w!=="/"&&w.endsWith("/"),Z=(P||w===".")&&u.endsWith("/");return!L.pathname.endsWith("/")&&(N||Z)&&(L.pathname+="/"),L}var lu=r=>r.join("/").replace(/\/\/+/g,"/"),Kw=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Xw=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Yw=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Qw(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var tb=["POST","PUT","PATCH","DELETE"];new Set(tb);var Jw=["GET",...tb];new Set(Jw);var qf=te.createContext(null);qf.displayName="DataRouter";var Vg=te.createContext(null);Vg.displayName="DataRouterState";te.createContext(!1);var rb=te.createContext({isTransitioning:!1});rb.displayName="ViewTransition";var e2=te.createContext(new Map);e2.displayName="Fetchers";var t2=te.createContext(null);t2.displayName="Await";var vl=te.createContext(null);vl.displayName="Navigation";var ym=te.createContext(null);ym.displayName="Location";var Fo=te.createContext({outlet:null,matches:[],isDataRoute:!1});Fo.displayName="Route";var F_=te.createContext(null);F_.displayName="RouteError";function r2(r,{relative:a}={}){Un(Wf(),"useHref() may be used only in the context of a <Router> component.");let{basename:u,navigator:m}=te.useContext(vl),{hash:b,pathname:P,search:w}=_m(r,{relative:a}),l=P;return u!=="/"&&(l=P==="/"?u:lu([u,P])),m.createHref({pathname:l,search:w,hash:b})}function Wf(){return te.useContext(ym)!=null}function Oo(){return Un(Wf(),"useLocation() may be used only in the context of a <Router> component."),te.useContext(ym).location}var nb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ib(r){te.useContext(vl).static||te.useLayoutEffect(r)}function Bd(){let{isDataRoute:r}=te.useContext(Fo);return r?_2():n2()}function n2(){Un(Wf(),"useNavigate() may be used only in the context of a <Router> component.");let r=te.useContext(qf),{basename:a,navigator:u}=te.useContext(vl),{matches:m}=te.useContext(Fo),{pathname:b}=Oo(),P=JSON.stringify(D_(m)),w=te.useRef(!1);return ib(()=>{w.current=!0}),te.useCallback((L,N={})=>{if(yl(w.current,nb),!w.current)return;if(typeof L=="number"){u.go(L);return}let Z=L_(L,JSON.parse(P),b,N.relative==="path");r==null&&a!=="/"&&(Z.pathname=Z.pathname==="/"?a:lu([a,Z.pathname])),(N.replace?u.replace:u.push)(Z,N.state,N)},[a,u,P,b,r])}var i2=te.createContext(null);function s2(r){let a=te.useContext(Fo).outlet;return a&&te.createElement(i2.Provider,{value:r},a)}function a2(){let{matches:r}=te.useContext(Fo),a=r[r.length-1];return a?a.params:{}}function _m(r,{relative:a}={}){let{matches:u}=te.useContext(Fo),{pathname:m}=Oo(),b=JSON.stringify(D_(u));return te.useMemo(()=>L_(r,JSON.parse(b),m,a==="path"),[r,b,m,a])}function o2(r,a){return sb(r,a)}function sb(r,a,u,m,b){var Me;Un(Wf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:P}=te.useContext(vl),{matches:w}=te.useContext(Fo),l=w[w.length-1],L=l?l.params:{},N=l?l.pathname:"/",Z=l?l.pathnameBase:"/",V=l&&l.route;{let Se=V&&V.path||"";ab(N,!V||Se.endsWith("*")||Se.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${N}" (under <Route path="${Se}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Se}"> to <Route path="${Se==="/"?"*":`${Se}/*`}">.`)}let ee=Oo(),q;if(a){let Se=typeof a=="string"?Gf(a):a;Un(Z==="/"||((Me=Se.pathname)==null?void 0:Me.startsWith(Z)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${Z}" but pathname "${Se.pathname}" was given in the \`location\` prop.`),q=Se}else q=ee;let _e=q.pathname||"/",fe=_e;if(Z!=="/"){let Se=Z.replace(/^\//,"").split("/");fe="/"+_e.replace(/^\//,"").split("/").slice(Se.length).join("/")}let Pe=Q0(r,{pathname:fe});yl(V||Pe!=null,`No routes matched location "${q.pathname}${q.search}${q.hash}" `),yl(Pe==null||Pe[Pe.length-1].route.element!==void 0||Pe[Pe.length-1].route.Component!==void 0||Pe[Pe.length-1].route.lazy!==void 0,`Matched leaf route at location "${q.pathname}${q.search}${q.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Le=d2(Pe&&Pe.map(Se=>Object.assign({},Se,{params:Object.assign({},L,Se.params),pathname:lu([Z,P.encodeLocation?P.encodeLocation(Se.pathname).pathname:Se.pathname]),pathnameBase:Se.pathnameBase==="/"?Z:lu([Z,P.encodeLocation?P.encodeLocation(Se.pathnameBase).pathname:Se.pathnameBase])})),w,u,m,b);return a&&Le?te.createElement(ym.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...q},navigationType:"POP"}},Le):Le}function l2(){let r=y2(),a=Qw(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),u=r instanceof Error?r.stack:null,m="rgba(200,200,200, 0.5)",b={padding:"0.5rem",backgroundColor:m},P={padding:"2px 4px",backgroundColor:m},w=null;return console.error("Error handled by React Router default ErrorBoundary:",r),w=te.createElement(te.Fragment,null,te.createElement("p",null," Hey developer "),te.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",te.createElement("code",{style:P},"ErrorBoundary")," or"," ",te.createElement("code",{style:P},"errorElement")," prop on your route.")),te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},a),u?te.createElement("pre",{style:b},u):null,w)}var c2=te.createElement(l2,null),u2=class extends te.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,a){return a.location!==r.location||a.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:a.error,location:a.location,revalidation:r.revalidation||a.revalidation}}componentDidCatch(r,a){this.props.unstable_onError?this.props.unstable_onError(r,a):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?te.createElement(Fo.Provider,{value:this.props.routeContext},te.createElement(F_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function h2({routeContext:r,match:a,children:u}){let m=te.useContext(qf);return m&&m.static&&m.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(m.staticContext._deepestRenderedBoundaryId=a.route.id),te.createElement(Fo.Provider,{value:r},u)}function d2(r,a=[],u=null,m=null,b=null){if(r==null){if(!u)return null;if(u.errors)r=u.matches;else if(a.length===0&&!u.initialized&&u.matches.length>0)r=u.matches;else return null}let P=r,w=u==null?void 0:u.errors;if(w!=null){let N=P.findIndex(Z=>Z.route.id&&(w==null?void 0:w[Z.route.id])!==void 0);Un(N>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(w).join(",")}`),P=P.slice(0,Math.min(P.length,N+1))}let l=!1,L=-1;if(u)for(let N=0;N<P.length;N++){let Z=P[N];if((Z.route.HydrateFallback||Z.route.hydrateFallbackElement)&&(L=N),Z.route.id){let{loaderData:V,errors:ee}=u,q=Z.route.loader&&!V.hasOwnProperty(Z.route.id)&&(!ee||ee[Z.route.id]===void 0);if(Z.route.lazy||q){l=!0,L>=0?P=P.slice(0,L+1):P=[P[0]];break}}}return P.reduceRight((N,Z,V)=>{let ee,q=!1,_e=null,fe=null;u&&(ee=w&&Z.route.id?w[Z.route.id]:void 0,_e=Z.route.errorElement||c2,l&&(L<0&&V===0?(ab("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,fe=null):L===V&&(q=!0,fe=Z.route.hydrateFallbackElement||null)));let Pe=a.concat(P.slice(0,V+1)),Le=()=>{let Me;return ee?Me=_e:q?Me=fe:Z.route.Component?Me=te.createElement(Z.route.Component,null):Z.route.element?Me=Z.route.element:Me=N,te.createElement(h2,{match:Z,routeContext:{outlet:N,matches:Pe,isDataRoute:u!=null},children:Me})};return u&&(Z.route.ErrorBoundary||Z.route.errorElement||V===0)?te.createElement(u2,{location:u.location,revalidation:u.revalidation,component:_e,error:ee,children:Le(),routeContext:{outlet:null,matches:Pe,isDataRoute:!0},unstable_onError:m}):Le()},null)}function O_(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f2(r){let a=te.useContext(qf);return Un(a,O_(r)),a}function p2(r){let a=te.useContext(Vg);return Un(a,O_(r)),a}function m2(r){let a=te.useContext(Fo);return Un(a,O_(r)),a}function j_(r){let a=m2(r),u=a.matches[a.matches.length-1];return Un(u.route.id,`${r} can only be used on routes that contain a unique "id"`),u.route.id}function g2(){return j_("useRouteId")}function y2(){var m;let r=te.useContext(F_),a=p2("useRouteError"),u=j_("useRouteError");return r!==void 0?r:(m=a.errors)==null?void 0:m[u]}function _2(){let{router:r}=f2("useNavigate"),a=j_("useNavigate"),u=te.useRef(!1);return ib(()=>{u.current=!0}),te.useCallback(async(b,P={})=>{yl(u.current,nb),u.current&&(typeof b=="number"?r.navigate(b):await r.navigate(b,{fromRouteId:a,...P}))},[r,a])}var hx={};function ab(r,a,u){!a&&!hx[r]&&(hx[r]=!0,yl(!1,u))}te.memo(v2);function v2({routes:r,future:a,state:u,unstable_onError:m}){return sb(r,void 0,u,m,a)}function x2({to:r,replace:a,state:u,relative:m}){Un(Wf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:b}=te.useContext(vl);yl(!b,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:P}=te.useContext(Fo),{pathname:w}=Oo(),l=Bd(),L=L_(r,D_(P),w,m==="path"),N=JSON.stringify(L);return te.useEffect(()=>{l(JSON.parse(N),{replace:a,state:u,relative:m})},[l,N,m,a,u]),null}function b2(r){return s2(r.context)}function io(r){Un(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function w2({basename:r="/",children:a=null,location:u,navigationType:m="POP",navigator:b,static:P=!1}){Un(!Wf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let w=r.replace(/^\/*/,"/"),l=te.useMemo(()=>({basename:w,navigator:b,static:P,future:{}}),[w,b,P]);typeof u=="string"&&(u=Gf(u));let{pathname:L="/",search:N="",hash:Z="",state:V=null,key:ee="default"}=u,q=te.useMemo(()=>{let _e=hu(L,w);return _e==null?null:{location:{pathname:_e,search:N,hash:Z,state:V,key:ee},navigationType:m}},[w,L,N,Z,V,ee,m]);return yl(q!=null,`<Router basename="${w}"> is not able to match the URL "${L}${N}${Z}" because it does not start with the basename, so the <Router> won't render anything.`),q==null?null:te.createElement(vl.Provider,{value:l},te.createElement(ym.Provider,{children:a,value:q}))}function S2({children:r,location:a}){return o2(Gy(r),a)}function Gy(r,a=[]){let u=[];return te.Children.forEach(r,(m,b)=>{if(!te.isValidElement(m))return;let P=[...a,b];if(m.type===te.Fragment){u.push.apply(u,Gy(m.props.children,P));return}Un(m.type===io,`[${typeof m.type=="string"?m.type:m.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Un(!m.props.index||!m.props.children,"An index route cannot have child routes.");let w={id:m.props.id||P.join("-"),caseSensitive:m.props.caseSensitive,element:m.props.element,Component:m.props.Component,index:m.props.index,path:m.props.path,loader:m.props.loader,action:m.props.action,hydrateFallbackElement:m.props.hydrateFallbackElement,HydrateFallback:m.props.HydrateFallback,errorElement:m.props.errorElement,ErrorBoundary:m.props.ErrorBoundary,hasErrorBoundary:m.props.hasErrorBoundary===!0||m.props.ErrorBoundary!=null||m.props.errorElement!=null,shouldRevalidate:m.props.shouldRevalidate,handle:m.props.handle,lazy:m.props.lazy};m.props.children&&(w.children=Gy(m.props.children,P)),u.push(w)}),u}var bg="get",wg="application/x-www-form-urlencoded";function Zg(r){return r!=null&&typeof r.tagName=="string"}function T2(r){return Zg(r)&&r.tagName.toLowerCase()==="button"}function P2(r){return Zg(r)&&r.tagName.toLowerCase()==="form"}function C2(r){return Zg(r)&&r.tagName.toLowerCase()==="input"}function k2(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function E2(r,a){return r.button===0&&(!a||a==="_self")&&!k2(r)}var ug=null;function I2(){if(ug===null)try{new FormData(document.createElement("form"),0),ug=!1}catch{ug=!0}return ug}var M2=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dy(r){return r!=null&&!M2.has(r)?(yl(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wg}"`),null):r}function A2(r,a){let u,m,b,P,w;if(P2(r)){let l=r.getAttribute("action");m=l?hu(l,a):null,u=r.getAttribute("method")||bg,b=Dy(r.getAttribute("enctype"))||wg,P=new FormData(r)}else if(T2(r)||C2(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let L=r.getAttribute("formaction")||l.getAttribute("action");if(m=L?hu(L,a):null,u=r.getAttribute("formmethod")||l.getAttribute("method")||bg,b=Dy(r.getAttribute("formenctype"))||Dy(l.getAttribute("enctype"))||wg,P=new FormData(l,r),!I2()){let{name:N,type:Z,value:V}=r;if(Z==="image"){let ee=N?`${N}.`:"";P.append(`${ee}x`,"0"),P.append(`${ee}y`,"0")}else N&&P.append(N,V)}}else{if(Zg(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');u=bg,m=null,b=wg,w=r}return P&&b==="text/plain"&&(w=P,P=void 0),{action:m,method:u.toLowerCase(),encType:b,formData:P,body:w}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function N_(r,a){if(r===!1||r===null||typeof r>"u")throw new Error(a)}function R2(r,a,u){let m=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return m.pathname==="/"?m.pathname=`_root.${u}`:a&&hu(m.pathname,a)==="/"?m.pathname=`${a.replace(/\/$/,"")}/_root.${u}`:m.pathname=`${m.pathname.replace(/\/$/,"")}.${u}`,m}async function z2(r,a){if(r.id in a)return a[r.id];try{let u=await import(r.module);return a[r.id]=u,u}catch(u){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(u),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function D2(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function L2(r,a,u){let m=await Promise.all(r.map(async b=>{let P=a.routes[b.route.id];if(P){let w=await z2(P,u);return w.links?w.links():[]}return[]}));return N2(m.flat(1).filter(D2).filter(b=>b.rel==="stylesheet"||b.rel==="preload").map(b=>b.rel==="stylesheet"?{...b,rel:"prefetch",as:"style"}:{...b,rel:"prefetch"}))}function dx(r,a,u,m,b,P){let w=(L,N)=>u[N]?L.route.id!==u[N].route.id:!0,l=(L,N)=>{var Z;return u[N].pathname!==L.pathname||((Z=u[N].route.path)==null?void 0:Z.endsWith("*"))&&u[N].params["*"]!==L.params["*"]};return P==="assets"?a.filter((L,N)=>w(L,N)||l(L,N)):P==="data"?a.filter((L,N)=>{var V;let Z=m.routes[L.route.id];if(!Z||!Z.hasLoader)return!1;if(w(L,N)||l(L,N))return!0;if(L.route.shouldRevalidate){let ee=L.route.shouldRevalidate({currentUrl:new URL(b.pathname+b.search+b.hash,window.origin),currentParams:((V=u[0])==null?void 0:V.params)||{},nextUrl:new URL(r,window.origin),nextParams:L.params,defaultShouldRevalidate:!0});if(typeof ee=="boolean")return ee}return!0}):[]}function F2(r,a,{includeHydrateFallback:u}={}){return O2(r.map(m=>{let b=a.routes[m.route.id];if(!b)return[];let P=[b.module];return b.clientActionModule&&(P=P.concat(b.clientActionModule)),b.clientLoaderModule&&(P=P.concat(b.clientLoaderModule)),u&&b.hydrateFallbackModule&&(P=P.concat(b.hydrateFallbackModule)),b.imports&&(P=P.concat(b.imports)),P}).flat(1))}function O2(r){return[...new Set(r)]}function j2(r){let a={},u=Object.keys(r).sort();for(let m of u)a[m]=r[m];return a}function N2(r,a){let u=new Set;return new Set(a),r.reduce((m,b)=>{let P=JSON.stringify(j2(b));return u.has(P)||(u.add(P),m.push({key:P,link:b})),m},[])}function ob(){let r=te.useContext(qf);return N_(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function B2(){let r=te.useContext(Vg);return N_(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var B_=te.createContext(void 0);B_.displayName="FrameworkContext";function lb(){let r=te.useContext(B_);return N_(r,"You must render this element inside a <HydratedRouter> element"),r}function $2(r,a){let u=te.useContext(B_),[m,b]=te.useState(!1),[P,w]=te.useState(!1),{onFocus:l,onBlur:L,onMouseEnter:N,onMouseLeave:Z,onTouchStart:V}=a,ee=te.useRef(null);te.useEffect(()=>{if(r==="render"&&w(!0),r==="viewport"){let fe=Le=>{Le.forEach(Me=>{w(Me.isIntersecting)})},Pe=new IntersectionObserver(fe,{threshold:.5});return ee.current&&Pe.observe(ee.current),()=>{Pe.disconnect()}}},[r]),te.useEffect(()=>{if(m){let fe=setTimeout(()=>{w(!0)},100);return()=>{clearTimeout(fe)}}},[m]);let q=()=>{b(!0)},_e=()=>{b(!1),w(!1)};return u?r!=="intent"?[P,ee,{}]:[P,ee,{onFocus:Up(l,q),onBlur:Up(L,_e),onMouseEnter:Up(N,q),onMouseLeave:Up(Z,_e),onTouchStart:Up(V,q)}]:[!1,ee,{}]}function Up(r,a){return u=>{r&&r(u),u.defaultPrevented||a(u)}}function U2({page:r,...a}){let{router:u}=ob(),m=te.useMemo(()=>Q0(u.routes,r,u.basename),[u.routes,r,u.basename]);return m?te.createElement(Z2,{page:r,matches:m,...a}):null}function V2(r){let{manifest:a,routeModules:u}=lb(),[m,b]=te.useState([]);return te.useEffect(()=>{let P=!1;return L2(r,a,u).then(w=>{P||b(w)}),()=>{P=!0}},[r,a,u]),m}function Z2({page:r,matches:a,...u}){let m=Oo(),{manifest:b,routeModules:P}=lb(),{basename:w}=ob(),{loaderData:l,matches:L}=B2(),N=te.useMemo(()=>dx(r,a,L,b,m,"data"),[r,a,L,b,m]),Z=te.useMemo(()=>dx(r,a,L,b,m,"assets"),[r,a,L,b,m]),V=te.useMemo(()=>{if(r===m.pathname+m.search+m.hash)return[];let _e=new Set,fe=!1;if(a.forEach(Le=>{var Se;let Me=b.routes[Le.route.id];!Me||!Me.hasLoader||(!N.some(De=>De.route.id===Le.route.id)&&Le.route.id in l&&((Se=P[Le.route.id])!=null&&Se.shouldRevalidate)||Me.hasClientLoader?fe=!0:_e.add(Le.route.id))}),_e.size===0)return[];let Pe=R2(r,w,"data");return fe&&_e.size>0&&Pe.searchParams.set("_routes",a.filter(Le=>_e.has(Le.route.id)).map(Le=>Le.route.id).join(",")),[Pe.pathname+Pe.search]},[w,l,m,b,N,a,r,P]),ee=te.useMemo(()=>F2(Z,b),[Z,b]),q=V2(Z);return te.createElement(te.Fragment,null,V.map(_e=>te.createElement("link",{key:_e,rel:"prefetch",as:"fetch",href:_e,...u})),ee.map(_e=>te.createElement("link",{key:_e,rel:"modulepreload",href:_e,...u})),q.map(({key:_e,link:fe})=>te.createElement("link",{key:_e,nonce:u.nonce,...fe})))}function G2(...r){return a=>{r.forEach(u=>{typeof u=="function"?u(a):u!=null&&(u.current=a)})}}var cb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{cb&&(window.__reactRouterVersion="7.9.1")}catch{}function q2({basename:r,children:a,window:u}){let m=te.useRef();m.current==null&&(m.current=Iw({window:u,v5Compat:!0}));let b=m.current,[P,w]=te.useState({action:b.action,location:b.location}),l=te.useCallback(L=>{te.startTransition(()=>w(L))},[w]);return te.useLayoutEffect(()=>b.listen(l),[b,l]),te.createElement(w2,{basename:r,children:a,location:P.location,navigationType:P.action,navigator:b})}var ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ei=te.forwardRef(function({onClick:a,discover:u="render",prefetch:m="none",relative:b,reloadDocument:P,replace:w,state:l,target:L,to:N,preventScrollReset:Z,viewTransition:V,...ee},q){let{basename:_e}=te.useContext(vl),fe=typeof N=="string"&&ub.test(N),Pe,Le=!1;if(typeof N=="string"&&fe&&(Pe=N,cb))try{let Je=new URL(window.location.href),Ke=N.startsWith("//")?new URL(Je.protocol+N):new URL(N),At=hu(Ke.pathname,_e);Ke.origin===Je.origin&&At!=null?N=At+Ke.search+Ke.hash:Le=!0}catch{yl(!1,`<Link to="${N}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Me=r2(N,{relative:b}),[Se,De,Ye]=$2(m,ee),ot=X2(N,{replace:w,state:l,target:L,preventScrollReset:Z,relative:b,viewTransition:V});function lt(Je){a&&a(Je),Je.defaultPrevented||ot(Je)}let ut=te.createElement("a",{...ee,...Ye,href:Pe||Me,onClick:Le||P?a:lt,ref:G2(q,De),target:L,"data-discover":!fe&&u==="render"?"true":void 0});return Se&&!fe?te.createElement(te.Fragment,null,ut,te.createElement(U2,{page:Me})):ut});ei.displayName="Link";var W2=te.forwardRef(function({"aria-current":a="page",caseSensitive:u=!1,className:m="",end:b=!1,style:P,to:w,viewTransition:l,children:L,...N},Z){let V=_m(w,{relative:N.relative}),ee=Oo(),q=te.useContext(Vg),{navigator:_e,basename:fe}=te.useContext(vl),Pe=q!=null&&tS(V)&&l===!0,Le=_e.encodeLocation?_e.encodeLocation(V).pathname:V.pathname,Me=ee.pathname,Se=q&&q.navigation&&q.navigation.location?q.navigation.location.pathname:null;u||(Me=Me.toLowerCase(),Se=Se?Se.toLowerCase():null,Le=Le.toLowerCase()),Se&&fe&&(Se=hu(Se,fe)||Se);const De=Le!=="/"&&Le.endsWith("/")?Le.length-1:Le.length;let Ye=Me===Le||!b&&Me.startsWith(Le)&&Me.charAt(De)==="/",ot=Se!=null&&(Se===Le||!b&&Se.startsWith(Le)&&Se.charAt(Le.length)==="/"),lt={isActive:Ye,isPending:ot,isTransitioning:Pe},ut=Ye?a:void 0,Je;typeof m=="function"?Je=m(lt):Je=[m,Ye?"active":null,ot?"pending":null,Pe?"transitioning":null].filter(Boolean).join(" ");let Ke=typeof P=="function"?P(lt):P;return te.createElement(ei,{...N,"aria-current":ut,className:Je,ref:Z,style:Ke,to:w,viewTransition:l},typeof L=="function"?L(lt):L)});W2.displayName="NavLink";var H2=te.forwardRef(({discover:r="render",fetcherKey:a,navigate:u,reloadDocument:m,replace:b,state:P,method:w=bg,action:l,onSubmit:L,relative:N,preventScrollReset:Z,viewTransition:V,...ee},q)=>{let _e=J2(),fe=eS(l,{relative:N}),Pe=w.toLowerCase()==="get"?"get":"post",Le=typeof l=="string"&&ub.test(l),Me=Se=>{if(L&&L(Se),Se.defaultPrevented)return;Se.preventDefault();let De=Se.nativeEvent.submitter,Ye=(De==null?void 0:De.getAttribute("formmethod"))||w;_e(De||Se.currentTarget,{fetcherKey:a,method:Ye,navigate:u,replace:b,state:P,relative:N,preventScrollReset:Z,viewTransition:V})};return te.createElement("form",{ref:q,method:Pe,action:fe,onSubmit:m?L:Me,...ee,"data-discover":!Le&&r==="render"?"true":void 0})});H2.displayName="Form";function K2(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hb(r){let a=te.useContext(qf);return Un(a,K2(r)),a}function X2(r,{target:a,replace:u,state:m,preventScrollReset:b,relative:P,viewTransition:w}={}){let l=Bd(),L=Oo(),N=_m(r,{relative:P});return te.useCallback(Z=>{if(E2(Z,a)){Z.preventDefault();let V=u!==void 0?u:em(L)===em(N);l(r,{replace:V,state:m,preventScrollReset:b,relative:P,viewTransition:w})}},[L,l,N,u,m,a,r,b,P,w])}var Y2=0,Q2=()=>`__${String(++Y2)}__`;function J2(){let{router:r}=hb("useSubmit"),{basename:a}=te.useContext(vl),u=g2();return te.useCallback(async(m,b={})=>{let{action:P,method:w,encType:l,formData:L,body:N}=A2(m,a);if(b.navigate===!1){let Z=b.fetcherKey||Q2();await r.fetch(Z,u,b.action||P,{preventScrollReset:b.preventScrollReset,formData:L,body:N,formMethod:b.method||w,formEncType:b.encType||l,flushSync:b.flushSync})}else await r.navigate(b.action||P,{preventScrollReset:b.preventScrollReset,formData:L,body:N,formMethod:b.method||w,formEncType:b.encType||l,replace:b.replace,state:b.state,fromRouteId:u,flushSync:b.flushSync,viewTransition:b.viewTransition})},[r,a,u])}function eS(r,{relative:a}={}){let{basename:u}=te.useContext(vl),m=te.useContext(Fo);Un(m,"useFormAction must be used inside a RouteContext");let[b]=m.matches.slice(-1),P={..._m(r||".",{relative:a})},w=Oo();if(r==null){P.search=w.search;let l=new URLSearchParams(P.search),L=l.getAll("index");if(L.some(Z=>Z==="")){l.delete("index"),L.filter(V=>V).forEach(V=>l.append("index",V));let Z=l.toString();P.search=Z?`?${Z}`:""}}return(!r||r===".")&&b.route.index&&(P.search=P.search?P.search.replace(/^\?/,"?index&"):"?index"),u!=="/"&&(P.pathname=P.pathname==="/"?u:lu([u,P.pathname])),em(P)}function tS(r,{relative:a}={}){let u=te.useContext(rb);Un(u!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:m}=hb("useViewTransitionState"),b=_m(r,{relative:a});if(!u.isTransitioning)return!1;let P=hu(u.currentLocation.pathname,m)||u.currentLocation.pathname,w=hu(u.nextLocation.pathname,m)||u.nextLocation.pathname;return kg(b.pathname,w)!=null||kg(b.pathname,P)!=null}var Gp=Y0();const rS=(r,a,u,m)=>{var P,w,l,L;const b=[u,{code:a,...m||{}}];if((w=(P=r==null?void 0:r.services)==null?void 0:P.logger)!=null&&w.forward)return r.services.logger.forward(b,"warn","react-i18next::",!0);Ld(b[0])&&(b[0]=`react-i18next:: ${b[0]}`),(L=(l=r==null?void 0:r.services)==null?void 0:l.logger)!=null&&L.warn?r.services.logger.warn(...b):console!=null&&console.warn&&console.warn(...b)},fx={},qy=(r,a,u,m)=>{Ld(u)&&fx[u]||(Ld(u)&&(fx[u]=new Date),rS(r,a,u,m))},db=(r,a)=>()=>{if(r.isInitialized)a();else{const u=()=>{setTimeout(()=>{r.off("initialized",u)},0),a()};r.on("initialized",u)}},Wy=(r,a,u)=>{r.loadNamespaces(a,db(r,u))},px=(r,a,u,m)=>{if(Ld(u)&&(u=[u]),r.options.preload&&r.options.preload.indexOf(a)>-1)return Wy(r,u,m);u.forEach(b=>{r.options.ns.indexOf(b)<0&&r.options.ns.push(b)}),r.loadLanguages(a,db(r,m))},nS=(r,a,u={})=>!a.languages||!a.languages.length?(qy(a,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:a.languages}),!0):a.hasLoadedNamespace(r,{lng:u.lng,precheck:(m,b)=>{if(u.bindI18n&&u.bindI18n.indexOf("languageChanging")>-1&&m.services.backendConnector.backend&&m.isLanguageChangingTo&&!b(m.isLanguageChangingTo,r))return!1}}),Ld=r=>typeof r=="string",iS=r=>typeof r=="object"&&r!==null,sS=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,aS={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},oS=r=>aS[r],lS=r=>r.replace(sS,oS);let Hy={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:lS};const cS=(r={})=>{Hy={...Hy,...r}},uS=()=>Hy;let fb;const hS=r=>{fb=r},dS=()=>fb,fS={type:"3rdParty",init(r){cS(r.options.react),hS(r)}},pS=te.createContext();class mS{constructor(){this.usedNamespaces={}}addUsedNamespaces(a){a.forEach(u=>{this.usedNamespaces[u]||(this.usedNamespaces[u]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const gS=(r,a)=>{const u=te.useRef();return te.useEffect(()=>{u.current=r},[r,a]),u.current},pb=(r,a,u,m)=>r.getFixedT(a,u,m),yS=(r,a,u,m)=>te.useCallback(pb(r,a,u,m),[r,a,u,m]),Ea=(r,a={})=>{var De,Ye,ot,lt;const{i18n:u}=a,{i18n:m,defaultNS:b}=te.useContext(pS)||{},P=u||m||dS();if(P&&!P.reportNamespaces&&(P.reportNamespaces=new mS),!P){qy(P,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const ut=(Ke,At)=>Ld(At)?At:iS(At)&&Ld(At.defaultValue)?At.defaultValue:Array.isArray(Ke)?Ke[Ke.length-1]:Ke,Je=[ut,{},!1];return Je.t=ut,Je.i18n={},Je.ready=!1,Je}(De=P.options.react)!=null&&De.wait&&qy(P,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const w={...uS(),...P.options.react,...a},{useSuspense:l,keyPrefix:L}=w;let N=b||((Ye=P.options)==null?void 0:Ye.defaultNS);N=Ld(N)?[N]:N||["translation"],(lt=(ot=P.reportNamespaces).addUsedNamespaces)==null||lt.call(ot,N);const Z=(P.isInitialized||P.initializedStoreOnce)&&N.every(ut=>nS(ut,P,w)),V=yS(P,a.lng||null,w.nsMode==="fallback"?N:N[0],L),ee=()=>V,q=()=>pb(P,a.lng||null,w.nsMode==="fallback"?N:N[0],L),[_e,fe]=te.useState(ee);let Pe=N.join();a.lng&&(Pe=`${a.lng}${Pe}`);const Le=gS(Pe),Me=te.useRef(!0);te.useEffect(()=>{const{bindI18n:ut,bindI18nStore:Je}=w;Me.current=!0,!Z&&!l&&(a.lng?px(P,a.lng,N,()=>{Me.current&&fe(q)}):Wy(P,N,()=>{Me.current&&fe(q)})),Z&&Le&&Le!==Pe&&Me.current&&fe(q);const Ke=()=>{Me.current&&fe(q)};return ut&&(P==null||P.on(ut,Ke)),Je&&(P==null||P.store.on(Je,Ke)),()=>{Me.current=!1,P&&ut&&(ut==null||ut.split(" ").forEach(At=>P.off(At,Ke))),Je&&P&&Je.split(" ").forEach(At=>P.store.off(At,Ke))}},[P,Pe]),te.useEffect(()=>{Me.current&&Z&&fe(ee)},[P,L,Z]);const Se=[_e,P,Z];if(Se.t=_e,Se.i18n=P,Se.ready=Z,Z||!Z&&!l)return Se;throw new Promise(ut=>{a.lng?px(P,a.lng,N,()=>ut()):Wy(P,N,()=>ut())})},mx=r=>{let a;const u=new Set,m=(N,Z)=>{const V=typeof N=="function"?N(a):N;if(!Object.is(V,a)){const ee=a;a=Z??(typeof V!="object"||V===null)?V:Object.assign({},a,V),u.forEach(q=>q(a,ee))}},b=()=>a,l={setState:m,getState:b,getInitialState:()=>L,subscribe:N=>(u.add(N),()=>u.delete(N))},L=a=r(m,b,l);return l},_S=(r=>r?mx(r):mx),vS=r=>r;function xS(r,a=vS){const u=hn.useSyncExternalStore(r.subscribe,hn.useCallback(()=>a(r.getState()),[r,a]),hn.useCallback(()=>a(r.getInitialState()),[r,a]));return hn.useDebugValue(u),u}const gx=r=>{const a=_S(r),u=m=>xS(a,m);return Object.assign(u,a),u},mb=(r=>r?gx(r):gx),Ky=mb(r=>({search:"",setSearch:a=>r({search:a})})),hg="bada_token",cc=mb(r=>({token:typeof window<"u"?window.localStorage.getItem(hg):null,setToken:u=>{u?window.localStorage.setItem(hg,u):window.localStorage.removeItem(hg),r({token:u})},clearToken:()=>{window.localStorage.removeItem(hg),r({token:null})}})),bS=()=>!!cc.getState().token;var $d=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},wS={setTimeout:(r,a)=>setTimeout(r,a),clearTimeout:r=>clearTimeout(r),setInterval:(r,a)=>setInterval(r,a),clearInterval:r=>clearInterval(r)},ih,A_,N0,SS=(N0=class{constructor(){Wt(this,ih,wS);Wt(this,A_,!1)}setTimeoutProvider(r){It(this,ih,r)}setTimeout(r,a){return ye(this,ih).setTimeout(r,a)}clearTimeout(r){ye(this,ih).clearTimeout(r)}setInterval(r,a){return ye(this,ih).setInterval(r,a)}clearInterval(r){ye(this,ih).clearInterval(r)}},ih=new WeakMap,A_=new WeakMap,N0),Td=new SS;function TS(r){setTimeout(r,0)}var Fd=typeof window>"u"||"Deno"in globalThis;function js(){}function PS(r,a){return typeof r=="function"?r(a):r}function Xy(r){return typeof r=="number"&&r>=0&&r!==1/0}function gb(r,a){return Math.max(r+(a||0)-Date.now(),0)}function mh(r,a){return typeof r=="function"?r(a):r}function Do(r,a){return typeof r=="function"?r(a):r}function yx(r,a){const{type:u="all",exact:m,fetchStatus:b,predicate:P,queryKey:w,stale:l}=r;if(w){if(m){if(a.queryHash!==$_(w,a.options))return!1}else if(!tm(a.queryKey,w))return!1}if(u!=="all"){const L=a.isActive();if(u==="active"&&!L||u==="inactive"&&L)return!1}return!(typeof l=="boolean"&&a.isStale()!==l||b&&b!==a.state.fetchStatus||P&&!P(a))}function _x(r,a){const{exact:u,status:m,predicate:b,mutationKey:P}=r;if(P){if(!a.options.mutationKey)return!1;if(u){if(Od(a.options.mutationKey)!==Od(P))return!1}else if(!tm(a.options.mutationKey,P))return!1}return!(m&&a.state.status!==m||b&&!b(a))}function $_(r,a){return((a==null?void 0:a.queryKeyHashFn)||Od)(r)}function Od(r){return JSON.stringify(r,(a,u)=>Yy(u)?Object.keys(u).sort().reduce((m,b)=>(m[b]=u[b],m),{}):u)}function tm(r,a){return r===a?!0:typeof r!=typeof a?!1:r&&a&&typeof r=="object"&&typeof a=="object"?Object.keys(a).every(u=>tm(r[u],a[u])):!1}var CS=Object.prototype.hasOwnProperty;function U_(r,a){if(r===a)return r;const u=vx(r)&&vx(a);if(!u&&!(Yy(r)&&Yy(a)))return a;const b=(u?r:Object.keys(r)).length,P=u?a:Object.keys(a),w=P.length,l=u?new Array(w):{};let L=0;for(let N=0;N<w;N++){const Z=u?N:P[N],V=r[Z],ee=a[Z];if(V===ee){l[Z]=V,(u?N<b:CS.call(r,Z))&&L++;continue}if(V===null||ee===null||typeof V!="object"||typeof ee!="object"){l[Z]=ee;continue}const q=U_(V,ee);l[Z]=q,q===V&&L++}return b===w&&L===b?r:l}function rm(r,a){if(!a||Object.keys(r).length!==Object.keys(a).length)return!1;for(const u in r)if(r[u]!==a[u])return!1;return!0}function vx(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Yy(r){if(!xx(r))return!1;const a=r.constructor;if(a===void 0)return!0;const u=a.prototype;return!(!xx(u)||!u.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function xx(r){return Object.prototype.toString.call(r)==="[object Object]"}function kS(r){return new Promise(a=>{Td.setTimeout(a,r)})}function Qy(r,a,u){return typeof u.structuralSharing=="function"?u.structuralSharing(r,a):u.structuralSharing!==!1?U_(r,a):a}function ES(r,a,u=0){const m=[...r,a];return u&&m.length>u?m.slice(1):m}function IS(r,a,u=0){const m=[a,...r];return u&&m.length>u?m.slice(0,-1):m}var V_=Symbol();function yb(r,a){return!r.queryFn&&(a!=null&&a.initialPromise)?()=>a.initialPromise:!r.queryFn||r.queryFn===V_?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function _b(r,a){return typeof r=="function"?r(...a):!!r}var Cd,sh,Mf,B0,MS=(B0=class extends $d{constructor(){super();Wt(this,Cd);Wt(this,sh);Wt(this,Mf);It(this,Mf,a=>{if(!Fd&&window.addEventListener){const u=()=>a();return window.addEventListener("visibilitychange",u,!1),()=>{window.removeEventListener("visibilitychange",u)}}})}onSubscribe(){ye(this,sh)||this.setEventListener(ye(this,Mf))}onUnsubscribe(){var a;this.hasListeners()||((a=ye(this,sh))==null||a.call(this),It(this,sh,void 0))}setEventListener(a){var u;It(this,Mf,a),(u=ye(this,sh))==null||u.call(this),It(this,sh,a(m=>{typeof m=="boolean"?this.setFocused(m):this.onFocus()}))}setFocused(a){ye(this,Cd)!==a&&(It(this,Cd,a),this.onFocus())}onFocus(){const a=this.isFocused();this.listeners.forEach(u=>{u(a)})}isFocused(){var a;return typeof ye(this,Cd)=="boolean"?ye(this,Cd):((a=globalThis.document)==null?void 0:a.visibilityState)!=="hidden"}},Cd=new WeakMap,sh=new WeakMap,Mf=new WeakMap,B0),Z_=new MS;function Jy(){let r,a;const u=new Promise((b,P)=>{r=b,a=P});u.status="pending",u.catch(()=>{});function m(b){Object.assign(u,b),delete u.resolve,delete u.reject}return u.resolve=b=>{m({status:"fulfilled",value:b}),r(b)},u.reject=b=>{m({status:"rejected",reason:b}),a(b)},u}var AS=TS;function RS(){let r=[],a=0,u=l=>{l()},m=l=>{l()},b=AS;const P=l=>{a?r.push(l):b(()=>{u(l)})},w=()=>{const l=r;r=[],l.length&&b(()=>{m(()=>{l.forEach(L=>{u(L)})})})};return{batch:l=>{let L;a++;try{L=l()}finally{a--,a||w()}return L},batchCalls:l=>(...L)=>{P(()=>{l(...L)})},schedule:P,setNotifyFunction:l=>{u=l},setBatchNotifyFunction:l=>{m=l},setScheduler:l=>{b=l}}}var li=RS(),Af,ah,Rf,$0,zS=($0=class extends $d{constructor(){super();Wt(this,Af,!0);Wt(this,ah);Wt(this,Rf);It(this,Rf,a=>{if(!Fd&&window.addEventListener){const u=()=>a(!0),m=()=>a(!1);return window.addEventListener("online",u,!1),window.addEventListener("offline",m,!1),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",m)}}})}onSubscribe(){ye(this,ah)||this.setEventListener(ye(this,Rf))}onUnsubscribe(){var a;this.hasListeners()||((a=ye(this,ah))==null||a.call(this),It(this,ah,void 0))}setEventListener(a){var u;It(this,Rf,a),(u=ye(this,ah))==null||u.call(this),It(this,ah,a(this.setOnline.bind(this)))}setOnline(a){ye(this,Af)!==a&&(It(this,Af,a),this.listeners.forEach(m=>{m(a)}))}isOnline(){return ye(this,Af)}},Af=new WeakMap,ah=new WeakMap,Rf=new WeakMap,$0),Eg=new zS;function DS(r){return Math.min(1e3*2**r,3e4)}function vb(r){return(r??"online")==="online"?Eg.isOnline():!0}var e_=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function xb(r){let a=!1,u=0,m;const b=Jy(),P=()=>b.status!=="pending",w=fe=>{var Pe;if(!P()){const Le=new e_(fe);ee(Le),(Pe=r.onCancel)==null||Pe.call(r,Le)}},l=()=>{a=!0},L=()=>{a=!1},N=()=>Z_.isFocused()&&(r.networkMode==="always"||Eg.isOnline())&&r.canRun(),Z=()=>vb(r.networkMode)&&r.canRun(),V=fe=>{P()||(m==null||m(),b.resolve(fe))},ee=fe=>{P()||(m==null||m(),b.reject(fe))},q=()=>new Promise(fe=>{var Pe;m=Le=>{(P()||N())&&fe(Le)},(Pe=r.onPause)==null||Pe.call(r)}).then(()=>{var fe;m=void 0,P()||(fe=r.onContinue)==null||fe.call(r)}),_e=()=>{if(P())return;let fe;const Pe=u===0?r.initialPromise:void 0;try{fe=Pe??r.fn()}catch(Le){fe=Promise.reject(Le)}Promise.resolve(fe).then(V).catch(Le=>{var ot;if(P())return;const Me=r.retry??(Fd?0:3),Se=r.retryDelay??DS,De=typeof Se=="function"?Se(u,Le):Se,Ye=Me===!0||typeof Me=="number"&&u<Me||typeof Me=="function"&&Me(u,Le);if(a||!Ye){ee(Le);return}u++,(ot=r.onFail)==null||ot.call(r,u,Le),kS(De).then(()=>N()?void 0:q()).then(()=>{a?ee(Le):_e()})})};return{promise:b,status:()=>b.status,cancel:w,continue:()=>(m==null||m(),b),cancelRetry:l,continueRetry:L,canStart:Z,start:()=>(Z()?_e():q().then(_e),b)}}var kd,U0,bb=(U0=class{constructor(){Wt(this,kd)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Xy(this.gcTime)&&It(this,kd,Td.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Fd?1/0:300*1e3))}clearGcTimeout(){ye(this,kd)&&(Td.clearTimeout(ye(this,kd)),It(this,kd,void 0))}},kd=new WeakMap,U0),Ed,zf,Ro,Id,cs,um,Md,fl,iu,V0,LS=(V0=class extends bb{constructor(a){super();Wt(this,fl);Wt(this,Ed);Wt(this,zf);Wt(this,Ro);Wt(this,Id);Wt(this,cs);Wt(this,um);Wt(this,Md);It(this,Md,!1),It(this,um,a.defaultOptions),this.setOptions(a.options),this.observers=[],It(this,Id,a.client),It(this,Ro,ye(this,Id).getQueryCache()),this.queryKey=a.queryKey,this.queryHash=a.queryHash,It(this,Ed,bx(this.options)),this.state=a.state??ye(this,Ed),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var a;return(a=ye(this,cs))==null?void 0:a.promise}setOptions(a){if(this.options={...ye(this,um),...a},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const u=bx(this.options);u.data!==void 0&&(this.setData(u.data,{updatedAt:u.dataUpdatedAt,manual:!0}),It(this,Ed,u))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ye(this,Ro).remove(this)}setData(a,u){const m=Qy(this.state.data,a,this.options);return wr(this,fl,iu).call(this,{data:m,type:"success",dataUpdatedAt:u==null?void 0:u.updatedAt,manual:u==null?void 0:u.manual}),m}setState(a,u){wr(this,fl,iu).call(this,{type:"setState",state:a,setStateOptions:u})}cancel(a){var m,b;const u=(m=ye(this,cs))==null?void 0:m.promise;return(b=ye(this,cs))==null||b.cancel(a),u?u.then(js).catch(js):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ye(this,Ed))}isActive(){return this.observers.some(a=>Do(a.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===V_||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(a=>mh(a.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(a=>a.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(a=0){return this.state.data===void 0?!0:a==="static"?!1:this.state.isInvalidated?!0:!gb(this.state.dataUpdatedAt,a)}onFocus(){var u;const a=this.observers.find(m=>m.shouldFetchOnWindowFocus());a==null||a.refetch({cancelRefetch:!1}),(u=ye(this,cs))==null||u.continue()}onOnline(){var u;const a=this.observers.find(m=>m.shouldFetchOnReconnect());a==null||a.refetch({cancelRefetch:!1}),(u=ye(this,cs))==null||u.continue()}addObserver(a){this.observers.includes(a)||(this.observers.push(a),this.clearGcTimeout(),ye(this,Ro).notify({type:"observerAdded",query:this,observer:a}))}removeObserver(a){this.observers.includes(a)&&(this.observers=this.observers.filter(u=>u!==a),this.observers.length||(ye(this,cs)&&(ye(this,Md)?ye(this,cs).cancel({revert:!0}):ye(this,cs).cancelRetry()),this.scheduleGc()),ye(this,Ro).notify({type:"observerRemoved",query:this,observer:a}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||wr(this,fl,iu).call(this,{type:"invalidate"})}async fetch(a,u){var L,N,Z,V,ee,q,_e,fe,Pe,Le,Me,Se;if(this.state.fetchStatus!=="idle"&&((L=ye(this,cs))==null?void 0:L.status())!=="rejected"){if(this.state.data!==void 0&&(u!=null&&u.cancelRefetch))this.cancel({silent:!0});else if(ye(this,cs))return ye(this,cs).continueRetry(),ye(this,cs).promise}if(a&&this.setOptions(a),!this.options.queryFn){const De=this.observers.find(Ye=>Ye.options.queryFn);De&&this.setOptions(De.options)}const m=new AbortController,b=De=>{Object.defineProperty(De,"signal",{enumerable:!0,get:()=>(It(this,Md,!0),m.signal)})},P=()=>{const De=yb(this.options,u),ot=(()=>{const lt={client:ye(this,Id),queryKey:this.queryKey,meta:this.meta};return b(lt),lt})();return It(this,Md,!1),this.options.persister?this.options.persister(De,ot,this):De(ot)},l=(()=>{const De={fetchOptions:u,options:this.options,queryKey:this.queryKey,client:ye(this,Id),state:this.state,fetchFn:P};return b(De),De})();(N=this.options.behavior)==null||N.onFetch(l,this),It(this,zf,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((Z=l.fetchOptions)==null?void 0:Z.meta))&&wr(this,fl,iu).call(this,{type:"fetch",meta:(V=l.fetchOptions)==null?void 0:V.meta}),It(this,cs,xb({initialPromise:u==null?void 0:u.initialPromise,fn:l.fetchFn,onCancel:De=>{De instanceof e_&&De.revert&&this.setState({...ye(this,zf),fetchStatus:"idle"}),m.abort()},onFail:(De,Ye)=>{wr(this,fl,iu).call(this,{type:"failed",failureCount:De,error:Ye})},onPause:()=>{wr(this,fl,iu).call(this,{type:"pause"})},onContinue:()=>{wr(this,fl,iu).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const De=await ye(this,cs).start();if(De===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(De),(q=(ee=ye(this,Ro).config).onSuccess)==null||q.call(ee,De,this),(fe=(_e=ye(this,Ro).config).onSettled)==null||fe.call(_e,De,this.state.error,this),De}catch(De){if(De instanceof e_){if(De.silent)return ye(this,cs).promise;if(De.revert){if(this.state.data===void 0)throw De;return this.state.data}}throw wr(this,fl,iu).call(this,{type:"error",error:De}),(Le=(Pe=ye(this,Ro).config).onError)==null||Le.call(Pe,De,this),(Se=(Me=ye(this,Ro).config).onSettled)==null||Se.call(Me,this.state.data,De,this),De}finally{this.scheduleGc()}}},Ed=new WeakMap,zf=new WeakMap,Ro=new WeakMap,Id=new WeakMap,cs=new WeakMap,um=new WeakMap,Md=new WeakMap,fl=new WeakSet,iu=function(a){const u=m=>{switch(a.type){case"failed":return{...m,fetchFailureCount:a.failureCount,fetchFailureReason:a.error};case"pause":return{...m,fetchStatus:"paused"};case"continue":return{...m,fetchStatus:"fetching"};case"fetch":return{...m,...wb(m.data,this.options),fetchMeta:a.meta??null};case"success":const b={...m,data:a.data,dataUpdateCount:m.dataUpdateCount+1,dataUpdatedAt:a.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!a.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return It(this,zf,a.manual?b:void 0),b;case"error":const P=a.error;return{...m,error:P,errorUpdateCount:m.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:m.fetchFailureCount+1,fetchFailureReason:P,fetchStatus:"idle",status:"error"};case"invalidate":return{...m,isInvalidated:!0};case"setState":return{...m,...a.state}}};this.state=u(this.state),li.batch(()=>{this.observers.forEach(m=>{m.onQueryUpdate()}),ye(this,Ro).notify({query:this,type:"updated",action:a})})},V0);function wb(r,a){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:vb(a.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function bx(r){const a=typeof r.initialData=="function"?r.initialData():r.initialData,u=a!==void 0,m=u?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:a,dataUpdateCount:0,dataUpdatedAt:u?m??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:u?"success":"pending",fetchStatus:"idle"}}var Pa,Jr,hm,ia,Ad,Df,su,oh,dm,Lf,Ff,Rd,zd,lh,Of,yn,qp,t_,r_,n_,i_,s_,a_,o_,Sb,Z0,G_=(Z0=class extends $d{constructor(a,u){super();Wt(this,yn);Wt(this,Pa);Wt(this,Jr);Wt(this,hm);Wt(this,ia);Wt(this,Ad);Wt(this,Df);Wt(this,su);Wt(this,oh);Wt(this,dm);Wt(this,Lf);Wt(this,Ff);Wt(this,Rd);Wt(this,zd);Wt(this,lh);Wt(this,Of,new Set);this.options=u,It(this,Pa,a),It(this,oh,null),It(this,su,Jy()),this.bindMethods(),this.setOptions(u)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ye(this,Jr).addObserver(this),wx(ye(this,Jr),this.options)?wr(this,yn,qp).call(this):this.updateResult(),wr(this,yn,i_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return l_(ye(this,Jr),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return l_(ye(this,Jr),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,wr(this,yn,s_).call(this),wr(this,yn,a_).call(this),ye(this,Jr).removeObserver(this)}setOptions(a){const u=this.options,m=ye(this,Jr);if(this.options=ye(this,Pa).defaultQueryOptions(a),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Do(this.options.enabled,ye(this,Jr))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");wr(this,yn,o_).call(this),ye(this,Jr).setOptions(this.options),u._defaulted&&!rm(this.options,u)&&ye(this,Pa).getQueryCache().notify({type:"observerOptionsUpdated",query:ye(this,Jr),observer:this});const b=this.hasListeners();b&&Sx(ye(this,Jr),m,this.options,u)&&wr(this,yn,qp).call(this),this.updateResult(),b&&(ye(this,Jr)!==m||Do(this.options.enabled,ye(this,Jr))!==Do(u.enabled,ye(this,Jr))||mh(this.options.staleTime,ye(this,Jr))!==mh(u.staleTime,ye(this,Jr)))&&wr(this,yn,t_).call(this);const P=wr(this,yn,r_).call(this);b&&(ye(this,Jr)!==m||Do(this.options.enabled,ye(this,Jr))!==Do(u.enabled,ye(this,Jr))||P!==ye(this,lh))&&wr(this,yn,n_).call(this,P)}getOptimisticResult(a){const u=ye(this,Pa).getQueryCache().build(ye(this,Pa),a),m=this.createResult(u,a);return OS(this,m)&&(It(this,ia,m),It(this,Df,this.options),It(this,Ad,ye(this,Jr).state)),m}getCurrentResult(){return ye(this,ia)}trackResult(a,u){return new Proxy(a,{get:(m,b)=>(this.trackProp(b),u==null||u(b),b==="promise"&&!this.options.experimental_prefetchInRender&&ye(this,su).status==="pending"&&ye(this,su).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(m,b))})}trackProp(a){ye(this,Of).add(a)}getCurrentQuery(){return ye(this,Jr)}refetch({...a}={}){return this.fetch({...a})}fetchOptimistic(a){const u=ye(this,Pa).defaultQueryOptions(a),m=ye(this,Pa).getQueryCache().build(ye(this,Pa),u);return m.fetch().then(()=>this.createResult(m,u))}fetch(a){return wr(this,yn,qp).call(this,{...a,cancelRefetch:a.cancelRefetch??!0}).then(()=>(this.updateResult(),ye(this,ia)))}createResult(a,u){var Je;const m=ye(this,Jr),b=this.options,P=ye(this,ia),w=ye(this,Ad),l=ye(this,Df),N=a!==m?a.state:ye(this,hm),{state:Z}=a;let V={...Z},ee=!1,q;if(u._optimisticResults){const Ke=this.hasListeners(),At=!Ke&&wx(a,u),Rt=Ke&&Sx(a,m,u,b);(At||Rt)&&(V={...V,...wb(Z.data,a.options)}),u._optimisticResults==="isRestoring"&&(V.fetchStatus="idle")}let{error:_e,errorUpdatedAt:fe,status:Pe}=V;q=V.data;let Le=!1;if(u.placeholderData!==void 0&&q===void 0&&Pe==="pending"){let Ke;P!=null&&P.isPlaceholderData&&u.placeholderData===(l==null?void 0:l.placeholderData)?(Ke=P.data,Le=!0):Ke=typeof u.placeholderData=="function"?u.placeholderData((Je=ye(this,Ff))==null?void 0:Je.state.data,ye(this,Ff)):u.placeholderData,Ke!==void 0&&(Pe="success",q=Qy(P==null?void 0:P.data,Ke,u),ee=!0)}if(u.select&&q!==void 0&&!Le)if(P&&q===(w==null?void 0:w.data)&&u.select===ye(this,dm))q=ye(this,Lf);else try{It(this,dm,u.select),q=u.select(q),q=Qy(P==null?void 0:P.data,q,u),It(this,Lf,q),It(this,oh,null)}catch(Ke){It(this,oh,Ke)}ye(this,oh)&&(_e=ye(this,oh),q=ye(this,Lf),fe=Date.now(),Pe="error");const Me=V.fetchStatus==="fetching",Se=Pe==="pending",De=Pe==="error",Ye=Se&&Me,ot=q!==void 0,ut={status:Pe,fetchStatus:V.fetchStatus,isPending:Se,isSuccess:Pe==="success",isError:De,isInitialLoading:Ye,isLoading:Ye,data:q,dataUpdatedAt:V.dataUpdatedAt,error:_e,errorUpdatedAt:fe,failureCount:V.fetchFailureCount,failureReason:V.fetchFailureReason,errorUpdateCount:V.errorUpdateCount,isFetched:V.dataUpdateCount>0||V.errorUpdateCount>0,isFetchedAfterMount:V.dataUpdateCount>N.dataUpdateCount||V.errorUpdateCount>N.errorUpdateCount,isFetching:Me,isRefetching:Me&&!Se,isLoadingError:De&&!ot,isPaused:V.fetchStatus==="paused",isPlaceholderData:ee,isRefetchError:De&&ot,isStale:q_(a,u),refetch:this.refetch,promise:ye(this,su),isEnabled:Do(u.enabled,a)!==!1};if(this.options.experimental_prefetchInRender){const Ke=Mt=>{ut.status==="error"?Mt.reject(ut.error):ut.data!==void 0&&Mt.resolve(ut.data)},At=()=>{const Mt=It(this,su,ut.promise=Jy());Ke(Mt)},Rt=ye(this,su);switch(Rt.status){case"pending":a.queryHash===m.queryHash&&Ke(Rt);break;case"fulfilled":(ut.status==="error"||ut.data!==Rt.value)&&At();break;case"rejected":(ut.status!=="error"||ut.error!==Rt.reason)&&At();break}}return ut}updateResult(){const a=ye(this,ia),u=this.createResult(ye(this,Jr),this.options);if(It(this,Ad,ye(this,Jr).state),It(this,Df,this.options),ye(this,Ad).data!==void 0&&It(this,Ff,ye(this,Jr)),rm(u,a))return;It(this,ia,u);const m=()=>{if(!a)return!0;const{notifyOnChangeProps:b}=this.options,P=typeof b=="function"?b():b;if(P==="all"||!P&&!ye(this,Of).size)return!0;const w=new Set(P??ye(this,Of));return this.options.throwOnError&&w.add("error"),Object.keys(ye(this,ia)).some(l=>{const L=l;return ye(this,ia)[L]!==a[L]&&w.has(L)})};wr(this,yn,Sb).call(this,{listeners:m()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&wr(this,yn,i_).call(this)}},Pa=new WeakMap,Jr=new WeakMap,hm=new WeakMap,ia=new WeakMap,Ad=new WeakMap,Df=new WeakMap,su=new WeakMap,oh=new WeakMap,dm=new WeakMap,Lf=new WeakMap,Ff=new WeakMap,Rd=new WeakMap,zd=new WeakMap,lh=new WeakMap,Of=new WeakMap,yn=new WeakSet,qp=function(a){wr(this,yn,o_).call(this);let u=ye(this,Jr).fetch(this.options,a);return a!=null&&a.throwOnError||(u=u.catch(js)),u},t_=function(){wr(this,yn,s_).call(this);const a=mh(this.options.staleTime,ye(this,Jr));if(Fd||ye(this,ia).isStale||!Xy(a))return;const m=gb(ye(this,ia).dataUpdatedAt,a)+1;It(this,Rd,Td.setTimeout(()=>{ye(this,ia).isStale||this.updateResult()},m))},r_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ye(this,Jr)):this.options.refetchInterval)??!1},n_=function(a){wr(this,yn,a_).call(this),It(this,lh,a),!(Fd||Do(this.options.enabled,ye(this,Jr))===!1||!Xy(ye(this,lh))||ye(this,lh)===0)&&It(this,zd,Td.setInterval(()=>{(this.options.refetchIntervalInBackground||Z_.isFocused())&&wr(this,yn,qp).call(this)},ye(this,lh)))},i_=function(){wr(this,yn,t_).call(this),wr(this,yn,n_).call(this,wr(this,yn,r_).call(this))},s_=function(){ye(this,Rd)&&(Td.clearTimeout(ye(this,Rd)),It(this,Rd,void 0))},a_=function(){ye(this,zd)&&(Td.clearInterval(ye(this,zd)),It(this,zd,void 0))},o_=function(){const a=ye(this,Pa).getQueryCache().build(ye(this,Pa),this.options);if(a===ye(this,Jr))return;const u=ye(this,Jr);It(this,Jr,a),It(this,hm,a.state),this.hasListeners()&&(u==null||u.removeObserver(this),a.addObserver(this))},Sb=function(a){li.batch(()=>{a.listeners&&this.listeners.forEach(u=>{u(ye(this,ia))}),ye(this,Pa).getQueryCache().notify({query:ye(this,Jr),type:"observerResultsUpdated"})})},Z0);function FS(r,a){return Do(a.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&a.retryOnMount===!1)}function wx(r,a){return FS(r,a)||r.state.data!==void 0&&l_(r,a,a.refetchOnMount)}function l_(r,a,u){if(Do(a.enabled,r)!==!1&&mh(a.staleTime,r)!=="static"){const m=typeof u=="function"?u(r):u;return m==="always"||m!==!1&&q_(r,a)}return!1}function Sx(r,a,u,m){return(r!==a||Do(m.enabled,r)===!1)&&(!u.suspense||r.state.status!=="error")&&q_(r,u)}function q_(r,a){return Do(a.enabled,r)!==!1&&r.isStaleByTime(mh(a.staleTime,r))}function OS(r,a){return!rm(r.getCurrentResult(),a)}function Tx(r){return{onFetch:(a,u)=>{var Z,V,ee,q,_e;const m=a.options,b=(ee=(V=(Z=a.fetchOptions)==null?void 0:Z.meta)==null?void 0:V.fetchMore)==null?void 0:ee.direction,P=((q=a.state.data)==null?void 0:q.pages)||[],w=((_e=a.state.data)==null?void 0:_e.pageParams)||[];let l={pages:[],pageParams:[]},L=0;const N=async()=>{let fe=!1;const Pe=Se=>{Object.defineProperty(Se,"signal",{enumerable:!0,get:()=>(a.signal.aborted?fe=!0:a.signal.addEventListener("abort",()=>{fe=!0}),a.signal)})},Le=yb(a.options,a.fetchOptions),Me=async(Se,De,Ye)=>{if(fe)return Promise.reject();if(De==null&&Se.pages.length)return Promise.resolve(Se);const lt=(()=>{const At={client:a.client,queryKey:a.queryKey,pageParam:De,direction:Ye?"backward":"forward",meta:a.options.meta};return Pe(At),At})(),ut=await Le(lt),{maxPages:Je}=a.options,Ke=Ye?IS:ES;return{pages:Ke(Se.pages,ut,Je),pageParams:Ke(Se.pageParams,De,Je)}};if(b&&P.length){const Se=b==="backward",De=Se?jS:Px,Ye={pages:P,pageParams:w},ot=De(m,Ye);l=await Me(Ye,ot,Se)}else{const Se=r??P.length;do{const De=L===0?w[0]??m.initialPageParam:Px(m,l);if(L>0&&De==null)break;l=await Me(l,De),L++}while(L<Se)}return l};a.options.persister?a.fetchFn=()=>{var fe,Pe;return(Pe=(fe=a.options).persister)==null?void 0:Pe.call(fe,N,{client:a.client,queryKey:a.queryKey,meta:a.options.meta,signal:a.signal},u)}:a.fetchFn=N}}}function Px(r,{pages:a,pageParams:u}){const m=a.length-1;return a.length>0?r.getNextPageParam(a[m],a,u[m],u):void 0}function jS(r,{pages:a,pageParams:u}){var m;return a.length>0?(m=r.getPreviousPageParam)==null?void 0:m.call(r,a[0],a,u[0],u):void 0}var nc,sa,Dd,ic,eh,G0,NS=(G0=class extends bb{constructor(a){super();Wt(this,ic);Wt(this,nc);Wt(this,sa);Wt(this,Dd);this.mutationId=a.mutationId,It(this,sa,a.mutationCache),It(this,nc,[]),this.state=a.state||Tb(),this.setOptions(a.options),this.scheduleGc()}setOptions(a){this.options=a,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(a){ye(this,nc).includes(a)||(ye(this,nc).push(a),this.clearGcTimeout(),ye(this,sa).notify({type:"observerAdded",mutation:this,observer:a}))}removeObserver(a){It(this,nc,ye(this,nc).filter(u=>u!==a)),this.scheduleGc(),ye(this,sa).notify({type:"observerRemoved",mutation:this,observer:a})}optionalRemove(){ye(this,nc).length||(this.state.status==="pending"?this.scheduleGc():ye(this,sa).remove(this))}continue(){var a;return((a=ye(this,Dd))==null?void 0:a.continue())??this.execute(this.state.variables)}async execute(a){var P,w,l,L,N,Z,V,ee,q,_e,fe,Pe,Le,Me,Se,De,Ye,ot,lt,ut;const u=()=>{wr(this,ic,eh).call(this,{type:"continue"})};It(this,Dd,xb({fn:()=>this.options.mutationFn?this.options.mutationFn(a):Promise.reject(new Error("No mutationFn found")),onFail:(Je,Ke)=>{wr(this,ic,eh).call(this,{type:"failed",failureCount:Je,error:Ke})},onPause:()=>{wr(this,ic,eh).call(this,{type:"pause"})},onContinue:u,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ye(this,sa).canRun(this)}));const m=this.state.status==="pending",b=!ye(this,Dd).canStart();try{if(m)u();else{wr(this,ic,eh).call(this,{type:"pending",variables:a,isPaused:b}),await((w=(P=ye(this,sa).config).onMutate)==null?void 0:w.call(P,a,this));const Ke=await((L=(l=this.options).onMutate)==null?void 0:L.call(l,a));Ke!==this.state.context&&wr(this,ic,eh).call(this,{type:"pending",context:Ke,variables:a,isPaused:b})}const Je=await ye(this,Dd).start();return await((Z=(N=ye(this,sa).config).onSuccess)==null?void 0:Z.call(N,Je,a,this.state.context,this)),await((ee=(V=this.options).onSuccess)==null?void 0:ee.call(V,Je,a,this.state.context)),await((_e=(q=ye(this,sa).config).onSettled)==null?void 0:_e.call(q,Je,null,this.state.variables,this.state.context,this)),await((Pe=(fe=this.options).onSettled)==null?void 0:Pe.call(fe,Je,null,a,this.state.context)),wr(this,ic,eh).call(this,{type:"success",data:Je}),Je}catch(Je){try{throw await((Me=(Le=ye(this,sa).config).onError)==null?void 0:Me.call(Le,Je,a,this.state.context,this)),await((De=(Se=this.options).onError)==null?void 0:De.call(Se,Je,a,this.state.context)),await((ot=(Ye=ye(this,sa).config).onSettled)==null?void 0:ot.call(Ye,void 0,Je,this.state.variables,this.state.context,this)),await((ut=(lt=this.options).onSettled)==null?void 0:ut.call(lt,void 0,Je,a,this.state.context)),Je}finally{wr(this,ic,eh).call(this,{type:"error",error:Je})}}finally{ye(this,sa).runNext(this)}}},nc=new WeakMap,sa=new WeakMap,Dd=new WeakMap,ic=new WeakSet,eh=function(a){const u=m=>{switch(a.type){case"failed":return{...m,failureCount:a.failureCount,failureReason:a.error};case"pause":return{...m,isPaused:!0};case"continue":return{...m,isPaused:!1};case"pending":return{...m,context:a.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:a.isPaused,status:"pending",variables:a.variables,submittedAt:Date.now()};case"success":return{...m,data:a.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...m,data:void 0,error:a.error,failureCount:m.failureCount+1,failureReason:a.error,isPaused:!1,status:"error"}}};this.state=u(this.state),li.batch(()=>{ye(this,nc).forEach(m=>{m.onMutationUpdate(a)}),ye(this,sa).notify({mutation:this,type:"updated",action:a})})},G0);function Tb(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var au,pl,fm,q0,BS=(q0=class extends $d{constructor(a={}){super();Wt(this,au);Wt(this,pl);Wt(this,fm);this.config=a,It(this,au,new Set),It(this,pl,new Map),It(this,fm,0)}build(a,u,m){const b=new NS({mutationCache:this,mutationId:++lg(this,fm)._,options:a.defaultMutationOptions(u),state:m});return this.add(b),b}add(a){ye(this,au).add(a);const u=dg(a);if(typeof u=="string"){const m=ye(this,pl).get(u);m?m.push(a):ye(this,pl).set(u,[a])}this.notify({type:"added",mutation:a})}remove(a){if(ye(this,au).delete(a)){const u=dg(a);if(typeof u=="string"){const m=ye(this,pl).get(u);if(m)if(m.length>1){const b=m.indexOf(a);b!==-1&&m.splice(b,1)}else m[0]===a&&ye(this,pl).delete(u)}}this.notify({type:"removed",mutation:a})}canRun(a){const u=dg(a);if(typeof u=="string"){const m=ye(this,pl).get(u),b=m==null?void 0:m.find(P=>P.state.status==="pending");return!b||b===a}else return!0}runNext(a){var m;const u=dg(a);if(typeof u=="string"){const b=(m=ye(this,pl).get(u))==null?void 0:m.find(P=>P!==a&&P.state.isPaused);return(b==null?void 0:b.continue())??Promise.resolve()}else return Promise.resolve()}clear(){li.batch(()=>{ye(this,au).forEach(a=>{this.notify({type:"removed",mutation:a})}),ye(this,au).clear(),ye(this,pl).clear()})}getAll(){return Array.from(ye(this,au))}find(a){const u={exact:!0,...a};return this.getAll().find(m=>_x(u,m))}findAll(a={}){return this.getAll().filter(u=>_x(a,u))}notify(a){li.batch(()=>{this.listeners.forEach(u=>{u(a)})})}resumePausedMutations(){const a=this.getAll().filter(u=>u.state.isPaused);return li.batch(()=>Promise.all(a.map(u=>u.continue().catch(js))))}},au=new WeakMap,pl=new WeakMap,fm=new WeakMap,q0);function dg(r){var a;return(a=r.options.scope)==null?void 0:a.id}var ch,uh,Ca,ou,uu,Sg,c_,W0,$S=(W0=class extends $d{constructor(u,m){super();Wt(this,uu);Wt(this,ch);Wt(this,uh);Wt(this,Ca);Wt(this,ou);It(this,ch,u),this.setOptions(m),this.bindMethods(),wr(this,uu,Sg).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(u){var b;const m=this.options;this.options=ye(this,ch).defaultMutationOptions(u),rm(this.options,m)||ye(this,ch).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ye(this,Ca),observer:this}),m!=null&&m.mutationKey&&this.options.mutationKey&&Od(m.mutationKey)!==Od(this.options.mutationKey)?this.reset():((b=ye(this,Ca))==null?void 0:b.state.status)==="pending"&&ye(this,Ca).setOptions(this.options)}onUnsubscribe(){var u;this.hasListeners()||(u=ye(this,Ca))==null||u.removeObserver(this)}onMutationUpdate(u){wr(this,uu,Sg).call(this),wr(this,uu,c_).call(this,u)}getCurrentResult(){return ye(this,uh)}reset(){var u;(u=ye(this,Ca))==null||u.removeObserver(this),It(this,Ca,void 0),wr(this,uu,Sg).call(this),wr(this,uu,c_).call(this)}mutate(u,m){var b;return It(this,ou,m),(b=ye(this,Ca))==null||b.removeObserver(this),It(this,Ca,ye(this,ch).getMutationCache().build(ye(this,ch),this.options)),ye(this,Ca).addObserver(this),ye(this,Ca).execute(u)}},ch=new WeakMap,uh=new WeakMap,Ca=new WeakMap,ou=new WeakMap,uu=new WeakSet,Sg=function(){var m;const u=((m=ye(this,Ca))==null?void 0:m.state)??Tb();It(this,uh,{...u,isPending:u.status==="pending",isSuccess:u.status==="success",isError:u.status==="error",isIdle:u.status==="idle",mutate:this.mutate,reset:this.reset})},c_=function(u){li.batch(()=>{var m,b,P,w,l,L,N,Z;if(ye(this,ou)&&this.hasListeners()){const V=ye(this,uh).variables,ee=ye(this,uh).context;(u==null?void 0:u.type)==="success"?((b=(m=ye(this,ou)).onSuccess)==null||b.call(m,u.data,V,ee),(w=(P=ye(this,ou)).onSettled)==null||w.call(P,u.data,null,V,ee)):(u==null?void 0:u.type)==="error"&&((L=(l=ye(this,ou)).onError)==null||L.call(l,u.error,V,ee),(Z=(N=ye(this,ou)).onSettled)==null||Z.call(N,void 0,u.error,V,ee))}this.listeners.forEach(V=>{V(ye(this,uh))})})},W0);function Cx(r,a){const u=new Set(a);return r.filter(m=>!u.has(m))}function US(r,a,u){const m=r.slice(0);return m[a]=u,m}var jf,so,Nf,Bf,zo,hh,pm,mm,gm,Cs,u_,h_,d_,f_,p_,H0,VS=(H0=class extends $d{constructor(a,u,m){super();Wt(this,Cs);Wt(this,jf);Wt(this,so);Wt(this,Nf);Wt(this,Bf);Wt(this,zo);Wt(this,hh);Wt(this,pm);Wt(this,mm);Wt(this,gm,[]);It(this,jf,a),It(this,Bf,m),It(this,Nf,[]),It(this,zo,[]),It(this,so,[]),this.setQueries(u)}onSubscribe(){this.listeners.size===1&&ye(this,zo).forEach(a=>{a.subscribe(u=>{wr(this,Cs,f_).call(this,a,u)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,ye(this,zo).forEach(a=>{a.destroy()})}setQueries(a,u){It(this,Nf,a),It(this,Bf,u),li.batch(()=>{const m=ye(this,zo),b=wr(this,Cs,d_).call(this,ye(this,Nf));It(this,gm,b),b.forEach(V=>V.observer.setOptions(V.defaultedQueryOptions));const P=b.map(V=>V.observer),w=P.map(V=>V.getCurrentResult()),l=m.length!==P.length,L=P.some((V,ee)=>V!==m[ee]),N=l||L,Z=N?!0:w.some((V,ee)=>{const q=ye(this,so)[ee];return!q||!rm(V,q)});!N&&!Z||(N&&It(this,zo,P),It(this,so,w),this.hasListeners()&&(N&&(Cx(m,P).forEach(V=>{V.destroy()}),Cx(P,m).forEach(V=>{V.subscribe(ee=>{wr(this,Cs,f_).call(this,V,ee)})})),wr(this,Cs,p_).call(this)))})}getCurrentResult(){return ye(this,so)}getQueries(){return ye(this,zo).map(a=>a.getCurrentQuery())}getObservers(){return ye(this,zo)}getOptimisticResult(a,u){const m=wr(this,Cs,d_).call(this,a),b=m.map(P=>P.observer.getOptimisticResult(P.defaultedQueryOptions));return[b,P=>wr(this,Cs,h_).call(this,P??b,u),()=>wr(this,Cs,u_).call(this,b,m)]}},jf=new WeakMap,so=new WeakMap,Nf=new WeakMap,Bf=new WeakMap,zo=new WeakMap,hh=new WeakMap,pm=new WeakMap,mm=new WeakMap,gm=new WeakMap,Cs=new WeakSet,u_=function(a,u){return u.map((m,b)=>{const P=a[b];return m.defaultedQueryOptions.notifyOnChangeProps?P:m.observer.trackResult(P,w=>{u.forEach(l=>{l.observer.trackProp(w)})})})},h_=function(a,u){return u?((!ye(this,hh)||ye(this,so)!==ye(this,mm)||u!==ye(this,pm))&&(It(this,pm,u),It(this,mm,ye(this,so)),It(this,hh,U_(ye(this,hh),u(a)))),ye(this,hh)):a},d_=function(a){const u=new Map(ye(this,zo).map(b=>[b.options.queryHash,b])),m=[];return a.forEach(b=>{const P=ye(this,jf).defaultQueryOptions(b),w=u.get(P.queryHash);w?m.push({defaultedQueryOptions:P,observer:w}):m.push({defaultedQueryOptions:P,observer:new G_(ye(this,jf),P)})}),m},f_=function(a,u){const m=ye(this,zo).indexOf(a);m!==-1&&(It(this,so,US(ye(this,so),m,u)),wr(this,Cs,p_).call(this))},p_=function(){var a;if(this.hasListeners()){const u=ye(this,hh),m=wr(this,Cs,u_).call(this,ye(this,so),ye(this,gm)),b=wr(this,Cs,h_).call(this,m,(a=ye(this,Bf))==null?void 0:a.combine);u!==b&&li.batch(()=>{this.listeners.forEach(P=>{P(ye(this,so))})})}},H0),sc,K0,ZS=(K0=class extends $d{constructor(a={}){super();Wt(this,sc);this.config=a,It(this,sc,new Map)}build(a,u,m){const b=u.queryKey,P=u.queryHash??$_(b,u);let w=this.get(P);return w||(w=new LS({client:a,queryKey:b,queryHash:P,options:a.defaultQueryOptions(u),state:m,defaultOptions:a.getQueryDefaults(b)}),this.add(w)),w}add(a){ye(this,sc).has(a.queryHash)||(ye(this,sc).set(a.queryHash,a),this.notify({type:"added",query:a}))}remove(a){const u=ye(this,sc).get(a.queryHash);u&&(a.destroy(),u===a&&ye(this,sc).delete(a.queryHash),this.notify({type:"removed",query:a}))}clear(){li.batch(()=>{this.getAll().forEach(a=>{this.remove(a)})})}get(a){return ye(this,sc).get(a)}getAll(){return[...ye(this,sc).values()]}find(a){const u={exact:!0,...a};return this.getAll().find(m=>yx(u,m))}findAll(a={}){const u=this.getAll();return Object.keys(a).length>0?u.filter(m=>yx(a,m)):u}notify(a){li.batch(()=>{this.listeners.forEach(u=>{u(a)})})}onFocus(){li.batch(()=>{this.getAll().forEach(a=>{a.onFocus()})})}onOnline(){li.batch(()=>{this.getAll().forEach(a=>{a.onOnline()})})}},sc=new WeakMap,K0),oi,dh,fh,$f,Uf,ph,Vf,Zf,X0,GS=(X0=class{constructor(r={}){Wt(this,oi);Wt(this,dh);Wt(this,fh);Wt(this,$f);Wt(this,Uf);Wt(this,ph);Wt(this,Vf);Wt(this,Zf);It(this,oi,r.queryCache||new ZS),It(this,dh,r.mutationCache||new BS),It(this,fh,r.defaultOptions||{}),It(this,$f,new Map),It(this,Uf,new Map),It(this,ph,0)}mount(){lg(this,ph)._++,ye(this,ph)===1&&(It(this,Vf,Z_.subscribe(async r=>{r&&(await this.resumePausedMutations(),ye(this,oi).onFocus())})),It(this,Zf,Eg.subscribe(async r=>{r&&(await this.resumePausedMutations(),ye(this,oi).onOnline())})))}unmount(){var r,a;lg(this,ph)._--,ye(this,ph)===0&&((r=ye(this,Vf))==null||r.call(this),It(this,Vf,void 0),(a=ye(this,Zf))==null||a.call(this),It(this,Zf,void 0))}isFetching(r){return ye(this,oi).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return ye(this,dh).findAll({...r,status:"pending"}).length}getQueryData(r){var u;const a=this.defaultQueryOptions({queryKey:r});return(u=ye(this,oi).get(a.queryHash))==null?void 0:u.state.data}ensureQueryData(r){const a=this.defaultQueryOptions(r),u=ye(this,oi).build(this,a),m=u.state.data;return m===void 0?this.fetchQuery(r):(r.revalidateIfStale&&u.isStaleByTime(mh(a.staleTime,u))&&this.prefetchQuery(a),Promise.resolve(m))}getQueriesData(r){return ye(this,oi).findAll(r).map(({queryKey:a,state:u})=>{const m=u.data;return[a,m]})}setQueryData(r,a,u){const m=this.defaultQueryOptions({queryKey:r}),b=ye(this,oi).get(m.queryHash),P=b==null?void 0:b.state.data,w=PS(a,P);if(w!==void 0)return ye(this,oi).build(this,m).setData(w,{...u,manual:!0})}setQueriesData(r,a,u){return li.batch(()=>ye(this,oi).findAll(r).map(({queryKey:m})=>[m,this.setQueryData(m,a,u)]))}getQueryState(r){var u;const a=this.defaultQueryOptions({queryKey:r});return(u=ye(this,oi).get(a.queryHash))==null?void 0:u.state}removeQueries(r){const a=ye(this,oi);li.batch(()=>{a.findAll(r).forEach(u=>{a.remove(u)})})}resetQueries(r,a){const u=ye(this,oi);return li.batch(()=>(u.findAll(r).forEach(m=>{m.reset()}),this.refetchQueries({type:"active",...r},a)))}cancelQueries(r,a={}){const u={revert:!0,...a},m=li.batch(()=>ye(this,oi).findAll(r).map(b=>b.cancel(u)));return Promise.all(m).then(js).catch(js)}invalidateQueries(r,a={}){return li.batch(()=>(ye(this,oi).findAll(r).forEach(u=>{u.invalidate()}),(r==null?void 0:r.refetchType)==="none"?Promise.resolve():this.refetchQueries({...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"},a)))}refetchQueries(r,a={}){const u={...a,cancelRefetch:a.cancelRefetch??!0},m=li.batch(()=>ye(this,oi).findAll(r).filter(b=>!b.isDisabled()&&!b.isStatic()).map(b=>{let P=b.fetch(void 0,u);return u.throwOnError||(P=P.catch(js)),b.state.fetchStatus==="paused"?Promise.resolve():P}));return Promise.all(m).then(js)}fetchQuery(r){const a=this.defaultQueryOptions(r);a.retry===void 0&&(a.retry=!1);const u=ye(this,oi).build(this,a);return u.isStaleByTime(mh(a.staleTime,u))?u.fetch(a):Promise.resolve(u.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(js).catch(js)}fetchInfiniteQuery(r){return r.behavior=Tx(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(js).catch(js)}ensureInfiniteQueryData(r){return r.behavior=Tx(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Eg.isOnline()?ye(this,dh).resumePausedMutations():Promise.resolve()}getQueryCache(){return ye(this,oi)}getMutationCache(){return ye(this,dh)}getDefaultOptions(){return ye(this,fh)}setDefaultOptions(r){It(this,fh,r)}setQueryDefaults(r,a){ye(this,$f).set(Od(r),{queryKey:r,defaultOptions:a})}getQueryDefaults(r){const a=[...ye(this,$f).values()],u={};return a.forEach(m=>{tm(r,m.queryKey)&&Object.assign(u,m.defaultOptions)}),u}setMutationDefaults(r,a){ye(this,Uf).set(Od(r),{mutationKey:r,defaultOptions:a})}getMutationDefaults(r){const a=[...ye(this,Uf).values()],u={};return a.forEach(m=>{tm(r,m.mutationKey)&&Object.assign(u,m.defaultOptions)}),u}defaultQueryOptions(r){if(r._defaulted)return r;const a={...ye(this,fh).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return a.queryHash||(a.queryHash=$_(a.queryKey,a)),a.refetchOnReconnect===void 0&&(a.refetchOnReconnect=a.networkMode!=="always"),a.throwOnError===void 0&&(a.throwOnError=!!a.suspense),!a.networkMode&&a.persister&&(a.networkMode="offlineFirst"),a.queryFn===V_&&(a.enabled=!1),a}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...ye(this,fh).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){ye(this,oi).clear(),ye(this,dh).clear()}},oi=new WeakMap,dh=new WeakMap,fh=new WeakMap,$f=new WeakMap,Uf=new WeakMap,ph=new WeakMap,Vf=new WeakMap,Zf=new WeakMap,X0),Pb=te.createContext(void 0),fu=r=>{const a=te.useContext(Pb);if(!a)throw new Error("No QueryClient set, use QueryClientProvider to set one");return a},qS=({client:r,children:a})=>(te.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),Y.jsx(Pb.Provider,{value:r,children:a})),Cb=te.createContext(!1),kb=()=>te.useContext(Cb);Cb.Provider;function WS(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var HS=te.createContext(WS()),Eb=()=>te.useContext(HS),Ib=(r,a)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(a.isReset()||(r.retryOnMount=!1))},Mb=r=>{te.useEffect(()=>{r.clearReset()},[r])},Ab=({result:r,errorResetBoundary:a,throwOnError:u,query:m,suspense:b})=>r.isError&&!a.isReset()&&!r.isFetching&&m&&(b&&r.data===void 0||_b(u,[r.error,m])),Rb=r=>{if(r.suspense){const u=b=>b==="static"?b:Math.max(b??1e3,1e3),m=r.staleTime;r.staleTime=typeof m=="function"?(...b)=>u(m(...b)):u(m),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},zb=(r,a)=>r.isLoading&&r.isFetching&&!a,m_=(r,a)=>(r==null?void 0:r.suspense)&&a.isPending,Ig=(r,a,u)=>a.fetchOptimistic(r).catch(()=>{u.clearReset()});function KS({queries:r,...a},u){const m=fu(),b=kb(),P=Eb(),w=te.useMemo(()=>r.map(fe=>{const Pe=m.defaultQueryOptions(fe);return Pe._optimisticResults=b?"isRestoring":"optimistic",Pe}),[r,m,b]);w.forEach(fe=>{Rb(fe),Ib(fe,P)}),Mb(P);const[l]=te.useState(()=>new VS(m,w,a)),[L,N,Z]=l.getOptimisticResult(w,a.combine),V=!b&&a.subscribed!==!1;te.useSyncExternalStore(te.useCallback(fe=>V?l.subscribe(li.batchCalls(fe)):js,[l,V]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),te.useEffect(()=>{l.setQueries(w,a)},[w,a,l]);const q=L.some((fe,Pe)=>m_(w[Pe],fe))?L.flatMap((fe,Pe)=>{const Le=w[Pe];if(Le){const Me=new G_(m,Le);if(m_(Le,fe))return Ig(Le,Me,P);zb(fe,b)&&Ig(Le,Me,P)}return[]}):[];if(q.length>0)throw Promise.all(q);const _e=L.find((fe,Pe)=>{const Le=w[Pe];return Le&&Ab({result:fe,errorResetBoundary:P,throwOnError:Le.throwOnError,query:m.getQueryCache().get(Le.queryHash),suspense:Le.suspense})});if(_e!=null&&_e.error)throw _e.error;return N(Z())}function XS(r,a,u){var V,ee,q,_e,fe;const m=kb(),b=Eb(),P=fu(),w=P.defaultQueryOptions(r);(ee=(V=P.getDefaultOptions().queries)==null?void 0:V._experimental_beforeQuery)==null||ee.call(V,w),w._optimisticResults=m?"isRestoring":"optimistic",Rb(w),Ib(w,b),Mb(b);const l=!P.getQueryCache().get(w.queryHash),[L]=te.useState(()=>new a(P,w)),N=L.getOptimisticResult(w),Z=!m&&r.subscribed!==!1;if(te.useSyncExternalStore(te.useCallback(Pe=>{const Le=Z?L.subscribe(li.batchCalls(Pe)):js;return L.updateResult(),Le},[L,Z]),()=>L.getCurrentResult(),()=>L.getCurrentResult()),te.useEffect(()=>{L.setOptions(w)},[w,L]),m_(w,N))throw Ig(w,L,b);if(Ab({result:N,errorResetBoundary:b,throwOnError:w.throwOnError,query:P.getQueryCache().get(w.queryHash),suspense:w.suspense}))throw N.error;if((_e=(q=P.getDefaultOptions().queries)==null?void 0:q._experimental_afterQuery)==null||_e.call(q,w,N),w.experimental_prefetchInRender&&!Fd&&zb(N,m)){const Pe=l?Ig(w,L,b):(fe=P.getQueryCache().get(w.queryHash))==null?void 0:fe.promise;Pe==null||Pe.catch(js).finally(()=>{L.updateResult()})}return w.notifyOnChangeProps?N:L.trackResult(N)}function Gg(r,a){return XS(r,G_)}function W_(r,a){const u=fu(),[m]=te.useState(()=>new $S(u,r));te.useEffect(()=>{m.setOptions(r)},[m,r]);const b=te.useSyncExternalStore(te.useCallback(w=>m.subscribe(li.batchCalls(w)),[m]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),P=te.useCallback((w,l)=>{m.mutate(w,l).catch(js)},[m]);if(b.error&&_b(m.options.throwOnError,[b.error]))throw b.error;return{...b,mutate:P,mutateAsync:b.mutate}}function kx(...r){console.log("[API]",...r)}const YS="https://bada-backend.vercel.app/api";async function Hf(r,a={}){const u=cc.getState().token,m=r.startsWith("http")?r:`${YS}${r}`,b={"Content-Type":"application/json",...a.headers||{}};u&&(b.Authorization=`Bearer ${u}`),kx("",a.method??"GET",m,{headers:b,body:a.body});const P=await fetch(m,{...a,headers:b});if(kx("",P.status,P.statusText,m),!P.ok){let w=null;try{w=await P.json()}catch{}const l=new Error((w==null?void 0:w.error)||P.statusText);throw l.status=P.status,l.details=w,l}if(P.status!==204)return await P.json()}function QS(r){var P;const a=r.properties,u=(P=r.geometry)==null?void 0:P.coordinates;if(!a||!u)return null;const[m,b]=u;return typeof b!="number"||typeof m!="number"?null:{id:a.NUTSKOD??r.id??"",name:a.NAMN??"Oknd",municipality:a.KMN_NAMN??"",lat:b,lon:m,lng:m}}async function Db(){return(await Hf("/beaches")).features.map(QS).filter(a=>a!==null)}async function Lb(r){return Hf(`/beaches/${r}`)}const JS=r=>te.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 79.01 44.97",...r},te.createElement("path",{fill:"currentColor",d:"M77.99,23.97l-10.75,3.73c-19.59,2-37.09-7.1-56.73-5.73-3.23.22-6.41,2.4-9.52,1.49,25.02-16.29,50.86,4.05,77.01.51Z"}),te.createElement("path",{fill:"currentColor",d:"M75.99,6.97l-9.73,3.75C43.83,13.96,22.14-.46,0,6.95c23.28-17.55,50.69,4.19,75.99.02Z"}),te.createElement("path",{fill:"currentColor",d:"M78.99,40.97c.24,1.44-1.73,1.35-2.78,1.69-19.44,6.32-32.53-2.19-50.73-3.69-6.82-.56-13.72.47-20.48.49,24-14.93,49.01,4.92,73.99,1.51Z"})),eT=r=>te.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 792 391",...r},te.createElement("defs",null,te.createElement("style",null,`
      .st0 {
        fill: #e11418;
      }

      .st1 { fill: currentColor; }

      .st2 {
        fill: #e33232;
      }

      .st3 {
        fill: #d91c1e;
      }

      .st4 {
        fill: #e53c3d;
      }

      .st5 {
        fill: #d91b1d;
      }

      .st6 { fill: currentColor; }

      .st7 { fill: currentColor; }

      .st8 {
        fill: #e33034;
      }

      .st9 {
        fill: #e02122;
      }

      .st10 {
        fill: #df2a2b;
      }

      .st11 {
        fill: #de3532;
      }

      .st12 {
        fill: #e03535;
      }

      .st13 {
        fill: #e23b3e;
      }

      .st14 {
        fill: #e42e30;
      }

      .st15 { fill: currentColor; }
    `)),te.createElement("path",{className:"st7",d:"M388.36,35c7.45,5.94,14.26,12.62,20.92,19.42,1.74,1.71,3.55,3.31,5.4,4.91,4.27,3.72,8.39,7.57,12.5,11.47,7.22,6.82,14.49,13.59,21.81,20.31,1.04.96,2.08,1.91,3.12,2.87,8.2,7.53,16.44,15.01,24.83,22.33,3.19,2.8,6.33,5.64,9.48,8.48,1.71,1.54,3.43,3.08,5.16,4.62,2.49,2.22,4.96,4.46,7.42,6.71.71.65,1.43,1.29,2.16,1.96,11.16,10.56,15.83,22.01,17.71,36.92,2.83,20.34,7.64,38.11,21.36,53.98,1.86,2.26,3.31,4.61,4.76,7.15-6.68.42-12.66-1.16-19.12-2.75-8.43-2.01-16.86-3.94-25.38-5.56-.82-.16-1.63-.32-2.47-.48-34.04-6.38-70.41-2.59-102.87,8.81-12.49,4.37-22.96,6.03-36.16,4.98-.87-.06-1.74-.13-2.64-.19-9.53-.74-19.01-1.79-28.36-3.81v-3c2.44-1.95,4.85-3.7,7.44-5.44,1.58-1.08,3.15-2.17,4.73-3.25.81-.55,1.62-1.11,2.45-1.67,3.59-2.46,7.14-4.99,10.7-7.51,4.51-3.19,9.04-6.37,13.57-9.54,8.89-6.21,17.75-12.46,26.52-18.82,5.85-4.24,11.74-8.42,17.66-12.57,5.04-3.54,10.01-7.17,14.93-10.87,1.33-.89,2.67-1.33,4-1.33-2.64-5.17-5.77-9.1-9.68-13.38-2.63-2.97-5.07-6.05-7.51-9.19-4.04-5.2-8.15-10.34-12.31-15.44-5.07-6.21-10.05-12.49-15-18.8-2.91-3.71-5.83-7.42-8.82-11.06-1.12-1.42-2.09-2.78-2.9-4.08s-2.08-2.65-3.79-4.05c-7.53-1-15.08.49-22.44,2-1.09.22-2.18.44-3.3.66-3.07.62-6.14,1.26-9.2,1.91-2.19.46-4.38.92-6.57,1.38-3.98.83-7.96,1.69-11.94,2.55-1.56.34-3.11.67-4.67,1-12.19,2.09-23.09,6.55-32.68,13.37-3.41,6.08-5.8,12.5-7.64,19.2-3.76,13.02-11.55,21.61-22.68,28.91-1.25.69-2.55,1.03-3.88,1.03.2-.66.41-1.33.62-2.01.27-.88.54-1.77.82-2.68.27-.87.53-1.74.81-2.64,1.37-4.85,1.93-9.31,2-14.36.03-1.14.05-2.29.08-3.45-.11-.94-.22-1.89-.33-2.86-2.91-1.94-4.41-2.56-7.87-2.43-8.04,1.62-15,7.66-21.49,12.38-4.82,3.5-9.72,6.84-14.7,10.11-.71.48-1.43.95-2.16,1.45-3.56,2.32-6.44,4.08-10.77,4.49,1.44-8.96,5.14-16.87,9-25,.31-.65.61-1.3.93-1.96,18.7-38.79,57.96-53.22,95.12-69.91,4.88-2.19,9.75-4.41,14.62-6.64,3.52-1.61,7.04-3.21,10.56-4.81,1.68-.77,3.37-1.54,5.05-2.31,30.99-14.25,51.35-18.08,61.08-11.47v-.04Z"}),te.createElement("path",{className:"st7",d:"M559,268.11c44.74,26.17,88.77,38.07,140.29,25.01,19.97-5.46,38.96-13.3,57.71-22.01.9-.42,1.8-.83,2.73-1.26,4.77-2.22,9.53-4.46,14.27-6.74,0,1.33-.45,2.46-1.36,3.38-.64.54-1.29,1.07-1.95,1.62-3.4,2.89-6.72,5.85-10,8.88-4.46,4.06-9.01,7.95-13.71,11.73-2.11,1.69-4.19,3.4-6.27,5.13-39.94,33.03-88.07,56.1-140.71,53.26-6.5-.69-12.74-2.18-19-4-.75-.21-1.5-.43-2.27-.65-17.28-5.06-32.46-13.06-47.91-22.2-8.11-4.79-16.26-9.22-24.81-13.15-1.17-.54-2.33-1.08-3.54-1.64-10.79-4.66-21.96-7.11-33.46-9.36-1.22-.25-2.43-.5-3.69-.75-55.28-9.32-110.4,14.11-160.28,34.91-9.65,4.02-19.32,8-29.03,11.85-.87.35-1.74.69-2.64,1.05-14.72,5.76-29.88,8.91-45.36,11.95-.79.18-1.57.37-2.38.56-3.47.59-6.91.66-10.43.72-.75.01-1.51.03-2.29.04-16.87.23-32.74.08-48.9-5.31-.89-.29-1.77-.58-2.68-.88-15.65-5.24-29.85-12.59-43.32-22.12,3.95-1.32,6.76-.2,10.62.88,23.54,6.53,51.87,4.82,75.38-.88.74-.17,1.48-.34,2.23-.52,24.39-5.78,47.88-15.45,70.77-25.48,2.3-1,4.59-1.99,6.89-2.99,1.18-.51,2.36-1.02,3.58-1.55,1.21-.52,2.42-1.05,3.66-1.59s2.48-1.08,3.73-1.62c4.05-1.76,8.1-3.51,12.15-5.26.76-.33,1.52-.66,2.3-1,80.2-34.68,165.02-69.31,249.7-20h-.02Z"}),te.createElement("path",{className:"st7",d:"M273.4,254.39c8.36,5.04,16.78,9.55,25.6,13.72,2.67,1.32,5.34,2.66,8,4-3.26,2.71-6.6,4.24-10.5,5.86-.63.26-1.27.53-1.91.8-2.05.85-4.1,1.69-6.15,2.54-1.41.59-2.83,1.17-4.24,1.76-2.79,1.16-5.59,2.32-8.38,3.47-4.8,1.99-9.59,4-14.38,6.02-.74.31-1.48.62-2.24.94-3.44,1.44-6.86,2.92-10.24,4.48-.64.29-1.28.58-1.94.88-1.68.77-3.36,1.55-5.04,2.34-3.64,1.14-5.33,1.06-8.98-.07-2.9-1.52-5.63-3.28-8.38-5.06-38.86-24.41-81.35-30.39-126.19-20.38-28.91,6.83-56.82,17.86-83.37,31.09-.89.44-1.78.88-2.69,1.33-.78.39-1.55.78-2.35,1.18-1.35.56-3.02.84-5.02.84,6.33-5.87,12.75-11.51,19.47-16.93,2.13-1.74,4.18-3.53,6.22-5.38,11.23-9.88,23.78-18.26,36.31-26.39,1.7-1.1,3.39-2.22,5.08-3.34,67.69-43.46,133.17-44.87,201.32-3.68v-.02Z"}),te.createElement("path",{className:"st1",d:"M536,148.11c7.05.86,13.91,3.03,20.69,5.06,2.13.63,4.26,1.26,6.38,1.89,1.12.33,2.25.67,3.4,1.01,5.54,1.64,11.09,3.24,16.64,4.85,3.28.95,6.57,1.9,9.85,2.86.66.19,1.32.38,2,.58,4.05,1.17,8.09,2.35,12.14,3.53,2.68.78,5.37,1.56,8.05,2.34l3.93,1.14c6.49,1.89,12.99,3.77,19.5,5.61.99.28,1.98.56,3,.85,1.82.51,3.63,1.02,5.45,1.53,3.91,1.1,6.24,2.02,6.98,2.76-.5,15.15-9.1,27.93-19.81,38.16-13.41,11.28-28.83,15.89-46.19,14.84-16.76-1.55-30.3-9.34-41.87-21.4-10.39-12.68-14.44-26.13-14.57-42.29-.01-1.06-.02-2.11-.03-3.2.12-10.55,1.61-17.25,4.47-20.11h0Z"}),te.createElement("path",{className:"st9",d:"M625.94,116.36c1.72,1.21,3.4,2.46,5.06,3.75.85.65,1.7,1.29,2.57,1.96,11.16,9.21,19.2,22.66,21.43,37.04.07,2.44.09,4.88.06,7.31,0,1.25-.02,2.51-.03,3.8-.01.95-.02,1.91-.04,2.89-6.88-.55-13.17-2.36-19.77-4.34-4.3-1.28-8.61-2.53-12.92-3.79-1-.29-1.99-.58-3.02-.88-9.32-2.72-18.65-5.39-27.98-8.05-.75-.22-1.51-.43-2.29-.65-7.16-2.04-14.31-4.08-21.47-6.12-9.22-2.62-18.41-5.29-27.55-8.17,5.28-14.34,18.1-23.39,31.47-29.62,17.72-6.83,38.18-4.92,54.46,4.87h.02Z"}),te.createElement("path",{className:"st11",d:"M652,151.11c3.3,4.95,3.12,9.46,3.06,15.31,0,1.25-.02,2.51-.03,3.8-.01.95-.02,1.91-.04,2.89-5.24-.55-9.97-1.43-15-3l2-1v-2c2.31-.33,4.65-.66,7-1,.51-1.56,1.01-3.12,1.5-4.69.28-.87.56-1.74.84-2.64.65-2.67.77-4.94.66-7.68h.01Z"}),te.createElement("path",{className:"st2",d:"M614.69,157.99c1.18.02,2.36.04,3.57.05.91.02,1.82.04,2.74.07.66,1.65,1.32,3.3,2,5-3.97,1.32-6.81.18-10.69-.94-.7-.19-1.41-.39-2.13-.59-1.73-.48-3.46-.98-5.19-1.47,3.63-2.42,5.38-2.21,9.69-2.12h.01Z"}),te.createElement("path",{className:"st3",d:"M650,150.11h2c1.27,6.47.69,9.98-2,16-.99-.33-1.98-.66-3-1,.11-2.13.24-4.25.38-6.38.07-1.18.14-2.37.21-3.59.27-2.03,1.08-3.71,2.41-5.04h0Z"}),te.createElement("path",{className:"st13",d:"M583,110.11c-.99.33-1.98.66-3,1v3c-.63-.02-1.25-.05-1.9-.07-.82-.02-1.63-.04-2.48-.05-.81-.02-1.63-.04-2.46-.07-1.59-.01-2.97.72-4.16,2.2-1.75.08-3.41.08-5,0,3-2.46,5.86-3.91,9.5-5.25.94-.36,1.88-.71,2.84-1.08,2.73-.69,4.05-.63,6.66.33h0Z"}),te.createElement("path",{className:"st4",d:"M582.26,148.25c.8.22,1.6.44,2.43.67.81.21,1.62.43,2.45.64.61.18,1.23.36,1.86.54-.33,1.32-.66,2.64-1,4-4.06-.47-7.47-.88-11-3,1.58-2.03,3.33-2.98,5.26-2.86h0Z"}),te.createElement("path",{className:"st5",d:"M637,164.11h8v3h-3v2c-1.98-.33-3.98-.66-6-1l1-4Z"}),te.createElement("path",{className:"st12",d:"M640,129.11c3.08,2.77,4.69,5.06,6,9h-6c.33-1.98.66-3.96,1-6l-2-1,1-2Z"}),te.createElement("path",{className:"st6",d:"M773,263.11l1,2c-2.64,2.31-5.28,4.62-8,7-.99-1.32-1.98-2.64-3-4l10-5Z"}),te.createElement("path",{className:"st15",d:"M16,300.11l2,1c-3.82,5.05-7.03,7.85-13,10l11-11Z"}),te.createElement("path",{className:"st8",d:"M563,116.11v3c-.66.66-1.32,1.32-2,2h-3v2c-1.65.33-3.3.66-5,1,3.11-3.29,6.02-5.84,10-8Z"}),te.createElement("path",{className:"st14",d:"M580,148.11c2.31.66,4.62,1.32,7,2-1.33,1.33-2.65,2.07-3.95,2.2-2.02-.07-4.04-.13-6.05-.2.99-1.32,1.98-2.64,3-4Z"}),te.createElement("path",{className:"st10",d:"M609,110.11l8,2c-.33.66-.66,1.32-1,2-2.64-.33-5.28-.66-8-1,.33-.99.66-1.98,1-3Z"}),te.createElement("path",{className:"st0",d:"M571,113.11c3.83.5,6.5,1.5,8,3h-8v-3Z"}));function Ly(r){const a=te.useRef(null);return te.useEffect(()=>{function u(m){a.current&&!a.current.contains(m.target)&&r()}return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[r]),a}function tT(){const[r,a]=te.useState(()=>document.documentElement.classList.contains("dark"));return te.useEffect(()=>{document.documentElement.classList.toggle("dark",r)},[r]),{isDark:r,setIsDark:a}}function rT({languageSwitcher:r}){const{t:a}=Ea();Oo();const u=Bd(),[m,b]=te.useState(!1),[P,w]=te.useState(!1),[l,L]=te.useState(!1),N=Ly(()=>b(!1)),Z=Ly(()=>w(!1)),V=Ly(()=>L(!1)),{isDark:ee,setIsDark:q}=tT(),_e=Ky(Je=>Je.search),fe=Ky(Je=>Je.setSearch),{token:Pe,clearToken:Le}=cc(),Me=!!Pe,Se=fu(),{data:De}=Gg({queryKey:["beaches"],queryFn:Db,staleTime:300*1e3}),Ye=te.useMemo(()=>{if(!_e.trim()||!De)return[];const Je=_e.trim().toLowerCase();return De.filter(Ke=>`${Ke.name} ${Ke.municipality??""}`.toLowerCase().includes(Je)).slice(0,10)},[_e,De]);function ot(){Le(),Se.clear(),w(!1)}function lt(Je){fe(Je),L(!!Je)}function ut(Je){fe(""),L(!1),u(`/beach/${Je}`)}return Y.jsxs(Y.Fragment,{children:[Y.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-accent focus:text-white focus:px-4 focus:py-2 focus:rounded focus:underline",children:a("header.skipToMain")}),Y.jsxs("header",{className:"bg-surface sticky top-0 z-50 border-b border-border",role:"banner",children:[Y.jsxs("div",{className:"mx-auto max-w-screen-lg px-3 py-2 flex items-center justify-between gap-2",children:[Y.jsxs("div",{className:"relative",ref:N,children:[Y.jsx("button",{"aria-label":a("header.openMenu"),className:"p-2 rounded-full hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/50 text-ink",onClick:()=>b(Je=>!Je),children:Y.jsx(JS,{width:30,height:30,"aria-hidden":"true"})}),m&&Y.jsxs("div",{role:"menu",className:"absolute left-0 mt-2 w-56 rounded-2xl border border-border bg-surface shadow p-2",children:[Y.jsx("div",{className:"px-2 py-1.5 text-xs text-ink-muted",children:a("header.menu")}),Y.jsx("div",{className:"h-px bg-border my-1"}),Y.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[Y.jsx("span",{className:"text-sm",children:a("header.language")}),r??Y.jsx("span",{className:"text-xs text-ink-muted",children:"SV / EN"})]}),Y.jsx(tu,{to:"/what-is-eu-beach",children:a("nav.whatIsEUBeach")}),Y.jsx(tu,{to:"/about",children:a("nav.about")}),Y.jsx(tu,{to:"/terms",children:a("nav.terms")}),Y.jsx(tu,{to:"/contact",children:a("nav.contact")})]})]}),Y.jsx("div",{className:"flex-1 min-w-0",children:Y.jsxs("div",{className:"flex items-center justify-center gap-2",children:[Y.jsx(ei,{to:"/",className:"font-spectral text-4xl font-bold tracking-[-0.06em] leading-none text-ink shrink-0","aria-label":"BADA  home",children:"BADA"}),Y.jsxs("div",{className:"text-left text-sm text-ink-muted leading-[1.1] shrink-0",children:[a("header.euBeaches"),Y.jsx("br",{}),a("header.inSweden")]})]})}),Y.jsxs("div",{className:"relative",ref:Z,children:[Y.jsx("button",{"aria-label":a("header.userMenu"),className:"p-2 rounded-full hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/50 text-ink",onClick:()=>w(Je=>!Je),children:Y.jsx(eT,{width:40,height:40,"aria-hidden":"true"})}),P&&Y.jsxs("div",{role:"menu",className:"absolute right-0 mt-2 w-60 rounded-2xl border border-border bg-surface shadow p-2",children:[Y.jsx("div",{className:"px-2 py-1.5 text-xs text-ink-muted",children:a(Me?"nav.account":"nav.user")}),Y.jsx("div",{className:"h-px bg-border my-1"}),Me?Y.jsxs(Y.Fragment,{children:[Y.jsx(tu,{to:"/favorites",children:a("nav.favoriteBeaches")}),Y.jsx(tu,{to:"/profile",children:a("nav.profile")}),Y.jsx(tu,{to:"/settings",children:a("nav.settings")}),Y.jsx("div",{className:"h-px bg-border my-1"}),Y.jsx("button",{className:"w-full text-left px-2 py-1.5 rounded-lg hover:bg-surface-muted text-sm",onClick:ot,children:a("nav.logOut")})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx(tu,{to:"/login",children:a("nav.signIn")}),Y.jsx(tu,{to:"/register",children:a("nav.register")})]}),Y.jsx("button",{className:"w-full text-left px-2 py-1.5 rounded-lg hover:bg-surface-muted text-sm",onClick:()=>q(!ee),children:a(ee?"theme.darkOn":"theme.darkOff")})]})]})]}),Y.jsx("div",{className:"mx-auto max-w-screen-lg px-3 pb-2",children:Y.jsxs("div",{className:"relative",ref:V,children:[Y.jsxs("div",{className:"flex gap-2 items-center",children:[Y.jsx("input",{type:"search",placeholder:a("header.searchPlaceholder"),"aria-label":a("header.searchPlaceholder"),className:"flex-1 rounded-2xl border border-border bg-surface-muted px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent/40",value:_e,onChange:Je=>lt(Je.target.value),onFocus:()=>_e&&L(!0)}),_e&&Y.jsx("button",{className:"rounded-2xl border border-border bg-surface px-3 py-2 hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",onClick:()=>{fe(""),L(!1)},"aria-label":a("header.clear"),title:a("header.clear"),children:a("header.clear")})]}),l&&_e&&Y.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 rounded-2xl border border-border bg-surface shadow-lg max-h-96 overflow-y-auto z-50",children:[Ye.length>0?Y.jsx("ul",{className:"py-2",children:Ye.map(Je=>Y.jsx("li",{children:Y.jsxs("button",{onClick:()=>ut(Je.id),className:"w-full text-left px-4 py-2 hover:bg-surface-muted focus:bg-surface-muted focus:outline-none transition-colors",children:[Y.jsx("div",{className:"font-medium",children:Je.name}),Y.jsx("div",{className:"text-sm text-ink-muted",children:Je.municipality??""})]})},Je.id))}):Y.jsx("div",{className:"px-4 py-3 text-sm text-ink-muted",children:a("beachesList.noMatches")}),Ye.length>0&&Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"h-px bg-border"}),Y.jsx(ei,{to:"/",onClick:()=>{L(!1)},className:"block px-4 py-2 text-sm text-accent hover:bg-surface-muted text-center",children:a("header.viewAllResults")})]})]})]})})]})]})}function tu({to:r,children:a}){return Y.jsx(ei,{to:r,className:"block px-2 py-1.5 rounded-lg hover:bg-surface-muted text-sm",role:"menuitem",children:a})}function Fb(){const{i18n:r}=Ea(),a=r.language.startsWith("en")?"en":"sv";function u(m){r.changeLanguage(m),localStorage.setItem("lang",m)}return Y.jsxs("div",{className:"p-2 flex gap-2",children:[Y.jsx("button",{onClick:()=>u("sv"),"aria-pressed":a==="sv",className:`px-3 py-1 rounded-lg text-sm transition-colors ${a==="sv"?"bg-accent text-white font-bold":"bg-surface-muted text-ink hover:bg-surface"}`,children:"Svenska"}),Y.jsx("button",{onClick:()=>u("en"),"aria-pressed":a==="en",className:`px-3 py-1 rounded-lg text-sm transition-colors ${a==="en"?"bg-accent text-white font-bold":"bg-surface-muted text-ink hover:bg-surface"}`,children:"English"})]})}const Ar=r=>typeof r=="string",Vp=()=>{let r,a;const u=new Promise((m,b)=>{r=m,a=b});return u.resolve=r,u.reject=a,u},Ex=r=>r==null?"":""+r,nT=(r,a,u)=>{r.forEach(m=>{a[m]&&(u[m]=a[m])})},iT=/###/g,Ix=r=>r&&r.indexOf("###")>-1?r.replace(iT,"."):r,Mx=r=>!r||Ar(r),Wp=(r,a,u)=>{const m=Ar(a)?a.split("."):a;let b=0;for(;b<m.length-1;){if(Mx(r))return{};const P=Ix(m[b]);!r[P]&&u&&(r[P]=new u),Object.prototype.hasOwnProperty.call(r,P)?r=r[P]:r={},++b}return Mx(r)?{}:{obj:r,k:Ix(m[b])}},Ax=(r,a,u)=>{const{obj:m,k:b}=Wp(r,a,Object);if(m!==void 0||a.length===1){m[b]=u;return}let P=a[a.length-1],w=a.slice(0,a.length-1),l=Wp(r,w,Object);for(;l.obj===void 0&&w.length;)P=`${w[w.length-1]}.${P}`,w=w.slice(0,w.length-1),l=Wp(r,w,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${P}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${P}`]=u},sT=(r,a,u,m)=>{const{obj:b,k:P}=Wp(r,a,Object);b[P]=b[P]||[],b[P].push(u)},Mg=(r,a)=>{const{obj:u,k:m}=Wp(r,a);if(u&&Object.prototype.hasOwnProperty.call(u,m))return u[m]},aT=(r,a,u)=>{const m=Mg(r,u);return m!==void 0?m:Mg(a,u)},Ob=(r,a,u)=>{for(const m in a)m!=="__proto__"&&m!=="constructor"&&(m in r?Ar(r[m])||r[m]instanceof String||Ar(a[m])||a[m]instanceof String?u&&(r[m]=a[m]):Ob(r[m],a[m],u):r[m]=a[m]);return r},Tf=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var oT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const lT=r=>Ar(r)?r.replace(/[&<>"'\/]/g,a=>oT[a]):r;class cT{constructor(a){this.capacity=a,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(a){const u=this.regExpMap.get(a);if(u!==void 0)return u;const m=new RegExp(a);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(a,m),this.regExpQueue.push(a),m}}const uT=[" ",",","?","!",";"],hT=new cT(20),dT=(r,a,u)=>{a=a||"",u=u||"";const m=uT.filter(w=>a.indexOf(w)<0&&u.indexOf(w)<0);if(m.length===0)return!0;const b=hT.getRegExp(`(${m.map(w=>w==="?"?"\\?":w).join("|")})`);let P=!b.test(r);if(!P){const w=r.indexOf(u);w>0&&!b.test(r.substring(0,w))&&(P=!0)}return P},g_=(r,a,u=".")=>{if(!r)return;if(r[a])return Object.prototype.hasOwnProperty.call(r,a)?r[a]:void 0;const m=a.split(u);let b=r;for(let P=0;P<m.length;){if(!b||typeof b!="object")return;let w,l="";for(let L=P;L<m.length;++L)if(L!==P&&(l+=u),l+=m[L],w=b[l],w!==void 0){if(["string","number","boolean"].indexOf(typeof w)>-1&&L<m.length-1)continue;P+=L-P+1;break}b=w}return b},nm=r=>r==null?void 0:r.replace("_","-"),fT={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,a){var u,m;(m=(u=console==null?void 0:console[r])==null?void 0:u.apply)==null||m.call(u,console,a)}};class Ag{constructor(a,u={}){this.init(a,u)}init(a,u={}){this.prefix=u.prefix||"i18next:",this.logger=a||fT,this.options=u,this.debug=u.debug}log(...a){return this.forward(a,"log","",!0)}warn(...a){return this.forward(a,"warn","",!0)}error(...a){return this.forward(a,"error","")}deprecate(...a){return this.forward(a,"warn","WARNING DEPRECATED: ",!0)}forward(a,u,m,b){return b&&!this.debug?null:(Ar(a[0])&&(a[0]=`${m}${this.prefix} ${a[0]}`),this.logger[u](a))}create(a){return new Ag(this.logger,{prefix:`${this.prefix}:${a}:`,...this.options})}clone(a){return a=a||this.options,a.prefix=a.prefix||this.prefix,new Ag(this.logger,a)}}var ac=new Ag;class qg{constructor(){this.observers={}}on(a,u){return a.split(" ").forEach(m=>{this.observers[m]||(this.observers[m]=new Map);const b=this.observers[m].get(u)||0;this.observers[m].set(u,b+1)}),this}off(a,u){if(this.observers[a]){if(!u){delete this.observers[a];return}this.observers[a].delete(u)}}emit(a,...u){this.observers[a]&&Array.from(this.observers[a].entries()).forEach(([b,P])=>{for(let w=0;w<P;w++)b(...u)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([b,P])=>{for(let w=0;w<P;w++)b.apply(b,[a,...u])})}}class Rx extends qg{constructor(a,u={ns:["translation"],defaultNS:"translation"}){super(),this.data=a||{},this.options=u,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(a){this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}removeNamespaces(a){const u=this.options.ns.indexOf(a);u>-1&&this.options.ns.splice(u,1)}getResource(a,u,m,b={}){var N,Z;const P=b.keySeparator!==void 0?b.keySeparator:this.options.keySeparator,w=b.ignoreJSONStructure!==void 0?b.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;a.indexOf(".")>-1?l=a.split("."):(l=[a,u],m&&(Array.isArray(m)?l.push(...m):Ar(m)&&P?l.push(...m.split(P)):l.push(m)));const L=Mg(this.data,l);return!L&&!u&&!m&&a.indexOf(".")>-1&&(a=l[0],u=l[1],m=l.slice(2).join(".")),L||!w||!Ar(m)?L:g_((Z=(N=this.data)==null?void 0:N[a])==null?void 0:Z[u],m,P)}addResource(a,u,m,b,P={silent:!1}){const w=P.keySeparator!==void 0?P.keySeparator:this.options.keySeparator;let l=[a,u];m&&(l=l.concat(w?m.split(w):m)),a.indexOf(".")>-1&&(l=a.split("."),b=u,u=l[1]),this.addNamespaces(u),Ax(this.data,l,b),P.silent||this.emit("added",a,u,m,b)}addResources(a,u,m,b={silent:!1}){for(const P in m)(Ar(m[P])||Array.isArray(m[P]))&&this.addResource(a,u,P,m[P],{silent:!0});b.silent||this.emit("added",a,u,m)}addResourceBundle(a,u,m,b,P,w={silent:!1,skipCopy:!1}){let l=[a,u];a.indexOf(".")>-1&&(l=a.split("."),b=m,m=u,u=l[1]),this.addNamespaces(u);let L=Mg(this.data,l)||{};w.skipCopy||(m=JSON.parse(JSON.stringify(m))),b?Ob(L,m,P):L={...L,...m},Ax(this.data,l,L),w.silent||this.emit("added",a,u,m)}removeResourceBundle(a,u){this.hasResourceBundle(a,u)&&delete this.data[a][u],this.removeNamespaces(u),this.emit("removed",a,u)}hasResourceBundle(a,u){return this.getResource(a,u)!==void 0}getResourceBundle(a,u){return u||(u=this.options.defaultNS),this.getResource(a,u)}getDataByLanguage(a){return this.data[a]}hasLanguageSomeTranslations(a){const u=this.getDataByLanguage(a);return!!(u&&Object.keys(u)||[]).find(b=>u[b]&&Object.keys(u[b]).length>0)}toJSON(){return this.data}}var jb={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,a,u,m,b){return r.forEach(P=>{var w;a=((w=this.processors[P])==null?void 0:w.process(a,u,m,b))??a}),a}};const Nb=Symbol("i18next/PATH_KEY");function pT(){const r=[],a=Object.create(null);let u;return a.get=(m,b)=>{var P;return(P=u==null?void 0:u.revoke)==null||P.call(u),b===Nb?r:(r.push(b),u=Proxy.revocable(m,a),u.proxy)},Proxy.revocable(Object.create(null),a).proxy}function y_(r,a){const{[Nb]:u}=r(pT());return u.join((a==null?void 0:a.keySeparator)??".")}const zx={},Dx=r=>!Ar(r)&&typeof r!="boolean"&&typeof r!="number";class Rg extends qg{constructor(a,u={}){super(),nT(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],a,this),this.options=u,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ac.create("translator")}changeLanguage(a){a&&(this.language=a)}exists(a,u={interpolation:{}}){const m={...u};if(a==null)return!1;const b=this.resolve(a,m);return(b==null?void 0:b.res)!==void 0}extractFromKey(a,u){let m=u.nsSeparator!==void 0?u.nsSeparator:this.options.nsSeparator;m===void 0&&(m=":");const b=u.keySeparator!==void 0?u.keySeparator:this.options.keySeparator;let P=u.ns||this.options.defaultNS||[];const w=m&&a.indexOf(m)>-1,l=!this.options.userDefinedKeySeparator&&!u.keySeparator&&!this.options.userDefinedNsSeparator&&!u.nsSeparator&&!dT(a,m,b);if(w&&!l){const L=a.match(this.interpolator.nestingRegexp);if(L&&L.length>0)return{key:a,namespaces:Ar(P)?[P]:P};const N=a.split(m);(m!==b||m===b&&this.options.ns.indexOf(N[0])>-1)&&(P=N.shift()),a=N.join(b)}return{key:a,namespaces:Ar(P)?[P]:P}}translate(a,u,m){let b=typeof u=="object"?{...u}:u;if(typeof b!="object"&&this.options.overloadTranslationOptionHandler&&(b=this.options.overloadTranslationOptionHandler(arguments)),typeof b=="object"&&(b={...b}),b||(b={}),a==null)return"";typeof a=="function"&&(a=y_(a,{...this.options,...b})),Array.isArray(a)||(a=[String(a)]);const P=b.returnDetails!==void 0?b.returnDetails:this.options.returnDetails,w=b.keySeparator!==void 0?b.keySeparator:this.options.keySeparator,{key:l,namespaces:L}=this.extractFromKey(a[a.length-1],b),N=L[L.length-1];let Z=b.nsSeparator!==void 0?b.nsSeparator:this.options.nsSeparator;Z===void 0&&(Z=":");const V=b.lng||this.language,ee=b.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((V==null?void 0:V.toLowerCase())==="cimode")return ee?P?{res:`${N}${Z}${l}`,usedKey:l,exactUsedKey:l,usedLng:V,usedNS:N,usedParams:this.getUsedParamsDetails(b)}:`${N}${Z}${l}`:P?{res:l,usedKey:l,exactUsedKey:l,usedLng:V,usedNS:N,usedParams:this.getUsedParamsDetails(b)}:l;const q=this.resolve(a,b);let _e=q==null?void 0:q.res;const fe=(q==null?void 0:q.usedKey)||l,Pe=(q==null?void 0:q.exactUsedKey)||l,Le=["[object Number]","[object Function]","[object RegExp]"],Me=b.joinArrays!==void 0?b.joinArrays:this.options.joinArrays,Se=!this.i18nFormat||this.i18nFormat.handleAsObject,De=b.count!==void 0&&!Ar(b.count),Ye=Rg.hasDefaultValue(b),ot=De?this.pluralResolver.getSuffix(V,b.count,b):"",lt=b.ordinal&&De?this.pluralResolver.getSuffix(V,b.count,{ordinal:!1}):"",ut=De&&!b.ordinal&&b.count===0,Je=ut&&b[`defaultValue${this.options.pluralSeparator}zero`]||b[`defaultValue${ot}`]||b[`defaultValue${lt}`]||b.defaultValue;let Ke=_e;Se&&!_e&&Ye&&(Ke=Je);const At=Dx(Ke),Rt=Object.prototype.toString.apply(Ke);if(Se&&Ke&&At&&Le.indexOf(Rt)<0&&!(Ar(Me)&&Array.isArray(Ke))){if(!b.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Mt=this.options.returnedObjectHandler?this.options.returnedObjectHandler(fe,Ke,{...b,ns:L}):`key '${l} (${this.language})' returned an object instead of string.`;return P?(q.res=Mt,q.usedParams=this.getUsedParamsDetails(b),q):Mt}if(w){const Mt=Array.isArray(Ke),Ht=Mt?[]:{},zr=Mt?Pe:fe;for(const or in Ke)if(Object.prototype.hasOwnProperty.call(Ke,or)){const Zt=`${zr}${w}${or}`;Ye&&!_e?Ht[or]=this.translate(Zt,{...b,defaultValue:Dx(Je)?Je[or]:void 0,joinArrays:!1,ns:L}):Ht[or]=this.translate(Zt,{...b,joinArrays:!1,ns:L}),Ht[or]===Zt&&(Ht[or]=Ke[or])}_e=Ht}}else if(Se&&Ar(Me)&&Array.isArray(_e))_e=_e.join(Me),_e&&(_e=this.extendTranslation(_e,a,b,m));else{let Mt=!1,Ht=!1;!this.isValidLookup(_e)&&Ye&&(Mt=!0,_e=Je),this.isValidLookup(_e)||(Ht=!0,_e=l);const or=(b.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Ht?void 0:_e,Zt=Ye&&Je!==_e&&this.options.updateMissing;if(Ht||Mt||Zt){if(this.logger.log(Zt?"updateKey":"missingKey",V,N,l,Zt?Je:_e),w){const Ie=this.resolve(l,{...b,keySeparator:!1});Ie&&Ie.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let _t=[];const ft=this.languageUtils.getFallbackCodes(this.options.fallbackLng,b.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ft&&ft[0])for(let Ie=0;Ie<ft.length;Ie++)_t.push(ft[Ie]);else this.options.saveMissingTo==="all"?_t=this.languageUtils.toResolveHierarchy(b.lng||this.language):_t.push(b.lng||this.language);const Ct=(Ie,Qe,jt)=>{var fr;const tr=Ye&&jt!==_e?jt:or;this.options.missingKeyHandler?this.options.missingKeyHandler(Ie,N,Qe,tr,Zt,b):(fr=this.backendConnector)!=null&&fr.saveMissing&&this.backendConnector.saveMissing(Ie,N,Qe,tr,Zt,b),this.emit("missingKey",Ie,N,Qe,_e)};this.options.saveMissing&&(this.options.saveMissingPlurals&&De?_t.forEach(Ie=>{const Qe=this.pluralResolver.getSuffixes(Ie,b);ut&&b[`defaultValue${this.options.pluralSeparator}zero`]&&Qe.indexOf(`${this.options.pluralSeparator}zero`)<0&&Qe.push(`${this.options.pluralSeparator}zero`),Qe.forEach(jt=>{Ct([Ie],l+jt,b[`defaultValue${jt}`]||Je)})}):Ct(_t,l,Je))}_e=this.extendTranslation(_e,a,b,q,m),Ht&&_e===l&&this.options.appendNamespaceToMissingKey&&(_e=`${N}${Z}${l}`),(Ht||Mt)&&this.options.parseMissingKeyHandler&&(_e=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${N}${Z}${l}`:l,Mt?_e:void 0,b))}return P?(q.res=_e,q.usedParams=this.getUsedParamsDetails(b),q):_e}extendTranslation(a,u,m,b,P){var L,N;if((L=this.i18nFormat)!=null&&L.parse)a=this.i18nFormat.parse(a,{...this.options.interpolation.defaultVariables,...m},m.lng||this.language||b.usedLng,b.usedNS,b.usedKey,{resolved:b});else if(!m.skipInterpolation){m.interpolation&&this.interpolator.init({...m,interpolation:{...this.options.interpolation,...m.interpolation}});const Z=Ar(a)&&(((N=m==null?void 0:m.interpolation)==null?void 0:N.skipOnVariables)!==void 0?m.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let V;if(Z){const q=a.match(this.interpolator.nestingRegexp);V=q&&q.length}let ee=m.replace&&!Ar(m.replace)?m.replace:m;if(this.options.interpolation.defaultVariables&&(ee={...this.options.interpolation.defaultVariables,...ee}),a=this.interpolator.interpolate(a,ee,m.lng||this.language||b.usedLng,m),Z){const q=a.match(this.interpolator.nestingRegexp),_e=q&&q.length;V<_e&&(m.nest=!1)}!m.lng&&b&&b.res&&(m.lng=this.language||b.usedLng),m.nest!==!1&&(a=this.interpolator.nest(a,(...q)=>(P==null?void 0:P[0])===q[0]&&!m.context?(this.logger.warn(`It seems you are nesting recursively key: ${q[0]} in key: ${u[0]}`),null):this.translate(...q,u),m)),m.interpolation&&this.interpolator.reset()}const w=m.postProcess||this.options.postProcess,l=Ar(w)?[w]:w;return a!=null&&(l!=null&&l.length)&&m.applyPostProcessor!==!1&&(a=jb.handle(l,a,u,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...b,usedParams:this.getUsedParamsDetails(m)},...m}:m,this)),a}resolve(a,u={}){let m,b,P,w,l;return Ar(a)&&(a=[a]),a.forEach(L=>{if(this.isValidLookup(m))return;const N=this.extractFromKey(L,u),Z=N.key;b=Z;let V=N.namespaces;this.options.fallbackNS&&(V=V.concat(this.options.fallbackNS));const ee=u.count!==void 0&&!Ar(u.count),q=ee&&!u.ordinal&&u.count===0,_e=u.context!==void 0&&(Ar(u.context)||typeof u.context=="number")&&u.context!=="",fe=u.lngs?u.lngs:this.languageUtils.toResolveHierarchy(u.lng||this.language,u.fallbackLng);V.forEach(Pe=>{var Le,Me;this.isValidLookup(m)||(l=Pe,!zx[`${fe[0]}-${Pe}`]&&((Le=this.utils)!=null&&Le.hasLoadedNamespace)&&!((Me=this.utils)!=null&&Me.hasLoadedNamespace(l))&&(zx[`${fe[0]}-${Pe}`]=!0,this.logger.warn(`key "${b}" for languages "${fe.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),fe.forEach(Se=>{var ot;if(this.isValidLookup(m))return;w=Se;const De=[Z];if((ot=this.i18nFormat)!=null&&ot.addLookupKeys)this.i18nFormat.addLookupKeys(De,Z,Se,Pe,u);else{let lt;ee&&(lt=this.pluralResolver.getSuffix(Se,u.count,u));const ut=`${this.options.pluralSeparator}zero`,Je=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(ee&&(u.ordinal&&lt.indexOf(Je)===0&&De.push(Z+lt.replace(Je,this.options.pluralSeparator)),De.push(Z+lt),q&&De.push(Z+ut)),_e){const Ke=`${Z}${this.options.contextSeparator||"_"}${u.context}`;De.push(Ke),ee&&(u.ordinal&&lt.indexOf(Je)===0&&De.push(Ke+lt.replace(Je,this.options.pluralSeparator)),De.push(Ke+lt),q&&De.push(Ke+ut))}}let Ye;for(;Ye=De.pop();)this.isValidLookup(m)||(P=Ye,m=this.getResource(Se,Pe,Ye,u))}))})}),{res:m,usedKey:b,exactUsedKey:P,usedLng:w,usedNS:l}}isValidLookup(a){return a!==void 0&&!(!this.options.returnNull&&a===null)&&!(!this.options.returnEmptyString&&a==="")}getResource(a,u,m,b={}){var P;return(P=this.i18nFormat)!=null&&P.getResource?this.i18nFormat.getResource(a,u,m,b):this.resourceStore.getResource(a,u,m,b)}getUsedParamsDetails(a={}){const u=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],m=a.replace&&!Ar(a.replace);let b=m?a.replace:a;if(m&&typeof a.count<"u"&&(b.count=a.count),this.options.interpolation.defaultVariables&&(b={...this.options.interpolation.defaultVariables,...b}),!m){b={...b};for(const P of u)delete b[P]}return b}static hasDefaultValue(a){const u="defaultValue";for(const m in a)if(Object.prototype.hasOwnProperty.call(a,m)&&u===m.substring(0,u.length)&&a[m]!==void 0)return!0;return!1}}class Lx{constructor(a){this.options=a,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ac.create("languageUtils")}getScriptPartFromCode(a){if(a=nm(a),!a||a.indexOf("-")<0)return null;const u=a.split("-");return u.length===2||(u.pop(),u[u.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(u.join("-"))}getLanguagePartFromCode(a){if(a=nm(a),!a||a.indexOf("-")<0)return a;const u=a.split("-");return this.formatLanguageCode(u[0])}formatLanguageCode(a){if(Ar(a)&&a.indexOf("-")>-1){let u;try{u=Intl.getCanonicalLocales(a)[0]}catch{}return u&&this.options.lowerCaseLng&&(u=u.toLowerCase()),u||(this.options.lowerCaseLng?a.toLowerCase():a)}return this.options.cleanCode||this.options.lowerCaseLng?a.toLowerCase():a}isSupportedCode(a){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(a=this.getLanguagePartFromCode(a)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(a)>-1}getBestMatchFromCodes(a){if(!a)return null;let u;return a.forEach(m=>{if(u)return;const b=this.formatLanguageCode(m);(!this.options.supportedLngs||this.isSupportedCode(b))&&(u=b)}),!u&&this.options.supportedLngs&&a.forEach(m=>{if(u)return;const b=this.getScriptPartFromCode(m);if(this.isSupportedCode(b))return u=b;const P=this.getLanguagePartFromCode(m);if(this.isSupportedCode(P))return u=P;u=this.options.supportedLngs.find(w=>{if(w===P)return w;if(!(w.indexOf("-")<0&&P.indexOf("-")<0)&&(w.indexOf("-")>0&&P.indexOf("-")<0&&w.substring(0,w.indexOf("-"))===P||w.indexOf(P)===0&&P.length>1))return w})}),u||(u=this.getFallbackCodes(this.options.fallbackLng)[0]),u}getFallbackCodes(a,u){if(!a)return[];if(typeof a=="function"&&(a=a(u)),Ar(a)&&(a=[a]),Array.isArray(a))return a;if(!u)return a.default||[];let m=a[u];return m||(m=a[this.getScriptPartFromCode(u)]),m||(m=a[this.formatLanguageCode(u)]),m||(m=a[this.getLanguagePartFromCode(u)]),m||(m=a.default),m||[]}toResolveHierarchy(a,u){const m=this.getFallbackCodes((u===!1?[]:u)||this.options.fallbackLng||[],a),b=[],P=w=>{w&&(this.isSupportedCode(w)?b.push(w):this.logger.warn(`rejecting language code not found in supportedLngs: ${w}`))};return Ar(a)&&(a.indexOf("-")>-1||a.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&P(this.formatLanguageCode(a)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&P(this.getScriptPartFromCode(a)),this.options.load!=="currentOnly"&&P(this.getLanguagePartFromCode(a))):Ar(a)&&P(this.formatLanguageCode(a)),m.forEach(w=>{b.indexOf(w)<0&&P(this.formatLanguageCode(w))}),b}}const Fx={zero:0,one:1,two:2,few:3,many:4,other:5},Ox={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class mT{constructor(a,u={}){this.languageUtils=a,this.options=u,this.logger=ac.create("pluralResolver"),this.pluralRulesCache={}}addRule(a,u){this.rules[a]=u}clearCache(){this.pluralRulesCache={}}getRule(a,u={}){const m=nm(a==="dev"?"en":a),b=u.ordinal?"ordinal":"cardinal",P=JSON.stringify({cleanedCode:m,type:b});if(P in this.pluralRulesCache)return this.pluralRulesCache[P];let w;try{w=new Intl.PluralRules(m,{type:b})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Ox;if(!a.match(/-|_/))return Ox;const L=this.languageUtils.getLanguagePartFromCode(a);w=this.getRule(L,u)}return this.pluralRulesCache[P]=w,w}needsPlural(a,u={}){let m=this.getRule(a,u);return m||(m=this.getRule("dev",u)),(m==null?void 0:m.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(a,u,m={}){return this.getSuffixes(a,m).map(b=>`${u}${b}`)}getSuffixes(a,u={}){let m=this.getRule(a,u);return m||(m=this.getRule("dev",u)),m?m.resolvedOptions().pluralCategories.sort((b,P)=>Fx[b]-Fx[P]).map(b=>`${this.options.prepend}${u.ordinal?`ordinal${this.options.prepend}`:""}${b}`):[]}getSuffix(a,u,m={}){const b=this.getRule(a,m);return b?`${this.options.prepend}${m.ordinal?`ordinal${this.options.prepend}`:""}${b.select(u)}`:(this.logger.warn(`no plural rule found for: ${a}`),this.getSuffix("dev",u,m))}}const jx=(r,a,u,m=".",b=!0)=>{let P=aT(r,a,u);return!P&&b&&Ar(u)&&(P=g_(r,u,m),P===void 0&&(P=g_(a,u,m))),P},Fy=r=>r.replace(/\$/g,"$$$$");class gT{constructor(a={}){var u;this.logger=ac.create("interpolator"),this.options=a,this.format=((u=a==null?void 0:a.interpolation)==null?void 0:u.format)||(m=>m),this.init(a)}init(a={}){a.interpolation||(a.interpolation={escapeValue:!0});const{escape:u,escapeValue:m,useRawValueToEscape:b,prefix:P,prefixEscaped:w,suffix:l,suffixEscaped:L,formatSeparator:N,unescapeSuffix:Z,unescapePrefix:V,nestingPrefix:ee,nestingPrefixEscaped:q,nestingSuffix:_e,nestingSuffixEscaped:fe,nestingOptionsSeparator:Pe,maxReplaces:Le,alwaysFormat:Me}=a.interpolation;this.escape=u!==void 0?u:lT,this.escapeValue=m!==void 0?m:!0,this.useRawValueToEscape=b!==void 0?b:!1,this.prefix=P?Tf(P):w||"{{",this.suffix=l?Tf(l):L||"}}",this.formatSeparator=N||",",this.unescapePrefix=Z?"":V||"-",this.unescapeSuffix=this.unescapePrefix?"":Z||"",this.nestingPrefix=ee?Tf(ee):q||Tf("$t("),this.nestingSuffix=_e?Tf(_e):fe||Tf(")"),this.nestingOptionsSeparator=Pe||",",this.maxReplaces=Le||1e3,this.alwaysFormat=Me!==void 0?Me:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const a=(u,m)=>(u==null?void 0:u.source)===m?(u.lastIndex=0,u):new RegExp(m,"g");this.regexp=a(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=a(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=a(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(a,u,m,b){var q;let P,w,l;const L=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},N=_e=>{if(_e.indexOf(this.formatSeparator)<0){const Me=jx(u,L,_e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(Me,void 0,m,{...b,...u,interpolationkey:_e}):Me}const fe=_e.split(this.formatSeparator),Pe=fe.shift().trim(),Le=fe.join(this.formatSeparator).trim();return this.format(jx(u,L,Pe,this.options.keySeparator,this.options.ignoreJSONStructure),Le,m,{...b,...u,interpolationkey:Pe})};this.resetRegExp();const Z=(b==null?void 0:b.missingInterpolationHandler)||this.options.missingInterpolationHandler,V=((q=b==null?void 0:b.interpolation)==null?void 0:q.skipOnVariables)!==void 0?b.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:_e=>Fy(_e)},{regex:this.regexp,safeValue:_e=>this.escapeValue?Fy(this.escape(_e)):Fy(_e)}].forEach(_e=>{for(l=0;P=_e.regex.exec(a);){const fe=P[1].trim();if(w=N(fe),w===void 0)if(typeof Z=="function"){const Le=Z(a,P,b);w=Ar(Le)?Le:""}else if(b&&Object.prototype.hasOwnProperty.call(b,fe))w="";else if(V){w=P[0];continue}else this.logger.warn(`missed to pass in variable ${fe} for interpolating ${a}`),w="";else!Ar(w)&&!this.useRawValueToEscape&&(w=Ex(w));const Pe=_e.safeValue(w);if(a=a.replace(P[0],Pe),V?(_e.regex.lastIndex+=w.length,_e.regex.lastIndex-=P[0].length):_e.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),a}nest(a,u,m={}){let b,P,w;const l=(L,N)=>{const Z=this.nestingOptionsSeparator;if(L.indexOf(Z)<0)return L;const V=L.split(new RegExp(`${Z}[ ]*{`));let ee=`{${V[1]}`;L=V[0],ee=this.interpolate(ee,w);const q=ee.match(/'/g),_e=ee.match(/"/g);(((q==null?void 0:q.length)??0)%2===0&&!_e||_e.length%2!==0)&&(ee=ee.replace(/'/g,'"'));try{w=JSON.parse(ee),N&&(w={...N,...w})}catch(fe){return this.logger.warn(`failed parsing options string in nesting for key ${L}`,fe),`${L}${Z}${ee}`}return w.defaultValue&&w.defaultValue.indexOf(this.prefix)>-1&&delete w.defaultValue,L};for(;b=this.nestingRegexp.exec(a);){let L=[];w={...m},w=w.replace&&!Ar(w.replace)?w.replace:w,w.applyPostProcessor=!1,delete w.defaultValue;const N=/{.*}/.test(b[1])?b[1].lastIndexOf("}")+1:b[1].indexOf(this.formatSeparator);if(N!==-1&&(L=b[1].slice(N).split(this.formatSeparator).map(Z=>Z.trim()).filter(Boolean),b[1]=b[1].slice(0,N)),P=u(l.call(this,b[1].trim(),w),w),P&&b[0]===a&&!Ar(P))return P;Ar(P)||(P=Ex(P)),P||(this.logger.warn(`missed to resolve ${b[1]} for nesting ${a}`),P=""),L.length&&(P=L.reduce((Z,V)=>this.format(Z,V,m.lng,{...m,interpolationkey:b[1].trim()}),P.trim())),a=a.replace(b[0],P),this.regexp.lastIndex=0}return a}}const yT=r=>{let a=r.toLowerCase().trim();const u={};if(r.indexOf("(")>-1){const m=r.split("(");a=m[0].toLowerCase().trim();const b=m[1].substring(0,m[1].length-1);a==="currency"&&b.indexOf(":")<0?u.currency||(u.currency=b.trim()):a==="relativetime"&&b.indexOf(":")<0?u.range||(u.range=b.trim()):b.split(";").forEach(w=>{if(w){const[l,...L]=w.split(":"),N=L.join(":").trim().replace(/^'+|'+$/g,""),Z=l.trim();u[Z]||(u[Z]=N),N==="false"&&(u[Z]=!1),N==="true"&&(u[Z]=!0),isNaN(N)||(u[Z]=parseInt(N,10))}})}return{formatName:a,formatOptions:u}},Nx=r=>{const a={};return(u,m,b)=>{let P=b;b&&b.interpolationkey&&b.formatParams&&b.formatParams[b.interpolationkey]&&b[b.interpolationkey]&&(P={...P,[b.interpolationkey]:void 0});const w=m+JSON.stringify(P);let l=a[w];return l||(l=r(nm(m),b),a[w]=l),l(u)}},_T=r=>(a,u,m)=>r(nm(u),m)(a);class vT{constructor(a={}){this.logger=ac.create("formatter"),this.options=a,this.init(a)}init(a,u={interpolation:{}}){this.formatSeparator=u.interpolation.formatSeparator||",";const m=u.cacheInBuiltFormats?Nx:_T;this.formats={number:m((b,P)=>{const w=new Intl.NumberFormat(b,{...P});return l=>w.format(l)}),currency:m((b,P)=>{const w=new Intl.NumberFormat(b,{...P,style:"currency"});return l=>w.format(l)}),datetime:m((b,P)=>{const w=new Intl.DateTimeFormat(b,{...P});return l=>w.format(l)}),relativetime:m((b,P)=>{const w=new Intl.RelativeTimeFormat(b,{...P});return l=>w.format(l,P.range||"day")}),list:m((b,P)=>{const w=new Intl.ListFormat(b,{...P});return l=>w.format(l)})}}add(a,u){this.formats[a.toLowerCase().trim()]=u}addCached(a,u){this.formats[a.toLowerCase().trim()]=Nx(u)}format(a,u,m,b={}){const P=u.split(this.formatSeparator);if(P.length>1&&P[0].indexOf("(")>1&&P[0].indexOf(")")<0&&P.find(l=>l.indexOf(")")>-1)){const l=P.findIndex(L=>L.indexOf(")")>-1);P[0]=[P[0],...P.splice(1,l)].join(this.formatSeparator)}return P.reduce((l,L)=>{var V;const{formatName:N,formatOptions:Z}=yT(L);if(this.formats[N]){let ee=l;try{const q=((V=b==null?void 0:b.formatParams)==null?void 0:V[b.interpolationkey])||{},_e=q.locale||q.lng||b.locale||b.lng||m;ee=this.formats[N](l,_e,{...Z,...b,...q})}catch(q){this.logger.warn(q)}return ee}else this.logger.warn(`there was no format function for ${N}`);return l},a)}}const xT=(r,a)=>{r.pending[a]!==void 0&&(delete r.pending[a],r.pendingCount--)};class bT extends qg{constructor(a,u,m,b={}){var P,w;super(),this.backend=a,this.store=u,this.services=m,this.languageUtils=m.languageUtils,this.options=b,this.logger=ac.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=b.maxParallelReads||10,this.readingCalls=0,this.maxRetries=b.maxRetries>=0?b.maxRetries:5,this.retryTimeout=b.retryTimeout>=1?b.retryTimeout:350,this.state={},this.queue=[],(w=(P=this.backend)==null?void 0:P.init)==null||w.call(P,m,b.backend,b)}queueLoad(a,u,m,b){const P={},w={},l={},L={};return a.forEach(N=>{let Z=!0;u.forEach(V=>{const ee=`${N}|${V}`;!m.reload&&this.store.hasResourceBundle(N,V)?this.state[ee]=2:this.state[ee]<0||(this.state[ee]===1?w[ee]===void 0&&(w[ee]=!0):(this.state[ee]=1,Z=!1,w[ee]===void 0&&(w[ee]=!0),P[ee]===void 0&&(P[ee]=!0),L[V]===void 0&&(L[V]=!0)))}),Z||(l[N]=!0)}),(Object.keys(P).length||Object.keys(w).length)&&this.queue.push({pending:w,pendingCount:Object.keys(w).length,loaded:{},errors:[],callback:b}),{toLoad:Object.keys(P),pending:Object.keys(w),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(L)}}loaded(a,u,m){const b=a.split("|"),P=b[0],w=b[1];u&&this.emit("failedLoading",P,w,u),!u&&m&&this.store.addResourceBundle(P,w,m,void 0,void 0,{skipCopy:!0}),this.state[a]=u?-1:2,u&&m&&(this.state[a]=0);const l={};this.queue.forEach(L=>{sT(L.loaded,[P],w),xT(L,a),u&&L.errors.push(u),L.pendingCount===0&&!L.done&&(Object.keys(L.loaded).forEach(N=>{l[N]||(l[N]={});const Z=L.loaded[N];Z.length&&Z.forEach(V=>{l[N][V]===void 0&&(l[N][V]=!0)})}),L.done=!0,L.errors.length?L.callback(L.errors):L.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(L=>!L.done)}read(a,u,m,b=0,P=this.retryTimeout,w){if(!a.length)return w(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:a,ns:u,fcName:m,tried:b,wait:P,callback:w});return}this.readingCalls++;const l=(N,Z)=>{if(this.readingCalls--,this.waitingReads.length>0){const V=this.waitingReads.shift();this.read(V.lng,V.ns,V.fcName,V.tried,V.wait,V.callback)}if(N&&Z&&b<this.maxRetries){setTimeout(()=>{this.read.call(this,a,u,m,b+1,P*2,w)},P);return}w(N,Z)},L=this.backend[m].bind(this.backend);if(L.length===2){try{const N=L(a,u);N&&typeof N.then=="function"?N.then(Z=>l(null,Z)).catch(l):l(null,N)}catch(N){l(N)}return}return L(a,u,l)}prepareLoading(a,u,m={},b){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),b&&b();Ar(a)&&(a=this.languageUtils.toResolveHierarchy(a)),Ar(u)&&(u=[u]);const P=this.queueLoad(a,u,m,b);if(!P.toLoad.length)return P.pending.length||b(),null;P.toLoad.forEach(w=>{this.loadOne(w)})}load(a,u,m){this.prepareLoading(a,u,{},m)}reload(a,u,m){this.prepareLoading(a,u,{reload:!0},m)}loadOne(a,u=""){const m=a.split("|"),b=m[0],P=m[1];this.read(b,P,"read",void 0,void 0,(w,l)=>{w&&this.logger.warn(`${u}loading namespace ${P} for language ${b} failed`,w),!w&&l&&this.logger.log(`${u}loaded namespace ${P} for language ${b}`,l),this.loaded(a,w,l)})}saveMissing(a,u,m,b,P,w={},l=()=>{}){var L,N,Z,V,ee;if((N=(L=this.services)==null?void 0:L.utils)!=null&&N.hasLoadedNamespace&&!((V=(Z=this.services)==null?void 0:Z.utils)!=null&&V.hasLoadedNamespace(u))){this.logger.warn(`did not save key "${m}" as the namespace "${u}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(m==null||m==="")){if((ee=this.backend)!=null&&ee.create){const q={...w,isUpdate:P},_e=this.backend.create.bind(this.backend);if(_e.length<6)try{let fe;_e.length===5?fe=_e(a,u,m,b,q):fe=_e(a,u,m,b),fe&&typeof fe.then=="function"?fe.then(Pe=>l(null,Pe)).catch(l):l(null,fe)}catch(fe){l(fe)}else _e(a,u,m,b,l,q)}!a||!a[0]||this.store.addResource(a[0],u,m,b)}}}const Bx=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let a={};if(typeof r[1]=="object"&&(a=r[1]),Ar(r[1])&&(a.defaultValue=r[1]),Ar(r[2])&&(a.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){const u=r[3]||r[2];Object.keys(u).forEach(m=>{a[m]=u[m]})}return a},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),$x=r=>{var a,u;return Ar(r.ns)&&(r.ns=[r.ns]),Ar(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),Ar(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((u=(a=r.supportedLngs)==null?void 0:a.indexOf)==null?void 0:u.call(a,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},fg=()=>{},wT=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(u=>{typeof r[u]=="function"&&(r[u]=r[u].bind(r))})};class im extends qg{constructor(a={},u){if(super(),this.options=$x(a),this.services={},this.logger=ac,this.modules={external:[]},wT(this),u&&!this.isInitialized&&!a.isClone){if(!this.options.initAsync)return this.init(a,u),this;setTimeout(()=>{this.init(a,u)},0)}}init(a={},u){this.isInitializing=!0,typeof a=="function"&&(u=a,a={}),a.defaultNS==null&&a.ns&&(Ar(a.ns)?a.defaultNS=a.ns:a.ns.indexOf("translation")<0&&(a.defaultNS=a.ns[0]));const m=Bx();this.options={...m,...this.options,...$x(a)},this.options.interpolation={...m.interpolation,...this.options.interpolation},a.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=a.keySeparator),a.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=a.nsSeparator);const b=N=>N?typeof N=="function"?new N:N:null;if(!this.options.isClone){this.modules.logger?ac.init(b(this.modules.logger),this.options):ac.init(null,this.options);let N;this.modules.formatter?N=this.modules.formatter:N=vT;const Z=new Lx(this.options);this.store=new Rx(this.options.resources,this.options);const V=this.services;V.logger=ac,V.resourceStore=this.store,V.languageUtils=Z,V.pluralResolver=new mT(Z,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==m.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),N&&(!this.options.interpolation.format||this.options.interpolation.format===m.interpolation.format)&&(V.formatter=b(N),V.formatter.init&&V.formatter.init(V,this.options),this.options.interpolation.format=V.formatter.format.bind(V.formatter)),V.interpolator=new gT(this.options),V.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},V.backendConnector=new bT(b(this.modules.backend),V.resourceStore,V,this.options),V.backendConnector.on("*",(q,..._e)=>{this.emit(q,..._e)}),this.modules.languageDetector&&(V.languageDetector=b(this.modules.languageDetector),V.languageDetector.init&&V.languageDetector.init(V,this.options.detection,this.options)),this.modules.i18nFormat&&(V.i18nFormat=b(this.modules.i18nFormat),V.i18nFormat.init&&V.i18nFormat.init(this)),this.translator=new Rg(this.services,this.options),this.translator.on("*",(q,..._e)=>{this.emit(q,..._e)}),this.modules.external.forEach(q=>{q.init&&q.init(this)})}if(this.format=this.options.interpolation.format,u||(u=fg),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const N=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);N.length>0&&N[0]!=="dev"&&(this.options.lng=N[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(N=>{this[N]=(...Z)=>this.store[N](...Z)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(N=>{this[N]=(...Z)=>(this.store[N](...Z),this)});const l=Vp(),L=()=>{const N=(Z,V)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(V),u(Z,V)};if(this.languages&&!this.isInitialized)return N(null,this.t.bind(this));this.changeLanguage(this.options.lng,N)};return this.options.resources||!this.options.initAsync?L():setTimeout(L,0),l}loadResources(a,u=fg){var P,w;let m=u;const b=Ar(a)?a:this.language;if(typeof a=="function"&&(m=a),!this.options.resources||this.options.partialBundledLanguages){if((b==null?void 0:b.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return m();const l=[],L=N=>{if(!N||N==="cimode")return;this.services.languageUtils.toResolveHierarchy(N).forEach(V=>{V!=="cimode"&&l.indexOf(V)<0&&l.push(V)})};b?L(b):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(Z=>L(Z)),(w=(P=this.options.preload)==null?void 0:P.forEach)==null||w.call(P,N=>L(N)),this.services.backendConnector.load(l,this.options.ns,N=>{!N&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),m(N)})}else m(null)}reloadResources(a,u,m){const b=Vp();return typeof a=="function"&&(m=a,a=void 0),typeof u=="function"&&(m=u,u=void 0),a||(a=this.languages),u||(u=this.options.ns),m||(m=fg),this.services.backendConnector.reload(a,u,P=>{b.resolve(),m(P)}),b}use(a){if(!a)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!a.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return a.type==="backend"&&(this.modules.backend=a),(a.type==="logger"||a.log&&a.warn&&a.error)&&(this.modules.logger=a),a.type==="languageDetector"&&(this.modules.languageDetector=a),a.type==="i18nFormat"&&(this.modules.i18nFormat=a),a.type==="postProcessor"&&jb.addPostProcessor(a),a.type==="formatter"&&(this.modules.formatter=a),a.type==="3rdParty"&&this.modules.external.push(a),this}setResolvedLanguage(a){if(!(!a||!this.languages)&&!(["cimode","dev"].indexOf(a)>-1)){for(let u=0;u<this.languages.length;u++){const m=this.languages[u];if(!(["cimode","dev"].indexOf(m)>-1)&&this.store.hasLanguageSomeTranslations(m)){this.resolvedLanguage=m;break}}!this.resolvedLanguage&&this.languages.indexOf(a)<0&&this.store.hasLanguageSomeTranslations(a)&&(this.resolvedLanguage=a,this.languages.unshift(a))}}changeLanguage(a,u){this.isLanguageChangingTo=a;const m=Vp();this.emit("languageChanging",a);const b=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},P=(l,L)=>{L?this.isLanguageChangingTo===a&&(b(L),this.translator.changeLanguage(L),this.isLanguageChangingTo=void 0,this.emit("languageChanged",L),this.logger.log("languageChanged",L)):this.isLanguageChangingTo=void 0,m.resolve((...N)=>this.t(...N)),u&&u(l,(...N)=>this.t(...N))},w=l=>{var Z,V;!a&&!l&&this.services.languageDetector&&(l=[]);const L=Ar(l)?l:l&&l[0],N=this.store.hasLanguageSomeTranslations(L)?L:this.services.languageUtils.getBestMatchFromCodes(Ar(l)?[l]:l);N&&(this.language||b(N),this.translator.language||this.translator.changeLanguage(N),(V=(Z=this.services.languageDetector)==null?void 0:Z.cacheUserLanguage)==null||V.call(Z,N)),this.loadResources(N,ee=>{P(ee,N)})};return!a&&this.services.languageDetector&&!this.services.languageDetector.async?w(this.services.languageDetector.detect()):!a&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(w):this.services.languageDetector.detect(w):w(a),m}getFixedT(a,u,m){const b=(P,w,...l)=>{let L;typeof w!="object"?L=this.options.overloadTranslationOptionHandler([P,w].concat(l)):L={...w},L.lng=L.lng||b.lng,L.lngs=L.lngs||b.lngs,L.ns=L.ns||b.ns,L.keyPrefix!==""&&(L.keyPrefix=L.keyPrefix||m||b.keyPrefix);const N=this.options.keySeparator||".";let Z;return L.keyPrefix&&Array.isArray(P)?Z=P.map(V=>(typeof V=="function"&&(V=y_(V,{...this.options,...w})),`${L.keyPrefix}${N}${V}`)):(typeof P=="function"&&(P=y_(P,{...this.options,...w})),Z=L.keyPrefix?`${L.keyPrefix}${N}${P}`:P),this.t(Z,L)};return Ar(a)?b.lng=a:b.lngs=a,b.ns=u,b.keyPrefix=m,b}t(...a){var u;return(u=this.translator)==null?void 0:u.translate(...a)}exists(...a){var u;return(u=this.translator)==null?void 0:u.exists(...a)}setDefaultNamespace(a){this.options.defaultNS=a}hasLoadedNamespace(a,u={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const m=u.lng||this.resolvedLanguage||this.languages[0],b=this.options?this.options.fallbackLng:!1,P=this.languages[this.languages.length-1];if(m.toLowerCase()==="cimode")return!0;const w=(l,L)=>{const N=this.services.backendConnector.state[`${l}|${L}`];return N===-1||N===0||N===2};if(u.precheck){const l=u.precheck(this,w);if(l!==void 0)return l}return!!(this.hasResourceBundle(m,a)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||w(m,a)&&(!b||w(P,a)))}loadNamespaces(a,u){const m=Vp();return this.options.ns?(Ar(a)&&(a=[a]),a.forEach(b=>{this.options.ns.indexOf(b)<0&&this.options.ns.push(b)}),this.loadResources(b=>{m.resolve(),u&&u(b)}),m):(u&&u(),Promise.resolve())}loadLanguages(a,u){const m=Vp();Ar(a)&&(a=[a]);const b=this.options.preload||[],P=a.filter(w=>b.indexOf(w)<0&&this.services.languageUtils.isSupportedCode(w));return P.length?(this.options.preload=b.concat(P),this.loadResources(w=>{m.resolve(),u&&u(w)}),m):(u&&u(),Promise.resolve())}dir(a){var b,P;if(a||(a=this.resolvedLanguage||(((b=this.languages)==null?void 0:b.length)>0?this.languages[0]:this.language)),!a)return"rtl";try{const w=new Intl.Locale(a);if(w&&w.getTextInfo){const l=w.getTextInfo();if(l&&l.direction)return l.direction}}catch{}const u=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],m=((P=this.services)==null?void 0:P.languageUtils)||new Lx(Bx());return a.toLowerCase().indexOf("-latn")>1?"ltr":u.indexOf(m.getLanguagePartFromCode(a))>-1||a.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(a={},u){return new im(a,u)}cloneInstance(a={},u=fg){const m=a.forkResourceStore;m&&delete a.forkResourceStore;const b={...this.options,...a,isClone:!0},P=new im(b);if((a.debug!==void 0||a.prefix!==void 0)&&(P.logger=P.logger.clone(a)),["store","services","language"].forEach(l=>{P[l]=this[l]}),P.services={...this.services},P.services.utils={hasLoadedNamespace:P.hasLoadedNamespace.bind(P)},m){const l=Object.keys(this.store.data).reduce((L,N)=>(L[N]={...this.store.data[N]},L[N]=Object.keys(L[N]).reduce((Z,V)=>(Z[V]={...L[N][V]},Z),L[N]),L),{});P.store=new Rx(l,b),P.services.resourceStore=P.store}return P.translator=new Rg(P.services,b),P.translator.on("*",(l,...L)=>{P.emit(l,...L)}),P.init(b,u),P.translator.options=b,P.translator.backendConnector.services.utils={hasLoadedNamespace:P.hasLoadedNamespace.bind(P)},P}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ki=im.createInstance();Ki.createInstance=im.createInstance;Ki.createInstance;Ki.dir;Ki.init;Ki.loadResources;Ki.reloadResources;Ki.use;Ki.changeLanguage;Ki.getFixedT;Ki.t;Ki.exists;Ki.setDefaultNamespace;Ki.hasLoadedNamespace;Ki.loadNamespaces;Ki.loadLanguages;const ST="BADA",TT="Badplatser",PT="Laddar badplatser",CT="Kunde inte ladda data.",kT="Tillbaka",ET="Vattenkvalitet",IT="Senaste r",MT="Koordinater",AT="Kommun",RT={excellent:"Utmrkt kvalitet",good:"Bra kvalitet",sufficient:"Tillfredsstllande kvalitet",poor:"Dlig kvalitet",unknown:"Oknd"},zT="Klltext p svenska",DT={menu:"Meny",language:"Sprk",searchPlaceholder:"Sk badplatser",clear:"Rensa",openMenu:"ppna meny",userMenu:"Anvndarmenyn",skipToMain:"Hoppa till huvudinnehllet",euBeaches:"EU-bad",inSweden:"i Sverige",viewAllResults:"Visa alla resultat p kartan"},LT={whatIsEUBeach:"Vad r en EU-badplats?",about:"Om BADA",terms:"Anvndarvillkor",contact:"Kontakt",favoriteBeaches:"Favoritbadplatser",profile:"Profil",settings:"Instllningar",logOut:"Logga ut",signIn:"Logga in",register:"Registrera",account:"KONTO",user:"ANVNDARE"},FT={signInTitle:"Logga in",registerTitle:"Registrera",email:"E-post",password:"Lsenord",confirmPassword:"Bekrfta lsenord",signIn:"Logga in",signInProgress:"Loggar in",register:"Registrera",registerProgress:"Registrerar",noAccount:"Inget konto?",registerHere:"Registrera hr",alreadyHaveAccount:"Har du redan ett konto?",signInHere:"Logga in hr",signInSuccess:"Inloggad!",registerSuccess:"Registrering lyckades! Logga in.",signInFailed:"Inloggning misslyckades",registerFailed:"Registrering misslyckades",emailRequired:"E-post krvs",passwordRequired:"Lsenord krvs",passwordTooShort:"Lsenordet mste vara minst 8 tecken",confirmPasswordRequired:"Bekrftelse av lsenord krvs",passwordsMustMatch:"Lsenorden mste matcha",invalidEmail:"Ogiltig e-postadress"},OT={title:"Dina favoritbadplatser",sortBy:"Sortera efter:",sortOptions:{custom:"Egen ordning (dra & slpp)",name:"Namn (A)",municipality:"Kommun (A)"},browseAll:"Blddra bland alla badplatser",empty:"Du har inga favoritbadplatser nnu",addFavorites:"Lgg till favoriter frn badplatskartan",view:"Visa",remove:"Ta bort",dragToReorder:"Dra fr att ndra ordning",added:"Tillagd som favorit",removed:"Borttagen frn favoriter"},jT={addFavorite:"Lgg till favorit",removeFavorite:"Ta bort favorit",added:"Tillagd som favorit",removed:"Borttagen frn favoriter",bathInformation:"Om badplatsen",latestSampleDate:"Senaste provtagning",beach:"Badplats",algalBloom:"Algblomning",euMotive:"EU-motivering",nutsCode:"NUTS-kod",mail:"E-post:",phone:"Telefon:",website:"Webbplats:",pleaseTryAgain:"Vnligen frsk igen.",euBad:"EU-bad"},NT={modeDefault:"Visa alla",modeNearby:"Nra mig",modeViewport:"Visa i fnster",gettingLocation:"Hmtar position",locationError:"Kunde inte hitta din position",requestLocation:"Anvnd min position",noBeachesFound:"Inga badplatser hittades",emptyState:"Prova att ndra skfilter",loadError:"Kunde inte ladda badplatser.",pleaseRetry:"Vnligen frsk igen.",retry:"Frsk igen",noMatches:"Inga trffar hr.",panOrZoom:"Panorera eller zooma till ett annat omrde.",widenRadius:"Prova att ka skradien."},BT={darkOn:"Mrkt tema: p",darkOff:"Mrkt tema: av"},$T={about:{title:"Om BADA",whatIsBADA:"Vad r BADA?",whatIsBADADesc:"BADA hjlper badgster och familjer i Sverige att hitta skra, EU-klassade badvatten med uppdateringar i realtid. Vi erstter inaktuella eller tunga webbplatser med en ren, mobilanpassad upplevelse.",whatIsBADAMission:"Vrt uppdrag r att gra vattenkvalitetsinformation tillgnglig fr alla, och hjlpa dig att fatta informerade beslut om var du ska simma och njuta av Sveriges vackra kustvatten.",dataSource:"Dataklla",dataSourceDesc:"BADA anvnder officiell data frn Havs- och Vattenmyndigheten (HaV), som vervakar och klassar EU-badplatser ver hela Sverige.",dataSourceDirective:"Vattenkvalitetsklassningar baseras p EU:s badvattendirektiv och uppdateras regelbundet under badssongen.",features:"Funktioner",featureMap:" Interaktiv karta ver alla EU-klassade badplatser i Sverige",featureLocation:" Hitta nrmaste badplats baserat p din nuvarande plats",featureQuality:" Se vattenkvalitet, klassning och senaste provresultat",featureFavorites:" Spara dina favoritbadplatser till din profil",featureDarkMode:" Mrkt lge och responsiv design",featureLang:" Flersprkigt std (Svenska / Engelska)",builtWith:"Byggd med",builtWithDesc:"BADA r byggd med React, TypeScript, Node.js, Express och MongoDB. Kartor drivs av MapLibre och OpenStreetMap. Se vr",builtWithDesc2:"fr mer information.",githubRepo:"GitHub-repository"},whatIsEUBeach:{title:"Vad r en EU-badplats?",directive:"EU:s badvattendirektiv",directiveDesc:"En EU-badplats r en strand eller del av en kust dr EU:s badvattendirektiv (2006/7/EG) gller. Detta direktiv krver att medlemsstaterna vervakar och regelbundet testar vattenkvaliteten vid utsedda badplatser.",directiveDesc2:"I Sverige vervakar Havs- och Vattenmyndigheten (HaV) dessa badplatser och klassar dem enligt vattenkvalitetsstandarder.",classifications:"Vattenkvalitetsklassningar",excellentDesc:"Bst vattenkvalitet. Vattnet uppfyller de hgsta standarderna med utmrkt mikrobiologisk kvalitet.",goodDesc:"Bra vattenkvalitet. Vattnet uppfyller standarderna med bra mikrobiologisk kvalitet.",sufficientDesc:"Tillfredsstllande vattenkvalitet. Vattnet uppfyller minimistandarderna.",poorDesc:"Dlig vattenkvalitet. Simning rekommenderas inte. Vattnet uppfyller inte minimistandarderna.",monitoring:"vervakning",monitoringDesc:"Vattenkvaliteten vervakas under hela badssongen (vanligtvis maj till september). Prover tas regelbundet och testas fr bakterier och andra froreningar som kan pverka mnniskors hlsa.",monitoringDesc2:"Klassningen baseras p data frn de senaste fyra badssongerna fr att ge en stabil och tillfrlitlig bedmning av vattenkvaliteten."},terms:{title:"Anvndarvillkor",acceptance:"Godknnande av villkor",acceptanceDesc:"Genom att anvnda BADA godknner du dessa anvndarvillkor. Om du inte hller med om ngon del av dessa villkor, vnligen anvnd inte vr tjnst.",service:"Tjnstebeskrivning",serviceDesc:"BADA tillhandahller information om EU-klassade badvatten i Sverige. Vi samlar data frn officiella kllor och presenterar den i ett tillgngligt format.",disclaimer:"Villkor",disclaimerDesc:"Vattenkvalitetsinformationen som tillhandahlls av BADA baseras p officiella data frn Havs- och Vattenmyndigheten. ven om vi strvar efter noggrannhet kan vi inte garantera fullstndigheten eller aktuellheten av all information.",disclaimerDesc2:'BADA tillhandahlls "som den r" utan garantier av ngot slag. Anvndare br anvnda sitt eget omdme och diskretion nr de anvnder denna information fr att fatta beslut om simning eller andra vattenaktiviteter.',accounts:"Anvndarkonton",accountsDesc:"Nr du skapar ett konto r du ansvarig fr att upprtthlla konfidentialiteten fr din kontoinformation och ditt lsenord. Du godknner att meddela oss omedelbart om obehrig anvndning av ditt konto.",ip:"Immateriella rttigheter",ipDesc:"BADA-applikationen och dess ursprungliga innehll, funktioner och funktionalitet gs av BADA-projektet och skyddas av internationella upphovsrtt, varumrke och andra immateriella lagar.",changes:"ndringar av villkor",changesDesc:"Vi frbehller oss rtten att ndra dessa villkor nr som helst. Vi kommer att meddela anvndare om betydande ndringar genom att publicera de nya villkoren p denna sida.",contact:"Kontakt",contactDesc:"Om du har frgor om dessa villkor, vnligen",contactUs:"kontakta oss"},contact:{title:"Kontakt",getInTouch:"Hr av dig",getInTouchDesc:"Vi skulle grna hra frn dig! Om du har feedback, frslag, frgor eller hittat en bugg, tveka inte att kontakta oss.",github:"GitHub",githubDesc:"Fr buggrapporter, funktionsfrfrgningar eller kodbidrag, besk vr",githubRepo:"GitHub-repository",feedback:"Problem & Feedback",feedbackDesc:"Om du stter p ngra problem med applikationen eller har frslag p frbttringar, ppna grna ett issue p GitHub. Din feedback hjlper oss att gra BADA bttre.",accuracy:"Datan noggrannhet",accuracyDesc:"Om du mrker ngra felaktigheter i vattenkvalitetsdata eller badplatsinformation, lt oss veta. Vi frlitar oss p officiella kllor, men fel kan uppst och vi kommer att arbeta fr att korrigera dem snabbt.",privacy:"Integritet",privacyDesc:"Fr frgor om integritet och datahantering, se vra anvndarvillkor eller kontakta oss via GitHub."},profile:{title:"Din profil"},settings:{title:"Instllningar",language:"Sprk",languageDescription:"Vlj ditt sprk"},backToMap:" Tillbaka till kartan"},UT={title:"Hoppsan! Ngot gick fel",message:"Vi sttte p ett ovntat fel. Vnligen frsk uppdatera sidan eller tervnd till startsidan.",technicalDetails:"Tekniska detaljer",reloadPage:"Ladda om sidan",goHome:"G till startsidan"},VT={appTitle:ST,beaches:TT,loadingBeaches:PT,loadError:CT,back:kT,waterQuality:ET,latestYear:IT,coordinates:MT,municipality:AT,classification:RT,sourceTextNote:zT,header:DT,nav:LT,auth:FT,favorites:OT,beachDetail:jT,beachesList:NT,theme:BT,pages:$T,errorBoundary:UT},ZT="BADA",GT="Beaches",qT="Loading beaches",WT="Could not load data.",HT="Back",KT="Water quality",XT="Latest year",YT="Coordinates",QT="Municipality",JT={excellent:"Excellent",good:"Good",sufficient:"Sufficient",poor:"Poor",unknown:"Unknown"},eP="Source text in Swedish",tP={menu:"Menu",language:"Language",searchPlaceholder:"Search beaches",clear:"Clear",openMenu:"Open menu",userMenu:"User menu",skipToMain:"Skip to main content",euBeaches:"EU Beaches",inSweden:"in Sweden",viewAllResults:"View all results on map"},rP={whatIsEUBeach:"What is an EU Beach?",about:"About BADA",terms:"Terms of Use",contact:"Contact",favoriteBeaches:"Favourite beaches",profile:"Profile",settings:"Settings",logOut:"Log out",signIn:"Sign in",register:"Register",account:"ACCOUNT",user:"USER"},nP={signInTitle:"Sign in",registerTitle:"Register",email:"Email",password:"Password",confirmPassword:"Confirm Password",signIn:"Sign in",signInProgress:"Signing in",register:"Register",registerProgress:"Registering",noAccount:"No account?",registerHere:"Register here",alreadyHaveAccount:"Already have an account?",signInHere:"Sign in here",signInSuccess:"Successfully signed in!",registerSuccess:"Registration successful! Please sign in.",signInFailed:"Login failed",registerFailed:"Registration failed",emailRequired:"Email is required",passwordRequired:"Password is required",passwordTooShort:"Password must be at least 8 characters",confirmPasswordRequired:"Confirm password is required",passwordsMustMatch:"Passwords must match",invalidEmail:"Invalid email address"},iP={title:"Your favorite beaches",sortBy:"Sort by:",sortOptions:{custom:"Custom (drag & drop)",name:"Name (AZ)",municipality:"Municipality (AZ)"},browseAll:"Browse all beaches",empty:"You have no favorite beaches yet",addFavorites:"Add favorites from the beach map",view:"View",remove:"Remove",dragToReorder:"Drag to reorder",added:"Added to favorites",removed:"Removed from favorites"},sP={addFavorite:"Add favorite",removeFavorite:"Remove favorite",added:"Added to favorites",removed:"Removed from favorites",bathInformation:"About this beach",latestSampleDate:"Latest sample",beach:"Beach",algalBloom:"Algal bloom",euMotive:"EU motive",nutsCode:"NUTS code",mail:"Mail:",phone:"Phone:",website:"Website:",pleaseTryAgain:"Please try again.",euBad:"EU Beach"},aP={modeDefault:"Show all",modeNearby:"Near me",modeViewport:"Show viewport",gettingLocation:"Getting location",locationError:"Could not get your location",requestLocation:"Use current location",noBeachesFound:"No beaches found",emptyState:"Try adjusting your search filters",loadError:"Could not load beaches.",pleaseRetry:"Please try again.",retry:"Retry",noMatches:"No matches here.",panOrZoom:"Pan or zoom to a different area.",widenRadius:"Try widening the radius."},oP={darkOn:"Dark theme: on",darkOff:"Dark theme: off"},lP={about:{title:"About BADA",whatIsBADA:"What is BADA?",whatIsBADADesc:"BADA helps beachgoers and families in Sweden find safe, EU-classified bathing waters with real-time quality updates. We replace outdated or clunky websites with a clean, mobile-friendly experience.",whatIsBADAMission:"Our mission is to make water quality information accessible to everyone, helping you make informed decisions about where to swim and enjoy Sweden's beautiful coastal waters.",dataSource:"Data Source",dataSourceDesc:"BADA uses official data from the Swedish Agency for Marine and Water Management (Havs- och Vattenmyndigheten, HaV), which monitors and classifies EU bathing waters across Sweden.",dataSourceDirective:"Water quality classifications are based on the European Bathing Water Directive and are updated regularly throughout the bathing season.",features:"Features",featureMap:" Interactive map of all EU-classified beaches in Sweden",featureLocation:" Find the nearest beach based on your current location",featureQuality:" View water quality, classification, and recent test results",featureFavorites:" Save your favorite beaches to your profile",featureDarkMode:" Dark mode and responsive design",featureLang:" Multi-language support (Swedish / English)",builtWith:"Built With",builtWithDesc:"BADA is built with React, TypeScript, Node.js, Express, and MongoDB. Maps are powered by MapLibre and OpenStreetMap. See our",builtWithDesc2:"for more details.",githubRepo:"GitHub repository"},whatIsEUBeach:{title:"What is an EU Beach?",directive:"EU Bathing Water Directive",directiveDesc:"An EU bathing water is a beach or section of a coastline where the European Union's Bathing Water Directive (2006/7/EC) applies. This directive requires member states to monitor and regularly test the water quality at designated bathing sites.",directiveDesc2:"In Sweden, the Swedish Agency for Marine and Water Management (HaV) monitors these beaches and classifies them according to water quality standards.",classifications:"Water Quality Classifications",excellentDesc:"Best water quality. The water meets the highest standards with excellent microbiological quality.",goodDesc:"Good water quality. The water meets the standards with good microbiological quality.",sufficientDesc:"Sufficient water quality. The water meets the minimum standards.",poorDesc:"Poor water quality. Swimming is not recommended. The water does not meet the minimum standards.",monitoring:"Monitoring",monitoringDesc:"Water quality is monitored throughout the bathing season (typically May to September). Samples are taken regularly and tested for bacteria and other contaminants that could affect human health.",monitoringDesc2:"The classification is based on data from the last four bathing seasons to provide a stable and reliable assessment of water quality."},terms:{title:"Terms of Use",acceptance:"Acceptance of Terms",acceptanceDesc:"By using BADA, you agree to these terms of use. If you do not agree with any part of these terms, please do not use our service.",service:"Service Description",serviceDesc:"BADA provides information about EU-classified bathing waters in Sweden. We aggregate data from official sources and present it in an accessible format.",disclaimer:"Disclaimer",disclaimerDesc:"The water quality information provided by BADA is based on official data from the Swedish Agency for Marine and Water Management. While we strive for accuracy, we cannot guarantee the completeness or timeliness of all information.",disclaimerDesc2:'BADA is provided "as is" without warranty of any kind. Users should exercise their own judgment and discretion when using this information to make decisions about swimming or other water activities.',accounts:"User Accounts",accountsDesc:"When you create an account, you are responsible for maintaining the confidentiality of your account information and password. You agree to notify us immediately of any unauthorized use of your account.",ip:"Intellectual Property",ipDesc:"The BADA application and its original content, features, and functionality are owned by the BADA project and are protected by international copyright, trademark, and other intellectual property laws.",changes:"Changes to Terms",changesDesc:"We reserve the right to modify these terms at any time. We will notify users of any significant changes by posting the new terms on this page.",contact:"Contact",contactDesc:"If you have questions about these terms, please",contactUs:"contact us"},contact:{title:"Contact",getInTouch:"Get in Touch",getInTouchDesc:"We'd love to hear from you! Whether you have feedback, suggestions, questions, or found a bug, please don't hesitate to reach out.",github:"GitHub",githubDesc:"For bug reports, feature requests, or code contributions, please visit our",githubRepo:"GitHub repository",feedback:"Issues & Feedback",feedbackDesc:"If you encounter any issues with the application or have suggestions for improvement, please open an issue on GitHub. Your feedback helps us make BADA better.",accuracy:"Data Accuracy",accuracyDesc:"If you notice any inaccuracies in the water quality data or beach information, please let us know. We rely on official sources, but errors can occur and we'll work to correct them promptly.",privacy:"Privacy",privacyDesc:"For questions about privacy and data handling, please see our terms of use or contact us through GitHub."},profile:{title:"Your Profile"},settings:{title:"Settings",language:"Language",languageDescription:"Select your language"},backToMap:" Back to map"},cP={title:"Oops! Something went wrong",message:"We encountered an unexpected error. Please try refreshing the page or return to the homepage.",technicalDetails:"Technical details",reloadPage:"Reload Page",goHome:"Go Home"},uP={appTitle:ZT,beaches:GT,loadingBeaches:qT,loadError:WT,back:HT,waterQuality:KT,latestYear:XT,coordinates:YT,municipality:QT,classification:JT,sourceTextNote:eP,header:tP,nav:rP,auth:nP,favorites:iP,beachDetail:sP,beachesList:aP,theme:oP,pages:lP,errorBoundary:cP},hP=localStorage.getItem("lang"),Bb="sv",dP=hP||Bb;Ki.use(fS).init({resources:{sv:{common:VT},en:{common:uP}},lng:dP,fallbackLng:Bb,ns:["common"],defaultNS:"common",interpolation:{escapeValue:!1}});class fP extends te.Component{constructor(){super(...arguments);Qv(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(u){return{hasError:!0,error:u}}componentDidCatch(u,m){console.error("ErrorBoundary caught an error:",u,m)}render(){if(this.state.hasError){const u=m=>Ki.t(m);return Y.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:Y.jsx("div",{className:"max-w-md w-full space-y-6",children:Y.jsxs("div",{className:"card p-8 text-center space-y-4",children:[Y.jsx("h1",{className:"font-spectral text-3xl text-red-600",children:u("errorBoundary.title")}),Y.jsx("p",{className:"text-ink-muted",children:u("errorBoundary.message")}),this.state.error&&Y.jsxs("details",{className:"text-left bg-surface p-3 rounded-lg overflow-auto",children:[Y.jsx("summary",{className:"cursor-pointer font-medium mb-2",children:u("errorBoundary.technicalDetails")}),Y.jsx("pre",{className:"text-xs text-ink-muted whitespace-pre-wrap",children:this.state.error.toString()})]}),Y.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[Y.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:u("errorBoundary.reloadPage")}),Y.jsx(ei,{to:"/",className:"px-4 py-2 rounded-lg border border-border hover:bg-surface-muted",children:u("errorBoundary.goHome")})]})]})})})}return this.props.children}}function pP(){const r=Oo();return bS()?Y.jsx(b2,{}):Y.jsx(x2,{to:"/login",replace:!0,state:{from:r}})}var Tg={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.1/LICENSE.txt
 */var mP=Tg.exports,Ux;function gP(){return Ux||(Ux=1,(function(r,a){(function(u,m){r.exports=m()})(mP,(function(){var u={},m={};function b(w,l,L){if(m[w]=L,w==="index"){var N="var sharedModule = {}; ("+m.shared+")(sharedModule); ("+m.worker+")(sharedModule);",Z={};return m.shared(Z),m.index(u,Z),typeof window<"u"&&u.setWorkerUrl(window.URL.createObjectURL(new Blob([N],{type:"text/javascript"}))),u}}b("shared",["exports"],(function(w){function l(i,t,n,c){return new(n||(n=Promise))((function(f,_){function v(M){try{k(c.next(M))}catch(A){_(A)}}function T(M){try{k(c.throw(M))}catch(A){_(A)}}function k(M){var A;M.done?f(M.value):(A=M.value,A instanceof n?A:new n((function(F){F(A)}))).then(v,T)}k((c=c.apply(i,t||[])).next())}))}function L(i,t){this.x=i,this.y=t}function N(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Z,V;typeof SuppressedError=="function"&&SuppressedError,L.prototype={clone(){return new L(this.x,this.y)},add(i){return this.clone()._add(i)},sub(i){return this.clone()._sub(i)},multByPoint(i){return this.clone()._multByPoint(i)},divByPoint(i){return this.clone()._divByPoint(i)},mult(i){return this.clone()._mult(i)},div(i){return this.clone()._div(i)},rotate(i){return this.clone()._rotate(i)},rotateAround(i,t){return this.clone()._rotateAround(i,t)},matMult(i){return this.clone()._matMult(i)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(i){return this.x===i.x&&this.y===i.y},dist(i){return Math.sqrt(this.distSqr(i))},distSqr(i){const t=i.x-this.x,n=i.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith(i){return this.angleWithSep(i.x,i.y)},angleWithSep(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult(i){const t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add(i){return this.x+=i.x,this.y+=i.y,this},_sub(i){return this.x-=i.x,this.y-=i.y,this},_mult(i){return this.x*=i,this.y*=i,this},_div(i){return this.x/=i,this.y/=i,this},_multByPoint(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint(i){return this.x/=i.x,this.y/=i.y,this},_unit(){return this._div(this.mag()),this},_perp(){const i=this.y;return this.y=this.x,this.x=-i,this},_rotate(i){const t=Math.cos(i),n=Math.sin(i),c=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=c,this},_rotateAround(i,t){const n=Math.cos(i),c=Math.sin(i),f=t.y+c*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-c*(this.y-t.y),this.y=f,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:L},L.convert=function(i){if(i instanceof L)return i;if(Array.isArray(i))return new L(+i[0],+i[1]);if(i.x!==void 0&&i.y!==void 0)return new L(+i.x,+i.y);throw new Error("Expected [x, y] or {x, y} point format")};var ee=(function(){if(V)return Z;function i(t,n,c,f){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(f-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=c,this.p2y=f}return V=1,Z=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,f=0;f<8;f++){var _=this.sampleCurveX(c)-t;if(Math.abs(_)<n)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=_/v}var T=0,k=1;for(c=t,f=0;f<20&&(_=this.sampleCurveX(c),!(Math.abs(_-t)<n));f++)t>_?T=c:k=c,c=.5*(k-T)+T;return c},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Z})(),q=N(ee);let _e,fe;function Pe(){return _e==null&&(_e=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),_e}function Le(){if(fe==null&&(fe=!1,Pe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let c=0;c<25;c++){const f=4*c;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(c%5,Math.floor(c/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let c=0;c<100;c++)if(c%4!=3&&n[c]!==c){fe=!0;break}}}return fe||!1}var Me=1e-6,Se=typeof Float32Array<"u"?Float32Array:Array;function De(){var i=new Se(9);return Se!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Ye(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ot(){var i=new Se(3);return Se!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function lt(i){var t=i[0],n=i[1],c=i[2];return Math.sqrt(t*t+n*n+c*c)}function ut(i,t,n){var c=new Se(3);return c[0]=i,c[1]=t,c[2]=n,c}function Je(i,t,n){return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i}function Ke(i,t,n){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i}function At(i,t,n){var c=t[0],f=t[1],_=t[2],v=n[0],T=n[1],k=n[2];return i[0]=f*k-_*T,i[1]=_*v-c*k,i[2]=c*T-f*v,i}var Rt,Mt=lt;function Ht(i,t,n){var c=t[0],f=t[1],_=t[2],v=t[3];return i[0]=n[0]*c+n[4]*f+n[8]*_+n[12]*v,i[1]=n[1]*c+n[5]*f+n[9]*_+n[13]*v,i[2]=n[2]*c+n[6]*f+n[10]*_+n[14]*v,i[3]=n[3]*c+n[7]*f+n[11]*_+n[15]*v,i}function zr(){var i=new Se(4);return Se!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function or(i,t,n,c){var f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;t*=_,c*=_,n*=_;var v=Math.sin(t),T=Math.cos(t),k=Math.sin(n),M=Math.cos(n),A=Math.sin(c),F=Math.cos(c);switch(f){case"xyz":i[0]=v*M*F+T*k*A,i[1]=T*k*F-v*M*A,i[2]=T*M*A+v*k*F,i[3]=T*M*F-v*k*A;break;case"xzy":i[0]=v*M*F-T*k*A,i[1]=T*k*F-v*M*A,i[2]=T*M*A+v*k*F,i[3]=T*M*F+v*k*A;break;case"yxz":i[0]=v*M*F+T*k*A,i[1]=T*k*F-v*M*A,i[2]=T*M*A-v*k*F,i[3]=T*M*F+v*k*A;break;case"yzx":i[0]=v*M*F+T*k*A,i[1]=T*k*F+v*M*A,i[2]=T*M*A-v*k*F,i[3]=T*M*F-v*k*A;break;case"zxy":i[0]=v*M*F-T*k*A,i[1]=T*k*F+v*M*A,i[2]=T*M*A+v*k*F,i[3]=T*M*F-v*k*A;break;case"zyx":i[0]=v*M*F-T*k*A,i[1]=T*k*F+v*M*A,i[2]=T*M*A-v*k*F,i[3]=T*M*F+v*k*A;break;default:throw new Error("Unknown angle order "+f)}return i}function Zt(){var i=new Se(2);return Se!=Float32Array&&(i[0]=0,i[1]=0),i}function _t(i,t){var n=new Se(2);return n[0]=i,n[1]=t,n}ot(),Rt=new Se(4),Se!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0,Rt[3]=0),ot(),ut(1,0,0),ut(0,1,0),zr(),zr(),De(),Zt();const ft=8192;function Ct(i,t,n){return t*(ft/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}function Ie(i,t){return(i%t+t)%t}function Qe(i,t,n){return i*(1-n)+t*n}function jt(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,n=t*i;return 4*(i<.5?n:3*(i-t)+n-.75)}function tr(i,t,n,c){const f=new q(i,t,n,c);return _=>f.solve(_)}const fr=tr(.25,.1,.25,1);function Kt(i,t,n){return Math.min(n,Math.max(t,i))}function Lr(i,t,n){const c=n-t,f=((i-t)%c+c)%c+t;return f===t?n:f}function sr(i,...t){for(const n of t)for(const c in n)i[c]=n[c];return i}let yr=1;function lr(i,t,n){const c={};for(const f in i)c[f]=t.call(this,i[f],f,i);return c}function ci(i,t,n){const c={};for(const f in i)t.call(this,i[f],f,i)&&(c[f]=i[f]);return c}function ln(i){return Array.isArray(i)?i.map(ln):typeof i=="object"&&i?lr(i,ln):i}const Vr={};function Nr(i){Vr[i]||(typeof console<"u"&&console.warn(i),Vr[i]=!0)}function Cn(i,t,n){return(n.y-i.y)*(t.x-i.x)>(t.y-i.y)*(n.x-i.x)}function jn(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Yi=null;function Ri(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Zn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function xe(i,t,n,c,f){return l(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(i,{timestamp:0});try{const v=_==null?void 0:_.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const T=v.startsWith("BGR"),k=new Uint8ClampedArray(c*f*4);if(yield _.copyTo(k,(function(M,A,F,U,G){const H=4*Math.max(-A,0),Q=(Math.max(0,F)-F)*U*4+H,ie=4*U,ce=Math.max(0,A),ze=Math.max(0,F);return{rect:{x:ce,y:ze,width:Math.min(M.width,A+U)-ce,height:Math.min(M.height,F+G)-ze},layout:[{offset:Q,stride:ie}]}})(i,t,n,c,f)),T)for(let M=0;M<k.length;M+=4){const A=k[M];k[M]=k[M+2],k[M+2]=A}return k}finally{_.close()}}))}let Be,Xe;function Et(i,t,n,c){return i.addEventListener(t,n,c),{unsubscribe:()=>{i.removeEventListener(t,n,c)}}}function vt(i){return i*Math.PI/180}function gt(i){return i/Math.PI*180}const Bt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},_r={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Sr="AbortError";function Te(){return new Error(Sr)}const K={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function X(i){return K.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const ne="global-dispatcher";class ue extends Error{constructor(t,n,c,f){super(`AJAXError: ${n} (${t}): ${c}`),this.status=t,this.statusText=n,this.url=c,this.body=f}}const ve=()=>jn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ae=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const c=X(i.url);if(c)return c(i,t);if(jn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:ne},t)}if(!(/^file:/.test(n=i.url)||/^file:/.test(ve())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(c,f){return l(this,void 0,void 0,(function*(){const _=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:ve(),signal:f.signal});let v,T;c.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{v=yield fetch(_)}catch(M){throw new ue(0,M.message,c.url,new Blob)}if(!v.ok){const M=yield v.blob();throw new ue(v.status,v.statusText,c.url,M)}T=c.type==="arrayBuffer"||c.type==="image"?v.arrayBuffer():c.type==="json"?v.json():v.text();const k=yield T;if(f.signal.aborted)throw Te();return{data:k,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(i,t);if(jn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:ne},t)}var n;return(function(c,f){return new Promise(((_,v)=>{var T;const k=new XMLHttpRequest;k.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(k.responseType="arraybuffer");for(const M in c.headers)k.setRequestHeader(M,c.headers[M]);c.type==="json"&&(k.responseType="text",!((T=c.headers)===null||T===void 0)&&T.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=c.credentials==="include",k.onerror=()=>{v(new Error(k.statusText))},k.onload=()=>{if(!f.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let M=k.response;if(c.type==="json")try{M=JSON.parse(k.response)}catch(A){return void v(A)}_({data:M,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const M=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});v(new ue(k.status,k.statusText,c.url,M))}},f.signal.addEventListener("abort",(()=>{k.abort(),v(Te())})),k.send(c.body)}))})(i,t)};function Oe(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function Re(i,t,n){n[i]&&n[i].indexOf(t)!==-1||(n[i]=n[i]||[],n[i].push(t))}function qe(i,t,n){if(n&&n[i]){const c=n[i].indexOf(t);c!==-1&&n[i].splice(c,1)}}class nt{constructor(t,n={}){sr(this,n),this.type=t}}class et extends nt{constructor(t,n={}){super("error",sr({error:t},n))}}class zt{on(t,n){return this._listeners=this._listeners||{},Re(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return qe(t,n,this._listeners),qe(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Re(t,n,this._oneTimeListeners),this):new Promise((c=>this.once(t,c)))}fire(t,n){typeof t=="string"&&(t=new nt(t,n||{}));const c=t.type;if(this.listens(c)){t.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const T of f)T.call(this,t);const _=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const T of _)qe(c,T,this._oneTimeListeners),T.call(this,t);const v=this._eventedParent;v&&(sr(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof et&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const $t=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function rr(i,t){const n={};for(const c in i)c!=="ref"&&(n[c]=i[c]);return $t.forEach((c=>{c in t&&(n[c]=t[c])})),n}function Dt(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let n=0;n<i.length;n++)if(!Dt(i[n],t[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const n in i)if(!Dt(i[n],t[n]))return!1;return!0}return i===t}function Xt(i,t){i.push(t)}function Cr(i,t,n){Xt(n,{command:"addSource",args:[i,t[i]]})}function Kr(i,t,n){Xt(t,{command:"removeSource",args:[i]}),n[i]=!0}function dn(i,t,n,c){Kr(i,n,c),Cr(i,t,n)}function Tr(i,t,n){let c;for(c in i[n])if(Object.prototype.hasOwnProperty.call(i[n],c)&&c!=="data"&&!Dt(i[n][c],t[n][c]))return!1;for(c in t[n])if(Object.prototype.hasOwnProperty.call(t[n],c)&&c!=="data"&&!Dt(i[n][c],t[n][c]))return!1;return!0}function cr(i,t,n,c,f,_){i=i||{},t=t||{};for(const v in i)Object.prototype.hasOwnProperty.call(i,v)&&(Dt(i[v],t[v])||n.push({command:_,args:[c,v,t[v],f]}));for(const v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(i,v)&&(Dt(i[v],t[v])||n.push({command:_,args:[c,v,t[v],f]}))}function ar(i){return i.id}function en(i,t){return i[t.id]=t,i}class st{constructor(t,n,c,f){this.message=(t?`${t}: `:"")+c,f&&(this.identifier=f),n!=null&&n.__line__&&(this.line=n.__line__)}}function _n(i,...t){for(const n of t)for(const c in n)i[c]=n[c];return i}class $r extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class vi{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[c,f]of n)this.bindings[c]=f}concat(t){return new vi(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const oa={kind:"null"},Pt={kind:"number"},Dr={kind:"string"},pr={kind:"boolean"},ri={kind:"color"},oo={kind:"projectionDefinition"},lo={kind:"object"},xr={kind:"value"},hc={kind:"collator"},Ma={kind:"formatted"},dc={kind:"padding"},la={kind:"colorArray"},xl={kind:"numberArray"},kr={kind:"resolvedImage"},pu={kind:"variableAnchorOffsetCollection"};function xi(i,t){return{kind:"array",itemType:i,N:t}}function an(i){if(i.kind==="array"){const t=an(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const fc=[oa,Pt,Dr,pr,ri,oo,Ma,lo,xi(xr),dc,xl,la,kr,pu];function pc(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!pc(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const n of fc)if(!pc(n,t))return null}}return`Expected ${an(i)} but found ${an(t)} instead.`}function mu(i,t){return t.some((n=>n.kind===i.kind))}function Ns(i,t){return t.some((n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i))}function ui(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const _h=.96422,ks=.82521,Zd=4/29,bl=6/29,Gd=3*bl*bl,gu=bl*bl*bl,yu=Math.PI/180,mc=180/Math.PI;function wl(i){return(i%=360)<0&&(i+=360),i}function Sl([i,t,n,c]){let f,_;const v=gc((.2225045*(i=vh(i))+.7168786*(t=vh(t))+.0606169*(n=vh(n)))/1);i===t&&t===n?f=_=v:(f=gc((.4360747*i+.3850649*t+.1430804*n)/_h),_=gc((.0139322*i+.0971045*t+.7141733*n)/ks));const T=116*v-16;return[T<0?0:T,500*(f-v),200*(v-_),c]}function vh(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function gc(i){return i>gu?Math.pow(i,1/3):i/Gd+Zd}function No([i,t,n,c]){let f=(i+16)/116,_=isNaN(t)?f:f+t/500,v=isNaN(n)?f:f-n/200;return f=1*Bo(f),_=_h*Bo(_),v=ks*Bo(v),[yc(3.1338561*_-1.6168667*f-.4906146*v),yc(-.9787684*_+1.9161415*f+.033454*v),yc(.0719453*_-.2289914*f+1.4052427*v),c]}function yc(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Bo(i){return i>bl?i*i*i:Gd*(i-Zd)}const Qf=Object.hasOwn||function(i,t){return Object.prototype.hasOwnProperty.call(i,t)};function co(i,t){return Qf(i,t)?i[t]:void 0}function qr(i){return parseInt(i.padEnd(2,i),16)/255}function Es(i,t){return Er(t?i/100:i,0,1)}function Er(i,t,n){return Math.min(Math.max(t,i),n)}function Aa(i){return!i.some(Number.isNaN)}const Ra={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ca(i,t,n){return i+n*(t-i)}function uo(i,t,n){return i.map(((c,f)=>ca(c,t[f],n)))}class Pr{constructor(t,n,c,f=1,_=!0){this.r=t,this.g=n,this.b=c,this.a=f,_||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,n,c,f]))}static parse(t){if(t instanceof Pr)return t;if(typeof t!="string")return;const n=(function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=co(Ra,c);if(f){const[v,T,k]=f;return[v/255,T/255,k/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const v=c.length<6?1:2;let T=1;return[qr(c.slice(T,T+=v)),qr(c.slice(T,T+=v)),qr(c.slice(T,T+=v)),qr(c.slice(T,T+v)||"ff")]}if(c.startsWith("rgb")){const v=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[T,k,M,A,F,U,G,H,Q,ie,ce,ze]=v,pe=[A||" ",G||" ",ie].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const be=[M,U,Q].join(""),Ue=be==="%%%"?100:be===""?255:0;if(Ue){const We=[Er(+k/Ue,0,1),Er(+F/Ue,0,1),Er(+H/Ue,0,1),ce?Es(+ce,ze):1];if(Aa(We))return We}}return}}const _=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,T,k,M,A,F,U,G,H]=_,Q=[k||" ",A||" ",U].join("");if(Q==="  "||Q==="  /"||Q===",,"||Q===",,,"){const ie=[+T,Er(+M,0,100),Er(+F,0,100),G?Es(+G,H):1];if(Aa(ie))return(function([ce,ze,pe,be]){function Ue(We){const it=(We+ce/30)%12,Tt=ze*Math.min(pe,1-pe);return pe-Tt*Math.max(-1,Math.min(it-3,9-it,1))}return ce=wl(ce),ze/=100,pe/=100,[Ue(0),Ue(8),Ue(4),be]})(ie)}}})(t);return n?new Pr(...n,!1):void 0}get rgb(){const{r:t,g:n,b:c,a:f}=this,_=f||1/0;return this.overwriteGetter("rgb",[t/_,n/_,c/_,f])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[n,c,f,_]=Sl(t),v=Math.sqrt(c*c+f*f);return[Math.round(1e4*v)?wl(Math.atan2(f,c)*mc):NaN,v,n,_]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Sl(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,c,f]=this.rgb;return`rgba(${[t,n,c].map((_=>Math.round(255*_))).join(",")},${f})`}static interpolate(t,n,c,f="rgb"){switch(f){case"rgb":{const[_,v,T,k]=uo(t.rgb,n.rgb,c);return new Pr(_,v,T,k,!1)}case"hcl":{const[_,v,T,k]=t.hcl,[M,A,F,U]=n.hcl;let G,H;if(isNaN(_)||isNaN(M))isNaN(_)?isNaN(M)?G=NaN:(G=M,T!==1&&T!==0||(H=A)):(G=_,F!==1&&F!==0||(H=v));else{let pe=M-_;M>_&&pe>180?pe-=360:M<_&&_-M>180&&(pe+=360),G=_+c*pe}const[Q,ie,ce,ze]=(function([pe,be,Ue,We]){return pe=isNaN(pe)?0:pe*yu,No([Ue,Math.cos(pe)*be,Math.sin(pe)*be,We])})([G,H??ca(v,A,c),ca(T,F,c),ca(k,U,c)]);return new Pr(Q,ie,ce,ze,!1)}case"lab":{const[_,v,T,k]=No(uo(t.lab,n.lab,c));return new Pr(_,v,T,k,!1)}}}}Pr.black=new Pr(0,0,0,1),Pr.white=new Pr(1,1,1,1),Pr.transparent=new Pr(0,0,0,0),Pr.red=new Pr(1,0,0,1);class ua{constructor(t,n,c){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Bs=["bottom","center","top"];class $s{constructor(t,n,c,f,_,v){this.text=t,this.image=n,this.scale=c,this.fontStack=f,this.textColor=_,this.verticalAlign=v}}class kn{constructor(t){this.sections=t}static fromString(t){return new kn([new $s(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof kn?t:kn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class En{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof En)return t;if(typeof t=="number")return new En([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new En(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,c){return new En(uo(t.values,n.values,c))}}class Gn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Gn)return t;if(typeof t=="number")return new Gn([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new Gn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,c){return new Gn(uo(t.values,n.values,c))}}class fn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof fn)return t;if(typeof t=="string"){const c=Pr.parse(t);return c?new fn([c]):void 0}if(!Array.isArray(t))return;const n=[];for(const c of t){if(typeof c!="string")return;const f=Pr.parse(c);if(!f)return;n.push(f)}return new fn(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,c,f="rgb"){const _=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let v=0;v<t.values.length;v++)_.push(Pr.interpolate(t.values[v],n.values[v],c,f));return new fn(_)}}class cn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const xh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class qn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const c=t[n],f=t[n+1];if(typeof c!="string"||!xh.has(c)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new qn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,c){const f=t.values,_=n.values;if(f.length!==_.length)throw new cn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const v=[];for(let T=0;T<f.length;T+=2){if(f[T]!==_[T])throw new cn(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${f[T]}, to[${T}]: ${_[T]}`);v.push(f[T]);const[k,M]=f[T+1],[A,F]=_[T+1];v.push([ca(k,A,c),ca(M,F,c)])}return new qn(v)}}class ds{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ds({name:t,available:!1}):null}}class hi{constructor(t,n,c){this.from=t,this.to=n,this.transition=c}static interpolate(t,n,c){return new hi(t,n,c)}static parse(t){return t instanceof hi?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new hi(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new hi(t.from,t.to,t.transition):typeof t=="string"?new hi(t,t,1):void 0}}function on(i,t,n,c){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,t,n,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,t,n,c]:[i,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ho(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof hi||i instanceof Pr||i instanceof ua||i instanceof kn||i instanceof En||i instanceof Gn||i instanceof fn||i instanceof qn||i instanceof ds)return!0;if(Array.isArray(i)){for(const t of i)if(!ho(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!ho(i[t]))return!1;return!0}return!1}function nr(i){if(i===null)return oa;if(typeof i=="string")return Dr;if(typeof i=="boolean")return pr;if(typeof i=="number")return Pt;if(i instanceof Pr)return ri;if(i instanceof hi)return oo;if(i instanceof ua)return hc;if(i instanceof kn)return Ma;if(i instanceof En)return dc;if(i instanceof Gn)return xl;if(i instanceof fn)return la;if(i instanceof qn)return pu;if(i instanceof ds)return kr;if(Array.isArray(i)){const t=i.length;let n;for(const c of i){const f=nr(c);if(n){if(n===f)continue;n=xr;break}n=f}return xi(n||xr,t)}return lo}function ur(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Pr||i instanceof hi||i instanceof kn||i instanceof En||i instanceof Gn||i instanceof fn||i instanceof qn||i instanceof ds?i.toString():JSON.stringify(i)}class fs{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ho(t[1]))return n.error("invalid value");const c=t[1];let f=nr(c);const _=n.expectedType;return f.kind!=="array"||f.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(f=_),new fs(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ir={string:Dr,number:Pt,boolean:pr,object:lo};class bi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let c,f=1;const _=t[0];if(_==="array"){let T,k;if(t.length>2){const M=t[1];if(typeof M!="string"||!(M in Ir)||M==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);T=Ir[M],f++}else T=xr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);k=t[2],f++}c=xi(T,k)}else{if(!Ir[_])throw new Error(`Types doesn't contain name = ${_}`);c=Ir[_]}const v=[];for(;f<t.length;f++){const T=n.parse(t[f],f,xr);if(!T)return null;v.push(T)}return new bi(c,v)}evaluate(t){for(let n=0;n<this.args.length;n++){const c=this.args[n].evaluate(t);if(!pc(this.type,nr(c)))return c;if(n===this.args.length-1)throw new cn(`Expected value to be of type ${an(this.type)}, but found ${an(nr(c))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const ha={"to-boolean":pr,"to-color":ri,"to-number":Pt,"to-string":Dr};class da{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const c=t[0];if(!ha[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&t.length!==2)return n.error("Expected one argument.");const f=ha[c],_=[];for(let v=1;v<t.length;v++){const T=n.parse(t[v],v,xr);if(!T)return null;_.push(T)}return new da(f,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,c;for(const f of this.args){if(n=f.evaluate(t),c=null,n instanceof Pr)return n;if(typeof n=="string"){const _=t.parseColor(n);if(_)return _}else if(Array.isArray(n)&&(c=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:on(n[0],n[1],n[2],n[3]),!c))return new Pr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new cn(c||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const c of this.args){n=c.evaluate(t);const f=En.parse(n);if(f)return f}throw new cn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const c of this.args){n=c.evaluate(t);const f=Gn.parse(n);if(f)return f}throw new cn(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const c of this.args){n=c.evaluate(t);const f=fn.parse(n);if(f)return f}throw new cn(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const c of this.args){n=c.evaluate(t);const f=qn.parse(n);if(f)return f}throw new cn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const c of this.args){if(n=c.evaluate(t),n===null)return 0;const f=Number(n);if(!isNaN(f))return f}throw new cn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return kn.fromString(ur(this.args[0].evaluate(t)));case"resolvedImage":return ds.fromString(ur(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ur(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Tl=["Unknown","Point","LineString","Polygon"];class Pl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=Pr.parse(t),this._parseColorCache.set(t,n)),n}}class fo{constructor(t,n,c=[],f,_=new vi,v=[]){this.registry=t,this.path=c,this.key=c.map((T=>`[${T}]`)).join(""),this.scope=_,this.errors=v,this.expectedType=f,this._isConstant=n}parse(t,n,c,f,_={}){return n?this.concat(n,c,f)._parse(t,_):this._parse(t,_)}_parse(t,n){function c(f,_,v){return v==="assert"?new bi(_,[f]):v==="coerce"?new da(_,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[f];if(_){let v=_.parse(t,this);if(!v)return null;if(this.expectedType){const T=this.expectedType,k=v.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||k.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(k.kind)||T.kind==="colorArray"&&["value","string","array"].includes(k.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))v=c(v,T,n.typeAnnotation||"coerce");else if(this.checkSubtype(T,k))return null}else v=c(v,T,n.typeAnnotation||"assert")}if(!(v instanceof fs)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const T=new Pl;try{v=new fs(v.type,v.evaluate(T))}catch(k){return this.error(k.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,c){const f=typeof t=="number"?this.path.concat(t):this.path,_=c?this.scope.concat(c):this.scope;return new fo(this.registry,this._isConstant,f,n||null,_,this.errors)}error(t,...n){const c=`${this.key}${n.map((f=>`[${f}]`)).join("")}`;this.errors.push(new $r(c,t))}checkSubtype(t,n){const c=pc(t,n);return c&&this.error(c),c}}class Cl{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let _=1;_<t.length-1;_+=2){const v=t[_];if(typeof v!="string")return n.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return n.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=n.parse(t[_+1],_+1);if(!T)return null;c.push([v,T])}const f=n.parse(t[t.length-1],t.length-1,n.expectedType,c);return f?new Cl(c,f):null}outputDefined(){return this.result.outputDefined()}}class Us{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const c=t[1];return n.scope.has(c)?new Us(c,n.scope.get(c)):n.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class kl{constructor(t,n,c){this.type=t,this.index=n,this.input=c}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=n.parse(t[1],1,Pt),f=n.parse(t[2],2,xi(n.expectedType||xr));return c&&f?new kl(f.type.itemType,c,f):null}evaluate(t){const n=this.index.evaluate(t),c=this.input.evaluate(t);if(n<0)throw new cn(`Array index out of bounds: ${n} < 0.`);if(n>=c.length)throw new cn(`Array index out of bounds: ${n} > ${c.length-1}.`);if(n!==Math.floor(n))throw new cn(`Array index must be an integer, but found ${n} instead.`);return c[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class $o{constructor(t,n){this.type=pr,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=n.parse(t[1],1,xr),f=n.parse(t[2],2,xr);return c&&f?mu(c.type,[pr,Dr,Pt,oa,xr])?new $o(c,f):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(c.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!c)return!1;if(!Ns(n,["boolean","string","number","null"]))throw new cn(`Expected first argument to be of type boolean, string, number or null, but found ${an(nr(n))} instead.`);if(!Ns(c,["string","array"]))throw new cn(`Expected second argument to be of type array or string, but found ${an(nr(c))} instead.`);return c.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Is{constructor(t,n,c){this.type=Pt,this.needle=t,this.haystack=n,this.fromIndex=c}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=n.parse(t[1],1,xr),f=n.parse(t[2],2,xr);if(!c||!f)return null;if(!mu(c.type,[pr,Dr,Pt,oa,xr]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(c.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,Pt);return _?new Is(c,f,_):null}return new Is(c,f)}evaluate(t){const n=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!Ns(n,["boolean","string","number","null"]))throw new cn(`Expected first argument to be of type boolean, string, number or null, but found ${an(nr(n))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(t)),Ns(c,["string"])){const _=c.indexOf(n,f);return _===-1?-1:[...c.slice(0,_)].length}if(Ns(c,["array"]))return c.indexOf(n,f);throw new cn(`Expected second argument to be of type array or string, but found ${an(nr(c))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Rn{constructor(t,n,c,f,_,v){this.inputType=t,this.type=n,this.input=c,this.cases=f,this.outputs=_,this.otherwise=v}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let c,f;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);const _={},v=[];for(let M=2;M<t.length-1;M+=2){let A=t[M];const F=t[M+1];Array.isArray(A)||(A=[A]);const U=n.concat(M);if(A.length===0)return U.error("Expected at least one branch label.");for(const H of A){if(typeof H!="number"&&typeof H!="string")return U.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return U.error("Numeric branch labels must be integer values.");if(c){if(U.checkSubtype(c,nr(H)))return null}else c=nr(H);if(_[String(H)]!==void 0)return U.error("Branch labels must be unique.");_[String(H)]=v.length}const G=n.parse(F,M,f);if(!G)return null;f=f||G.type,v.push(G)}const T=n.parse(t[1],1,xr);if(!T)return null;const k=n.parse(t[t.length-1],t.length-1,f);return k?T.type.kind!=="value"&&n.concat(1).checkSubtype(c,T.type)?null:new Rn(c,f,T,_,v,k):null}evaluate(t){const n=this.input.evaluate(t);return(nr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class za{constructor(t,n,c){this.type=t,this.branches=n,this.otherwise=c}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let c;n.expectedType&&n.expectedType.kind!=="value"&&(c=n.expectedType);const f=[];for(let v=1;v<t.length-1;v+=2){const T=n.parse(t[v],v,pr);if(!T)return null;const k=n.parse(t[v+1],v+1,c);if(!k)return null;f.push([T,k]),c=c||k.type}const _=n.parse(t[t.length-1],t.length-1,c);if(!_)return null;if(!c)throw new Error("Can't infer output type");return new za(c,f,_)}evaluate(t){for(const[n,c]of this.branches)if(n.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,c]of this.branches)t(n),t(c);t(this.otherwise)}outputDefined(){return this.branches.every((([t,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class El{constructor(t,n,c,f){this.type=t,this.input=n,this.beginIndex=c,this.endIndex=f}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=n.parse(t[1],1,xr),f=n.parse(t[2],2,Pt);if(!c||!f)return null;if(!mu(c.type,[xi(xr),Dr,xr]))return n.error(`Expected first argument to be of type array or string, but found ${an(c.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,Pt);return _?new El(c.type,c,f,_):null}return new El(c.type,c,f)}evaluate(t){const n=this.input.evaluate(t),c=this.beginIndex.evaluate(t);let f;if(this.endIndex&&(f=this.endIndex.evaluate(t)),Ns(n,["string"]))return[...n].slice(c,f).join("");if(Ns(n,["array"]))return n.slice(c,f);throw new cn(`Expected first argument to be of type array or string, but found ${an(nr(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Wn(i,t){const n=i.length-1;let c,f,_=0,v=n,T=0;for(;_<=v;)if(T=Math.floor((_+v)/2),c=i[T],f=i[T+1],c<=t){if(T===n||t<f)return T;_=T+1}else{if(!(c>t))throw new cn("Input is not a number.");v=T-1}return 0}class pn{constructor(t,n,c){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[f,_]of c)this.labels.push(f),this.outputs.push(_)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const c=n.parse(t[1],1,Pt);if(!c)return null;const f=[];let _=null;n.expectedType&&n.expectedType.kind!=="value"&&(_=n.expectedType);for(let v=1;v<t.length;v+=2){const T=v===1?-1/0:t[v],k=t[v+1],M=v,A=v+1;if(typeof T!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(f.length&&f[f.length-1][0]>=T)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const F=n.parse(k,A,_);if(!F)return null;_=_||F.type,f.push([T,F])}return new pn(_,c,f)}evaluate(t){const n=this.labels,c=this.outputs;if(n.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return c[0].evaluate(t);const _=n.length;return f>=n[_-1]?c[_-1].evaluate(t):c[Wn(n,f)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function _u(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Da,bh,wh=(function(){if(bh)return Da;function i(t,n,c,f){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(f-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=c,this.p2y=f}return bh=1,Da=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,f=0;f<8;f++){var _=this.sampleCurveX(c)-t;if(Math.abs(_)<n)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=_/v}var T=0,k=1;for(c=t,f=0;f<20&&(_=this.sampleCurveX(c),!(Math.abs(_-t)<n));f++)t>_?T=c:k=c,c=.5*(k-T)+T;return c},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Da})(),po=_u(wh);class zn{constructor(t,n,c,f,_){this.type=t,this.operator=n,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[v,T]of _)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(t,n,c,f){let _=0;if(t.name==="exponential")_=mo(n,t.base,c,f);else if(t.name==="linear")_=mo(n,1,c,f);else if(t.name==="cubic-bezier"){const v=t.controlPoints;_=new po(v[0],v[1],v[2],v[3]).solve(mo(n,1,c,f))}return _}static parse(t,n){let[c,f,_,...v]=t;if(!Array.isArray(f)||f.length===0)return n.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const M=f[1];if(typeof M!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:M}}else{if(f[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const M=f.slice(1);if(M.length!==4||M.some((A=>typeof A!="number"||A<0||A>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:M}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(_=n.parse(_,2,Pt),!_)return null;const T=[];let k=null;c!=="interpolate-hcl"&&c!=="interpolate-lab"||n.expectedType==la?n.expectedType&&n.expectedType.kind!=="value"&&(k=n.expectedType):k=ri;for(let M=0;M<v.length;M+=2){const A=v[M],F=v[M+1],U=M+3,G=M+4;if(typeof A!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(T.length&&T[T.length-1][0]>=A)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const H=n.parse(F,G,k);if(!H)return null;k=k||H.type,T.push([A,H])}return ui(k,Pt)||ui(k,oo)||ui(k,ri)||ui(k,dc)||ui(k,xl)||ui(k,la)||ui(k,pu)||ui(k,xi(Pt))?new zn(k,c,f,_,T):n.error(`Type ${an(k)} is not interpolatable.`)}evaluate(t){const n=this.labels,c=this.outputs;if(n.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return c[0].evaluate(t);const _=n.length;if(f>=n[_-1])return c[_-1].evaluate(t);const v=Wn(n,f),T=zn.interpolationFactor(this.interpolation,f,n[v],n[v+1]),k=c[v].evaluate(t),M=c[v+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ca(k,M,T);case"color":return Pr.interpolate(k,M,T);case"padding":return En.interpolate(k,M,T);case"colorArray":return fn.interpolate(k,M,T);case"numberArray":return Gn.interpolate(k,M,T);case"variableAnchorOffsetCollection":return qn.interpolate(k,M,T);case"array":return uo(k,M,T);case"projectionDefinition":return hi.interpolate(k,M,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return Pr.interpolate(k,M,T,"hcl");case"colorArray":return fn.interpolate(k,M,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Pr.interpolate(k,M,T,"lab");case"colorArray":return fn.interpolate(k,M,T,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function mo(i,t,n,c){const f=c-n,_=i-n;return f===0?0:t===1?_/f:(Math.pow(t,_)-1)/(Math.pow(t,f)-1)}const Vs={color:Pr.interpolate,number:ca,padding:En.interpolate,numberArray:Gn.interpolate,colorArray:fn.interpolate,variableAnchorOffsetCollection:qn.interpolate,array:uo};class _c{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let c=null;const f=n.expectedType;f&&f.kind!=="value"&&(c=f);const _=[];for(const T of t.slice(1)){const k=n.parse(T,1+_.length,c,void 0,{typeAnnotation:"omit"});if(!k)return null;c=c||k.type,_.push(k)}if(!c)throw new Error("No output type");const v=f&&_.some((T=>pc(f,T.type)));return new _c(v?xr:c,_)}evaluate(t){let n,c=null,f=0;for(const _ of this.args)if(f++,c=_.evaluate(t),c&&c instanceof ds&&!c.available&&(n||(n=c.name),c=null,f===this.args.length&&(c=n)),c!==null)break;return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function vc(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function xc(i,t,n,c){return c.compare(t,n)===0}function ni(i,t,n){const c=i!=="=="&&i!=="!=";return class $b{constructor(_,v,T){this.type=pr,this.lhs=_,this.rhs=v,this.collator=T,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const T=_[0];let k=v.parse(_[1],1,xr);if(!k)return null;if(!vc(T,k.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${an(k.type)}'.`);let M=v.parse(_[2],2,xr);if(!M)return null;if(!vc(T,M.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${an(M.type)}'.`);if(k.type.kind!==M.type.kind&&k.type.kind!=="value"&&M.type.kind!=="value")return v.error(`Cannot compare types '${an(k.type)}' and '${an(M.type)}'.`);c&&(k.type.kind==="value"&&M.type.kind!=="value"?k=new bi(M.type,[k]):k.type.kind!=="value"&&M.type.kind==="value"&&(M=new bi(k.type,[M])));let A=null;if(_.length===4){if(k.type.kind!=="string"&&M.type.kind!=="string"&&k.type.kind!=="value"&&M.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(A=v.parse(_[3],3,hc),!A)return null}return new $b(k,M,A)}evaluate(_){const v=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(c&&this.hasUntypedArgument){const k=nr(v),M=nr(T);if(k.kind!==M.kind||k.kind!=="string"&&k.kind!=="number")throw new cn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${k.kind}, ${M.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const k=nr(v),M=nr(T);if(k.kind!=="string"||M.kind!=="string")return t(_,v,T)}return this.collator?n(_,v,T,this.collator.evaluate(_)):t(_,v,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const qd=ni("==",(function(i,t,n){return t===n}),xc),vu=ni("!=",(function(i,t,n){return t!==n}),(function(i,t,n,c){return!xc(0,t,n,c)})),Jf=ni("<",(function(i,t,n){return t<n}),(function(i,t,n,c){return c.compare(t,n)<0})),Sh=ni(">",(function(i,t,n){return t>n}),(function(i,t,n,c){return c.compare(t,n)>0})),ep=ni("<=",(function(i,t,n){return t<=n}),(function(i,t,n,c){return c.compare(t,n)<=0})),Wd=ni(">=",(function(i,t,n){return t>=n}),(function(i,t,n,c){return c.compare(t,n)>=0}));class xu{constructor(t,n,c){this.type=hc,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return n.error("Collator options argument must be an object.");const f=n.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,pr);if(!f)return null;const _=n.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,pr);if(!_)return null;let v=null;return c.locale&&(v=n.parse(c.locale,1,Dr),!v)?null:new xu(f,_,v)}evaluate(t){return new ua(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Th{constructor(t,n,c,f,_){this.type=Dr,this.number=t,this.locale=n,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const c=n.parse(t[1],1,Pt);if(!c)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return n.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=n.parse(f.locale,1,Dr),!_))return null;let v=null;if(f.currency&&(v=n.parse(f.currency,1,Dr),!v))return null;let T=null;if(f["min-fraction-digits"]&&(T=n.parse(f["min-fraction-digits"],1,Pt),!T))return null;let k=null;return f["max-fraction-digits"]&&(k=n.parse(f["max-fraction-digits"],1,Pt),!k)?null:new Th(c,_,v,T,k)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Uo{constructor(t){this.type=Ma,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return n.error("First argument must be an image or text section.");const f=[];let _=!1;for(let v=1;v<=t.length-1;++v){const T=t[v];if(_&&typeof T=="object"&&!Array.isArray(T)){_=!1;let k=null;if(T["font-scale"]&&(k=n.parse(T["font-scale"],1,Pt),!k))return null;let M=null;if(T["text-font"]&&(M=n.parse(T["text-font"],1,xi(Dr)),!M))return null;let A=null;if(T["text-color"]&&(A=n.parse(T["text-color"],1,ri),!A))return null;let F=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!Bs.includes(T["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(F=n.parse(T["vertical-align"],1,Dr),!F)return null}const U=f[f.length-1];U.scale=k,U.font=M,U.textColor=A,U.verticalAlign=F}else{const k=n.parse(t[v],1,xr);if(!k)return null;const M=k.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Uo(f)}evaluate(t){return new kn(this.sections.map((n=>{const c=n.content.evaluate(t);return nr(c)===kr?new $s("",c,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new $s(ur(c),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class Ph{constructor(t){this.type=kr,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const c=n.parse(t[1],1,Dr);return c?new Ph(c):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),c=ds.fromString(n);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(n)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}}class Il{constructor(t){this.type=Pt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=n.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${an(c.type)} instead.`):new Il(c):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new cn(`Expected value to be of type string or array, but found ${an(nr(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Zs=8192;function tp(i,t){const n=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(n*f*Zs),Math.round(c*f*Zs)]}function bu(i,t){const n=Math.pow(2,t.z);return[(f=(i[0]/Zs+t.x)/n,360*f-180),(c=(i[1]/Zs+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,f}function Ml(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function bc(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function rp(i,t,n){const c=i[0]-t[0],f=i[1]-t[1],_=i[0]-n[0],v=i[1]-n[1];return c*v-_*f==0&&c*_<=0&&f*v<=0}function wu(i,t,n,c){return(f=[c[0]-n[0],c[1]-n[1]])[0]*(_=[t[0]-i[0],t[1]-i[1]])[1]-f[1]*_[0]!=0&&!(!Al(i,t,n,c)||!Al(n,c,i,t));var f,_}function np(i,t,n){for(const c of n)for(let f=0;f<c.length-1;++f)if(wu(i,t,c[f],c[f+1]))return!0;return!1}function Vo(i,t,n=!1){let c=!1;for(const T of t)for(let k=0;k<T.length-1;k++){if(rp(i,T[k],T[k+1]))return n;(_=T[k])[1]>(f=i)[1]!=(v=T[k+1])[1]>f[1]&&f[0]<(v[0]-_[0])*(f[1]-_[1])/(v[1]-_[1])+_[0]&&(c=!c)}var f,_,v;return c}function Hd(i,t){for(const n of t)if(Vo(i,n))return!0;return!1}function Ch(i,t){for(const n of i)if(!Vo(n,t))return!1;for(let n=0;n<i.length-1;++n)if(np(i[n],i[n+1],t))return!1;return!0}function kh(i,t){for(const n of t)if(Ch(i,n))return!0;return!1}function Al(i,t,n,c){const f=c[0]-n[0],_=c[1]-n[1],v=(i[0]-n[0])*_-f*(i[1]-n[1]),T=(t[0]-n[0])*_-f*(t[1]-n[1]);return v>0&&T<0||v<0&&T>0}function Eh(i,t,n){const c=[];for(let f=0;f<i.length;f++){const _=[];for(let v=0;v<i[f].length;v++){const T=tp(i[f][v],n);Ml(t,T),_.push(T)}c.push(_)}return c}function Ih(i,t,n){const c=[];for(let f=0;f<i.length;f++){const _=Eh(i[f],t,n);c.push(_)}return c}function wc(i,t,n,c){if(i[0]<n[0]||i[0]>n[2]){const f=.5*c;let _=i[0]-n[0]>f?-c:n[0]-i[0]>f?c:0;_===0&&(_=i[0]-n[2]>f?-c:n[2]-i[0]>f?c:0),i[0]+=_}Ml(t,i)}function Mh(i,t,n,c){const f=Math.pow(2,c.z)*Zs,_=[c.x*Zs,c.y*Zs],v=[];for(const T of i)for(const k of T){const M=[k.x+_[0],k.y+_[1]];wc(M,t,n,f),v.push(M)}return v}function Ah(i,t,n,c){const f=Math.pow(2,c.z)*Zs,_=[c.x*Zs,c.y*Zs],v=[];for(const k of i){const M=[];for(const A of k){const F=[A.x+_[0],A.y+_[1]];Ml(t,F),M.push(F)}v.push(M)}if(t[2]-t[0]<=f/2){(T=t)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const k of v)for(const M of k)wc(M,t,n,f)}var T;return v}class go{constructor(t,n){this.type=pr,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const c=t[1];if(c.type==="FeatureCollection"){const f=[];for(const _ of c.features){const{type:v,coordinates:T}=_.geometry;v==="Polygon"&&f.push(T),v==="MultiPolygon"&&f.push(...T)}if(f.length)return new go(c,{type:"MultiPolygon",coordinates:f})}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new go(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new go(c,c)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(c.type==="Polygon"){const T=Eh(c.coordinates,_,v),k=Mh(n.geometry(),f,_,v);if(!bc(f,_))return!1;for(const M of k)if(!Vo(M,T))return!1}if(c.type==="MultiPolygon"){const T=Ih(c.coordinates,_,v),k=Mh(n.geometry(),f,_,v);if(!bc(f,_))return!1;for(const M of k)if(!Hd(M,T))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(c.type==="Polygon"){const T=Eh(c.coordinates,_,v),k=Ah(n.geometry(),f,_,v);if(!bc(f,_))return!1;for(const M of k)if(!Ch(M,T))return!1}if(c.type==="MultiPolygon"){const T=Ih(c.coordinates,_,v),k=Ah(n.geometry(),f,_,v);if(!bc(f,_))return!1;for(const M of k)if(!kh(M,T))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let yo=class{constructor(i=[],t=(n,c)=>n<c?-1:n>c?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:n}=this,c=t[i];for(;i>0;){const f=i-1>>1,_=t[f];if(n(c,_)>=0)break;t[i]=_,i=f}t[i]=c}_down(i){const{data:t,compare:n}=this,c=this.length>>1,f=t[i];for(;i<c;){let _=1+(i<<1);const v=_+1;if(v<this.length&&n(t[v],t[_])<0&&(_=v),n(t[_],f)>=0)break;t[i]=t[_],i=_}t[i]=f}};function Rh(i,t,n=0,c=i.length-1,f=ip){for(;c>n;){if(c-n>600){const k=c-n+1,M=t-n+1,A=Math.log(k),F=.5*Math.exp(2*A/3),U=.5*Math.sqrt(A*F*(k-F)/k)*(M-k/2<0?-1:1);Rh(i,t,Math.max(n,Math.floor(t-M*F/k+U)),Math.min(c,Math.floor(t+(k-M)*F/k+U)),f)}const _=i[t];let v=n,T=c;for(Sc(i,n,t),f(i[c],_)>0&&Sc(i,n,c);v<T;){for(Sc(i,v,T),v++,T--;f(i[v],_)<0;)v++;for(;f(i[T],_)>0;)T--}f(i[n],_)===0?Sc(i,n,T):(T++,Sc(i,T,c)),T<=t&&(n=T+1),t<=T&&(c=T-1)}}function Sc(i,t,n){const c=i[t];i[t]=i[n],i[n]=c}function ip(i,t){return i<t?-1:i>t?1:0}function Rl(i,t){if(i.length<=1)return[i];const n=[];let c,f;for(const _ of i){const v=Tc(_);v!==0&&(_.area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(c&&n.push(c),c=[_]):c.push(_))}if(c&&n.push(c),t>1)for(let _=0;_<n.length;_++)n[_].length<=t||(Rh(n[_],t,1,n[_].length-1,zh),n[_]=n[_].slice(0,t));return n}function zh(i,t){return t.area-i.area}function Tc(i){let t=0;for(let n,c,f=0,_=i.length,v=_-1;f<_;v=f++)n=i[f],c=i[v],t+=(c.x-n.x)*(n.y+c.y);return t}const zl=1/298.257223563,Kd=zl*(2-zl),Dl=Math.PI/180;class Dh{constructor(t){const n=6378.137*Dl*1e3,c=Math.cos(t*Dl),f=1/(1-Kd*(1-c*c)),_=Math.sqrt(f);this.kx=n*_*c,this.ky=n*_*f*(1-Kd)}distance(t,n){const c=this.wrap(t[0]-n[0])*this.kx,f=(t[1]-n[1])*this.ky;return Math.sqrt(c*c+f*f)}pointOnLine(t,n){let c,f,_,v,T=1/0;for(let k=0;k<t.length-1;k++){let M=t[k][0],A=t[k][1],F=this.wrap(t[k+1][0]-M)*this.kx,U=(t[k+1][1]-A)*this.ky,G=0;F===0&&U===0||(G=(this.wrap(n[0]-M)*this.kx*F+(n[1]-A)*this.ky*U)/(F*F+U*U),G>1?(M=t[k+1][0],A=t[k+1][1]):G>0&&(M+=F/this.kx*G,A+=U/this.ky*G)),F=this.wrap(n[0]-M)*this.kx,U=(n[1]-A)*this.ky;const H=F*F+U*U;H<T&&(T=H,c=M,f=A,_=k,v=G)}return{point:[c,f],index:_,t:Math.max(0,Math.min(1,v))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Lh(i,t){return t[0]-i[0]}function Ll(i){return i[1]-i[0]+1}function Gs(i,t){return i[1]>=i[0]&&i[1]<t}function Ur(i,t){if(i[0]>i[1])return[null,null];const n=Ll(i);if(t){if(n===2)return[i,null];const f=Math.floor(n/2);return[[i[0],i[0]+f],[i[0]+f,i[1]]]}if(n===1)return[i,null];const c=Math.floor(n/2)-1;return[[i[0],i[0]+c],[i[0]+c+1,i[1]]]}function Su(i,t){if(!Gs(t,i.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let c=t[0];c<=t[1];++c)Ml(n,i[c]);return n}function Tu(i){const t=[1/0,1/0,-1/0,-1/0];for(const n of i)for(const c of n)Ml(t,c);return t}function Xd(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Fh(i,t,n){if(!Xd(i)||!Xd(t))return NaN;let c=0,f=0;return i[2]<t[0]&&(c=t[0]-i[2]),i[0]>t[2]&&(c=i[0]-t[2]),i[1]>t[3]&&(f=i[1]-t[3]),i[3]<t[1]&&(f=t[1]-i[3]),n.distance([0,0],[c,f])}function Zo(i,t,n){const c=n.pointOnLine(t,i);return n.distance(i,c.point)}function Oh(i,t,n,c,f){const _=Math.min(Zo(i,[n,c],f),Zo(t,[n,c],f)),v=Math.min(Zo(n,[i,t],f),Zo(c,[i,t],f));return Math.min(_,v)}function sp(i,t,n,c,f){if(!Gs(t,i.length)||!Gs(c,n.length))return 1/0;let _=1/0;for(let v=t[0];v<t[1];++v){const T=i[v],k=i[v+1];for(let M=c[0];M<c[1];++M){const A=n[M],F=n[M+1];if(wu(T,k,A,F))return 0;_=Math.min(_,Oh(T,k,A,F,f))}}return _}function qs(i,t,n,c,f){if(!Gs(t,i.length)||!Gs(c,n.length))return NaN;let _=1/0;for(let v=t[0];v<=t[1];++v)for(let T=c[0];T<=c[1];++T)if(_=Math.min(_,f.distance(i[v],n[T])),_===0)return _;return _}function Pc(i,t,n){if(Vo(i,t,!0))return 0;let c=1/0;for(const f of t){const _=f[0],v=f[f.length-1];if(_!==v&&(c=Math.min(c,Zo(i,[v,_],n)),c===0))return c;const T=n.pointOnLine(f,i);if(c=Math.min(c,n.distance(i,T.point)),c===0)return c}return c}function Yd(i,t,n,c){if(!Gs(t,i.length))return NaN;for(let _=t[0];_<=t[1];++_)if(Vo(i[_],n,!0))return 0;let f=1/0;for(let _=t[0];_<t[1];++_){const v=i[_],T=i[_+1];for(const k of n)for(let M=0,A=k.length,F=A-1;M<A;F=M++){const U=k[F],G=k[M];if(wu(v,T,U,G))return 0;f=Math.min(f,Oh(v,T,U,G,c))}}return f}function jh(i,t){for(const n of i)for(const c of n)if(Vo(c,t,!0))return!0;return!1}function Qd(i,t,n,c=1/0){const f=Tu(i),_=Tu(t);if(c!==1/0&&Fh(f,_,n)>=c)return c;if(bc(f,_)){if(jh(i,t))return 0}else if(jh(t,i))return 0;let v=1/0;for(const T of i)for(let k=0,M=T.length,A=M-1;k<M;A=k++){const F=T[A],U=T[k];for(const G of t)for(let H=0,Q=G.length,ie=Q-1;H<Q;ie=H++){const ce=G[ie],ze=G[H];if(wu(F,U,ce,ze))return 0;v=Math.min(v,Oh(F,U,ce,ze,n))}}return v}function Nh(i,t,n,c,f,_){if(!_)return;const v=Fh(Su(c,_),f,n);v<t&&i.push([v,_,[0,0]])}function Fl(i,t,n,c,f,_,v){if(!_||!v)return;const T=Fh(Su(c,_),Su(f,v),n);T<t&&i.push([T,_,v])}function Pu(i,t,n,c,f=1/0){let _=Math.min(c.distance(i[0],n[0][0]),f);if(_===0)return _;const v=new yo([[0,[0,i.length-1],[0,0]]],Lh),T=Tu(n);for(;v.length>0;){const k=v.pop();if(k[0]>=_)continue;const M=k[1],A=t?50:100;if(Ll(M)<=A){if(!Gs(M,i.length))return NaN;if(t){const F=Yd(i,M,n,c);if(isNaN(F)||F===0)return F;_=Math.min(_,F)}else for(let F=M[0];F<=M[1];++F){const U=Pc(i[F],n,c);if(_=Math.min(_,U),_===0)return 0}}else{const F=Ur(M,t);Nh(v,_,c,i,T,F[0]),Nh(v,_,c,i,T,F[1])}}return _}function Cu(i,t,n,c,f,_=1/0){let v=Math.min(_,f.distance(i[0],n[0]));if(v===0)return v;const T=new yo([[0,[0,i.length-1],[0,n.length-1]]],Lh);for(;T.length>0;){const k=T.pop();if(k[0]>=v)continue;const M=k[1],A=k[2],F=t?50:100,U=c?50:100;if(Ll(M)<=F&&Ll(A)<=U){if(!Gs(M,i.length)&&Gs(A,n.length))return NaN;let G;if(t&&c)G=sp(i,M,n,A,f),v=Math.min(v,G);else if(t&&!c){const H=i.slice(M[0],M[1]+1);for(let Q=A[0];Q<=A[1];++Q)if(G=Zo(n[Q],H,f),v=Math.min(v,G),v===0)return v}else if(!t&&c){const H=n.slice(A[0],A[1]+1);for(let Q=M[0];Q<=M[1];++Q)if(G=Zo(i[Q],H,f),v=Math.min(v,G),v===0)return v}else G=qs(i,M,n,A,f),v=Math.min(v,G)}else{const G=Ur(M,t),H=Ur(A,c);Fl(T,v,f,i,n,G[0],H[0]),Fl(T,v,f,i,n,G[0],H[1]),Fl(T,v,f,i,n,G[1],H[0]),Fl(T,v,f,i,n,G[1],H[1])}}return v}function _o(i){return i.type==="MultiPolygon"?i.coordinates.map((t=>({type:"Polygon",coordinates:t}))):i.type==="MultiLineString"?i.coordinates.map((t=>({type:"LineString",coordinates:t}))):i.type==="MultiPoint"?i.coordinates.map((t=>({type:"Point",coordinates:t}))):[i]}class La{constructor(t,n){this.type=Pt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const c=t[1];if(c.type==="FeatureCollection")return new La(c,c.features.map((f=>_o(f.geometry))).flat());if(c.type==="Feature")return new La(c,_o(c.geometry));if("type"in c&&"coordinates"in c)return new La(c,_o(c))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,c){const f=n.geometry(),_=f.flat().map((k=>bu([k.x,k.y],n.canonical)));if(f.length===0)return NaN;const v=new Dh(_[0][1]);let T=1/0;for(const k of c){switch(k.type){case"Point":T=Math.min(T,Cu(_,!1,[k.coordinates],!1,v,T));break;case"LineString":T=Math.min(T,Cu(_,!1,k.coordinates,!0,v,T));break;case"Polygon":T=Math.min(T,Pu(_,!1,k.coordinates,v,T))}if(T===0)return T}return T})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,c){const f=n.geometry(),_=f.flat().map((k=>bu([k.x,k.y],n.canonical)));if(f.length===0)return NaN;const v=new Dh(_[0][1]);let T=1/0;for(const k of c){switch(k.type){case"Point":T=Math.min(T,Cu(_,!0,[k.coordinates],!1,v,T));break;case"LineString":T=Math.min(T,Cu(_,!0,k.coordinates,!0,v,T));break;case"Polygon":T=Math.min(T,Pu(_,!0,k.coordinates,v,T))}if(T===0)return T}return T})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(n,c){const f=n.geometry();if(f.length===0||f[0].length===0)return NaN;const _=Rl(f,0).map((k=>k.map((M=>M.map((A=>bu([A.x,A.y],n.canonical))))))),v=new Dh(_[0][0][0][1]);let T=1/0;for(const k of c)for(const M of _){switch(k.type){case"Point":T=Math.min(T,Pu([k.coordinates],!1,M,v,T));break;case"LineString":T=Math.min(T,Pu(k.coordinates,!0,M,v,T));break;case"Polygon":T=Math.min(T,Qd(M,k.coordinates,v,T))}if(T===0)return T}return T})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Fa{constructor(t){this.type=xr,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=t[1];return c==null?n.error("Global state property must be defined."):typeof c!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Fa(c)}evaluate(t){var n;const c=(n=t.globals)===null||n===void 0?void 0:n.globalState;return c&&Object.keys(c).length!==0?co(c,this.key):null}eachChild(){}outputDefined(){return!1}}const vo={"==":qd,"!=":vu,">":Sh,"<":Jf,">=":Wd,"<=":ep,array:bi,at:kl,boolean:bi,case:za,coalesce:_c,collator:xu,format:Uo,image:Ph,in:$o,"index-of":Is,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:Il,let:Cl,literal:fs,match:Rn,number:bi,"number-format":Th,object:bi,slice:El,step:pn,string:bi,"to-boolean":da,"to-color":da,"to-number":da,"to-string":da,var:Us,within:go,distance:La,"global-state":Fa};class ps{constructor(t,n,c,f){this.name=t,this.type=n,this._evaluate=c,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const c=t[0],f=ps.definitions[c];if(!f)return n.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,T=v.filter((([M])=>!Array.isArray(M)||M.length===t.length-1));let k=null;for(const[M,A]of T){k=new fo(n.registry,qo,n.path,null,n.scope);const F=[];let U=!1;for(let G=1;G<t.length;G++){const H=t[G],Q=Array.isArray(M)?M[G-1]:M.type,ie=k.parse(H,1+F.length,Q);if(!ie){U=!0;break}F.push(ie)}if(!U)if(Array.isArray(M)&&M.length!==F.length)k.error(`Expected ${M.length} arguments, but found ${F.length} instead.`);else{for(let G=0;G<F.length;G++){const H=Array.isArray(M)?M[G]:M.type,Q=F[G];k.concat(G+1).checkSubtype(H,Q.type)}if(k.errors.length===0)return new ps(c,_,A,F)}}if(T.length===1)n.errors.push(...k.errors);else{const M=(T.length?T:v).map((([F])=>{return U=F,Array.isArray(U)?`(${U.map(an).join(", ")})`:`(${an(U.type)}...)`;var U})).join(" | "),A=[];for(let F=1;F<t.length;F++){const U=n.parse(t[F],1+A.length);if(!U)return null;A.push(an(U.type))}n.error(`Expected arguments of type ${M}, but found (${A.join(", ")}) instead.`)}return null}static register(t,n){ps.definitions=n;for(const c in n)t[c]=ps}}function Cc(i,[t,n,c,f]){t=t.evaluate(i),n=n.evaluate(i),c=c.evaluate(i);const _=f?f.evaluate(i):1,v=on(t,n,c,_);if(v)throw new cn(v);return new Pr(t/255,n/255,c/255,_,!1)}function Go(i,t){return i in t}function kc(i,t){const n=t[i];return n===void 0?null:n}function xo(i){return{type:i}}function qo(i){if(i instanceof Us)return qo(i.boundExpression);if(i instanceof ps&&i.name==="error"||i instanceof xu||i instanceof go||i instanceof La||i instanceof Fa)return!1;const t=i instanceof da||i instanceof bi;let n=!0;return i.eachChild((c=>{n=t?n&&qo(c):n&&c instanceof fs})),!!n&&Ec(i)&&Ic(i,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ec(i){if(i instanceof ps&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof go||i instanceof La)return!1;let t=!0;return i.eachChild((n=>{t&&!Ec(n)&&(t=!1)})),t}function Ol(i){if(i instanceof ps&&i.name==="feature-state")return!1;let t=!0;return i.eachChild((n=>{t&&!Ol(n)&&(t=!1)})),t}function Ic(i,t){if(i instanceof ps&&t.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild((c=>{n&&!Ic(c,t)&&(n=!1)})),n}function Bh(i){return{result:"success",value:i}}function Wo(i){return{result:"error",value:i}}function Oa(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function ja(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Mc(i){return!!i.expression&&i.expression.interpolated}function Mr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Ac(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&nr(i)===lo}function ap(i){return i}function jl(i,t){const n=i.stops&&typeof i.stops[0][0]=="object",c=n||!(n||i.property!==void 0),f=i.type||(Mc(t)?"exponential":"interval"),_=(function(A){switch(A.type){case"color":return Pr.parse;case"padding":return En.parse;case"numberArray":return Gn.parse;case"colorArray":return fn.parse;default:return null}})(t);if(_&&((i=_n({},i)).stops&&(i.stops=i.stops.map((A=>[A[0],_(A[1])]))),i.default=_(i.default?i.default:t.default)),i.colorSpace&&(v=i.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var v;const T=(function(A){switch(A){case"exponential":return gn;case"interval":return Jd;case"categorical":return $h;case"identity":return Uh;default:throw new Error(`Unknown function type "${A}"`)}})(f);let k,M;if(f==="categorical"){k=Object.create(null);for(const A of i.stops)k[A[0]]=A[1];M=typeof i.stops[0][0]}if(n){const A={},F=[];for(let H=0;H<i.stops.length;H++){const Q=i.stops[H],ie=Q[0].zoom;A[ie]===void 0&&(A[ie]={zoom:ie,type:i.type,property:i.property,default:i.default,stops:[]},F.push(ie)),A[ie].stops.push([Q[0].value,Q[1]])}const U=[];for(const H of F)U.push([A[H].zoom,jl(A[H],t)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:zn.interpolationFactor.bind(void 0,G),zoomStops:U.map((H=>H[0])),evaluate:({zoom:H},Q)=>gn({stops:U,base:i.base},t,H).evaluate(H,Q)}}if(c){const A=f==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:zn.interpolationFactor.bind(void 0,A),zoomStops:i.stops.map((F=>F[0])),evaluate:({zoom:F})=>T(i,t,F,k,M)}}return{kind:"source",evaluate(A,F){const U=F&&F.properties?F.properties[i.property]:void 0;return U===void 0?bo(i.default,t.default):T(i,t,U,k,M)}}}function bo(i,t,n){return i!==void 0?i:t!==void 0?t:n!==void 0?n:void 0}function $h(i,t,n,c,f){return bo(typeof n===f?c[n]:void 0,i.default,t.default)}function Jd(i,t,n){if(Mr(n)!=="number")return bo(i.default,t.default);const c=i.stops.length;if(c===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[c-1][0])return i.stops[c-1][1];const f=Wn(i.stops.map((_=>_[0])),n);return i.stops[f][1]}function gn(i,t,n){const c=i.base!==void 0?i.base:1;if(Mr(n)!=="number")return bo(i.default,t.default);const f=i.stops.length;if(f===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[f-1][0])return i.stops[f-1][1];const _=Wn(i.stops.map((A=>A[0])),n),v=(function(A,F,U,G){const H=G-U,Q=A-U;return H===0?0:F===1?Q/H:(Math.pow(F,Q)-1)/(Math.pow(F,H)-1)})(n,c,i.stops[_][0],i.stops[_+1][0]),T=i.stops[_][1],k=i.stops[_+1][1],M=Vs[t.type]||ap;return typeof T.evaluate=="function"?{evaluate(...A){const F=T.evaluate.apply(void 0,A),U=k.evaluate.apply(void 0,A);if(F!==void 0&&U!==void 0)return M(F,U,v,i.colorSpace)}}:M(T,k,v,i.colorSpace)}function Uh(i,t,n){switch(t.type){case"color":n=Pr.parse(n);break;case"formatted":n=kn.fromString(n.toString());break;case"resolvedImage":n=ds.fromString(n.toString());break;case"padding":n=En.parse(n);break;case"colorArray":n=fn.parse(n);break;case"numberArray":n=Gn.parse(n);break;default:Mr(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return bo(n,i.default,t.default)}ps.register(vo,{error:[{kind:"error"},[Dr],(i,[t])=>{throw new cn(t.evaluate(i))}],typeof:[Dr,[xr],(i,[t])=>an(nr(t.evaluate(i)))],"to-rgba":[xi(Pt,4),[ri],(i,[t])=>{const[n,c,f,_]=t.evaluate(i).rgb;return[255*n,255*c,255*f,_]}],rgb:[ri,[Pt,Pt,Pt],Cc],rgba:[ri,[Pt,Pt,Pt,Pt],Cc],has:{type:pr,overloads:[[[Dr],(i,[t])=>Go(t.evaluate(i),i.properties())],[[Dr,lo],(i,[t,n])=>Go(t.evaluate(i),n.evaluate(i))]]},get:{type:xr,overloads:[[[Dr],(i,[t])=>kc(t.evaluate(i),i.properties())],[[Dr,lo],(i,[t,n])=>kc(t.evaluate(i),n.evaluate(i))]]},"feature-state":[xr,[Dr],(i,[t])=>kc(t.evaluate(i),i.featureState||{})],properties:[lo,[],i=>i.properties()],"geometry-type":[Dr,[],i=>i.geometryType()],id:[xr,[],i=>i.id()],zoom:[Pt,[],i=>i.globals.zoom],"heatmap-density":[Pt,[],i=>i.globals.heatmapDensity||0],elevation:[Pt,[],i=>i.globals.elevation||0],"line-progress":[Pt,[],i=>i.globals.lineProgress||0],accumulated:[xr,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Pt,xo(Pt),(i,t)=>{let n=0;for(const c of t)n+=c.evaluate(i);return n}],"*":[Pt,xo(Pt),(i,t)=>{let n=1;for(const c of t)n*=c.evaluate(i);return n}],"-":{type:Pt,overloads:[[[Pt,Pt],(i,[t,n])=>t.evaluate(i)-n.evaluate(i)],[[Pt],(i,[t])=>-t.evaluate(i)]]},"/":[Pt,[Pt,Pt],(i,[t,n])=>t.evaluate(i)/n.evaluate(i)],"%":[Pt,[Pt,Pt],(i,[t,n])=>t.evaluate(i)%n.evaluate(i)],ln2:[Pt,[],()=>Math.LN2],pi:[Pt,[],()=>Math.PI],e:[Pt,[],()=>Math.E],"^":[Pt,[Pt,Pt],(i,[t,n])=>Math.pow(t.evaluate(i),n.evaluate(i))],sqrt:[Pt,[Pt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Pt,[Pt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Pt,[Pt],(i,[t])=>Math.log(t.evaluate(i))],log2:[Pt,[Pt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Pt,[Pt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Pt,[Pt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Pt,[Pt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Pt,[Pt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Pt,[Pt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Pt,[Pt],(i,[t])=>Math.atan(t.evaluate(i))],min:[Pt,xo(Pt),(i,t)=>Math.min(...t.map((n=>n.evaluate(i))))],max:[Pt,xo(Pt),(i,t)=>Math.max(...t.map((n=>n.evaluate(i))))],abs:[Pt,[Pt],(i,[t])=>Math.abs(t.evaluate(i))],round:[Pt,[Pt],(i,[t])=>{const n=t.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[Pt,[Pt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Pt,[Pt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[pr,[Dr,xr],(i,[t,n])=>i.properties()[t.value]===n.value],"filter-id-==":[pr,[xr],(i,[t])=>i.id()===t.value],"filter-type-==":[pr,[Dr],(i,[t])=>i.geometryType()===t.value],"filter-<":[pr,[Dr,xr],(i,[t,n])=>{const c=i.properties()[t.value],f=n.value;return typeof c==typeof f&&c<f}],"filter-id-<":[pr,[xr],(i,[t])=>{const n=i.id(),c=t.value;return typeof n==typeof c&&n<c}],"filter->":[pr,[Dr,xr],(i,[t,n])=>{const c=i.properties()[t.value],f=n.value;return typeof c==typeof f&&c>f}],"filter-id->":[pr,[xr],(i,[t])=>{const n=i.id(),c=t.value;return typeof n==typeof c&&n>c}],"filter-<=":[pr,[Dr,xr],(i,[t,n])=>{const c=i.properties()[t.value],f=n.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[pr,[xr],(i,[t])=>{const n=i.id(),c=t.value;return typeof n==typeof c&&n<=c}],"filter->=":[pr,[Dr,xr],(i,[t,n])=>{const c=i.properties()[t.value],f=n.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[pr,[xr],(i,[t])=>{const n=i.id(),c=t.value;return typeof n==typeof c&&n>=c}],"filter-has":[pr,[xr],(i,[t])=>t.value in i.properties()],"filter-has-id":[pr,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[pr,[xi(Dr)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[pr,[xi(xr)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[pr,[Dr,xi(xr)],(i,[t,n])=>n.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[pr,[Dr,xi(xr)],(i,[t,n])=>(function(c,f,_,v){for(;_<=v;){const T=_+v>>1;if(f[T]===c)return!0;f[T]>c?v=T-1:_=T+1}return!1})(i.properties()[t.value],n.value,0,n.value.length-1)],all:{type:pr,overloads:[[[pr,pr],(i,[t,n])=>t.evaluate(i)&&n.evaluate(i)],[xo(pr),(i,t)=>{for(const n of t)if(!n.evaluate(i))return!1;return!0}]]},any:{type:pr,overloads:[[[pr,pr],(i,[t,n])=>t.evaluate(i)||n.evaluate(i)],[xo(pr),(i,t)=>{for(const n of t)if(n.evaluate(i))return!0;return!1}]]},"!":[pr,[pr],(i,[t])=>!t.evaluate(i)],"is-supported-script":[pr,[Dr],(i,[t])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(t.evaluate(i))}],upcase:[Dr,[Dr],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[Dr,[Dr],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[Dr,xo(xr),(i,t)=>t.map((n=>ur(n.evaluate(i)))).join("")],"resolved-locale":[Dr,[hc],(i,[t])=>t.evaluate(i).resolvedLocale()]});class Nl{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new Pl,this._defaultValue=n?(function(c){if(c.type==="color"&&Ac(c.default))return new Pr(0,0,0,0);switch(c.type){case"color":return Pr.parse(c.default)||null;case"padding":return En.parse(c.default)||null;case"numberArray":return Gn.parse(c.default)||null;case"colorArray":return fn.parse(c.default)||null;case"variableAnchorOffsetCollection":return qn.parse(c.default)||null;case"projectionDefinition":return hi.parse(c.default)||null;default:return c.default===void 0?null:c.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,c,f,_,v){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(t,n,c,f,_,v){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new cn(`Expected value to be one of ${Object.keys(this._enumValues).map((k=>JSON.stringify(k))).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function wo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in vo}function Bl(i,t){const n=new fo(vo,qo,[],t?(function(f){const _={color:ri,string:Dr,number:Pt,enum:Dr,boolean:pr,formatted:Ma,padding:dc,numberArray:xl,colorArray:la,projectionDefinition:oo,resolvedImage:kr,variableAnchorOffsetCollection:pu};return f.type==="array"?xi(_[f.value]||xr,f.length):_[f.type]})(t):void 0),c=n.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Bh(new Nl(c,t)):Wo(n.errors)}class Ho{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Ol(n.expression),this.globalStateRefs=zc(n.expression)}evaluateWithoutErrorHandling(t,n,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(t,n,c,f,_,v)}evaluate(t,n,c,f,_,v){return this._styleExpression.evaluate(t,n,c,f,_,v)}}class Ko{constructor(t,n,c,f){this.kind=t,this.zoomStops=c,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Ol(n.expression),this.globalStateRefs=zc(n.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,n,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(t,n,c,f,_,v)}evaluate(t,n,c,f,_,v){return this._styleExpression.evaluate(t,n,c,f,_,v)}interpolationFactor(t,n,c){return this.interpolationType?zn.interpolationFactor(this.interpolationType,t,n,c):0}}function Rc(i,t){const n=Bl(i,t);if(n.result==="error")return n;const c=n.value.expression,f=Ec(c);if(!f&&!Oa(t))return Wo([new $r("","data expressions not supported")]);const _=Ic(c,["zoom"]);if(!_&&!ja(t))return Wo([new $r("","zoom expressions not supported")]);const v=$l(c);return v||_?v instanceof $r?Wo([v]):v instanceof zn&&!Mc(t)?Wo([new $r("",'"interpolate" expressions cannot be used with this property')]):Bh(v?new Ko(f?"camera":"composite",n.value,v.labels,v instanceof zn?v.interpolation:void 0):new Ho(f?"constant":"source",n.value)):Wo([new $r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fa{constructor(t,n){this._parameters=t,this._specification=n,_n(this,jl(this._parameters,this._specification))}static deserialize(t){return new fa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function $l(i){let t=null;if(i instanceof Cl)t=$l(i.result);else if(i instanceof _c){for(const n of i.args)if(t=$l(n),t)break}else(i instanceof pn||i instanceof zn)&&i.input instanceof ps&&i.input.name==="zoom"&&(t=i);return t instanceof $r||i.eachChild((n=>{const c=$l(n);c instanceof $r?t=c:!t&&c?t=new $r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new $r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function zc(i,t=new Set){return i instanceof Fa&&t.add(i.key),i.eachChild((n=>{zc(n,t)})),t}function ku(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!ku(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Eu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function pa(i){if(i==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ku(i)||(i=Na(i));const t=Bl(i,Eu);if(t.result==="error")throw new Error(t.value.map((n=>`${n.key}: ${n.message}`)).join(", "));return{filter:(n,c,f)=>t.value.evaluate(n,c,{},f),needGeometry:Vl(i),getGlobalStateRefs:()=>zc(t.value.expression)}}function Ul(i,t){return i<t?-1:i>t?1:0}function Vl(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Vl(i[t]))return!0;return!1}function Na(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Dc(i[1],i[2],"=="):t==="!="?Lc(Dc(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Dc(i[1],i[2],t):t==="any"?(n=i.slice(1),["any"].concat(n.map(Na))):t==="all"?["all"].concat(i.slice(1).map(Na)):t==="none"?["all"].concat(i.slice(1).map(Na).map(Lc)):t==="in"?Iu(i[1],i.slice(2)):t==="!in"?Lc(Iu(i[1],i.slice(2))):t==="has"?ef(i[1]):t!=="!has"||Lc(ef(i[1]));var n}function Dc(i,t,n){switch(i){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,i,t]}}function Iu(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((n=>typeof n!=typeof t[0]))?["filter-in-large",i,["literal",t.sort(Ul)]]:["filter-in-small",i,["literal",t]]}}function ef(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Lc(i){return["!",i]}function Vh(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let f="[";for(const _ of i)f+=`${Vh(_)},`;return`${f}]`}const n=Object.keys(i).sort();let c="{";for(let f=0;f<n.length;f++)c+=`${JSON.stringify(n[f])}:${Vh(i[n[f]])},`;return`${c}}`}function op(i){let t="";for(const n of $t)t+=`/${Vh(i[n])}`;return t}function Fc(i){const t=i.value;return t?[new st(i.key,t,"constants have been deprecated as of v8")]:[]}function tn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ws(i){if(Array.isArray(i))return i.map(Ws);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const n in i)t[n]=Ws(i[n]);return t}return tn(i)}function di(i){const t=i.key,n=i.value,c=i.valueSpec||{},f=i.objectElementValidators||{},_=i.style,v=i.styleSpec,T=i.validateSpec;let k=[];const M=Mr(n);if(M!=="object")return[new st(t,n,`object expected, ${M} found`)];for(const A in n){const F=A.split(".")[0],U=co(c,F)||c["*"];let G;if(co(f,F))G=f[F];else if(co(c,F))G=T;else if(f["*"])G=f["*"];else{if(!c["*"]){k.push(new st(t,n[A],`unknown property "${A}"`));continue}G=T}k=k.concat(G({key:(t&&`${t}.`)+A,value:n[A],valueSpec:U,style:_,styleSpec:v,object:n,objectKey:A,validateSpec:T},n))}for(const A in c)f[A]||c[A].required&&c[A].default===void 0&&n[A]===void 0&&k.push(new st(t,n,`missing required property "${A}"`));return k}function ms(i){const t=i.value,n=i.valueSpec,c=i.style,f=i.styleSpec,_=i.key,v=i.arrayElementValidator||i.validateSpec;if(Mr(t)!=="array")return[new st(_,t,`array expected, ${Mr(t)} found`)];if(n.length&&t.length!==n.length)return[new st(_,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new st(_,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let T={type:n.value,values:n.values};f.$version<7&&(T.function=n.function),Mr(n.value)==="object"&&(T=n.value);let k=[];for(let M=0;M<t.length;M++)k=k.concat(v({array:t,arrayIndex:M,value:t[M],valueSpec:T,validateSpec:i.validateSpec,style:c,styleSpec:f,key:`${_}[${M}]`}));return k}function Ba(i){const t=i.key,n=i.value,c=i.valueSpec;let f=Mr(n);return f==="number"&&n!=n&&(f="NaN"),f!=="number"?[new st(t,n,`number expected, ${f} found`)]:"minimum"in c&&n<c.minimum?[new st(t,n,`${n} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&n>c.maximum?[new st(t,n,`${n} is greater than the maximum value ${c.maximum}`)]:[]}function ma(i){const t=i.valueSpec,n=tn(i.value.type);let c,f,_,v={};const T=n!=="categorical"&&i.value.property===void 0,k=!T,M=Mr(i.value.stops)==="array"&&Mr(i.value.stops[0])==="array"&&Mr(i.value.stops[0][0])==="object",A=di({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(G){if(n==="identity")return[new st(G.key,G.value,'identity function may not have a "stops" property')];let H=[];const Q=G.value;return H=H.concat(ms({key:G.key,value:Q,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:F})),Mr(Q)==="array"&&Q.length===0&&H.push(new st(G.key,Q,"array must have at least one stop")),H},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:t,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return n==="identity"&&T&&A.push(new st(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||A.push(new st(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!Mc(i.valueSpec)&&A.push(new st(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(k&&!Oa(i.valueSpec)?A.push(new st(i.key,i.value,"property functions not supported")):T&&!ja(i.valueSpec)&&A.push(new st(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!M||i.value.property!==void 0||A.push(new st(i.key,i.value,'"property" property is required')),A;function F(G){let H=[];const Q=G.value,ie=G.key;if(Mr(Q)!=="array")return[new st(ie,Q,`array expected, ${Mr(Q)} found`)];if(Q.length!==2)return[new st(ie,Q,`array length 2 expected, length ${Q.length} found`)];if(M){if(Mr(Q[0])!=="object")return[new st(ie,Q,`object expected, ${Mr(Q[0])} found`)];if(Q[0].zoom===void 0)return[new st(ie,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new st(ie,Q,"object stop key must have value")];if(_&&_>tn(Q[0].zoom))return[new st(ie,Q[0].zoom,"stop zoom values must appear in ascending order")];tn(Q[0].zoom)!==_&&(_=tn(Q[0].zoom),f=void 0,v={}),H=H.concat(di({key:`${ie}[0]`,value:Q[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:Ba,value:U}}))}else H=H.concat(U({key:`${ie}[0]`,value:Q[0],validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},Q));return wo(Ws(Q[1]))?H.concat([new st(`${ie}[1]`,Q[1],"expressions are not allowed in function stops.")]):H.concat(G.validateSpec({key:`${ie}[1]`,value:Q[1],valueSpec:t,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function U(G,H){const Q=Mr(G.value),ie=tn(G.value),ce=G.value!==null?G.value:H;if(c){if(Q!==c)return[new st(G.key,ce,`${Q} stop domain type must match previous stop domain type ${c}`)]}else c=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean")return[new st(G.key,ce,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&n!=="categorical"){let ze=`number expected, ${Q} found`;return Oa(t)&&n===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new st(G.key,ce,ze)]}return n!=="categorical"||Q!=="number"||isFinite(ie)&&Math.floor(ie)===ie?n!=="categorical"&&Q==="number"&&f!==void 0&&ie<f?[new st(G.key,ce,"stop domain values must appear in ascending order")]:(f=ie,n==="categorical"&&ie in v?[new st(G.key,ce,"stop domain values must be unique")]:(v[ie]=!0,[])):[new st(G.key,ce,`integer expected, found ${ie}`)]}}function $a(i){const t=(i.expressionContext==="property"?Rc:Bl)(Ws(i.value),i.valueSpec);if(t.result==="error")return t.value.map((c=>new st(`${i.key}${c.key}`,i.value,c.message)));const n=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new st(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ol(n))return[new st(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Ol(n))return[new st(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Ic(n,["zoom","feature-state"]))return[new st(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Ec(n))return[new st(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mu(i){const t=i.key,n=i.value,c=Mr(n);return c!=="string"?[new st(t,n,`color expected, ${c} found`)]:Pr.parse(String(n))?[]:[new st(t,n,`color expected, "${n}" found`)]}function Ua(i){const t=i.key,n=i.value,c=i.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(tn(n))===-1&&f.push(new st(t,n,`expected one of [${c.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(c.values).indexOf(tn(n))===-1&&f.push(new st(t,n,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(n)} found`)),f}function Va(i){return ku(Ws(i.value))?$a(_n({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Zl(i)}function Zl(i){const t=i.value,n=i.key;if(Mr(t)!=="array")return[new st(n,t,`array expected, ${Mr(t)} found`)];const c=i.styleSpec;let f,_=[];if(t.length<1)return[new st(n,t,"filter array must have at least 1 element")];switch(_=_.concat(Ua({key:`${n}[0]`,value:t[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),tn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&tn(t[1])==="$type"&&_.push(new st(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new st(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=Mr(t[1]),f!=="string"&&_.push(new st(`${n}[1]`,t[1],`string expected, ${f} found`)));for(let v=2;v<t.length;v++)f=Mr(t[v]),tn(t[1])==="$type"?_=_.concat(Ua({key:`${n}[${v}]`,value:t[v],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&_.push(new st(`${n}[${v}]`,t[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)_=_.concat(Zl({key:`${n}[${v}]`,value:t[v],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Mr(t[1]),t.length!==2?_.push(new st(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&_.push(new st(`${n}[1]`,t[1],`string expected, ${f} found`))}return _}function Xo(i,t){const n=i.key,c=i.validateSpec,f=i.style,_=i.styleSpec,v=i.value,T=i.objectKey,k=_[`${t}_${i.layerType}`];if(!k)return[];const M=T.match(/^(.*)-transition$/);if(t==="paint"&&M&&k[M[1]]&&k[M[1]].transition)return c({key:n,value:v,valueSpec:_.transition,style:f,styleSpec:_});const A=i.valueSpec||k[T];if(!A)return[new st(n,v,`unknown property "${T}"`)];let F;if(Mr(v)==="string"&&Oa(A)&&!A.tokens&&(F=/^{([^}]+)}$/.exec(v)))return[new st(n,v,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const U=[];return i.layerType==="symbol"&&(T==="text-field"&&f&&!f.glyphs&&U.push(new st(n,v,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Ac(Ws(v))&&tn(v.type)==="identity"&&U.push(new st(n,v,'"text-font" does not support identity functions'))),U.concat(c({key:i.key,value:v,valueSpec:A,style:f,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:T}))}function Oc(i){return Xo(i,"paint")}function Au(i){return Xo(i,"layout")}function Yo(i){let t=[];const n=i.value,c=i.key,f=i.style,_=i.styleSpec;if(Mr(n)!=="object")return[new st(c,n,`object expected, ${Mr(n)} found`)];n.type||n.ref||t.push(new st(c,n,'either "type" or "ref" is required'));let v=tn(n.type);const T=tn(n.ref);if(n.id){const k=tn(n.id);for(let M=0;M<i.arrayIndex;M++){const A=f.layers[M];tn(A.id)===k&&t.push(new st(c,n.id,`duplicate layer id "${n.id}", previously used at line ${A.id.__line__}`))}}if("ref"in n){let k;["type","source","source-layer","filter","layout"].forEach((M=>{M in n&&t.push(new st(c,n[M],`"${M}" is prohibited for ref layers`))})),f.layers.forEach((M=>{tn(M.id)===T&&(k=M)})),k?k.ref?t.push(new st(c,n.ref,"ref cannot reference another ref layer")):v=tn(k.type):t.push(new st(c,n.ref,`ref layer "${T}" not found`))}else if(v!=="background")if(n.source){const k=f.sources&&f.sources[n.source],M=k&&tn(k.type);k?M==="vector"&&v==="raster"?t.push(new st(c,n.source,`layer "${n.id}" requires a raster source`)):M!=="raster-dem"&&v==="hillshade"||M!=="raster-dem"&&v==="color-relief"?t.push(new st(c,n.source,`layer "${n.id}" requires a raster-dem source`)):M==="raster"&&v!=="raster"?t.push(new st(c,n.source,`layer "${n.id}" requires a vector source`)):M!=="vector"||n["source-layer"]?M==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?t.push(new st(c,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!n.paint||!n.paint["line-gradient"]||M==="geojson"&&k.lineMetrics||t.push(new st(c,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new st(c,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new st(c,n.source,`source "${n.source}" not found`))}else t.push(new st(c,n,'missing required property "source"'));return t=t.concat(di({key:c,value:n,valueSpec:_.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${c}.type`,value:n.type,valueSpec:_.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:n,objectKey:"type"}),filter:Va,layout:k=>di({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":M=>Au(_n({layerType:v},M))}}),paint:k=>di({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":M=>Oc(_n({layerType:v},M))}})}})),t}function ii(i){const t=i.value,n=i.key,c=Mr(t);return c!=="string"?[new st(n,t,`string expected, ${c} found`)]:[]}const rn={promoteId:function({key:i,value:t}){if(Mr(t)==="string")return ii({key:i,value:t});{const n=[];for(const c in t)n.push(...ii({key:`${i}.${c}`,value:t[c]}));return n}}};function Or(i){const t=i.value,n=i.key,c=i.styleSpec,f=i.style,_=i.validateSpec;if(!t.type)return[new st(n,t,'"type" is required')];const v=tn(t.type);let T;switch(v){case"vector":case"raster":return T=di({key:n,value:t,valueSpec:c[`source_${v.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:rn,validateSpec:_}),T;case"raster-dem":return T=(function(k){var M;const A=(M=k.sourceName)!==null&&M!==void 0?M:"",F=k.value,U=k.styleSpec,G=U.source_raster_dem,H=k.style;let Q=[];const ie=Mr(F);if(F===void 0)return Q;if(ie!=="object")return Q.push(new st("source_raster_dem",F,`object expected, ${ie} found`)),Q;const ce=tn(F.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],pe=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const be in F)!ce&&ze.includes(be)?Q.push(new st(be,F[be],`In "${A}": "${be}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):G[be]?Q=Q.concat(k.validateSpec({key:be,value:F[be],valueSpec:G[be],validateSpec:k.validateSpec,style:H,styleSpec:U})):Q.push(new st(be,F[be],`unknown property "${be}"`));return Q})({sourceName:n,value:t,style:i.style,styleSpec:c,validateSpec:_}),T;case"geojson":if(T=di({key:n,value:t,valueSpec:c.source_geojson,style:f,styleSpec:c,validateSpec:_,objectElementValidators:rn}),t.cluster)for(const k in t.clusterProperties){const[M,A]=t.clusterProperties[k],F=typeof M=="string"?[M,["accumulated"],["get",k]]:M;T.push(...$a({key:`${n}.${k}.map`,value:A,expressionContext:"cluster-map"})),T.push(...$a({key:`${n}.${k}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return T;case"video":return di({key:n,value:t,valueSpec:c.source_video,style:f,validateSpec:_,styleSpec:c});case"image":return di({key:n,value:t,valueSpec:c.source_image,style:f,validateSpec:_,styleSpec:c});case"canvas":return[new st(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ua({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function gs(i){const t=i.value,n=i.styleSpec,c=n.light,f=i.style;let _=[];const v=Mr(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new st("light",t,`object expected, ${v} found`)]),_;for(const T in t){const k=T.match(/^(.*)-transition$/);_=_.concat(k&&c[k[1]]&&c[k[1]].transition?i.validateSpec({key:T,value:t[T],valueSpec:n.transition,validateSpec:i.validateSpec,style:f,styleSpec:n}):c[T]?i.validateSpec({key:T,value:t[T],valueSpec:c[T],validateSpec:i.validateSpec,style:f,styleSpec:n}):[new st(T,t[T],`unknown property "${T}"`)])}return _}function si(i){const t=i.value,n=i.styleSpec,c=n.sky,f=i.style,_=Mr(t);if(t===void 0)return[];if(_!=="object")return[new st("sky",t,`object expected, ${_} found`)];let v=[];for(const T in t)v=v.concat(c[T]?i.validateSpec({key:T,value:t[T],valueSpec:c[T],style:f,styleSpec:n}):[new st(T,t[T],`unknown property "${T}"`)]);return v}function zi(i){const t=i.value,n=i.styleSpec,c=n.terrain,f=i.style;let _=[];const v=Mr(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new st("terrain",t,`object expected, ${v} found`)]),_;for(const T in t)_=_.concat(c[T]?i.validateSpec({key:T,value:t[T],valueSpec:c[T],validateSpec:i.validateSpec,style:f,styleSpec:n}):[new st(T,t[T],`unknown property "${T}"`)]);return _}function So(i){let t=[];const n=i.value,c=i.key;if(Array.isArray(n)){const f=[],_=[];for(const v in n)n[v].id&&f.includes(n[v].id)&&t.push(new st(c,n,`all the sprites' ids must be unique, but ${n[v].id} is duplicated`)),f.push(n[v].id),n[v].url&&_.includes(n[v].url)&&t.push(new st(c,n,`all the sprites' URLs must be unique, but ${n[v].url} is duplicated`)),_.push(n[v].url),t=t.concat(di({key:`${c}[${v}]`,value:n[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return ii({key:c,value:n})}function Hs(i){return t=i.value,t&&t.constructor===Object?[]:[new st(i.key,i.value,`object expected, ${Mr(i.value)} found`)];var t}const wi={"*":()=>[],array:ms,boolean:function(i){const t=i.value,n=i.key,c=Mr(t);return c!=="boolean"?[new st(n,t,`boolean expected, ${c} found`)]:[]},number:Ba,color:Mu,constants:Fc,enum:Ua,filter:Va,function:ma,layer:Yo,object:di,source:Or,light:gs,sky:si,terrain:zi,projection:function(i){const t=i.value,n=i.styleSpec,c=n.projection,f=i.style,_=Mr(t);if(t===void 0)return[];if(_!=="object")return[new st("projection",t,`object expected, ${_} found`)];let v=[];for(const T in t)v=v.concat(c[T]?i.validateSpec({key:T,value:t[T],valueSpec:c[T],style:f,styleSpec:n}):[new st(T,t[T],`unknown property "${T}"`)]);return v},projectionDefinition:function(i){const t=i.key;let n=i.value;n=n instanceof String?n.valueOf():n;const c=Mr(n);return c!=="array"||(function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"})(n)||(function(f){return!!["interpolate","step","literal"].includes(f[0])})(n)?["array","string"].includes(c)?[]:[new st(t,n,`projection expected, invalid type "${c}" found`)]:[new st(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:ii,formatted:function(i){return ii(i).length===0?[]:$a(i)},resolvedImage:function(i){return ii(i).length===0?[]:$a(i)},padding:function(i){const t=i.key,n=i.value;if(Mr(n)==="array"){if(n.length<1||n.length>4)return[new st(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const c={type:"number"};let f=[];for(let _=0;_<n.length;_++)f=f.concat(i.validateSpec({key:`${t}[${_}]`,value:n[_],validateSpec:i.validateSpec,valueSpec:c}));return f}return Ba({key:t,value:n,valueSpec:{}})},numberArray:function(i){const t=i.key,n=i.value;if(Mr(n)==="array"){const c={type:"number"};if(n.length<1)return[new st(t,n,"array length at least 1 expected, length 0 found")];let f=[];for(let _=0;_<n.length;_++)f=f.concat(i.validateSpec({key:`${t}[${_}]`,value:n[_],validateSpec:i.validateSpec,valueSpec:c}));return f}return Ba({key:t,value:n,valueSpec:{}})},colorArray:function(i){const t=i.key,n=i.value;if(Mr(n)==="array"){if(n.length<1)return[new st(t,n,"array length at least 1 expected, length 0 found")];let c=[];for(let f=0;f<n.length;f++)c=c.concat(Mu({key:`${t}[${f}]`,value:n[f]}));return c}return Mu({key:t,value:n})},variableAnchorOffsetCollection:function(i){const t=i.key,n=i.value,c=Mr(n),f=i.styleSpec;if(c!=="array"||n.length<1||n.length%2!=0)return[new st(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let v=0;v<n.length;v+=2)_=_.concat(Ua({key:`${t}[${v}]`,value:n[v],valueSpec:f.layout_symbol["text-anchor"]})),_=_.concat(ms({key:`${t}[${v+1}]`,value:n[v+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:f}));return _},sprite:So,state:Hs};function Za(i){const t=i.value,n=i.valueSpec,c=i.styleSpec;return i.validateSpec=Za,n.expression&&Ac(tn(t))?ma(i):n.expression&&wo(Ws(t))?$a(i):n.type&&wi[n.type]?wi[n.type](i):di(_n({},i,{valueSpec:n.type?c[n.type]:n}))}function Zh(i){const t=i.value,n=i.key,c=ii(i);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new st(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new st(n,t,'"glyphs" url must include a "{range}" token'))),c}function Di(i,t=Ce){let n=[];return n=n.concat(Za({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:Za,objectElementValidators:{glyphs:Zh,"*":()=>[]}})),i.constants&&(n=n.concat(Fc({key:"constants",value:i.constants}))),Qo(n)}function Qi(i){return function(t){return i({...t,validateSpec:Za})}}function Qo(i){return[].concat(i).sort(((t,n)=>t.line-n.line))}function Hn(i){return function(...t){return Qo(i.apply(this,t))}}Di.source=Hn(Qi(Or)),Di.sprite=Hn(Qi(So)),Di.glyphs=Hn(Qi(Zh)),Di.light=Hn(Qi(gs)),Di.sky=Hn(Qi(si)),Di.terrain=Hn(Qi(zi)),Di.state=Hn(Qi(Hs)),Di.layer=Hn(Qi(Yo)),Di.filter=Hn(Qi(Va)),Di.paintProperty=Hn(Qi(Oc)),Di.layoutProperty=Hn(Qi(Au));const Ga=Di,Gh=Ga.light,Gl=Ga.sky,lp=Ga.paintProperty,To=Ga.layoutProperty;function ga(i,t){let n=!1;if(t&&t.length)for(const c of t)i.fire(new et(new Error(c.message))),n=!0;return n}class ya{constructor(t,n,c){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const v=new Int32Array(this.arrayBuffer);t=v[0],this.d=(n=v[1])+2*(c=v[2]);for(let k=0;k<this.d*this.d;k++){const M=v[3+k],A=v[3+k+1];f.push(M===A?null:v.subarray(M,A))}const T=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],T),this.bboxes=v.subarray(T),this.insert=this._insertReadonly}else{this.d=n+2*c;for(let v=0;v<this.d*this.d;v++)f.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=c,this.scale=n/t,this.uid=0;const _=c/n*t;this.min=-_,this.max=t+_}insert(t,n,c,f,_){this._forEachCell(n,c,f,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,c,f,_,v){this.cells[_].push(v)}query(t,n,c,f,_){const v=this.min,T=this.max;if(t<=v&&n<=v&&T<=c&&T<=f&&!_)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(t,n,c,f,this._queryCell,k,{},_),k}}_queryCell(t,n,c,f,_,v,T,k){const M=this.cells[_];if(M!==null){const A=this.keys,F=this.bboxes;for(let U=0;U<M.length;U++){const G=M[U];if(T[G]===void 0){const H=4*G;(k?k(F[H+0],F[H+1],F[H+2],F[H+3]):t<=F[H+2]&&n<=F[H+3]&&c>=F[H+0]&&f>=F[H+1])?(T[G]=!0,v.push(A[G])):T[G]=!1}}}}_forEachCell(t,n,c,f,_,v,T,k){const M=this._convertToCellCoord(t),A=this._convertToCellCoord(n),F=this._convertToCellCoord(c),U=this._convertToCellCoord(f);for(let G=M;G<=F;G++)for(let H=A;H<=U;H++){const Q=this.d*H+G;if((!k||k(this._convertFromCellCoord(G),this._convertFromCellCoord(H),this._convertFromCellCoord(G+1),this._convertFromCellCoord(H+1)))&&_.call(this,t,n,c,f,Q,v,T,k))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let c=0;for(let v=0;v<this.cells.length;v++)c+=this.cells[v].length;const f=new Int32Array(n+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let _=n;for(let v=0;v<t.length;v++){const T=t[v];f[3+v]=_,f.set(T,_),_+=T.length}return f[3+t.length]=_,f.set(this.keys,_),_+=this.keys.length,f[3+t.length+1]=_,f.set(this.bboxes,_),_+=this.bboxes.length,f.buffer}static serialize(t,n){const c=t.toArrayBuffer();return n&&n.push(c),{buffer:c}}static deserialize(t){return new ya(t.buffer)}}const Ji={};function kt(i,t,n={}){if(Ji[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Ji[i]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}kt("Object",Object),kt("Set",Set),kt("TransferableGridIndex",ya),kt("Color",Pr),kt("Error",Error),kt("AJAXError",ue),kt("ResolvedImage",ds),kt("StylePropertyFunction",fa),kt("StyleExpression",Nl,{omit:["_evaluator"]}),kt("ZoomDependentExpression",Ko),kt("ZoomConstantExpression",Ho),kt("CompoundExpression",ps,{omit:["_evaluate"]});for(const i in vo)vo[i]._classRegistryKey||kt(`Expression_${i}`,vo[i]);function es(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Li(i){return i.$name||i.constructor._classRegistryKey}function qa(i){return!(function(t){if(t===null||typeof t!="object")return!1;const n=Li(t);return!(!n||n==="Object")})(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||es(i)||Ri(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function ts(i,t){if(qa(i))return(es(i)||Ri(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const _=[];for(const v of i)_.push(ts(v,t));return _}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const n=Li(i);if(!n)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Ji[n])throw new Error(`${n} is not registered.`);const{klass:c}=Ji[n],f=c.serialize?c.serialize(i,t):{};if(c.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in i){if(!i.hasOwnProperty(_)||Ji[n].omit.indexOf(_)>=0)continue;const v=i[_];f[_]=Ji[n].shallow.indexOf(_)>=0?v:ts(v,t)}i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(f.$name=n),f}function Fi(i){if(qa(i))return i;if(Array.isArray(i))return i.map(Fi);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=Li(i)||"Object";if(!Ji[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Ji[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(i);const c=Object.create(n.prototype);for(const f of Object.keys(i)){if(f==="$name")continue;const _=i[f];c[f]=Ji[t].shallow.indexOf(f)>=0?_:Fi(_)}return c}class _a{constructor(){this.first=!0}update(t,n){const c=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=c,!0))}}const Fr={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Hangul Syllables":i=>i>=44032&&i<=55215,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function ql(i){for(const t of i)if(Ru(t.charCodeAt(0)))return!0;return!1}function qh(i){for(const t of i)if(!vn(t.charCodeAt(0)))return!1;return!0}function Si(i){const t=i.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(t.join("|"),"u")}const ys=Si(["Arab","Dupl","Mong","Ougr","Syrc"]);function vn(i){return!ys.test(String.fromCodePoint(i))}const _s=Si(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ru(i){return!(i!==746&&i!==747&&(i<4352||!(Fr["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Fr["CJK Compatibility"](i)||Fr["CJK Strokes"](i)||!(!Fr["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Fr["Enclosed CJK Letters and Months"](i)||Fr["Ideographic Description Characters"](i)||Fr.Kanbun(i)||Fr.Katakana(i)&&i!==12540||!(!Fr["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Fr["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Fr["Vertical Forms"](i)||Fr["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||_s.test(String.fromCodePoint(i)))))}function Wh(i){return!(Ru(i)||(function(t){return!!(Fr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Fr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Fr["Letterlike Symbols"](t)||Fr["Number Forms"](t)||Fr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Fr["Control Pictures"](t)&&t!==9251||Fr["Optical Character Recognition"](t)||Fr["Enclosed Alphanumerics"](t)||Fr["Geometric Shapes"](t)||Fr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Fr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Fr["CJK Symbols and Punctuation"](t)||Fr.Katakana(t)||Fr["Private Use Area"](t)||Fr["CJK Compatibility Forms"](t)||Fr["Small Form Variants"](t)||Fr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(i))}const zu=Si(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function jc(i){return zu.test(String.fromCodePoint(i))}function Hh(i,t){return!(!t&&jc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Fr.Khmer(i))}function Nc(i){for(const t of i)if(jc(t.charCodeAt(0)))return!0;return!1}const Ms=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(Ms.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,t){return l(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const n=i.pluginURL,c=new Promise((_=>{this.loadScriptResolve=_}));t(n);const f=new Promise((_=>setTimeout((()=>_()),this.TIMEOUT)));if(yield Promise.race([c,f]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:n};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class Wr{constructor(t,n){this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new _a,this.transition=n.transition||{},this.globalState=n.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _a,this.transition={},this.globalState={})}isSupportedScript(t){return(function(n,c){for(const f of n)if(!Hh(f.charCodeAt(0),c))return!1;return!0})(t,Ms.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),c=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*n}}}class Po{constructor(t,n){this.property=t,this.value=n,this.expression=(function(c,f){if(Ac(c))return new fa(c,f);if(wo(c)){const _=Rc(c,f);if(_.result==="error")throw new Error(_.value.map((v=>`${v.key}: ${v.message}`)).join(", "));return _.value}{let _=c;return f.type==="color"&&typeof c=="string"?_=Pr.parse(c):f.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?f.type!=="numberArray"||typeof c!="number"&&!Array.isArray(c)?f.type!=="colorArray"||typeof c!="string"&&!Array.isArray(c)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(c)?_=qn.parse(c):f.type==="projectionDefinition"&&typeof c=="string"&&(_=hi.parse(c)):_=fn.parse(c):_=Gn.parse(c):_=En.parse(c),{globalStateRefs:new Set,kind:"constant",evaluate:()=>_}}})(n===void 0?t.specification.default:n,t.specification),this._evaluate=this.expression.evaluate}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,c){return this.property.possiblyEvaluate(this,t,n,c)}setGlobalState(t){this.expression.evaluate=(n,c,f,_,v,T)=>(n.globalState=t,this._evaluate.call(this.expression,n,c,f,_,v,T))}}class Kh{constructor(t){this.property=t,this.value=new Po(t,void 0)}transitioned(t,n){return new Hl(this.property,this.value,n,sr({},t.transition,this.transition),t.now)}untransitioned(){return new Hl(this.property,this.value,null,{},0)}}class Wl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ln(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Kh(this._values[t].property)),this._values[t].value=new Po(this._values[t].property,n===null?void 0:ln(n))}getTransition(t){return ln(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Kh(this._values[t].property)),this._values[t].transition=ln(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const c=this.getValue(n);c!==void 0&&(t[n]=c);const f=this.getTransition(n);f!==void 0&&(t[`${n}-transition`]=f)}return t}transitioned(t,n){const c=new Du(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(t,n._values[f]);return c}untransitioned(){const t=new Du(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class Hl{constructor(t,n,c,f,_){this.property=t,this.value=n,this.begin=_+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(t,n,c){const f=t.now||0,_=this.value.possiblyEvaluate(t,n,c),v=this.prior;if(v){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return v.possiblyEvaluate(t,n,c);{const T=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,n,c),_,jt(T))}}return _}}class Du{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,c){const f=new Bc(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(t,n,c);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Xh{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState={}}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ln(this._values[t].value)}setValue(t,n){this._values[t]=new Po(this._values[t].property,n===null?void 0:ln(n)),this._values[t].setGlobalState(this._globalState)}serialize(){const t={};for(const n of Object.keys(this._values)){const c=this.getValue(n);c!==void 0&&(t[n]=c)}return t}possiblyEvaluate(t,n,c){const f=new Bc(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(t,n,c);return f}setGlobalState(t){this._globalState=t;for(const n of Object.values(this._values))n.setGlobalState(t)}}class Oi{constructor(t,n,c){this.property=t,this.value=n,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,c,f){return this.property.evaluate(this.value,this.parameters,t,n,c,f)}}class Bc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Lt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,c){const f=Vs[this.specification.type];return f?f(t,n,c):t}}class Yt{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,c,f){return new Oi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},c,f)}:t.expression,n)}interpolate(t,n,c){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Oi(this,{kind:"constant",value:void 0},t.parameters);const f=Vs[this.specification.type];if(f){const _=f(t.value.value,n.value.value,c);return new Oi(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,n,c,f,_,v){return t.kind==="constant"?t.value:t.evaluate(n,c,f,_,v)}}class Wa extends Yt{possiblyEvaluate(t,n,c,f){if(t.value===void 0)return new Oi(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},c,f),v=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(v,v,v,n);return new Oi(this,{kind:"constant",value:T},n)}if(t.expression.kind==="camera"){const _=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Oi(this,{kind:"constant",value:_},n)}return new Oi(this,t.expression,n)}evaluate(t,n,c,f,_,v){if(t.kind==="source"){const T=t.evaluate(n,c,f,_,v);return this._calculate(T,T,T,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},c,f),t.evaluate({zoom:Math.floor(n.zoom)},c,f),t.evaluate({zoom:Math.floor(n.zoom)+1},c,f),n):t.value}_calculate(t,n,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:c,to:n}}interpolate(t){return t}}class va{constructor(t){this.specification=t}possiblyEvaluate(t,n,c,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},c,f);return this._calculate(_,_,_,n)}return this._calculate(t.expression.evaluate(new Wr(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Wr(Math.floor(n.zoom),n)),t.expression.evaluate(new Wr(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:c,to:n}}interpolate(t){return t}}class Kl{constructor(t){this.specification=t}possiblyEvaluate(t,n,c,f){return!!t.expression.evaluate(n,null,{},c,f)}interpolate(){return!1}}class fi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const c=t[n];c.specification.overridable&&this.overridableProperties.push(n);const f=this.defaultPropertyValues[n]=new Po(c,void 0),_=this.defaultTransitionablePropertyValues[n]=new Kh(c);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=f.possiblyEvaluate({})}}}kt("DataDrivenProperty",Yt),kt("DataConstantProperty",Lt),kt("CrossFadedDataDrivenProperty",Wa),kt("CrossFadedProperty",va),kt("ColorRampProperty",Kl);const Lu="-transition";class pi extends zt{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this._globalState={},t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=pa(t.filter)),n.layout&&(this._unevaluatedLayout=new Xh(n.layout)),n.paint)){this._transitionablePaint=new Wl(n.paint);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bc(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=pa(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const c=this._unevaluatedLayout._values[n];for(const f of c.getGlobalStateRefs())t.add(f)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}getPaintAffectingGlobalStateRefs(){var t;const n=new globalThis.Map;if(this._transitionablePaint)for(const c in this._transitionablePaint._values){const f=this._transitionablePaint._values[c].value;for(const _ of f.getGlobalStateRefs()){const v=(t=n.get(_))!==null&&t!==void 0?t:[];v.push({name:c,value:f.value}),n.set(_,v)}}return n}setLayoutProperty(t,n,c={}){n!=null&&this._validate(To,`layers.${this.id}.layout.${t}`,t,n,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Lu)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,c={}){if(n!=null&&this._validate(lp,`layers.${this.id}.paint.${t}`,t,n,c))return!1;if(t.endsWith(Lu))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const f=this._transitionablePaint._values[t],_=f.property.specification["property-type"]==="cross-faded-data-driven",v=f.value.isDataDriven(),T=f.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const k=this._transitionablePaint._values[t].value;return k.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(t,T,k)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.globalState=this._globalState,t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}setGlobalState(t){this._globalState=t,this._unevaluatedLayout&&this._unevaluatedLayout.setGlobalState(t)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ci(t,((n,c)=>!(n===void 0||c==="layout"&&!Object.keys(n).length||c==="paint"&&!Object.keys(n).length)))}_validate(t,n,c,f,_={}){return(!_||_.validate!==!1)&&ga(this,t.call(Ga,{key:n,layerType:this.type,objectKey:c,value:f,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Oi&&Oa(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const As={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ks{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function wn(i,t=1){let n=0,c=0;return{members:i.map((f=>{const _=As[f.type].BYTES_PER_ELEMENT,v=n=Rs(n,Math.max(t,_)),T=f.components||1;return c=Math.max(c,_),n+=_*T,{name:f.name,type:f.type,components:T,offset:v}})),size:Rs(n,Math.max(c,t)),alignment:t}}function Rs(i,t){return Math.ceil(i/t)*t}class vs extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const c=this.length;return this.resize(c+1),this.emplace(c,t,n)}emplace(t,n,c){const f=2*t;return this.int16[f+0]=n,this.int16[f+1]=c,t}}vs.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",vs);class Co extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,c)}emplace(t,n,c,f){const _=3*t;return this.int16[_+0]=n,this.int16[_+1]=c,this.int16[_+2]=f,t}}Co.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",Co);class Fu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,c,f)}emplace(t,n,c,f,_){const v=4*t;return this.int16[v+0]=n,this.int16[v+1]=c,this.int16[v+2]=f,this.int16[v+3]=_,t}}Fu.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",Fu);class rs extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,c,f,_,v)}emplace(t,n,c,f,_,v,T){const k=6*t;return this.int16[k+0]=n,this.int16[k+1]=c,this.int16[k+2]=f,this.int16[k+3]=_,this.int16[k+4]=v,this.int16[k+5]=T,t}}rs.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",rs);class ns extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,c,f,_,v)}emplace(t,n,c,f,_,v,T){const k=4*t,M=8*t;return this.int16[k+0]=n,this.int16[k+1]=c,this.uint8[M+4]=f,this.uint8[M+5]=_,this.uint8[M+6]=v,this.uint8[M+7]=T,t}}ns.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",ns);class ko extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const c=this.length;return this.resize(c+1),this.emplace(c,t,n)}emplace(t,n,c){const f=2*t;return this.float32[f+0]=n,this.float32[f+1]=c,t}}ko.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",ko);class $c extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v,T,k,M,A){const F=this.length;return this.resize(F+1),this.emplace(F,t,n,c,f,_,v,T,k,M,A)}emplace(t,n,c,f,_,v,T,k,M,A,F){const U=10*t;return this.uint16[U+0]=n,this.uint16[U+1]=c,this.uint16[U+2]=f,this.uint16[U+3]=_,this.uint16[U+4]=v,this.uint16[U+5]=T,this.uint16[U+6]=k,this.uint16[U+7]=M,this.uint16[U+8]=A,this.uint16[U+9]=F,t}}$c.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",$c);class xa extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v,T,k,M,A,F,U){const G=this.length;return this.resize(G+1),this.emplace(G,t,n,c,f,_,v,T,k,M,A,F,U)}emplace(t,n,c,f,_,v,T,k,M,A,F,U,G){const H=12*t;return this.int16[H+0]=n,this.int16[H+1]=c,this.int16[H+2]=f,this.int16[H+3]=_,this.uint16[H+4]=v,this.uint16[H+5]=T,this.uint16[H+6]=k,this.uint16[H+7]=M,this.int16[H+8]=A,this.int16[H+9]=F,this.int16[H+10]=U,this.int16[H+11]=G,t}}xa.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",xa);class Ou extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,c)}emplace(t,n,c,f){const _=3*t;return this.float32[_+0]=n,this.float32[_+1]=c,this.float32[_+2]=f,t}}Ou.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",Ou);class Jo extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}Jo.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",Jo);class xs extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v,T,k,M){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,c,f,_,v,T,k,M)}emplace(t,n,c,f,_,v,T,k,M,A){const F=10*t,U=5*t;return this.int16[F+0]=n,this.int16[F+1]=c,this.int16[F+2]=f,this.int16[F+3]=_,this.int16[F+4]=v,this.int16[F+5]=T,this.uint32[U+3]=k,this.uint16[F+8]=M,this.uint16[F+9]=A,t}}xs.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",xs);class el extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,c,f,_,v)}emplace(t,n,c,f,_,v,T){const k=6*t;return this.int16[k+0]=n,this.int16[k+1]=c,this.int16[k+2]=f,this.int16[k+3]=_,this.int16[k+4]=v,this.int16[k+5]=T,t}}el.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",el);class g extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,c,f,_)}emplace(t,n,c,f,_,v){const T=4*t,k=8*t;return this.float32[T+0]=n,this.float32[T+1]=c,this.float32[T+2]=f,this.int16[k+6]=_,this.int16[k+7]=v,t}}g.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",g);class e extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,c,f,_,v)}emplace(t,n,c,f,_,v,T){const k=16*t,M=4*t,A=8*t;return this.uint8[k+0]=n,this.uint8[k+1]=c,this.float32[M+1]=f,this.float32[M+2]=_,this.int16[A+6]=v,this.int16[A+7]=T,t}}e.prototype.bytesPerElement=16,kt("StructArrayLayout2ub2f2i16",e);class s extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,c)}emplace(t,n,c,f){const _=3*t;return this.uint16[_+0]=n,this.uint16[_+1]=c,this.uint16[_+2]=f,t}}s.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",s);class h extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce){const ze=this.length;return this.resize(ze+1),this.emplace(ze,t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce)}emplace(t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce,ze){const pe=24*t,be=12*t,Ue=48*t;return this.int16[pe+0]=n,this.int16[pe+1]=c,this.uint16[pe+2]=f,this.uint16[pe+3]=_,this.uint32[be+2]=v,this.uint32[be+3]=T,this.uint32[be+4]=k,this.uint16[pe+10]=M,this.uint16[pe+11]=A,this.uint16[pe+12]=F,this.float32[be+7]=U,this.float32[be+8]=G,this.uint8[Ue+36]=H,this.uint8[Ue+37]=Q,this.uint8[Ue+38]=ie,this.uint32[be+10]=ce,this.int16[pe+22]=ze,t}}h.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",h);class p extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce,ze,pe,be,Ue,We,it,Tt,yt,wt,qt,xt){const St=this.length;return this.resize(St+1),this.emplace(St,t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce,ze,pe,be,Ue,We,it,Tt,yt,wt,qt,xt)}emplace(t,n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce,ze,pe,be,Ue,We,it,Tt,yt,wt,qt,xt,St){const tt=32*t,ir=16*t;return this.int16[tt+0]=n,this.int16[tt+1]=c,this.int16[tt+2]=f,this.int16[tt+3]=_,this.int16[tt+4]=v,this.int16[tt+5]=T,this.int16[tt+6]=k,this.int16[tt+7]=M,this.uint16[tt+8]=A,this.uint16[tt+9]=F,this.uint16[tt+10]=U,this.uint16[tt+11]=G,this.uint16[tt+12]=H,this.uint16[tt+13]=Q,this.uint16[tt+14]=ie,this.uint16[tt+15]=ce,this.uint16[tt+16]=ze,this.uint16[tt+17]=pe,this.uint16[tt+18]=be,this.uint16[tt+19]=Ue,this.uint16[tt+20]=We,this.uint16[tt+21]=it,this.uint16[tt+22]=Tt,this.uint32[ir+12]=yt,this.float32[ir+13]=wt,this.float32[ir+14]=qt,this.uint16[tt+30]=xt,this.uint16[tt+31]=St,t}}p.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",p);class y extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}y.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",y);class S extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,c)}emplace(t,n,c,f){const _=3*t;return this.uint16[6*t+0]=n,this.float32[_+1]=c,this.float32[_+2]=f,t}}S.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",S);class E extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,c)}emplace(t,n,c,f){const _=4*t;return this.uint32[2*t+0]=n,this.uint16[_+2]=c,this.uint16[_+3]=f,t}}E.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",E);class I extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const c=this.length;return this.resize(c+1),this.emplace(c,t,n)}emplace(t,n,c){const f=2*t;return this.uint16[f+0]=n,this.uint16[f+1]=c,t}}I.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",I);class z extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}z.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",z);class D extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,c,f)}emplace(t,n,c,f,_){const v=4*t;return this.float32[v+0]=n,this.float32[v+1]=c,this.float32[v+2]=f,this.float32[v+3]=_,t}}D.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",D);class B extends Ks{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new L(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class j extends xs{get(t){return new B(this,t)}}kt("CollisionBoxArray",j);class $ extends Ks{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}$.prototype.size=48;class W extends h{get(t){return new $(this,t)}}kt("PlacedSymbolArray",W);class re extends Ks{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}re.prototype.size=64;class se extends p{get(t){return new re(this,t)}}kt("SymbolInstanceArray",se);class ae extends y{getoffsetX(t){return this.float32[1*t+0]}}kt("GlyphOffsetArray",ae);class oe extends Co{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}kt("SymbolLineVertexArray",oe);class de extends Ks{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}de.prototype.size=12;class le extends S{get(t){return new de(this,t)}}kt("TextAnchorOffsetArray",le);class ge extends Ks{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ge.prototype.size=8;class we extends E{get(t){return new ge(this,t)}}kt("FeatureIndexArray",we);class he extends vs{}class ke extends vs{}class $e extends vs{}class je extends rs{}class Ne extends ns{}class Ze extends ko{}class ht extends $c{}class mt extends xa{}class rt extends Ou{}class Ft extends Jo{}class br extends el{}class Zr extends e{}class nn extends s{}class Qr extends I{}const un=wn([{name:"a_pos",components:2,type:"Int16"}],4),{members:xn}=un;class mr{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,c,f){const _=this.segments[this.segments.length-1];return t>mr.MAX_VERTEX_ARRAY_LENGTH&&Nr(`Max vertices per segment is ${mr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${mr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+t>mr.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f?this.createNewSegment(n,c,f):_}createNewSegment(t,n,c){const f={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(f.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(t,n,c){return this.prepareSegment(0,t,n,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,c,f){return new mr([{vertexOffset:t,primitiveOffset:n,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function Xr(i,t){return 256*(i=Kt(Math.floor(i),0,255))+Kt(Math.floor(t),0,255)}mr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",mr);const Dn=wn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ln,Kn,Ti,zs={exports:{}},Ha={exports:{}},ba={exports:{}},tl=(function(){if(Ti)return zs.exports;Ti=1;var i=(Ln||(Ln=1,Ha.exports=function(n,c){var f,_,v,T,k,M,A,F;for(_=n.length-(f=3&n.length),v=c,k=3432918353,M=461845907,F=0;F<_;)A=255&n.charCodeAt(F)|(255&n.charCodeAt(++F))<<8|(255&n.charCodeAt(++F))<<16|(255&n.charCodeAt(++F))<<24,++F,v=27492+(65535&(T=5*(65535&(v=(v^=A=(65535&(A=(A=(65535&A)*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*M+(((A>>>16)*M&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(A=0,f){case 3:A^=(255&n.charCodeAt(F+2))<<16;case 2:A^=(255&n.charCodeAt(F+1))<<8;case 1:v^=A=(65535&(A=(A=(65535&(A^=255&n.charCodeAt(F)))*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*M+(((A>>>16)*M&65535)<<16)&4294967295}return v^=n.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Ha.exports),t=(Kn||(Kn=1,ba.exports=function(n,c){for(var f,_=n.length,v=c^_,T=0;_>=4;)f=1540483477*(65535&(f=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24))+((1540483477*(f>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),_-=4,++T;switch(_){case 3:v^=(255&n.charCodeAt(T+2))<<16;case 2:v^=(255&n.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&n.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),ba.exports);return zs.exports=i,zs.exports.murmur3=i,zs.exports.murmur2=t,zs.exports})(),rl=N(tl);class Eo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,c,f){this.ids.push(nl(t)),this.positions.push(n,c,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=nl(t);let c=0,f=this.ids.length-1;for(;c<f;){const v=c+f>>1;this.ids[v]>=n?f=v:c=v+1}const _=[];for(;this.ids[c]===n;)_.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return _}static serialize(t,n){const c=new Float64Array(t.ids),f=new Uint32Array(t.positions);return ji(c,f,0,c.length-1),n&&n.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(t){const n=new Eo;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function nl(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:rl(String(i))}function ji(i,t,n,c){for(;n<c;){const f=i[n+c>>1];let _=n-1,v=c+1;for(;;){do _++;while(i[_]<f);do v--;while(i[v]>f);if(_>=v)break;Xs(i,_,v),Xs(t,3*_,3*v),Xs(t,3*_+1,3*v+1),Xs(t,3*_+2,3*v+2)}v-n<c-v?(ji(i,t,n,v),n=v+1):(ji(i,t,v+1,c),c=v)}}function Xs(i,t,n){const c=i[t];i[t]=i[n],i[n]=c}kt("FeaturePositionMap",Eo);class Ni{constructor(t,n){this.gl=t.gl,this.location=n}}class Ka extends Ni{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Fn extends Ni{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Nn extends Ni{constructor(t,n){super(t,n),this.current=Pr.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Bi=new Float32Array(16);function Bn(i){return[Xr(255*i.r,255*i.g),Xr(255*i.b,255*i.a)]}class Uc{constructor(t,n,c){this.value=t,this.uniformNames=n.map((f=>`u_${f}`)),this.type=c}setUniform(t,n,c){t.set(c.constantOr(this.value))}getBinding(t,n,c){return this.type==="color"?new Nn(t,n):new Ka(t,n)}}class Xl{constructor(t,n){this.uniformNames=n.map((c=>`u_${c}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,c,f){const _=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&t.set(_)}getBinding(t,n,c){return c.substr(0,9)==="u_pattern"?new Fn(t,n):new Ka(t,n)}}class Xn{constructor(t,n,c,f){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=n.map((_=>({name:`a_${_}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(t,n,c){const f=this.paintVertexArray.length,_=this.expression.evaluate(new Wr(0,c),n,{},c.canonical,[],c.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(f,t,_)}updatePaintArray(t,n,c,f,_){const v=this.expression.evaluate(new Wr(0,_),c,f);this._setPaintValue(t,n,v)}_setPaintValue(t,n,c){if(this.type==="color"){const f=Bn(c);for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=t;f<n;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bs{constructor(t,n,c,f,_,v){this.expression=t,this.uniformNames=n.map((T=>`u_${T}_t`)),this.type=c,this.useIntegerZoom=f,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map((T=>({name:`a_${T}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(t,n,c){const f=this.expression.evaluate(new Wr(this.zoom,c),n,{},c.canonical,[],c.formattedSection),_=this.expression.evaluate(new Wr(this.zoom+1,c),n,{},c.canonical,[],c.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,f,_)}updatePaintArray(t,n,c,f,_){const v=this.expression.evaluate(new Wr(this.zoom,_),c,f),T=this.expression.evaluate(new Wr(this.zoom+1,_),c,f);this._setPaintValue(t,n,v,T)}_setPaintValue(t,n,c,f){if(this.type==="color"){const _=Bn(c),v=Bn(f);for(let T=t;T<n;T++)this.paintVertexArray.emplace(T,_[0],_[1],v[0],v[1])}else{for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const c=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,f=Kt(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,n,c){return new Ka(t,n)}}class Ys{constructor(t,n,c,f,_,v){this.expression=t,this.type=n,this.useIntegerZoom=c,this.zoom=f,this.layerId=v,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,n,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,n.patterns&&n.patterns[this.layerId],c.imagePositions)}updatePaintArray(t,n,c,f,_){this._setPaintValues(t,n,c.patterns&&c.patterns[this.layerId],_.imagePositions)}_setPaintValues(t,n,c,f){if(!f||!c)return;const{min:_,mid:v,max:T}=c,k=f[_],M=f[v],A=f[T];if(k&&M&&A)for(let F=t;F<n;F++)this.zoomInPaintVertexArray.emplace(F,M.tl[0],M.tl[1],M.br[0],M.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],M.pixelRatio,k.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,M.tl[0],M.tl[1],M.br[0],M.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],M.pixelRatio,A.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Dn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Dn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Yh{constructor(t,n,c){this.binders={},this._buffers=[];const f=[];for(const _ in t.paint._values){if(!c(_))continue;const v=t.paint.get(_);if(!(v instanceof Oi&&Oa(v.property.specification)))continue;const T=Qh(_,t.type),k=v.value,M=v.property.specification.type,A=v.property.useIntegerZoom,F=v.property.specification["property-type"],U=F==="cross-faded"||F==="cross-faded-data-driven";if(k.kind==="constant")this.binders[_]=U?new Xl(k.value,T):new Uc(k.value,T,M),f.push(`/u_${_}`);else if(k.kind==="source"||U){const G=Vc(_,M,"source");this.binders[_]=U?new Ys(k,M,A,n,G,t.id):new Xn(k,T,M,G),f.push(`/a_${_}`)}else{const G=Vc(_,M,"composite");this.binders[_]=new bs(k,T,M,A,n,G),f.push(`/z_${_}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof Xn||n instanceof bs?n.maxValue:0}populatePaintArrays(t,n,c){for(const f in this.binders){const _=this.binders[f];(_ instanceof Xn||_ instanceof bs||_ instanceof Ys)&&_.populatePaintArray(t,n,c)}}setConstantPatternPositions(t,n){for(const c in this.binders){const f=this.binders[c];f instanceof Xl&&f.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,c,f,_){let v=!1;for(const T in t){const k=n.getPositions(T);for(const M of k){const A=c.feature(M.index);for(const F in this.binders){const U=this.binders[F];if((U instanceof Xn||U instanceof bs||U instanceof Ys)&&U.expression.isStateDependent===!0){const G=f.paint.get(F);U.expression=G.value,U.updatePaintArray(M.start,M.end,A,t[T],_),v=!0}}}}return v}defines(){const t=[];for(const n in this.binders){const c=this.binders[n];(c instanceof Uc||c instanceof Xl)&&t.push(...c.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const c=this.binders[n];if(c instanceof Xn||c instanceof bs)for(let f=0;f<c.paintVertexAttributes.length;f++)t.push(c.paintVertexAttributes[f].name);else if(c instanceof Ys)for(let f=0;f<Dn.members.length;f++)t.push(Dn.members[f].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const c=this.binders[n];if(c instanceof Uc||c instanceof Xl||c instanceof bs)for(const f of c.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const c=[];for(const f in this.binders){const _=this.binders[f];if(_ instanceof Uc||_ instanceof Xl||_ instanceof bs){for(const v of _.uniformNames)if(n[v]){const T=_.getBinding(t,n[v],v);c.push({name:v,property:f,binding:T})}}}return c}setUniforms(t,n,c,f){for(const{name:_,property:v,binding:T}of n)this.binders[v].setUniform(T,f,c.get(v),_)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const c=this.binders[n];if(t&&c instanceof Ys){const f=t.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof Xn||c instanceof bs)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(t){for(const n in this.binders){const c=this.binders[n];(c instanceof Xn||c instanceof bs||c instanceof Ys)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof Xn||n instanceof bs||n instanceof Ys)&&n.destroy()}}}class is{constructor(t,n,c=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new Yh(f,n,c);this.needsUpload=!1,this._featureMap=new Eo,this._bufferOffset=0}populatePaintArrays(t,n,c,f){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,n,f);n.id!==void 0&&this._featureMap.add(n.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,c,f){for(const _ of c)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,n,_,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Qh(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Vc(i,t,n){const c={color:{source:ko,composite:D},number:{source:y,composite:ko}},f=(function(_){return{"line-pattern":{source:ht,composite:ht},"fill-pattern":{source:ht,composite:ht},"fill-extrusion-pattern":{source:ht,composite:ht}}[_]})(i);return f&&f[n]||c[t][n]}kt("ConstantBinder",Uc),kt("CrossFadedConstantBinder",Xl),kt("SourceExpressionBinder",Xn),kt("CrossFadedCompositeBinder",Ys),kt("CompositeExpressionBinder",bs),kt("ProgramConfiguration",Yh,{omit:["_buffers"]}),kt("ProgramConfigurationSet",is);const Xa=Math.pow(2,14)-1,Yl=-Xa-1;function wa(i){const t=ft/i.extent,n=i.loadGeometry();for(let c=0;c<n.length;c++){const f=n[c];for(let _=0;_<f.length;_++){const v=f[_],T=Math.round(v.x*t),k=Math.round(v.y*t);v.x=Kt(T,Yl,Xa),v.y=Kt(k,Yl,Xa),(T<v.x||T>v.x+1||k<v.y||k>v.y+1)&&Nr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ya(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?wa(i):[]}}const cp=-32768;function Pm(i,t,n,c,f){i.emplaceBack(cp+8*t+c,cp+8*n+f)}class tf{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.indexArray=new nn,this.segments=new mr,this.programConfigurations=new is(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,c){const f=this.layers[0],_=[];let v=null,T=!1,k=f.type==="heatmap";if(f.type==="circle"){const A=f;v=A.layout.get("circle-sort-key"),T=!v.isConstant(),k=k||A.paint.get("circle-pitch-alignment")==="map"}const M=k?n.subdivisionGranularity.circle:1;for(const{feature:A,id:F,index:U,sourceLayerIndex:G}of t){const H=this.layers[0]._featureFilter.needGeometry,Q=Ya(A,H);if(!this.layers[0]._featureFilter.filter(new Wr(this.zoom,{globalState:this.globalState}),Q,c))continue;const ie=T?v.evaluate(Q,{},c):void 0,ce={id:F,properties:A.properties,type:A.type,sourceLayerIndex:G,index:U,geometry:H?Q.geometry:wa(A),patterns:{},sortKey:ie};_.push(ce)}T&&_.sort(((A,F)=>A.sortKey-F.sortKey));for(const A of _){const{geometry:F,index:U,sourceLayerIndex:G}=A,H=t[U].feature;this.addFeature(A,F,U,c,M),n.featureIndex.insert(H,F,U,G,this.index)}}update(t,n,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:c,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,c,f,_=1){let v;switch(_){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const T=v.length;for(const k of n)for(const M of k){const A=M.x,F=M.y;if(A<0||A>=ft||F<0||F>=ft)continue;const U=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,t.sortKey),G=U.vertexLength;for(let H=0;H<T;H++)for(let Q=0;Q<T;Q++)Pm(this.layoutVertexArray,A,F,v[Q],v[H]);for(let H=0;H<T-1;H++)for(let Q=0;Q<T-1;Q++){const ie=G+H*T+Q,ce=G+(H+1)*T+Q;this.indexArray.emplaceBack(ie,ce+1,ie+1),this.indexArray.emplaceBack(ie,ce,ce+1)}U.vertexLength+=T*T,U.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{imagePositions:{},canonical:f,globalState:this.globalState})}}function up(i,t){for(let n=0;n<i.length;n++)if(Zc(t,i[n]))return!0;for(let n=0;n<t.length;n++)if(Zc(i,t[n]))return!0;return!!$i(i,t)}function Cm(i,t,n){return!!Zc(i,t)||!!rf(t,i,n)}function km(i,t){if(i.length===1)return dp(t,i[0]);for(let n=0;n<t.length;n++){const c=t[n];for(let f=0;f<c.length;f++)if(Zc(i,c[f]))return!0}for(let n=0;n<i.length;n++)if(dp(t,i[n]))return!0;for(let n=0;n<t.length;n++)if($i(i,t[n]))return!0;return!1}function Ds(i,t,n){if(i.length>1){if($i(i,t))return!0;for(let c=0;c<t.length;c++)if(rf(t[c],i,n))return!0}for(let c=0;c<i.length;c++)if(rf(i[c],t,n))return!0;return!1}function $i(i,t){if(i.length===0||t.length===0)return!1;for(let n=0;n<i.length-1;n++){const c=i[n],f=i[n+1];for(let _=0;_<t.length-1;_++)if(Em(c,f,t[_],t[_+1]))return!0}return!1}function Em(i,t,n,c){return Cn(i,n,c)!==Cn(t,n,c)&&Cn(i,t,n)!==Cn(i,t,c)}function rf(i,t,n){const c=n*n;if(t.length===1)return i.distSqr(t[0])<c;for(let f=1;f<t.length;f++)if(hp(i,t[f-1],t[f])<c)return!0;return!1}function hp(i,t,n){const c=t.distSqr(n);if(c===0)return i.distSqr(t);const f=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/c;return i.distSqr(f<0?t:f>1?n:n.sub(t)._mult(f)._add(t))}function dp(i,t){let n,c,f,_=!1;for(let v=0;v<i.length;v++){n=i[v];for(let T=0,k=n.length-1;T<n.length;k=T++)c=n[T],f=n[k],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(_=!_)}return _}function Zc(i,t){let n=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const _=i[c],v=i[f];_.y>t.y!=v.y>t.y&&t.x<(v.x-_.x)*(t.y-_.y)/(v.y-_.y)+_.x&&(n=!n)}return n}function fp(i,t,n){const c=n[0],f=n[2];if(i.x<c.x&&t.x<c.x||i.x>f.x&&t.x>f.x||i.y<c.y&&t.y<c.y||i.y>f.y&&t.y>f.y)return!1;const _=Cn(i,t,n[0]);return _!==Cn(i,t,n[1])||_!==Cn(i,t,n[2])||_!==Cn(i,t,n[3])}function ju(i,t,n){const c=t.paint.get(i).value;return c.kind==="constant"?c.value:n.programConfigurations.get(t.id).getMaxValue(i)}function Nu(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Jh(i,t,n,c,f){if(!t[0]&&!t[1])return i;const _=L.convert(t)._mult(f);n==="viewport"&&_._rotate(-c);const v=[];for(let T=0;T<i.length;T++)v.push(i[T].sub(_));return v}let pp,nf;kt("CircleBucket",tf,{omit:["layers"]});var mp={get paint(){return nf=nf||new fi({"circle-radius":new Yt(Ce.paint_circle["circle-radius"]),"circle-color":new Yt(Ce.paint_circle["circle-color"]),"circle-blur":new Yt(Ce.paint_circle["circle-blur"]),"circle-opacity":new Yt(Ce.paint_circle["circle-opacity"]),"circle-translate":new Lt(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Lt(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Lt(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Lt(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yt(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yt(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yt(Ce.paint_circle["circle-stroke-opacity"])})},get layout(){return pp=pp||new fi({"circle-sort-key":new Yt(Ce.layout_circle["circle-sort-key"])})}};class Im extends pi{constructor(t){super(t,mp)}createBucket(t){return new tf(t)}queryRadius(t){const n=t;return ju("circle-radius",this,n)+ju("circle-stroke-width",this,n)+Nu(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:c,geometry:f,transform:_,pixelsToTileUnits:v,unwrappedTileID:T,getElevation:k}){const M=Jh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,v),A=this.paint.get("circle-radius").evaluate(n,c)+this.paint.get("circle-stroke-width").evaluate(n,c),F=this.paint.get("circle-pitch-alignment")==="map",U=F?M:(function(H,Q,ie,ce){return H.map((ze=>sf(ze,Q,ie,ce)))})(M,_,T,k),G=F?A*v:A;for(const H of f)for(const Q of H){const ie=F?Q:sf(Q,_,T,k);let ce=G;const ze=_.projectTileCoordinates(Q.x,Q.y,T,k).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=ze/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=_.cameraToCenterDistance/ze),Cm(U,ie,ce))return!0}return!1}}function sf(i,t,n,c){const f=t.projectTileCoordinates(i.x,i.y,n,c).point;return new L((.5*f.x+.5)*t.width,(.5*-f.y+.5)*t.height)}class ed extends tf{}let Mm;kt("HeatmapBucket",ed,{omit:["layers"]});var Am={get paint(){return Mm=Mm||new fi({"heatmap-radius":new Yt(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yt(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Lt(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Kl(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Lt(Ce.paint_heatmap["heatmap-opacity"])})}};function td(i,{width:t,height:n},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*n*c)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*n*c}`)}else f=new Uint8Array(t*n*c);return i.width=t,i.height=n,i.data=f,i}function gp(i,{width:t,height:n},c){if(t===i.width&&n===i.height)return;const f=td({},{width:t,height:n},c);Bu(i,f,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,n)},c),i.width=t,i.height=n,i.data=f.data}function Bu(i,t,n,c,f,_){if(f.width===0||f.height===0)return t;if(f.width>i.width||f.height>i.height||n.x>i.width-f.width||n.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=i.data,T=t.data;if(v===T)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<f.height;k++){const M=((n.y+k)*i.width+n.x)*_,A=((c.y+k)*t.width+c.x)*_;for(let F=0;F<f.width*_;F++)T[A+F]=v[M+F]}return t}class Qs{constructor(t,n){td(this,t,1,n)}resize(t){gp(this,t,1)}clone(){return new Qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,c,f,_){Bu(t,n,c,f,_,1)}}class ws{constructor(t,n){td(this,t,4,n)}resize(t){gp(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ws({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,c,f,_){Bu(t,n,c,f,_,4)}setPixel(t,n,c){const f=4*(t*this.width+n);this.data[f+0]=Math.round(255*c.r/c.a),this.data[f+1]=Math.round(255*c.g/c.a),this.data[f+2]=Math.round(255*c.b/c.a),this.data[f+3]=Math.round(255*c.a)}}function yp(i){const t={},n=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new ws({width:n,height:c});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const _=(v,T,k)=>{t[i.evaluationKey]=k;const M=i.expression.evaluate(t);f.setPixel(v/4/n,T/4,M)};if(i.clips)for(let v=0,T=0;v<c;++v,T+=4*n)for(let k=0,M=0;k<n;k++,M+=4){const A=k/(n-1),{start:F,end:U}=i.clips[v];_(T,M,F*(1-A)+U*A)}else for(let v=0,T=0;v<n;v++,T+=4)_(0,T,v/(n-1));return f}kt("AlphaImage",Qs),kt("RGBAImage",ws);const rd="big-fb";class Rm extends pi{createBucket(t){return new ed(t)}constructor(t){super(t,Am),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(rd)&&this.heatmapFbos.delete(rd)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let _p;var nd={get paint(){return _p=_p||new fi({"hillshade-illumination-direction":new Lt(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Lt(Ce.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Lt(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Lt(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Lt(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Lt(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Lt(Ce.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Lt(Ce.paint_hillshade["hillshade-method"])})}};class ss extends pi{constructor(t){super(t,nd),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,c=this.paint.get("hillshade-highlight-color").values,f=this.paint.get("hillshade-shadow-color").values;const _=Math.max(t.length,n.length,c.length,f.length);t=t.concat(Array(_-t.length).fill(t.at(-1))),n=n.concat(Array(_-n.length).fill(n.at(-1))),c=c.concat(Array(_-c.length).fill(c.at(-1))),f=f.concat(Array(_-f.length).fill(f.at(-1)));const v=n.map(vt);return{directionRadians:t.map(vt),altitudeRadians:v,shadowColor:f,highlightColor:c}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let zm;var ay={get paint(){return zm=zm||new fi({"color-relief-opacity":new Lt(Ce["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Kl(Ce["paint_color-relief"]["color-relief-color"])})}};class $u{constructor(t,n,c,f){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(n,f)}update(t,n,c){const{width:f,height:_}=t,v=!(this.size&&this.size[0]===f&&this.size[1]===_||c),{context:T}=this,{gl:k}=T;if(this.useMipmap=!!(n&&n.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[f,_],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Ri(t)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,t):k.texImage2D(k.TEXTURE_2D,0,this.format,f,_,0,this.format,k.UNSIGNED_BYTE,t.data);else{const{x:M,y:A}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Ri(t)?k.texSubImage2D(k.TEXTURE_2D,0,M,A,k.RGBA,k.UNSIGNED_BYTE,t):k.texSubImage2D(k.TEXTURE_2D,0,M,A,f,_,k.RGBA,k.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),T.pixelStoreUnpackFlipY.setDefault(),T.pixelStoreUnpack.setDefault(),T.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,c){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),c!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=_.LINEAR),t!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,t),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,c||t),this.filter=t),n!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,n),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Ui{constructor(t,n,c,f=1,_=1,v=1,T=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void Nr(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const k=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=_,this.blueFactor=v,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<k;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(k,M)]=this.data[this._idx(k-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,k)]=this.data[this._idx(M,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<k;M++)for(let A=0;A<k;A++){const F=this.get(M,A);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,n){const c=new Uint8Array(this.data.buffer),f=4*this._idx(t,n);return this.unpack(c[f],c[f+1],c[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,c){return t*this.redFactor+n*this.greenFactor+c*this.blueFactor-this.baseShift}pack(t){return Dm(t,this.getUnpackVector())}getPixels(){return new ws({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=n*this.dim,_=n*this.dim+this.dim,v=c*this.dim,T=c*this.dim+this.dim;switch(n){case-1:f=_-1;break;case 1:_=f+1}switch(c){case-1:v=T-1;break;case 1:T=v+1}const k=-n*this.dim,M=-c*this.dim;for(let A=v;A<T;A++)for(let F=f;F<_;F++)this.data[this._idx(F,A)]=t.data[this._idx(F+k,A+M)]}}function Dm(i,t){const n=t[0],c=t[1],f=t[2],_=t[3],v=Math.min(n,c,f),T=Math.round((i+_)/v);return{r:Math.floor(T*v/n)%256,g:Math.floor(T*v/c)%256,b:Math.floor(T*v/f)%256}}kt("DEMData",Ui);class Ut extends pi{constructor(t){super(t,ay)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},c=this._transitionablePaint._values["color-relief-color"].value.expression;if(c instanceof Ho&&c._styleExpression.expression instanceof zn){this.colorRampExpression=c;const v=c._styleExpression.expression;n.elevationStops=v.labels,n.colorStops=[];for(const T of n.elevationStops)n.colorStops.push(v.evaluate({globals:{elevation:T}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[Pr.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const f={elevationStops:[],colorStops:[]},_=(n.elevationStops.length-1)/(t-1);for(let v=0;v<n.elevationStops.length-.5;v+=_)f.elevationStops.push(n.elevationStops[Math.round(v)]),f.colorStops.push(n.colorStops[Math.round(v)]);return Nr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),f}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,c){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const f=this._createColorRamp(n),_=new ws({width:f.colorStops.length,height:1}),v=new ws({width:f.colorStops.length,height:1});for(let T=0;T<f.elevationStops.length;T++){const k=Dm(f.elevationStops[T],c);v.setPixel(0,T,new Pr(k.r/255,k.g/255,k.b/255,1)),_.setPixel(0,T,f.colorStops[T])}return this.colorRampTextures={elevationTexture:new $u(t,v,t.gl.RGBA),colorTexture:new $u(t,_,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Uu=wn([{name:"a_pos",components:2,type:"Int16"}],4),{members:vp}=Uu;function af(i,t,n){const c=n.patternDependencies;let f=!1;for(const _ of t){const v=_.paint.get(`${i}-pattern`);v.isConstant()||(f=!0);const T=v.constantOr(null);T&&(f=!0,c[T.to]=!0,c[T.from]=!0)}return f}function xp(i,t,n,c,f){const{zoom:_,globalState:v}=c,T=f.patternDependencies;for(const k of t){const M=k.paint.get(`${i}-pattern`).value;if(M.kind!=="constant"){let A=M.evaluate({zoom:_-1,globalState:v},n,{},f.availableImages),F=M.evaluate({zoom:_,globalState:v},n,{},f.availableImages),U=M.evaluate({zoom:_+1,globalState:v},n,{},f.availableImages);A=A&&A.name?A.name:A,F=F&&F.name?F.name:F,U=U&&U.name?U.name:U,T[A]=!0,T[F]=!0,T[U]=!0,n.patterns[k.id]={min:A,mid:F,max:U}}}return n}function Vu(i,t,n,c,f){let _;if(f===(function(v,T,k,M){let A=0;for(let F=T,U=k-M;F<k;F+=M)A+=(v[U]-v[F])*(v[F+1]+v[U+1]),U=F;return A})(i,t,n,c)>0)for(let v=t;v<n;v+=c)_=ad(v/c|0,i[v],i[v+1],_);else for(let v=n-c;v>=t;v-=c)_=ad(v/c|0,i[v],i[v+1],_);return _&&Zu(_,_.next)&&(qc(_),_=_.next),_}function Io(i,t){if(!i)return i;t||(t=i);let n,c=i;do if(n=!1,c.steiner||!Zu(c,c.next)&&sn(c.prev,c,c.next)!==0)c=c.next;else{if(qc(c),c=t=c.prev,c===c.next)break;n=!0}while(n||c!==t);return t}function Gc(i,t,n,c,f,_,v){if(!i)return;!v&&_&&(function(k,M,A,F){let U=k;do U.z===0&&(U.z=Mo(U.x,U.y,M,A,F)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==k);U.prevZ.nextZ=null,U.prevZ=null,(function(G){let H,Q=1;do{let ie,ce=G;G=null;let ze=null;for(H=0;ce;){H++;let pe=ce,be=0;for(let We=0;We<Q&&(be++,pe=pe.nextZ,pe);We++);let Ue=Q;for(;be>0||Ue>0&&pe;)be!==0&&(Ue===0||!pe||ce.z<=pe.z)?(ie=ce,ce=ce.nextZ,be--):(ie=pe,pe=pe.nextZ,Ue--),ze?ze.nextZ=ie:G=ie,ie.prevZ=ze,ze=ie;ce=pe}ze.nextZ=null,Q*=2}while(H>1)})(U)})(i,c,f,_);let T=i;for(;i.prev!==i.next;){const k=i.prev,M=i.next;if(_?Fm(i,c,f,_):Lm(i))t.push(k.i,i.i,M.i),qc(i),i=M.next,T=M.next;else if((i=M)===T){v?v===1?Gc(i=Om(Io(i),t),t,n,c,f,_,2):v===2&&bp(i,t,n,c,f,_):Gc(Io(i),t,n,c,f,_,1);break}}}function Lm(i){const t=i.prev,n=i,c=i.next;if(sn(t,n,c)>=0)return!1;const f=t.x,_=n.x,v=c.x,T=t.y,k=n.y,M=c.y,A=Math.min(f,_,v),F=Math.min(T,k,M),U=Math.max(f,_,v),G=Math.max(T,k,M);let H=c.next;for(;H!==t;){if(H.x>=A&&H.x<=U&&H.y>=F&&H.y<=G&&Ss(f,T,_,k,v,M,H.x,H.y)&&sn(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function Fm(i,t,n,c){const f=i.prev,_=i,v=i.next;if(sn(f,_,v)>=0)return!1;const T=f.x,k=_.x,M=v.x,A=f.y,F=_.y,U=v.y,G=Math.min(T,k,M),H=Math.min(A,F,U),Q=Math.max(T,k,M),ie=Math.max(A,F,U),ce=Mo(G,H,t,n,c),ze=Mo(Q,ie,t,n,c);let pe=i.prevZ,be=i.nextZ;for(;pe&&pe.z>=ce&&be&&be.z<=ze;){if(pe.x>=G&&pe.x<=Q&&pe.y>=H&&pe.y<=ie&&pe!==f&&pe!==v&&Ss(T,A,k,F,M,U,pe.x,pe.y)&&sn(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,be.x>=G&&be.x<=Q&&be.y>=H&&be.y<=ie&&be!==f&&be!==v&&Ss(T,A,k,F,M,U,be.x,be.y)&&sn(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;pe&&pe.z>=ce;){if(pe.x>=G&&pe.x<=Q&&pe.y>=H&&pe.y<=ie&&pe!==f&&pe!==v&&Ss(T,A,k,F,M,U,pe.x,pe.y)&&sn(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;be&&be.z<=ze;){if(be.x>=G&&be.x<=Q&&be.y>=H&&be.y<=ie&&be!==f&&be!==v&&Ss(T,A,k,F,M,U,be.x,be.y)&&sn(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function Om(i,t){let n=i;do{const c=n.prev,f=n.next.next;!Zu(c,f)&&Tp(c,n,n.next,f)&&Gu(c,f)&&Gu(f,c)&&(t.push(c.i,n.i,f.i),qc(n),qc(n.next),n=i=f),n=n.next}while(n!==i);return Io(n)}function bp(i,t,n,c,f,_){let v=i;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&Nm(v,T)){let k=Bm(v,T);return v=Io(v,v.next),k=Io(k,k.next),Gc(v,t,n,c,f,_,0),void Gc(k,t,n,c,f,_,0)}T=T.next}v=v.next}while(v!==i)}function wp(i,t){let n=i.x-t.x;return n===0&&(n=i.y-t.y,n===0)&&(n=(i.next.y-i.y)/(i.next.x-i.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Vi(i,t){const n=(function(f,_){let v=_;const T=f.x,k=f.y;let M,A=-1/0;if(Zu(f,v))return v;do{if(Zu(f,v.next))return v.next;if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const Q=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(Q<=T&&Q>A&&(A=Q,M=v.x<v.next.x?v:v.next,Q===T))return M}v=v.next}while(v!==_);if(!M)return null;const F=M,U=M.x,G=M.y;let H=1/0;v=M;do{if(T>=v.x&&v.x>=U&&T!==v.x&&Sp(k<G?T:A,k,U,G,k<G?A:T,k,v.x,v.y)){const Q=Math.abs(k-v.y)/(T-v.x);Gu(v,f)&&(Q<H||Q===H&&(v.x>M.x||v.x===M.x&&Qa(M,v)))&&(M=v,H=Q)}v=v.next}while(v!==F);return M})(i,t);if(!n)return t;const c=Bm(n,i);return Io(c,c.next),Io(n,n.next)}function Qa(i,t){return sn(i.prev,i,t.prev)<0&&sn(t.next,i,i.next)<0}function Mo(i,t,n,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function jm(i){let t=i,n=i;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==i);return n}function Sp(i,t,n,c,f,_,v,T){return(f-v)*(t-T)>=(i-v)*(_-T)&&(i-v)*(c-T)>=(n-v)*(t-T)&&(n-v)*(_-T)>=(f-v)*(c-T)}function Ss(i,t,n,c,f,_,v,T){return!(i===v&&t===T)&&Sp(i,t,n,c,f,_,v,T)}function Nm(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!(function(n,c){let f=n;do{if(f.i!==n.i&&f.next.i!==n.i&&f.i!==c.i&&f.next.i!==c.i&&Tp(f,f.next,n,c))return!0;f=f.next}while(f!==n);return!1})(i,t)&&(Gu(i,t)&&Gu(t,i)&&(function(n,c){let f=n,_=!1;const v=(n.x+c.x)/2,T=(n.y+c.y)/2;do f.y>T!=f.next.y>T&&f.next.y!==f.y&&v<(f.next.x-f.x)*(T-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next;while(f!==n);return _})(i,t)&&(sn(i.prev,i,t.prev)||sn(i,t.prev,t))||Zu(i,t)&&sn(i.prev,i,i.next)>0&&sn(t.prev,t,t.next)>0)}function sn(i,t,n){return(t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y)}function Zu(i,t){return i.x===t.x&&i.y===t.y}function Tp(i,t,n,c){const f=sd(sn(i,t,n)),_=sd(sn(i,t,c)),v=sd(sn(n,c,i)),T=sd(sn(n,c,t));return f!==_&&v!==T||!(f!==0||!id(i,n,t))||!(_!==0||!id(i,c,t))||!(v!==0||!id(n,i,c))||!(T!==0||!id(n,t,c))}function id(i,t,n){return t.x<=Math.max(i.x,n.x)&&t.x>=Math.min(i.x,n.x)&&t.y<=Math.max(i.y,n.y)&&t.y>=Math.min(i.y,n.y)}function sd(i){return i>0?1:i<0?-1:0}function Gu(i,t){return sn(i.prev,i,i.next)<0?sn(i,t,i.next)>=0&&sn(i,i.prev,t)>=0:sn(i,t,i.prev)<0||sn(i,i.next,t)<0}function Bm(i,t){const n=Ls(i.i,i.x,i.y),c=Ls(t.i,t.x,t.y),f=i.next,_=t.prev;return i.next=t,t.prev=i,n.next=f,f.prev=n,c.next=n,n.prev=c,_.next=c,c.prev=_,c}function ad(i,t,n,c){const f=Ls(i,t,n);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function qc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ls(i,t,n){return{i,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Br{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Yn{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Yn.noSubdivision=new Yn({fill:new Br(0,0),line:new Br(0,0),tile:new Br(0,0),stencil:new Br(0,0),circle:1}),kt("SubdivisionGranularityExpression",Br),kt("SubdivisionGranularitySetting",Yn);const Sn=-32768,Qn=32767;class Js{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=ft/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(t),f=0|Math.round(n),_=this._getKey(c,f);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,v),this._vertexBuffer.push(c,f),v}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(f,_){const v=[];for(let T=0;T<_.length;T+=3){const k=_[T],M=_[T+1],A=_[T+2],F=f[2*k],U=f[2*k+1];(f[2*M]-F)*(f[2*A+1]-U)-(f[2*M+1]-U)*(f[2*A]-F)>0?(v.push(k),v.push(A),v.push(M)):(v.push(k),v.push(M),v.push(A))}return v})(this._vertexBuffer,t);const n=[],c=t.length;for(let f=0;f<c;f+=3){const _=[t[f+0],t[f+1],t[f+2]],v=[this._vertexBuffer[2*t[f+0]+0],this._vertexBuffer[2*t[f+0]+1],this._vertexBuffer[2*t[f+1]+0],this._vertexBuffer[2*t[f+1]+1],this._vertexBuffer[2*t[f+2]+0],this._vertexBuffer[2*t[f+2]+1]];let T=1/0,k=1/0,M=-1/0,A=-1/0;for(let Q=0;Q<3;Q++){const ie=v[2*Q],ce=v[2*Q+1];T=Math.min(T,ie),M=Math.max(M,ie),k=Math.min(k,ce),A=Math.max(A,ce)}if(T===M||k===A)continue;const F=Math.floor(T/this._granularityCellSize),U=Math.ceil(M/this._granularityCellSize),G=Math.floor(k/this._granularityCellSize),H=Math.ceil(A/this._granularityCellSize);if(F!==U||G!==H)for(let Q=G;Q<H;Q++){const ie=this._scanlineGenerateVertexRingForCellRow(Q,v,_);od(this._vertexBuffer,ie,n)}else n.push(..._)}return n}_scanlineGenerateVertexRingForCellRow(t,n,c){const f=t*this._granularityCellSize,_=f+this._granularityCellSize,v=[];for(let T=0;T<3;T++){const k=n[2*T],M=n[2*T+1],A=n[2*(T+1)%6],F=n[(2*(T+1)+1)%6],U=n[2*(T+2)%6],G=n[(2*(T+2)+1)%6],H=A-k,Q=F-M,ie=H===0,ce=Q===0,ze=(f-M)/Q,pe=(_-M)/Q,be=Math.min(ze,pe),Ue=Math.max(ze,pe);if(!ce&&(be>=1||Ue<=0)||ce&&(M<f||M>_)){F>=f&&F<=_&&v.push(c[(T+1)%3]);continue}!ce&&be>0&&v.push(this._vertexToIndex(k+H*be,M+Q*be));const We=k+H*Math.max(be,0),it=k+H*Math.min(Ue,1);ie||this._generateIntraEdgeVertices(v,k,M,A,F,We,it),!ce&&Ue<1&&v.push(this._vertexToIndex(k+H*Ue,M+Q*Ue)),(ce||F>=f&&F<=_)&&v.push(c[(T+1)%3]),!ce&&(F<=f||F>=_)&&this._generateInterEdgeVertices(v,k,M,A,F,U,G,it,f,_)}return v}_generateIntraEdgeVertices(t,n,c,f,_,v,T){const k=f-n,M=_-c,A=M===0,F=A?Math.min(n,f):Math.min(v,T),U=A?Math.max(n,f):Math.max(v,T),G=Math.floor(F/this._granularityCellSize)+1,H=Math.ceil(U/this._granularityCellSize)-1;if(A?n<f:v<T)for(let Q=G;Q<=H;Q++){const ie=Q*this._granularityCellSize;t.push(this._vertexToIndex(ie,c+M*(ie-n)/k))}else for(let Q=H;Q>=G;Q--){const ie=Q*this._granularityCellSize;t.push(this._vertexToIndex(ie,c+M*(ie-n)/k))}}_generateInterEdgeVertices(t,n,c,f,_,v,T,k,M,A){const F=_-c,U=v-f,G=T-_,H=(M-_)/G,Q=(A-_)/G,ie=Math.min(H,Q),ce=Math.max(H,Q),ze=f+U*ie;let pe=Math.floor(Math.min(ze,k)/this._granularityCellSize)+1,be=Math.ceil(Math.max(ze,k)/this._granularityCellSize)-1,Ue=k<ze;const We=G===0;if(We&&(T===M||T===A))return;if(We||ie>=1||ce<=0){const Tt=c-T,yt=v+(n-v)*Math.min((M-T)/Tt,(A-T)/Tt);pe=Math.floor(Math.min(yt,k)/this._granularityCellSize)+1,be=Math.ceil(Math.max(yt,k)/this._granularityCellSize)-1,Ue=k<yt}const it=F>0?A:M;if(Ue)for(let Tt=pe;Tt<=be;Tt++)t.push(this._vertexToIndex(Tt*this._granularityCellSize,it));else for(let Tt=be;Tt>=pe;Tt--)t.push(this._vertexToIndex(Tt*this._granularityCellSize,it))}_generateOutline(t){const n=[];for(const c of t){const f=Tn(c,this._granularity,!0),_=this._pointArrayToIndices(f),v=[];for(let T=1;T<_.length;T++)v.push(_[T-1]),v.push(_[T]);n.push(v)}return n}_handlePoles(t){let n=!1,c=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(n||c)&&this._fillPoles(t,n,c)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const c=t[n+1];c===Sn&&(t[n+1]=-32767),c===Qn&&(t[n+1]=32766)}}_generatePoleQuad(t,n,c,f,_,v){f>_!=(v===Sn)?(t.push(n),t.push(c),t.push(this._vertexToIndex(f,v)),t.push(c),t.push(this._vertexToIndex(_,v)),t.push(this._vertexToIndex(f,v))):(t.push(c),t.push(n),t.push(this._vertexToIndex(f,v)),t.push(this._vertexToIndex(_,v)),t.push(c),t.push(this._vertexToIndex(f,v)))}_fillPoles(t,n,c){const f=this._vertexBuffer,_=ft,v=t.length;for(let T=2;T<v;T+=3){const k=t[T-2],M=t[T-1],A=t[T],F=f[2*k],U=f[2*k+1],G=f[2*M],H=f[2*M+1],Q=f[2*A],ie=f[2*A+1];n&&(U===0&&H===0&&this._generatePoleQuad(t,k,M,F,G,Sn),H===0&&ie===0&&this._generatePoleQuad(t,M,A,G,Q,Sn),ie===0&&U===0&&this._generatePoleQuad(t,A,k,Q,F,Sn)),c&&(U===_&&H===_&&this._generatePoleQuad(t,k,M,F,G,Qn),H===_&&ie===_&&this._generatePoleQuad(t,M,A,G,Q,Qn),ie===_&&U===_&&this._generatePoleQuad(t,A,k,Q,F,Qn))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:f}=(function(T){const k=[],M=[];for(const A of T)if(A.length!==0){A!==T[0]&&k.push(M.length/2);for(let F=0;F<A.length;F++)M.push(A[F].x),M.push(A[F].y)}return{flattened:M,holeIndices:k}})(t);let _;this._initializeVertices(c);try{const T=(function(M,A,F=2){const U=A&&A.length,G=U?A[0]*F:M.length;let H=Vu(M,0,G,F,!0);const Q=[];if(!H||H.next===H.prev)return Q;let ie,ce,ze;if(U&&(H=(function(pe,be,Ue,We){const it=[];for(let Tt=0,yt=be.length;Tt<yt;Tt++){const wt=Vu(pe,be[Tt]*We,Tt<yt-1?be[Tt+1]*We:pe.length,We,!1);wt===wt.next&&(wt.steiner=!0),it.push(jm(wt))}it.sort(wp);for(let Tt=0;Tt<it.length;Tt++)Ue=Vi(it[Tt],Ue);return Ue})(M,A,H,F)),M.length>80*F){ie=M[0],ce=M[1];let pe=ie,be=ce;for(let Ue=F;Ue<G;Ue+=F){const We=M[Ue],it=M[Ue+1];We<ie&&(ie=We),it<ce&&(ce=it),We>pe&&(pe=We),it>be&&(be=it)}ze=Math.max(pe-ie,be-ce),ze=ze!==0?32767/ze:0}return Gc(H,Q,F,ie,ce,ze,0),Q})(c,f),k=this._convertIndices(c,T);_=this._subdivideTrianglesScanline(k)}catch(T){console.error(T)}let v=[];return n&&(v=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:v}}_convertIndices(t,n){const c=[];for(let f=0;f<n.length;f++)c.push(this._vertexToIndex(t[2*n[f]],t[2*n[f]+1]));return c}_pointArrayToIndices(t){const n=[];for(let c=0;c<t.length;c++){const f=t[c];n.push(this._vertexToIndex(f.x,f.y))}return n}}function Wc(i,t,n,c=!0){return new Js(n,t).subdividePolygonInternal(i,c)}function Tn(i,t,n=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const c=i[0],f=i[i.length-1],_=n&&(c.x!==f.x||c.y!==f.y);if(t<2)return _?[...i,i[0]]:[...i];const v=Math.floor(ft/t),T=[];T.push(new L(i[0].x,i[0].y));const k=i.length,M=_?k:k-1;for(let A=0;A<M;A++){const F=i[A],U=A<k-1?i[A+1]:i[0],G=F.x,H=F.y,Q=U.x,ie=U.y,ce=G!==Q,ze=H!==ie;if(!ce&&!ze)continue;const pe=Q-G,be=ie-H,Ue=Math.abs(pe),We=Math.abs(be);let it=G,Tt=H;for(;;){const wt=pe>0?(Math.floor(it/v)+1)*v:(Math.ceil(it/v)-1)*v,qt=be>0?(Math.floor(Tt/v)+1)*v:(Math.ceil(Tt/v)-1)*v,xt=Math.abs(it-wt),St=Math.abs(Tt-qt),tt=Math.abs(it-Q),ir=Math.abs(Tt-ie),gr=ce?xt/Ue:Number.POSITIVE_INFINITY,er=ze?St/We:Number.POSITIVE_INFINITY;if((tt<=xt||!ce)&&(ir<=St||!ze))break;if(gr<er&&ce||!ze){it=wt,Tt+=be*gr;const Nt=new L(it,Math.round(Tt));T[T.length-1].x===Nt.x&&T[T.length-1].y===Nt.y||T.push(Nt)}else{it+=pe*er,Tt=qt;const Nt=new L(Math.round(it),Tt);T[T.length-1].x===Nt.x&&T[T.length-1].y===Nt.y||T.push(Nt)}}const yt=new L(Q,ie);T[T.length-1].x===yt.x&&T[T.length-1].y===yt.y||T.push(yt)}return T}function od(i,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,f=i[2*t[0]];for(let k=1;k<t.length;k++){const M=i[2*t[k]];M<f&&(f=M,c=k)}const _=t.length;let v=c,T=(v+1)%_;for(;;){const k=v-1>=0?v-1:_-1,M=(T+1)%_,A=i[2*t[k]],F=i[2*t[M]],U=i[2*t[v]],G=i[2*t[v]+1],H=i[2*t[T]+1];let Q=!1;if(A<F)Q=!0;else if(A>F)Q=!1;else{const ie=H-G,ce=-(i[2*t[T]]-U),ze=G<H?1:-1;((A-U)*ie+(i[2*t[k]+1]-G)*ce)*ze>((F-U)*ie+(i[2*t[M]+1]-G)*ce)*ze&&(Q=!0)}if(Q){const ie=t[k],ce=t[v],ze=t[T];ie!==ce&&ie!==ze&&ce!==ze&&n.push(ze,ce,ie),v--,v<0&&(v=_-1)}else{const ie=t[M],ce=t[v],ze=t[T];ie!==ce&&ie!==ze&&ce!==ze&&n.push(ze,ce,ie),T++,T>=_&&(T=0)}if(k===M)break}}function Ql(i,t,n,c,f,_,v,T,k){const M=f.length/2,A=v&&T&&k;if(M<mr.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(M,n,c),U=F.vertexLength;for(let Q=0;Q<_.length;Q+=3)c.emplaceBack(U+_[Q],U+_[Q+1],U+_[Q+2]);let G,H;F.vertexLength+=M,F.primitiveLength+=_.length/3,A&&(H=v.prepareSegment(M,n,T),G=H.vertexLength,H.vertexLength+=M);for(let Q=0;Q<f.length;Q+=2)i(f[Q],f[Q+1]);if(A)for(let Q=0;Q<k.length;Q++){const ie=k[Q];for(let ce=1;ce<ie.length;ce+=2)T.emplaceBack(G+ie[ce-1],G+ie[ce]);H.primitiveLength+=ie.length/2}}else(function(F,U,G,H,Q,ie){const ce=[];for(let We=0;We<H.length/2;We++)ce.push(-1);const ze={count:0};let pe=0,be=F.getOrCreateLatestSegment(U,G),Ue=be.vertexLength;for(let We=2;We<Q.length;We+=3){const it=Q[We-2],Tt=Q[We-1],yt=Q[We];let wt=ce[it]<pe,qt=ce[Tt]<pe,xt=ce[yt]<pe;be.vertexLength+((wt?1:0)+(qt?1:0)+(xt?1:0))>mr.MAX_VERTEX_ARRAY_LENGTH&&(be=F.createNewSegment(U,G),pe=ze.count,wt=!0,qt=!0,xt=!0,Ue=0);const St=Jl(ce,H,ie,ze,it,wt,be),tt=Jl(ce,H,ie,ze,Tt,qt,be),ir=Jl(ce,H,ie,ze,yt,xt,be);G.emplaceBack(Ue+St-pe,Ue+tt-pe,Ue+ir-pe),be.primitiveLength++}})(t,n,c,f,_,i),A&&(function(F,U,G,H,Q,ie){const ce=[];for(let We=0;We<H.length/2;We++)ce.push(-1);const ze={count:0};let pe=0,be=F.getOrCreateLatestSegment(U,G),Ue=be.vertexLength;for(let We=0;We<Q.length;We++){const it=Q[We];for(let Tt=1;Tt<Q[We].length;Tt+=2){const yt=it[Tt-1],wt=it[Tt];let qt=ce[yt]<pe,xt=ce[wt]<pe;be.vertexLength+((qt?1:0)+(xt?1:0))>mr.MAX_VERTEX_ARRAY_LENGTH&&(be=F.createNewSegment(U,G),pe=ze.count,qt=!0,xt=!0,Ue=0);const St=Jl(ce,H,ie,ze,yt,qt,be),tt=Jl(ce,H,ie,ze,wt,xt,be);G.emplaceBack(Ue+St-pe,Ue+tt-pe),be.primitiveLength++}}})(v,n,T,f,k,i),t.forceNewSegmentOnNextPrepare(),v==null||v.forceNewSegmentOnNextPrepare()}function Jl(i,t,n,c,f,_,v){if(_){const T=c.count;return n(t[2*f],t[2*f+1]),i[f]=c.count,c.count++,v.vertexLength++,T}return i[f]}class ld{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $e,this.indexArray=new nn,this.indexArray2=new Qr,this.programConfigurations=new is(t.layers,t.zoom),this.segments=new mr,this.segments2=new mr,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,c){this.hasPattern=af("fill",this.layers,n);const f=this.layers[0].layout.get("fill-sort-key"),_=!f.isConstant(),v=[];for(const{feature:T,id:k,index:M,sourceLayerIndex:A}of t){const F=this.layers[0]._featureFilter.needGeometry,U=Ya(T,F);if(!this.layers[0]._featureFilter.filter(new Wr(this.zoom,{globalState:this.globalState}),U,c))continue;const G=_?f.evaluate(U,{},c,n.availableImages):void 0,H={id:k,properties:T.properties,type:T.type,sourceLayerIndex:A,index:M,geometry:F?U.geometry:wa(T),patterns:{},sortKey:G};v.push(H)}_&&v.sort(((T,k)=>T.sortKey-k.sortKey));for(const T of v){const{geometry:k,index:M,sourceLayerIndex:A}=T;if(this.hasPattern){const F=xp("fill",this.layers,T,{zoom:this.zoom,globalState:this.globalState},n);this.patternFeatures.push(F)}else this.addFeature(T,k,M,c,{},n.subdivisionGranularity);n.featureIndex.insert(t[M].feature,k,M,A,this.index)}}update(t,n,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:c,globalState:this.globalState})}addFeatures(t,n,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,c,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,c,f,_,v){for(const T of Rl(n,500)){const k=Wc(T,f,v.fill.getGranularityForZoomLevel(f.z)),M=this.layoutVertexArray;Ql(((A,F)=>{M.emplaceBack(A,F)}),this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{imagePositions:_,canonical:f,globalState:this.globalState})}}let qu,Ts;kt("FillBucket",ld,{omit:["layers","patternFeatures"]});var Pp={get paint(){return Ts=Ts||new fi({"fill-antialias":new Lt(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Yt(Ce.paint_fill["fill-opacity"]),"fill-color":new Yt(Ce.paint_fill["fill-color"]),"fill-outline-color":new Yt(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Lt(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Lt(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wa(Ce.paint_fill["fill-pattern"])})},get layout(){return qu=qu||new fi({"fill-sort-key":new Yt(Ce.layout_fill["fill-sort-key"])})}};class Wu extends pi{constructor(t){super(t,Pp)}recalculate(t,n){super.recalculate(t,n);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ld(t)}queryRadius(){return Nu(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:c,pixelsToTileUnits:f}){return km(Jh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,f),n)}isTileClipped(){return!0}}const il=wn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),of=wn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Cp}=il;class ea{constructor(t,n,c,f,_){this.properties={},this.extent=c,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=f,this._values=_,t.readFields(lf,this,n)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos,c=[];let f,_=1,v=0,T=0,k=0;for(;t.pos<n;){if(v<=0){const M=t.readVarint();_=7&M,v=M>>3}if(v--,_===1||_===2)T+=t.readSVarint(),k+=t.readSVarint(),_===1&&(f&&c.push(f),f=[]),f&&f.push(new L(T,k));else{if(_!==7)throw new Error(`unknown command ${_}`);f&&f.push(f[0].clone())}}return f&&c.push(f),c}bbox(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos;let c=1,f=0,_=0,v=0,T=1/0,k=-1/0,M=1/0,A=-1/0;for(;t.pos<n;){if(f<=0){const F=t.readVarint();c=7&F,f=F>>3}if(f--,c===1||c===2)_+=t.readSVarint(),v+=t.readSVarint(),_<T&&(T=_),_>k&&(k=_),v<M&&(M=v),v>A&&(A=v);else if(c!==7)throw new Error(`unknown command ${c}`)}return[T,M,k,A]}toGeoJSON(t,n,c){const f=this.extent*Math.pow(2,c),_=this.extent*t,v=this.extent*n,T=this.loadGeometry();function k(U){return[360*(U.x+_)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(U.y+v)/f)*Math.PI))-90]}function M(U){return U.map(k)}let A;if(this.type===1){const U=[];for(const H of T)U.push(H[0]);const G=M(U);A=U.length===1?{type:"Point",coordinates:G[0]}:{type:"MultiPoint",coordinates:G}}else if(this.type===2){const U=T.map(M);A=U.length===1?{type:"LineString",coordinates:U[0]}:{type:"MultiLineString",coordinates:U}}else{if(this.type!==3)throw new Error("unknown feature type");{const U=(function(H){const Q=H.length;if(Q<=1)return[H];const ie=[];let ce,ze;for(let pe=0;pe<Q;pe++){const be=ec(H[pe]);be!==0&&(ze===void 0&&(ze=be<0),ze===be<0?(ce&&ie.push(ce),ce=[H[pe]]):ce&&ce.push(H[pe]))}return ce&&ie.push(ce),ie})(T),G=[];for(const H of U)G.push(H.map(M));A=G.length===1?{type:"Polygon",coordinates:G[0]}:{type:"MultiPolygon",coordinates:G}}}const F={type:"Feature",geometry:A,properties:this.properties};return this.id!=null&&(F.id=this.id),F}}function lf(i,t,n){i===1?t.id=n.readVarint():i===2?(function(c,f){const _=c.readVarint()+c.pos;for(;c.pos<_;){const v=f._keys[c.readVarint()],T=f._values[c.readVarint()];f.properties[v]=T}})(n,t):i===3?t.type=n.readVarint():i===4&&(t._geometry=n.pos)}function ec(i){let t=0;for(let n,c,f=0,_=i.length,v=_-1;f<_;v=f++)n=i[f],c=i[v],t+=(c.x-n.x)*(n.y+c.y);return t}ea.types=["Unknown","Point","LineString","Polygon"];class cd{constructor(t,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ud,this,n),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new ea(this._pbf,n,this.extent,this._keys,this._values)}}function ud(i,t,n){i===15?t.version=n.readVarint():i===1?t.name=n.readString():i===5?t.extent=n.readVarint():i===2?t._features.push(n.pos):i===3?t._keys.push(n.readString()):i===4&&t._values.push((function(c){let f=null;const _=c.readVarint()+c.pos;for(;c.pos<_;){const v=c.readVarint()>>3;f=v===1?c.readString():v===2?c.readFloat():v===3?c.readDouble():v===4?c.readVarint64():v===5?c.readVarint():v===6?c.readSVarint():v===7?c.readBoolean():null}if(f==null)throw new Error("unknown feature value");return f})(n))}class cf{constructor(t,n){this.layers=t.readFields(uf,{},n)}}function uf(i,t,n){if(i===3){const c=new cd(n,n.readVarint()+n.pos);c.length&&(t[c.name]=c)}}const Hu=Math.pow(2,13);function mi(i,t,n,c,f,_,v,T){i.emplaceBack(t,n,2*Math.floor(c*Hu)+v,f*Hu*2,_*Hu*2,Math.round(T))}class Ao{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new je,this.centroidVertexArray=new he,this.indexArray=new nn,this.programConfigurations=new is(t.layers,t.zoom),this.segments=new mr,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,c){this.features=[],this.hasPattern=af("fill-extrusion",this.layers,n);for(const{feature:f,id:_,index:v,sourceLayerIndex:T}of t){const k=this.layers[0]._featureFilter.needGeometry,M=Ya(f,k);if(!this.layers[0]._featureFilter.filter(new Wr(this.zoom,{globalState:this.globalState}),M,c))continue;const A={id:_,sourceLayerIndex:T,index:v,geometry:k?M.geometry:wa(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(xp("fill-extrusion",this.layers,A,{zoom:this.zoom,globalState:this.globalState},n)):this.addFeature(A,A.geometry,v,c,{},n.subdivisionGranularity),n.featureIndex.insert(f,A.geometry,v,T,this.index,!0)}}addFeatures(t,n,c){for(const f of this.features){const{geometry:_}=f;this.addFeature(f,_,f.index,n,c,t.subdivisionGranularity)}}update(t,n,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:c,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Cp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,of.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,c,f,_,v){for(const T of Rl(n,500)){const k={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(k,f,t,T,v);const A=this.layoutVertexArray.length-M,F=Math.floor(k.x/k.sampleCount),U=Math.floor(k.y/k.sampleCount);for(let G=0;G<A;G++)this.centroidVertexArray.emplaceBack(F,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{imagePositions:_,canonical:f,globalState:this.globalState})}processPolygon(t,n,c,f,_){if(f.length<1||kp(f[0]))return;for(const F of f)F.length!==0&&Ja(t,F);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=_.fill.getGranularityForZoomLevel(n.z),k=ea.types[c.type]==="Polygon";for(const F of f){if(F.length===0||kp(F))continue;const U=Tn(F,T,k);this._generateSideFaces(U,v)}if(!k)return;const M=Wc(f,n,T,!1),A=this.layoutVertexArray;Ql(((F,U)=>{mi(A,F,U,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(t,n){let c=0;for(let f=1;f<t.length;f++){const _=t[f],v=t[f-1];if(Fs(_,v))continue;n.segment.vertexLength+4>mr.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=_.sub(v)._perp()._unit(),k=v.dist(_);c+k>32768&&(c=0),mi(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,0,c),mi(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,1,c),c+=k,mi(this.layoutVertexArray,v.x,v.y,T.x,T.y,0,0,c),mi(this.layoutVertexArray,v.x,v.y,T.x,T.y,0,1,c);const M=n.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function Ja(i,t){for(let n=0;n<t.length;n++){const c=t[n];n===t.length-1&&t[0].x===c.x&&t[0].y===c.y||(i.x+=c.x,i.y+=c.y,i.sampleCount++)}}function Fs(i,t){return i.x===t.x&&(i.x<0||i.x>ft)||i.y===t.y&&(i.y<0||i.y>ft)}function kp(i){return i.every((t=>t.x<0))||i.every((t=>t.x>ft))||i.every((t=>t.y<0))||i.every((t=>t.y>ft))}let hf;kt("FillExtrusionBucket",Ao,{omit:["layers","features"]});var Ep={get paint(){return hf=hf||new fi({"fill-extrusion-opacity":new Lt(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yt(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Lt(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Lt(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wa(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yt(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yt(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Lt(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class oy extends pi{constructor(t){super(t,Ep)}createBucket(t){return new Ao(t)}queryRadius(){return Nu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:c,geometry:f,transform:_,pixelsToTileUnits:v,pixelPosMatrix:T}){const k=Jh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,v),M=this.paint.get("fill-extrusion-height").evaluate(n,c),A=this.paint.get("fill-extrusion-base").evaluate(n,c),F=(function(G,H){const Q=[];for(const ie of G){const ce=[ie.x,ie.y,0,1];Ht(ce,ce,H),Q.push(new L(ce[0]/ce[3],ce[1]/ce[3]))}return Q})(k,T),U=(function(G,H,Q,ie){const ce=[],ze=[],pe=ie[8]*H,be=ie[9]*H,Ue=ie[10]*H,We=ie[11]*H,it=ie[8]*Q,Tt=ie[9]*Q,yt=ie[10]*Q,wt=ie[11]*Q;for(const qt of G){const xt=[],St=[];for(const tt of qt){const ir=tt.x,gr=tt.y,er=ie[0]*ir+ie[4]*gr+ie[12],Nt=ie[1]*ir+ie[5]*gr+ie[13],jr=ie[2]*ir+ie[6]*gr+ie[14],On=ie[3]*ir+ie[7]*gr+ie[15],yi=jr+Ue,os=On+We,to=er+it,ra=Nt+Tt,Zi=jr+yt,Mn=On+wt,Pi=new L((er+pe)/os,(Nt+be)/os);Pi.z=yi/os,xt.push(Pi);const Gi=new L(to/Mn,ra/Mn);Gi.z=Zi/Mn,St.push(Gi)}ce.push(xt),ze.push(St)}return[ce,ze]})(f,A,M,T);return(function(G,H,Q){let ie=1/0;km(Q,H)&&(ie=Ip(Q,H[0]));for(let ce=0;ce<H.length;ce++){const ze=H[ce],pe=G[ce];for(let be=0;be<ze.length-1;be++){const Ue=ze[be],We=[Ue,ze[be+1],pe[be+1],pe[be],Ue];up(Q,We)&&(ie=Math.min(ie,Ip(Q,We)))}}return ie!==1/0&&ie})(U[0],U[1],F)}}function Sa(i,t){return i.x*t.x+i.y*t.y}function Ip(i,t){if(i.length===1){let n=0;const c=t[n++];let f;for(;!f||c.equals(f);)if(f=t[n++],!f)return 1/0;for(;n<t.length;n++){const _=t[n],v=i[0],T=f.sub(c),k=_.sub(c),M=v.sub(c),A=Sa(T,T),F=Sa(T,k),U=Sa(k,k),G=Sa(M,T),H=Sa(M,k),Q=A*U-F*F,ie=(U*G-F*H)/Q,ce=(A*H-F*G)/Q,ze=c.z*(1-ie-ce)+f.z*ie+_.z*ce;if(isFinite(ze))return ze}return 1/0}{let n=1/0;for(const c of t)n=Math.min(n,c.z);return n}}const Mp=wn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Hc}=Mp,Ap=wn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Kc}=Ap,$m=Math.cos(Math.PI/180*37.5),Rp=Math.pow(2,14)/.5;class hd{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new Ne,this.layoutVertexArray2=new Ze,this.indexArray=new nn,this.programConfigurations=new is(t.layers,t.zoom),this.segments=new mr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,c){this.hasPattern=af("line",this.layers,n);const f=this.layers[0].layout.get("line-sort-key"),_=!f.isConstant(),v=[];for(const{feature:T,id:k,index:M,sourceLayerIndex:A}of t){const F=this.layers[0]._featureFilter.needGeometry,U=Ya(T,F);if(!this.layers[0]._featureFilter.filter(new Wr(this.zoom,{globalState:this.globalState}),U,c))continue;const G=_?f.evaluate(U,{},c):void 0,H={id:k,properties:T.properties,type:T.type,sourceLayerIndex:A,index:M,geometry:F?U.geometry:wa(T),patterns:{},sortKey:G};v.push(H)}_&&v.sort(((T,k)=>T.sortKey-k.sortKey));for(const T of v){const{geometry:k,index:M,sourceLayerIndex:A}=T;if(this.hasPattern){const F=xp("line",this.layers,T,{zoom:this.zoom,globalState:this.globalState},n);this.patternFeatures.push(F)}else this.addFeature(T,k,M,c,{},n.subdivisionGranularity);n.featureIndex.insert(t[M].feature,k,M,A,this.index)}}update(t,n,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:c,globalState:this.globalState})}addFeatures(t,n,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,c,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Kc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Hc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,c,f,_,v){const T=this.layers[0].layout,k=T.get("line-join").evaluate(t,{}),M=T.get("line-cap"),A=T.get("line-miter-limit"),F=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const U of n)this.addLine(U,t,k,M,A,F,f,v);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{imagePositions:_,canonical:f,globalState:this.globalState})}addLine(t,n,c,f,_,v,T,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Tn(t,T?k.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let pe=0;pe<t.length-1;pe++)this.totalDistance+=t[pe].dist(t[pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=ea.types[n.type]==="Polygon";let A=t.length;for(;A>=2&&t[A-1].equals(t[A-2]);)A--;let F=0;for(;F<A-1&&t[F].equals(t[F+1]);)F++;if(A<(M?3:2))return;c==="bevel"&&(_=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,G=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let H,Q,ie,ce,ze;this.e1=this.e2=-1,M&&(H=t[A-2],ze=t[F].sub(H)._unit()._perp());for(let pe=F;pe<A;pe++){if(ie=pe===A-1?M?t[F+1]:void 0:t[pe+1],ie&&t[pe].equals(ie))continue;ze&&(ce=ze),H&&(Q=H),H=t[pe],ze=ie?ie.sub(H)._unit()._perp():ce,ce=ce||ze;let be=ce.add(ze);be.x===0&&be.y===0||be._unit();const Ue=ce.x*ze.x+ce.y*ze.y,We=be.x*ze.x+be.y*ze.y,it=We!==0?1/We:1/0,Tt=2*Math.sqrt(2-2*We),yt=We<$m&&Q&&ie,wt=ce.x*ze.y-ce.y*ze.x>0;if(yt&&pe>F){const St=H.dist(Q);if(St>2*U){const tt=H.sub(H.sub(Q)._mult(U/St)._round());this.updateDistance(Q,tt),this.addCurrentVertex(tt,ce,0,0,G),Q=tt}}const qt=Q&&ie;let xt=qt?c:M?"butt":f;if(qt&&xt==="round"&&(it<v?xt="miter":it<=2&&(xt="fakeround")),xt==="miter"&&it>_&&(xt="bevel"),xt==="bevel"&&(it>2&&(xt="flipbevel"),it<_&&(xt="miter")),Q&&this.updateDistance(Q,H),xt==="miter")be._mult(it),this.addCurrentVertex(H,be,0,0,G);else if(xt==="flipbevel"){if(it>100)be=ze.mult(-1);else{const St=it*ce.add(ze).mag()/ce.sub(ze).mag();be._perp()._mult(St*(wt?-1:1))}this.addCurrentVertex(H,be,0,0,G),this.addCurrentVertex(H,be.mult(-1),0,0,G)}else if(xt==="bevel"||xt==="fakeround"){const St=-Math.sqrt(it*it-1),tt=wt?St:0,ir=wt?0:St;if(Q&&this.addCurrentVertex(H,ce,tt,ir,G),xt==="fakeround"){const gr=Math.round(180*Tt/Math.PI/20);for(let er=1;er<gr;er++){let Nt=er/gr;if(Nt!==.5){const On=Nt-.5;Nt+=Nt*On*(Nt-1)*((1.0904+Ue*(Ue*(3.55645-1.43519*Ue)-3.2452))*On*On+(.848013+Ue*(.215638*Ue-1.06021)))}const jr=ze.sub(ce)._mult(Nt)._add(ce)._unit()._mult(wt?-1:1);this.addHalfVertex(H,jr.x,jr.y,!1,wt,0,G)}}ie&&this.addCurrentVertex(H,ze,-tt,-ir,G)}else if(xt==="butt")this.addCurrentVertex(H,be,0,0,G);else if(xt==="square"){const St=Q?1:-1;this.addCurrentVertex(H,be,St,St,G)}else xt==="round"&&(Q&&(this.addCurrentVertex(H,ce,0,0,G),this.addCurrentVertex(H,ce,1,1,G,!0)),ie&&(this.addCurrentVertex(H,ze,-1,-1,G,!0),this.addCurrentVertex(H,ze,0,0,G)));if(yt&&pe<A-1){const St=H.dist(ie);if(St>2*U){const tt=H.add(ie.sub(H)._mult(U/St)._round());this.updateDistance(H,tt),this.addCurrentVertex(tt,ze,0,0,G),H=tt}}}}addCurrentVertex(t,n,c,f,_,v=!1){const T=n.y*f-n.x,k=-n.y-n.x*f;this.addHalfVertex(t,n.x+n.y*c,n.y-n.x*c,v,!1,c,_),this.addHalfVertex(t,T,k,v,!0,-f,_),this.distance>Rp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,c,f,_,v))}addHalfVertex({x:t,y:n},c,f,_,v,T,k){const M=.5*(this.lineClips?this.scaledDistance*(Rp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(n<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(T===0?0:T<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,A,this.e2),k.primitiveLength++),v?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let dd,Um;kt("LineBucket",hd,{omit:["layers","patternFeatures"]});var Vm={get paint(){return Um=Um||new fi({"line-opacity":new Yt(Ce.paint_line["line-opacity"]),"line-color":new Yt(Ce.paint_line["line-color"]),"line-translate":new Lt(Ce.paint_line["line-translate"]),"line-translate-anchor":new Lt(Ce.paint_line["line-translate-anchor"]),"line-width":new Yt(Ce.paint_line["line-width"]),"line-gap-width":new Yt(Ce.paint_line["line-gap-width"]),"line-offset":new Yt(Ce.paint_line["line-offset"]),"line-blur":new Yt(Ce.paint_line["line-blur"]),"line-dasharray":new va(Ce.paint_line["line-dasharray"]),"line-pattern":new Wa(Ce.paint_line["line-pattern"]),"line-gradient":new Kl(Ce.paint_line["line-gradient"])})},get layout(){return dd=dd||new fi({"line-cap":new Lt(Ce.layout_line["line-cap"]),"line-join":new Yt(Ce.layout_line["line-join"]),"line-miter-limit":new Lt(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Lt(Ce.layout_line["line-round-limit"]),"line-sort-key":new Yt(Ce.layout_line["line-sort-key"])})}};class Zm extends Yt{possiblyEvaluate(t,n){return n=new Wr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,c,f){return n=sr({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,c,f)}}let fd;class Xc extends pi{constructor(t){super(t,Vm),this.gradientVersion=0,fd||(fd=new Zm(Vm.paint.properties["line-width"].specification),fd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(c){return c._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof pn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=fd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new hd(t)}queryRadius(t){const n=t,c=Gm(ju("line-width",this,n),ju("line-gap-width",this,n)),f=ju("line-offset",this,n);return c/2+Math.abs(f)+Nu(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:c,geometry:f,transform:_,pixelsToTileUnits:v}){const T=Jh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,v),k=v/2*Gm(this.paint.get("line-width").evaluate(n,c),this.paint.get("line-gap-width").evaluate(n,c)),M=this.paint.get("line-offset").evaluate(n,c);return M&&(f=(function(A,F){const U=[];for(let G=0;G<A.length;G++){const H=A[G],Q=[];for(let ie=0;ie<H.length;ie++){const ce=H[ie-1],ze=H[ie],pe=H[ie+1],be=ie===0?new L(0,0):ze.sub(ce)._unit()._perp(),Ue=ie===H.length-1?new L(0,0):pe.sub(ze)._unit()._perp(),We=be._add(Ue)._unit(),it=We.x*Ue.x+We.y*Ue.y;it!==0&&We._mult(1/it),Q.push(We._mult(F)._add(ze))}U.push(Q)}return U})(f,M*v)),(function(A,F,U){for(let G=0;G<F.length;G++){const H=F[G];if(A.length>=3){for(let Q=0;Q<H.length;Q++)if(Zc(A,H[Q]))return!0}if(Ds(A,H,U))return!0}return!1})(T,f,k)}isTileClipped(){return!0}}function Gm(i,t){return t>0?t+2*i:i}const Ku=wn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qm=wn([{name:"a_projected_pos",components:3,type:"Float32"}],4);wn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $n=wn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);wn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wm=wn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Hm=wn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ly(i,t,n){return i.sections.forEach((c=>{c.text=(function(f,_,v){const T=_.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?f=f.toLocaleUpperCase():T==="lowercase"&&(f=f.toLocaleLowerCase()),Ms.applyArabicShaping&&(f=Ms.applyArabicShaping(f)),f})(c.text,t,n)})),i}wn([{name:"triangle",components:3,type:"Uint16"}]),wn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),wn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),wn([{type:"Float32",name:"offsetX"}]),wn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),wn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const pd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Jn=24;const df=4294967296,Km=1/df,ta=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class md{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,n,c=this.length){for(;this.pos<c;){const f=this.readVarint(),_=f>>3,v=this.pos;this.type=7&f,t(_,n,this),this.pos===v&&this.skip(f)}return n}readMessage(t,n){return this.readFields(t,n,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*df;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*df;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const n=this.buf;let c,f;return f=n[this.pos++],c=127&f,f<128?c:(f=n[this.pos++],c|=(127&f)<<7,f<128?c:(f=n[this.pos++],c|=(127&f)<<14,f<128?c:(f=n[this.pos++],c|=(127&f)<<21,f<128?c:(f=n[this.pos],c|=(15&f)<<28,(function(_,v,T){const k=T.buf;let M,A;if(A=k[T.pos++],M=(112&A)>>4,A<128||(A=k[T.pos++],M|=(127&A)<<3,A<128)||(A=k[T.pos++],M|=(127&A)<<10,A<128)||(A=k[T.pos++],M|=(127&A)<<17,A<128)||(A=k[T.pos++],M|=(127&A)<<24,A<128)||(A=k[T.pos++],M|=(1&A)<<31,A<128))return Xu(_,M,v);throw new Error("Expected varint not more than 10 bytes")})(c,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&ta?ta.decode(this.buf.subarray(n,t)):(function(c,f,_){let v="",T=f;for(;T<_;){const k=c[T];let M,A,F,U=null,G=k>239?4:k>223?3:k>191?2:1;if(T+G>_)break;G===1?k<128&&(U=k):G===2?(M=c[T+1],(192&M)==128&&(U=(31&k)<<6|63&M,U<=127&&(U=null))):G===3?(M=c[T+1],A=c[T+2],(192&M)==128&&(192&A)==128&&(U=(15&k)<<12|(63&M)<<6|63&A,(U<=2047||U>=55296&&U<=57343)&&(U=null))):G===4&&(M=c[T+1],A=c[T+2],F=c[T+3],(192&M)==128&&(192&A)==128&&(192&F)==128&&(U=(15&k)<<18|(63&M)<<12|(63&A)<<6|63&F,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,G=1):U>65535&&(U-=65536,v+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),v+=String.fromCharCode(U),T+=G}return v})(this.buf,n,t)}readBytes(){const t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n}readPackedVarint(t=[],n){const c=this.readPackedEnd();for(;this.pos<c;)t.push(this.readVarint(n));return t}readPackedSVarint(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const n=7&t;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(t,n){this.writeVarint(t<<3|n)}realloc(t){let n=this.length||16;for(;n<this.pos+t;)n*=2;if(n!==this.length){const c=new Uint8Array(n);c.set(this.buf),this.buf=c,this.dataView=new DataView(c.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Km),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Km),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(n,c){let f,_;if(n>=0?(f=n%4294967296|0,_=n/4294967296|0):(f=~(-n%4294967296),_=~(-n/4294967296),4294967295^f?f=f+1|0:(f=0,_=_+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),(function(v,T,k){k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,k.buf[k.pos]=127&(v>>>=7)})(f,0,c),(function(v,T){const k=(7&v)<<4;T.buf[T.pos++]|=k|((v>>>=3)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v)))))})(_,c)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const n=this.pos;this.pos=(function(f,_,v){for(let T,k,M=0;M<_.length;M++){if(T=_.charCodeAt(M),T>55295&&T<57344){if(!k){T>56319||M+1===_.length?(f[v++]=239,f[v++]=191,f[v++]=189):k=T;continue}if(T<56320){f[v++]=239,f[v++]=191,f[v++]=189,k=T;continue}T=k-55296<<10|T-56320|65536,k=null}else k&&(f[v++]=239,f[v++]=191,f[v++]=189,k=null);T<128?f[v++]=T:(T<2048?f[v++]=T>>6|192:(T<65536?f[v++]=T>>12|224:(f[v++]=T>>18|240,f[v++]=T>>12&63|128),f[v++]=T>>6&63|128),f[v++]=63&T|128)}return v})(this.buf,t,this.pos);const c=this.pos-n;c>=128&&sl(n,c,this),this.pos=n-1,this.writeVarint(c),this.pos+=c}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const n=t.length;this.writeVarint(n),this.realloc(n);for(let c=0;c<n;c++)this.buf[this.pos++]=t[c]}writeRawMessage(t,n){this.pos++;const c=this.pos;t(n,this);const f=this.pos-c;f>=128&&sl(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f}writeMessage(t,n,c){this.writeTag(t,2),this.writeRawMessage(n,c)}writePackedVarint(t,n){n.length&&this.writeMessage(t,ff,n)}writePackedSVarint(t,n){n.length&&this.writeMessage(t,Yc,n)}writePackedBoolean(t,n){n.length&&this.writeMessage(t,Dp,n)}writePackedFloat(t,n){n.length&&this.writeMessage(t,pf,n)}writePackedDouble(t,n){n.length&&this.writeMessage(t,zp,n)}writePackedFixed32(t,n){n.length&&this.writeMessage(t,cy,n)}writePackedSFixed32(t,n){n.length&&this.writeMessage(t,Lp,n)}writePackedFixed64(t,n){n.length&&this.writeMessage(t,uy,n)}writePackedSFixed64(t,n){n.length&&this.writeMessage(t,Xm,n)}writeBytesField(t,n){this.writeTag(t,2),this.writeBytes(n)}writeFixed32Field(t,n){this.writeTag(t,5),this.writeFixed32(n)}writeSFixed32Field(t,n){this.writeTag(t,5),this.writeSFixed32(n)}writeFixed64Field(t,n){this.writeTag(t,1),this.writeFixed64(n)}writeSFixed64Field(t,n){this.writeTag(t,1),this.writeSFixed64(n)}writeVarintField(t,n){this.writeTag(t,0),this.writeVarint(n)}writeSVarintField(t,n){this.writeTag(t,0),this.writeSVarint(n)}writeStringField(t,n){this.writeTag(t,2),this.writeString(n)}writeFloatField(t,n){this.writeTag(t,5),this.writeFloat(n)}writeDoubleField(t,n){this.writeTag(t,1),this.writeDouble(n)}writeBooleanField(t,n){this.writeVarintField(t,+n)}}function Xu(i,t,n){return n?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function sl(i,t,n){const c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(c);for(let f=n.pos-1;f>=i;f--)n.buf[f+c]=n.buf[f]}function ff(i,t){for(let n=0;n<i.length;n++)t.writeVarint(i[n])}function Yc(i,t){for(let n=0;n<i.length;n++)t.writeSVarint(i[n])}function pf(i,t){for(let n=0;n<i.length;n++)t.writeFloat(i[n])}function zp(i,t){for(let n=0;n<i.length;n++)t.writeDouble(i[n])}function Dp(i,t){for(let n=0;n<i.length;n++)t.writeBoolean(i[n])}function cy(i,t){for(let n=0;n<i.length;n++)t.writeFixed32(i[n])}function Lp(i,t){for(let n=0;n<i.length;n++)t.writeSFixed32(i[n])}function uy(i,t){for(let n=0;n<i.length;n++)t.writeFixed64(i[n])}function Xm(i,t){for(let n=0;n<i.length;n++)t.writeSFixed64(i[n])}function Ym(i,t,n){i===1&&n.readMessage(mf,t)}function mf(i,t,n){if(i===3){const{id:c,bitmap:f,width:_,height:v,left:T,top:k,advance:M}=n.readMessage(gf,{});t.push({id:c,bitmap:new Qs({width:_+6,height:v+6},f),metrics:{width:_,height:v,left:T,top:k,advance:M}})}}function gf(i,t,n){i===1?t.id=n.readVarint():i===2?t.bitmap=n.readBytes():i===3?t.width=n.readVarint():i===4?t.height=n.readVarint():i===5?t.left=n.readSVarint():i===6?t.top=n.readSVarint():i===7&&(t.advance=n.readVarint())}function Fp(i){let t=0,n=0;for(const v of i)t+=v.w*v.h,n=Math.max(n,v.w);i.sort(((v,T)=>T.h-v.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let f=0,_=0;for(const v of i)for(let T=c.length-1;T>=0;T--){const k=c[T];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,_=Math.max(_,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===k.w&&v.h===k.h){const M=c.pop();M&&T<c.length&&(c[T]=M)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(c.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:f,h:_,fill:t/(f*_)||0}}class gd{constructor(t,{pixelRatio:n,version:c,stretchX:f,stretchY:_,content:v,textFitWidth:T,textFitHeight:k}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=f,this.stretchY=_,this.content=v,this.version=c,this.textFitWidth=T,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Qm{constructor(t,n){const c={},f={};this.haveRenderCallbacks=[];const _=[];this.addImages(t,c,_),this.addImages(n,f,_);const{w:v,h:T}=Fp(_),k=new ws({width:v||1,height:T||1});for(const M in t){const A=t[M],F=c[M].paddedRect;ws.copy(A.data,k,{x:0,y:0},{x:F.x+1,y:F.y+1},A.data)}for(const M in n){const A=n[M],F=f[M].paddedRect,U=F.x+1,G=F.y+1,H=A.data.width,Q=A.data.height;ws.copy(A.data,k,{x:0,y:0},{x:U,y:G},A.data),ws.copy(A.data,k,{x:0,y:Q-1},{x:U,y:G-1},{width:H,height:1}),ws.copy(A.data,k,{x:0,y:0},{x:U,y:G+Q},{width:H,height:1}),ws.copy(A.data,k,{x:H-1,y:0},{x:U-1,y:G},{width:1,height:Q}),ws.copy(A.data,k,{x:0,y:0},{x:U+H,y:G},{width:1,height:Q})}this.image=k,this.iconPositions=c,this.patternPositions=f}addImages(t,n,c){for(const f in t){const _=t[f],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};c.push(v),n[f]=new gd(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),n),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),n)}patchUpdatedImage(t,n,c){if(!t||!n||t.version===n.version)return;t.version=n.version;const[f,_]=t.tl;c.update(n.data,void 0,{x:f,y:_})}}var al;kt("ImagePosition",gd),kt("ImageAtlas",Qm),w.ao=void 0,(al=w.ao||(w.ao={}))[al.none=0]="none",al[al.horizontal=1]="horizontal",al[al.vertical=2]="vertical",al[al.horizontalOnly=3]="horizontalOnly";class Qc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,c){const f=new Qc;return f.scale=t||1,f.fontStack=n,f.verticalAlign=c||"bottom",f}static forImage(t,n){const c=new Qc;return c.imageName=t,c.verticalAlign=n||"bottom",c}}class ol{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const c=new ol;for(let f=0;f<t.sections.length;f++){const _=t.sections[f];_.image?c.addImageSection(_):c.addTextSection(_,n)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let n="";for(let c=0;c<t.length;c++){const f=t.charCodeAt(c+1)||null,_=t.charCodeAt(c-1)||null;n+=f&&Wh(f)&&!pd[t[c+1]]||_&&Wh(_)&&!pd[t[c-1]]||!pd[t[c]]?t[c]:pd[t[c]]}return n})(this.text)}trim(){let t=0;for(let c=0;c<this.text.length&&Jc[this.text.charCodeAt(c)];c++)t++;let n=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&Jc[this.text.charCodeAt(c)];c--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const c=new ol;return c.text=this.text.substring(t,n),c.sectionIndex=this.sectionIndex.slice(t,n),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,n)=>Math.max(t,this.sections[n].scale)),0)}getMaxImageSize(t){let n=0,c=0;for(let f=0;f<this.length();f++){const _=this.getSection(f);if(_.imageName){const v=t[_.imageName];if(!v)continue;const T=v.displaySize;n=Math.max(n,T[0]),c=Math.max(c,T[1])}}return{maxImageWidth:n,maxImageHeight:c}}addTextSection(t,n){this.text+=t.text,this.sections.push(Qc.forText(t.scale,t.fontStack||n,t.verticalAlign));const c=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(c)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Nr("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Qc.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Nr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yu(i,t,n,c,f,_,v,T,k,M,A,F,U,G,H){const Q=ol.fromFeature(i,f);let ie;F===w.ao.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:ze}=Ms;if(ce&&Q.sections.length===1){ie=[];const Ue=ce(Q.toString(),o(Q,M,_,t,c,G));for(const We of Ue){const it=new ol;it.text=We,it.sections=Q.sections;for(let Tt=0;Tt<We.length;Tt++)it.sectionIndex.push(0);ie.push(it)}}else if(ze){ie=[];const Ue=ze(Q.text,Q.sectionIndex,o(Q,M,_,t,c,G));for(const We of Ue){const it=new ol;it.text=We[0],it.sectionIndex=We[1],it.sections=Q.sections,ie.push(it)}}else ie=(function(Ue,We){const it=[],Tt=Ue.text;let yt=0;for(const wt of We)it.push(Ue.substring(yt,wt)),yt=wt;return yt<Tt.length&&it.push(Ue.substring(yt,Tt.length)),it})(Q,o(Q,M,_,t,c,G));const pe=[],be={positionedLines:pe,text:Q.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:F,iconsInText:!1,verticalizable:!1};return(function(Ue,We,it,Tt,yt,wt,qt,xt,St,tt,ir,gr){let er=0,Nt=0,jr=0,On=0;const yi=xt==="right"?1:xt==="left"?0:.5,os=Jn/gr;let to=0;for(const Mn of yt){Mn.trim();const Pi=Mn.getMaxScale(),Gi={positionedGlyphs:[],lineOffset:0};Ue.positionedLines[to]=Gi;const qi=Gi.positionedGlyphs;let Os=0;if(!Mn.length()){Nt+=wt,++to;continue}const ro=x(Tt,Mn,os);for(let na=0;na<Mn.length();na++){const _i=Mn.getSection(na),ki=Mn.getSectionIndex(na),Ei=Mn.getCharCode(na),ai=R(St,ir,Ei);let bn;if(_i.imageName){if(Ue.iconsInText=!0,_i.scale=_i.scale*os,bn=J(_i,ai,Pi,ro,Tt),!bn)continue;Os=Math.max(Os,bn.imageOffset)}else if(bn=O(_i,Ei,ai,ro,We,it),!bn)continue;const{rect:cl,metrics:vf,baselineOffset:ul}=bn;qi.push({glyph:Ei,imageName:_i.imageName,x:er,y:Nt+ul+-17,vertical:ai,scale:_i.scale,fontStack:_i.fontStack,sectionIndex:ki,metrics:vf,rect:cl}),ai?(Ue.verticalizable=!0,er+=(_i.imageName?vf.advance:Jn)*_i.scale+tt):er+=vf.advance*_i.scale+tt}qi.length!==0&&(jr=Math.max(er-tt,jr),me(qi,0,qi.length-1,yi)),er=0,Gi.lineOffset=Math.max(Os,(Pi-1)*Jn);const Ci=wt*Pi+Os;Nt+=Ci,On=Math.max(Ci,On),++to}const{horizontalAlign:ra,verticalAlign:Zi}=d(qt);(function(Mn,Pi,Gi,qi,Os,ro,Ci,na,_i){const ki=(Pi-Gi)*Os;let Ei=0;Ei=ro!==Ci?-na*qi- -17:-qi*_i*Ci+.5*Ci;for(const ai of Mn)for(const bn of ai.positionedGlyphs)bn.x+=ki,bn.y+=Ei})(Ue.positionedLines,yi,ra,Zi,jr,On,wt,Nt,yt.length),Ue.top+=-Zi*Nt,Ue.bottom=Ue.top+Nt,Ue.left+=-ra*jr,Ue.right=Ue.left+jr})(be,t,n,c,ie,v,T,k,F,M,U,H),!(function(Ue){for(const We of Ue)if(We.positionedGlyphs.length!==0)return!1;return!0})(pe)&&be}const Jc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Jm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},hy={40:!0};function yd(i,t,n,c,f,_){if(t.imageName){const v=c[t.imageName];return v?v.displaySize[0]*t.scale*Jn/_+f:0}{const v=n[t.fontStack],T=v&&v[i];return T?T.metrics.advance*t.scale+f:0}}function eg(i,t,n,c){const f=Math.pow(i-t,2);return c?i<t?f/2:2*f:f+Math.abs(n)*n}function _d(i,t,n){let c=0;return i===10&&(c-=1e4),n&&(c+=150),i!==40&&i!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function tg(i,t,n,c,f,_){let v=null,T=eg(t,n,f,_);for(const k of c){const M=eg(t-k.x,n,f,_)+k.badness;M<=T&&(v=k,T=M)}return{index:i,x:t,priorBreak:v,badness:T}}function vd(i){return i?vd(i.priorBreak).concat(i.index):[]}function o(i,t,n,c,f,_){if(!i)return[];const v=[],T=(function(F,U,G,H,Q,ie){let ce=0;for(let ze=0;ze<F.length();ze++){const pe=F.getSection(ze);ce+=yd(F.getCharCode(ze),pe,H,Q,U,ie)}return ce/Math.max(1,Math.ceil(ce/G))})(i,t,n,c,f,_),k=i.text.indexOf("")>=0;let M=0;for(let F=0;F<i.length();F++){const U=i.getSection(F),G=i.getCharCode(F);if(Jc[G]||(M+=yd(G,U,c,f,t,_)),F<i.length()-1){const H=!((A=G)<11904)&&(!!Fr["CJK Compatibility Forms"](A)||!!Fr["CJK Compatibility"](A)||!!Fr["CJK Strokes"](A)||!!Fr["CJK Symbols and Punctuation"](A)||!!Fr["Enclosed CJK Letters and Months"](A)||!!Fr["Halfwidth and Fullwidth Forms"](A)||!!Fr["Ideographic Description Characters"](A)||!!Fr["Vertical Forms"](A)||_s.test(String.fromCodePoint(A)));(Jm[G]||H||U.imageName||F!==i.length()-2&&hy[i.getCharCode(F+1)])&&v.push(tg(F+1,M,T,v,_d(G,i.getCharCode(F+1),H&&k),!1))}}var A;return vd(tg(i.length(),M,T,v,0,!0))}function d(i){let t=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function x(i,t,n){const c=t.getMaxScale()*Jn,{maxImageWidth:f,maxImageHeight:_}=t.getMaxImageSize(i),v=Math.max(c,_*n);return{verticalLineContentWidth:Math.max(c,f*n),horizontalLineContentHeight:v}}function C(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function R(i,t,n){return!(i===w.ao.horizontal||!t&&!Ru(n)||t&&(Jc[n]||(c=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(c)))));var c}function O(i,t,n,c,f,_){const v=_[i.fontStack],T=(function(M,A,F,U){if(M&&M.rect)return M;const G=A[F.fontStack],H=G&&G[U];return H?{rect:null,metrics:H.metrics}:null})(v&&v[t],f,i,t);if(T===null)return null;let k;if(n)k=c.verticalLineContentWidth-i.scale*Jn;else{const M=C(i.verticalAlign);k=(c.horizontalLineContentHeight-i.scale*Jn)*M}return{rect:T.rect,metrics:T.metrics,baselineOffset:k}}function J(i,t,n,c,f){const _=f[i.imageName];if(!_)return null;const v=_.paddedRect,T=_.displaySize,k={width:T[0],height:T[1],left:1,top:-3,advance:t?T[1]:T[0]};let M;if(t)M=c.verticalLineContentWidth-T[1]*i.scale;else{const A=C(i.verticalAlign);M=(c.horizontalLineContentHeight-T[1]*i.scale)*A}return{rect:v,metrics:k,baselineOffset:M,imageOffset:(t?T[0]:T[1])*i.scale-Jn*n}}function me(i,t,n,c){if(c===0)return;const f=i[n],_=(i[n].x+f.metrics.advance*f.scale)*c;for(let v=t;v<=n;v++)i[v].x-=_}function Ee(i,t,n){const{horizontalAlign:c,verticalAlign:f}=d(n),_=t[0]-i.displaySize[0]*c,v=t[1]-i.displaySize[1]*f;return{image:i,top:v,bottom:v+i.displaySize[1],left:_,right:_+i.displaySize[0]}}function He(i){var t,n;let c=i.left,f=i.top,_=i.right-c,v=i.bottom-f;const T=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",k=(n=i.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",M=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(k==="proportional"){if(T==="stretchOnly"&&_/v<M||T==="proportional"){const A=Math.ceil(v*M);c*=A/_,_=A}}else if(T==="proportional"&&k==="stretchOnly"&&M!==0&&_/v>M){const A=Math.ceil(_/M);f*=A/v,v=A}return{x1:c,y1:f,x2:c+_,y2:f+v}}function dt(i,t,n,c,f,_){const v=i.image;let T;if(v.content){const ie=v.content,ce=v.pixelRatio||1;T=[ie[0]/ce,ie[1]/ce,v.displaySize[0]-ie[2]/ce,v.displaySize[1]-ie[3]/ce]}const k=t.left*_,M=t.right*_;let A,F,U,G;n==="width"||n==="both"?(G=f[0]+k-c[3],F=f[0]+M+c[1]):(G=f[0]+(k+M-v.displaySize[0])/2,F=G+v.displaySize[0]);const H=t.top*_,Q=t.bottom*_;return n==="height"||n==="both"?(A=f[1]+H-c[0],U=f[1]+Q+c[2]):(A=f[1]+(H+Q-v.displaySize[1])/2,U=A+v.displaySize[1]),{image:v,top:A,right:F,bottom:U,left:G,collisionPadding:T}}const ct=128,at=32640;function Ot(i,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Wr(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=n;let _=0;for(;_<c.length&&c[_]<=i;)_++;_=Math.max(0,_-1);let v=_;for(;v<c.length&&c[v]<i+1;)v++;v=Math.min(c.length-1,v);const T=c[_],k=c[v];return n.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:k,interpolationType:f}:{kind:"camera",minZoom:T,maxZoom:k,minSize:n.evaluate(new Wr(T)),maxSize:n.evaluate(new Wr(k)),interpolationType:f}}}function Vt(i,t,n){let c="never";const f=i.get(t);return f?c=f:i.get(n)&&(c="always"),c}const Qt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function In(i,t,n,c,f,_,v,T,k,M,A,F,U){const G=T?Math.min(at,Math.round(T[0])):0,H=T?Math.min(at,Math.round(T[1])):0;i.emplaceBack(t,n,Math.round(32*c),Math.round(32*f),_,v,(G<<1)+(k?1:0),H,16*M,16*A,256*F,256*U)}function Ve(i,t,n){i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n)}function Fe(i){for(const t of i.sections)if(Nc(t.text))return!0;return!1}class Ge{constructor(t){this.layoutVertexArray=new mt,this.indexArray=new nn,this.programConfigurations=t,this.segments=new mr,this.dynamicLayoutVertexArray=new rt,this.opacityVertexArray=new Ft,this.hasVisibleVertices=!1,this.placedSymbolArray=new W}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ku.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,qm.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Qt,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",Ge);class bt{constructor(t,n,c){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new c,this.segments=new mr,this.collisionVertexArray=new Zr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,$n.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",bt);class Gt{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ot(this.zoom,n["text-size"]),this.iconSizeData=Ot(this.zoom,n["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),_=c.get("symbol-z-order");this.canOverlap=Vt(c,"text-overlap","text-allow-overlap")!=="never"||Vt(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map((v=>w.ao[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Ge(new is(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Ge(new is(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new ae,this.lineVertexArray=new oe,this.symbolInstances=new se,this.textAnchorOffsets=new le}calculateGlyphDependencies(t,n,c,f,_){for(let v=0;v<t.length;v++)if(n[t.charCodeAt(v)]=!0,(c||f)&&_){const T=pd[t.charAt(v)];T&&(n[T.charCodeAt(0)]=!0)}}populate(t,n,c){const f=this.layers[0],_=f.layout,v=_.get("text-font"),T=_.get("text-field"),k=_.get("icon-image"),M=(T.value.kind!=="constant"||T.value.value instanceof kn&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),A=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,F=_.get("symbol-sort-key");if(this.features=[],!M&&!A)return;const U=n.iconDependencies,G=n.glyphDependencies,H=n.availableImages,Q=new Wr(this.zoom,{globalState:this.globalState});for(const{feature:ie,id:ce,index:ze,sourceLayerIndex:pe}of t){const be=f._featureFilter.needGeometry,Ue=Ya(ie,be);if(!f._featureFilter.filter(Q,Ue,c))continue;let We,it;if(be||(Ue.geometry=wa(ie)),M){const yt=f.getValueAndResolveTokens("text-field",Ue,c,H),wt=kn.factory(yt),qt=this.hasRTLText=this.hasRTLText||Fe(wt);(!qt||Ms.getRTLTextPluginStatus()==="unavailable"||qt&&Ms.isParsed())&&(We=ly(wt,f,Ue))}if(A){const yt=f.getValueAndResolveTokens("icon-image",Ue,c,H);it=yt instanceof ds?yt:ds.fromString(yt)}if(!We&&!it)continue;const Tt=this.sortFeaturesByKey?F.evaluate(Ue,{},c):void 0;if(this.features.push({id:ce,text:We,icon:it,index:ze,sourceLayerIndex:pe,geometry:Ue.geometry,properties:ie.properties,type:ea.types[ie.type],sortKey:Tt}),it&&(U[it.name]=!0),We){const yt=v.evaluate(Ue,{},c).join(","),wt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(w.ao.vertical)>=0;for(const qt of We.sections)if(qt.image)U[qt.image.name]=!0;else{const xt=ql(We.toString()),St=qt.fontStack||yt,tt=G[St]=G[St]||{};this.calculateGlyphDependencies(qt.text,tt,wt,this.allowVerticalPlacement,xt)}}}_.get("symbol-placement")==="line"&&(this.features=(function(ie){const ce={},ze={},pe=[];let be=0;function Ue(yt){pe.push(ie[yt]),be++}function We(yt,wt,qt){const xt=ze[yt];return delete ze[yt],ze[wt]=xt,pe[xt].geometry[0].pop(),pe[xt].geometry[0]=pe[xt].geometry[0].concat(qt[0]),xt}function it(yt,wt,qt){const xt=ce[wt];return delete ce[wt],ce[yt]=xt,pe[xt].geometry[0].shift(),pe[xt].geometry[0]=qt[0].concat(pe[xt].geometry[0]),xt}function Tt(yt,wt,qt){const xt=qt?wt[0][wt[0].length-1]:wt[0][0];return`${yt}:${xt.x}:${xt.y}`}for(let yt=0;yt<ie.length;yt++){const wt=ie[yt],qt=wt.geometry,xt=wt.text?wt.text.toString():null;if(!xt){Ue(yt);continue}const St=Tt(xt,qt),tt=Tt(xt,qt,!0);if(St in ze&&tt in ce&&ze[St]!==ce[tt]){const ir=it(St,tt,qt),gr=We(St,tt,pe[ir].geometry);delete ce[St],delete ze[tt],ze[Tt(xt,pe[gr].geometry,!0)]=gr,pe[ir].geometry=null}else St in ze?We(St,tt,qt):tt in ce?it(St,tt,qt):(Ue(yt),ce[St]=be-1,ze[tt]=be-1)}return pe.filter((yt=>yt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ie,ce)=>ie.sortKey-ce.sortKey))}update(t,n,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:c,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:c,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const c=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(n[t.segment+1]),_=t.dist(n[t.segment]);const v={};for(let T=t.segment+1;T<n.length;T++)v[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:f},T<n.length-1&&(f+=n[T+1].dist(n[T]));for(let T=t.segment||0;T>=0;T--)v[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=n[T-1].dist(n[T]));for(let T=0;T<n.length;T++){const k=v[T];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,n,c,f,_,v,T,k,M,A,F,U){const G=t.indexArray,H=t.layoutVertexArray,Q=t.segments.prepareSegment(4*n.length,H,G,this.canOverlap?v.sortKey:void 0),ie=this.glyphOffsetArray.length,ce=Q.vertexLength,ze=this.allowVerticalPlacement&&T===w.ao.vertical?Math.PI/2:0,pe=v.text&&v.text.sections;for(let be=0;be<n.length;be++){const{tl:Ue,tr:We,bl:it,br:Tt,tex:yt,pixelOffsetTL:wt,pixelOffsetBR:qt,minFontScaleX:xt,minFontScaleY:St,glyphOffset:tt,isSDF:ir,sectionIndex:gr}=n[be],er=Q.vertexLength,Nt=tt[1];In(H,k.x,k.y,Ue.x,Nt+Ue.y,yt.x,yt.y,c,ir,wt.x,wt.y,xt,St),In(H,k.x,k.y,We.x,Nt+We.y,yt.x+yt.w,yt.y,c,ir,qt.x,wt.y,xt,St),In(H,k.x,k.y,it.x,Nt+it.y,yt.x,yt.y+yt.h,c,ir,wt.x,qt.y,xt,St),In(H,k.x,k.y,Tt.x,Nt+Tt.y,yt.x+yt.w,yt.y+yt.h,c,ir,qt.x,qt.y,xt,St),Ve(t.dynamicLayoutVertexArray,k,ze),G.emplaceBack(er,er+2,er+1),G.emplaceBack(er+1,er+2,er+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(tt[0]),be!==n.length-1&&gr===n[be+1].sectionIndex||t.programConfigurations.populatePaintArrays(H.length,v,v.index,{imagePositions:{},canonical:U,formattedSection:pe&&pe[gr],globalState:this.globalState})}t.placedSymbolArray.emplaceBack(k.x,k.y,ie,this.glyphOffsetArray.length-ie,ce,M,A,k.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],T,0,!1,0,F)}_addCollisionDebugVertex(t,n,c,f,_,v){return n.emplaceBack(0,0),t.emplaceBack(c.x,c.y,f,_,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(t,n,c,f,_,v,T){const k=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),M=k.vertexLength,A=_.layoutVertexArray,F=_.collisionVertexArray,U=T.anchorX,G=T.anchorY;this._addCollisionDebugVertex(A,F,v,U,G,new L(t,n)),this._addCollisionDebugVertex(A,F,v,U,G,new L(c,n)),this._addCollisionDebugVertex(A,F,v,U,G,new L(c,f)),this._addCollisionDebugVertex(A,F,v,U,G,new L(t,f)),k.vertexLength+=4;const H=_.indexArray;H.emplaceBack(M,M+1),H.emplaceBack(M+1,M+2),H.emplaceBack(M+2,M+3),H.emplaceBack(M+3,M),k.primitiveLength+=4}addDebugCollisionBoxes(t,n,c,f){for(let _=t;_<n;_++){const v=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,f?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bt(br,Wm.members,Qr),this.iconCollisionBox=new bt(br,Wm.members,Qr);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,c,f,_,v,T,k,M){const A={};for(let F=n;F<c;F++){const U=t.get(F);A.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},A.textFeatureIndex=U.featureIndex;break}for(let F=f;F<_;F++){const U=t.get(F);A.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},A.verticalTextFeatureIndex=U.featureIndex;break}for(let F=v;F<T;F++){const U=t.get(F);A.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},A.iconFeatureIndex=U.featureIndex;break}for(let F=k;F<M;F++){const U=t.get(F);A.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},A.verticalIconFeatureIndex=U.featureIndex;break}return A}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const c=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const c=t.placedSymbolArray.get(n),f=c.vertexStartIndex+4*c.numGlyphs;for(let _=c.vertexStartIndex;_<f;_+=4)t.indexArray.emplaceBack(_,_+2,_+1),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),c=Math.cos(t),f=[],_=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const k=this.symbolInstances.get(T);f.push(0|Math.round(n*k.anchorX+c*k.anchorY)),_.push(k.featureIndex)}return v.sort(((T,k)=>f[T]-f[k]||_[k]-_[T])),v}addToSortKeyRanges(t,n){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===n?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const c=this.symbolInstances.get(n);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach(((f,_,v)=>{f>=0&&v.indexOf(f)===_&&this.addIndicesForPlacedSymbol(this.text,f)})),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hr,dr;kt("SymbolBucket",Gt,{omit:["layers","collisionBoxArray","features","compareText"]}),Gt.MAX_GLYPHS=65535,Gt.addDynamicAttributes=Ve;var vr={get paint(){return dr=dr||new fi({"icon-opacity":new Yt(Ce.paint_symbol["icon-opacity"]),"icon-color":new Yt(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Yt(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yt(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yt(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Lt(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Lt(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yt(Ce.paint_symbol["text-opacity"]),"text-color":new Yt(Ce.paint_symbol["text-color"],{runtimeType:ri,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Yt(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Yt(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Yt(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Lt(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Lt(Ce.paint_symbol["text-translate-anchor"])})},get layout(){return hr=hr||new fi({"symbol-placement":new Lt(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Lt(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Lt(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yt(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Lt(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Lt(Ce.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Lt(Ce.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Lt(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Lt(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Lt(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yt(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Lt(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Lt(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yt(Ce.layout_symbol["icon-image"]),"icon-rotate":new Yt(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Yt(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Lt(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Yt(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Yt(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Lt(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Lt(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Lt(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Yt(Ce.layout_symbol["text-field"]),"text-font":new Yt(Ce.layout_symbol["text-font"]),"text-size":new Yt(Ce.layout_symbol["text-size"]),"text-max-width":new Yt(Ce.layout_symbol["text-max-width"]),"text-line-height":new Lt(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Yt(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Yt(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Yt(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Lt(Ce.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Yt(Ce.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Yt(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Lt(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Lt(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Yt(Ce.layout_symbol["text-rotate"]),"text-padding":new Lt(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Lt(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Yt(Ce.layout_symbol["text-transform"]),"text-offset":new Yt(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Lt(Ce.layout_symbol["text-allow-overlap"]),"text-overlap":new Lt(Ce.layout_symbol["text-overlap"]),"text-ignore-placement":new Lt(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Lt(Ce.layout_symbol["text-optional"])})}};class gi{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:oa,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",gi,{omit:["defaultValue"]});class Hr extends pi{constructor(t){super(t,vr)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const _ of c)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,c,f){const _=this.layout.get(t).evaluate(n,{},c,f),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||wo(v.value)||!_?_:(function(T,k){return k.replace(/{([^{}]+)}/g,((M,A)=>T&&A in T?String(T[A]):""))})(n.properties,_)}createBucket(t){return new Gt(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of vr.paint.overridableProperties){if(!Hr.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),c=new gi(n),f=new Nl(c,n.property.specification);let _=null;_=n.value.kind==="constant"||n.value.kind==="source"?new Ho("source",f):new Ko("composite",f,n.value.zoomStops),this.paint._values[t]=new Oi(n.property,_,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,c){return!(!this.layout||n.isDataDriven()||c.isDataDriven())&&Hr.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const c=t.get("text-field"),f=vr.paint.properties[n];let _=!1;const v=T=>{for(const k of T)if(f.overrides&&f.overrides.hasOverride(k))return void(_=!0)};if(c.value.kind==="constant"&&c.value.value instanceof kn)v(c.value.value.sections);else if(c.value.kind==="source"||c.value.kind==="composite"){const T=M=>{_||(M instanceof fs&&nr(M.value)===Ma?v(M.value.sections):M instanceof Uo?v(M.sections):M.eachChild(T))},k=c.value;k._styleExpression&&T(k._styleExpression.expression)}return _}}let ll;var dy={get paint(){return ll=ll||new fi({"background-color":new Lt(Ce.paint_background["background-color"]),"background-pattern":new va(Ce.paint_background["background-pattern"]),"background-opacity":new Lt(Ce.paint_background["background-opacity"])})}};class G1 extends pi{constructor(t){super(t,dy)}}let gv;var q1={get paint(){return gv=gv||new fi({"raster-opacity":new Lt(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Lt(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Lt(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Lt(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Lt(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Lt(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Lt(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Lt(Ce.paint_raster["raster-fade-duration"])})}};class W1 extends pi{constructor(t){super(t,q1)}}class H1 extends pi{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class K1{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const X1={once:!0},fy=63710088e-1;class Qu{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Qu(Lr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,c=this.lat*n,f=t.lat*n,_=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((t.lng-this.lng)*n);return fy*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof Qu)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Qu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Qu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const yv=2*Math.PI*fy;function _v(i){return yv*Math.cos(i*Math.PI/180)}function vv(i){return(180+i)/360}function xv(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function bv(i,t){return i/_v(t)}function py(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function wv(i,t){return i*_v(py(t))}class Op{constructor(t,n,c=0){this.x=+t,this.y=+n,this.z=+c}static fromLngLat(t,n=0){const c=Qu.convert(t);return new Op(vv(c.lng),xv(c.lat),bv(n,c.lat))}toLngLat(){return new Qu(360*this.x-180,py(this.y))}toAltitude(){return wv(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yv*(t=py(this.y),1/Math.cos(t*Math.PI/180));var t}}function Sv(i,t,n){var c=2*Math.PI*6378137/256/Math.pow(2,n);return[i*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class my{constructor(t,n,c){if(!(function(f,_,v){return!(f<0||f>25||v<0||v>=Math.pow(2,f)||_<0||_>=Math.pow(2,f))})(t,n,c))throw new Error(`x=${n}, y=${c}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=c,this.key=yf(0,t,t,n,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,c){const f=(v=this.y,T=this.z,k=Sv(256*(_=this.x),256*(v=Math.pow(2,T)-v-1),T),M=Sv(256*(_+1),256*(v+1),T),k[0]+","+k[1]+","+M[0]+","+M[1]);var _,v,T,k,M;const A=(function(F,U,G){let H,Q="";for(let ie=F;ie>0;ie--)H=1<<ie-1,Q+=(U&H?1:0)+(G&H?2:0);return Q})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new L((t.x*n-this.x)*ft,(t.y*n-this.y)*ft)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tv{constructor(t,n){this.wrap=t,this.canonical=n,this.key=yf(t,n.z,n.z,n.x,n.y)}}class eo{constructor(t,n,c,f,_){if(this.terrainRttPosMatrix32f=null,t<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${c}`);this.overscaledZ=t,this.wrap=n,this.canonical=new my(c,+f,+_),this.key=yf(n,t,c,f,_)}clone(){return new eo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new eo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new eo(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-t;return t>this.canonical.z?yf(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):yf(this.wrap*+n,t,t,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new eo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new eo(n,this.wrap,n,c,f),new eo(n,this.wrap,n,c+1,f),new eo(n,this.wrap,n,c,f+1),new eo(n,this.wrap,n,c+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new eo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new eo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Op(t.x-this.wrap,t.y))}}function yf(i,t,n,c,f){(i*=2)<0&&(i=-1*i-1);const _=1<<n;return(_*_*i+_*f+c).toString(36)+n.toString(36)+t.toString(36)}function jp(i,t){return t?i.properties[t]:i.id}kt("CanonicalTileID",my),kt("OverscaledTileID",eo,{omit:["terrainRttPosMatrix32f"]});class xd{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new xd;return n.extend(t(new L(this.minX,this.minY))),n.extend(t(new L(this.maxX,this.minY))),n.extend(t(new L(this.minX,this.maxY))),n.extend(t(new L(this.maxX,this.maxY))),n}static fromPoints(t){const n=new xd;for(const c of t)n.extend(c);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class Pv{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const c=t[n];this._stringToNumber[c]=n,this._numberToString[n]=c}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Cv{constructor(t,n,c,f,_){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=c,t._y=f,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class kv{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ya(ft,16,0),this.grid3D=new ya(ft,16,0),this.featureIndexArray=new we,this.promoteId=n}insert(t,n,c,f,_,v){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,_);const k=v?this.grid3D:this.grid;for(let M=0;M<n.length;M++){const A=n[M],F=[1/0,1/0,-1/0,-1/0];for(let U=0;U<A.length;U++){const G=A[U];F[0]=Math.min(F[0],G.x),F[1]=Math.min(F[1],G.y),F[2]=Math.max(F[2],G.x),F[3]=Math.max(F[3],G.y)}F[0]<ft&&F[1]<ft&&F[2]>=0&&F[3]>=0&&k.insert(T,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cf(new md(this.rawTileData)).layers,this.sourceLayerCoder=new Pv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,c,f){this.loadVTLayers();const _=t.params,v=ft/t.tileSize/t.scale,T=pa(_.filter),k=t.queryGeometry,M=t.queryPadding*v,A=xd.fromPoints(k),F=this.grid.query(A.minX-M,A.minY-M,A.maxX+M,A.maxY+M),U=xd.fromPoints(t.cameraQueryGeometry).expandBy(M),G=this.grid3D.query(U.minX,U.minY,U.maxX,U.maxY,((ie,ce,ze,pe)=>(function(be,Ue,We,it,Tt){for(const wt of be)if(Ue<=wt.x&&We<=wt.y&&it>=wt.x&&Tt>=wt.y)return!0;const yt=[new L(Ue,We),new L(Ue,Tt),new L(it,Tt),new L(it,We)];if(be.length>2){for(const wt of yt)if(Zc(be,wt))return!0}for(let wt=0;wt<be.length-1;wt++)if(fp(be[wt],be[wt+1],yt))return!0;return!1})(t.cameraQueryGeometry,ie-M,ce-M,ze+M,pe+M)));for(const ie of G)F.push(ie);F.sort(Y1);const H={};let Q;for(let ie=0;ie<F.length;ie++){const ce=F[ie];if(ce===Q)continue;Q=ce;const ze=this.featureIndexArray.get(ce);let pe=null;this.loadMatchingFeature(H,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,T,_.layers,_.availableImages,n,c,f,((be,Ue,We)=>(pe||(pe=wa(be)),Ue.queryIntersectsFeature({queryGeometry:k,feature:be,featureState:We,geometry:pe,zoom:this.z,transform:t.transform,pixelsToTileUnits:v,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return H}loadMatchingFeature(t,n,c,f,_,v,T,k,M,A,F){const U=this.bucketLayerIDs[n];if(v&&!U.some((ie=>v.has(ie))))return;const G=this.sourceLayerCoder.decode(c),H=this.vtLayers[G].feature(f);if(_.needGeometry){const ie=Ya(H,!0);if(!_.filter(new Wr(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!_.filter(new Wr(this.tileID.overscaledZ),H))return;const Q=this.getId(H,G);for(let ie=0;ie<U.length;ie++){const ce=U[ie];if(v&&!v.has(ce))continue;const ze=k[ce];if(!ze)continue;let pe={};Q&&A&&(pe=A.getState(ze.sourceLayer||"_geojsonTileLayer",Q));const be=sr({},M[ce]);be.paint=Ev(be.paint,ze.paint,H,pe,T),be.layout=Ev(be.layout,ze.layout,H,pe,T);const Ue=!F||F(H,ze,pe);if(!Ue)continue;const We=new Cv(H,this.z,this.x,this.y,Q);We.layer=be;let it=t[ce];it===void 0&&(it=t[ce]=[]),it.push({featureIndex:f,feature:We,intersectionZ:Ue})}}lookupSymbolFeatures(t,n,c,f,_,v,T,k){const M={};this.loadVTLayers();const A=pa(_);for(const F of t)this.loadMatchingFeature(M,c,f,F,A,v,T,k,n);return M}hasLayer(t){for(const n of this.bucketLayerIDs)for(const c of n)if(t===c)return!0;return!1}getId(t,n){var c;let f=t.id;return this.promoteId&&(f=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((c=t.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(f=Number(t.properties.cluster_id))),f}}function Ev(i,t,n,c,f){return lr(i,((_,v)=>{const T=t instanceof Bc?t.get(v):null;return T&&T.evaluate?T.evaluate(n,c,f):T}))}function Y1(i,t){return t-i}function Iv(i,t,n,c,f){const _=[];for(let v=0;v<i.length;v++){const T=i[v];let k;for(let M=0;M<T.length-1;M++){let A=T[M],F=T[M+1];A.x<t&&F.x<t||(A.x<t?A=new L(t,A.y+(t-A.x)/(F.x-A.x)*(F.y-A.y))._round():F.x<t&&(F=new L(t,A.y+(t-A.x)/(F.x-A.x)*(F.y-A.y))._round()),A.y<n&&F.y<n||(A.y<n?A=new L(A.x+(n-A.y)/(F.y-A.y)*(F.x-A.x),n)._round():F.y<n&&(F=new L(A.x+(n-A.y)/(F.y-A.y)*(F.x-A.x),n)._round()),A.x>=c&&F.x>=c||(A.x>=c?A=new L(c,A.y+(c-A.x)/(F.x-A.x)*(F.y-A.y))._round():F.x>=c&&(F=new L(c,A.y+(c-A.x)/(F.x-A.x)*(F.y-A.y))._round()),A.y>=f&&F.y>=f||(A.y>=f?A=new L(A.x+(f-A.y)/(F.y-A.y)*(F.x-A.x),f)._round():F.y>=f&&(F=new L(A.x+(f-A.y)/(F.y-A.y)*(F.x-A.x),f)._round()),k&&A.equals(k[k.length-1])||(k=[A],_.push(k)),k.push(F)))))}}return _}kt("FeatureIndex",kv,{omit:["rawTileData","sourceLayerCoder"]});class Ju extends L{constructor(t,n,c,f){super(t,n),this.angle=c,f!==void 0&&(this.segment=f)}clone(){return new Ju(this.x,this.y,this.angle,this.segment)}}function Mv(i,t,n,c,f){if(t.segment===void 0||n===0)return!0;let _=t,v=t.segment+1,T=0;for(;T>-n/2;){if(v--,v<0)return!1;T-=i[v].dist(_),_=i[v]}T+=i[v].dist(i[v+1]),v++;const k=[];let M=0;for(;T<n/2;){const A=i[v],F=i[v+1];if(!F)return!1;let U=i[v-1].angleTo(A)-A.angleTo(F);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:T,angleDelta:U}),M+=U;T-k[0].distance>c;)M-=k.shift().angleDelta;if(M>f)return!1;v++,T+=A.dist(F)}return!0}function Av(i){let t=0;for(let n=0;n<i.length-1;n++)t+=i[n].dist(i[n+1]);return t}function Rv(i,t,n){return i?.6*t*n:0}function zv(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function Q1(i,t,n,c,f,_){const v=Rv(n,f,_),T=zv(n,c)*_;let k=0;const M=Av(i)/2;for(let A=0;A<i.length-1;A++){const F=i[A],U=i[A+1],G=F.dist(U);if(k+G>M){const H=(M-k)/G,Q=Vs.number(F.x,U.x,H),ie=Vs.number(F.y,U.y,H),ce=new Ju(Q,ie,U.angleTo(F),A);return ce._round(),!v||Mv(i,ce,T,v,t)?ce:void 0}k+=G}}function J1(i,t,n,c,f,_,v,T,k){const M=Rv(c,_,v),A=zv(c,f),F=A*v,U=i[0].x===0||i[0].x===k||i[0].y===0||i[0].y===k;return t-F<t/4&&(t=F+t/4),Dv(i,U?t/2*T%t:(A/2+2*_)*v*T%t,t,M,n,F,U,!1,k)}function Dv(i,t,n,c,f,_,v,T,k){const M=_/2,A=Av(i);let F=0,U=t-n,G=[];for(let H=0;H<i.length-1;H++){const Q=i[H],ie=i[H+1],ce=Q.dist(ie),ze=ie.angleTo(Q);for(;U+n<F+ce;){U+=n;const pe=(U-F)/ce,be=Vs.number(Q.x,ie.x,pe),Ue=Vs.number(Q.y,ie.y,pe);if(be>=0&&be<k&&Ue>=0&&Ue<k&&U-M>=0&&U+M<=A){const We=new Ju(be,Ue,ze,H);We._round(),c&&!Mv(i,We,_,c,f)||G.push(We)}}F+=ce}return T||G.length||v||(G=Dv(i,F/2,n,c,f,_,v,!0,k)),G}function Lv(i,t,n,c){const f=[],_=i.image,v=_.pixelRatio,T=_.paddedRect.w-2,k=_.paddedRect.h-2;let M={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const A=_.stretchX||[[0,T]],F=_.stretchY||[[0,k]],U=(tt,ir)=>tt+ir[1]-ir[0],G=A.reduce(U,0),H=F.reduce(U,0),Q=T-G,ie=k-H;let ce=0,ze=G,pe=0,be=H,Ue=0,We=Q,it=0,Tt=ie;if(_.content&&c){const tt=_.content,ir=tt[2]-tt[0],gr=tt[3]-tt[1];(_.textFitWidth||_.textFitHeight)&&(M=He(i)),ce=rg(A,0,tt[0]),pe=rg(F,0,tt[1]),ze=rg(A,tt[0],tt[2]),be=rg(F,tt[1],tt[3]),Ue=tt[0]-ce,it=tt[1]-pe,We=ir-ze,Tt=gr-be}const yt=M.x1,wt=M.y1,qt=M.x2-yt,xt=M.y2-wt,St=(tt,ir,gr,er)=>{const Nt=ng(tt.stretch-ce,ze,qt,yt),jr=ig(tt.fixed-Ue,We,tt.stretch,G),On=ng(ir.stretch-pe,be,xt,wt),yi=ig(ir.fixed-it,Tt,ir.stretch,H),os=ng(gr.stretch-ce,ze,qt,yt),to=ig(gr.fixed-Ue,We,gr.stretch,G),ra=ng(er.stretch-pe,be,xt,wt),Zi=ig(er.fixed-it,Tt,er.stretch,H),Mn=new L(Nt,On),Pi=new L(os,On),Gi=new L(os,ra),qi=new L(Nt,ra),Os=new L(jr/v,yi/v),ro=new L(to/v,Zi/v),Ci=t*Math.PI/180;if(Ci){const ki=Math.sin(Ci),Ei=Math.cos(Ci),ai=[Ei,-ki,ki,Ei];Mn._matMult(ai),Pi._matMult(ai),qi._matMult(ai),Gi._matMult(ai)}const na=tt.stretch+tt.fixed,_i=ir.stretch+ir.fixed;return{tl:Mn,tr:Pi,bl:qi,br:Gi,tex:{x:_.paddedRect.x+1+na,y:_.paddedRect.y+1+_i,w:gr.stretch+gr.fixed-na,h:er.stretch+er.fixed-_i},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Os,pixelOffsetBR:ro,minFontScaleX:We/v/qt,minFontScaleY:Tt/v/xt,isSDF:n}};if(c&&(_.stretchX||_.stretchY)){const tt=Fv(A,Q,G),ir=Fv(F,ie,H);for(let gr=0;gr<tt.length-1;gr++){const er=tt[gr],Nt=tt[gr+1];for(let jr=0;jr<ir.length-1;jr++)f.push(St(er,ir[jr],Nt,ir[jr+1]))}}else f.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:k+1}));return f}function rg(i,t,n){let c=0;for(const f of i)c+=Math.max(t,Math.min(n,f[1]))-Math.max(t,Math.min(n,f[0]));return c}function Fv(i,t,n){const c=[{fixed:-1,stretch:0}];for(const[f,_]of i){const v=c[c.length-1];c.push({fixed:f-v.stretch,stretch:v.stretch}),c.push({fixed:f-v.stretch,stretch:v.stretch+(_-f)})}return c.push({fixed:t+1,stretch:n}),c}function ng(i,t,n,c){return i/t*n+c}function ig(i,t,n,c){return i-t*n/c}kt("Anchor",Ju);class sg{constructor(t,n,c,f,_,v,T,k,M,A){var F;if(this.boxStartIndex=t.length,M){let U=v.top,G=v.bottom;const H=v.collisionPadding;H&&(U-=H[1],G+=H[3]);let Q=G-U;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{const U=!((F=v.image)===null||F===void 0)&&F.content&&(v.image.textFitWidth||v.image.textFitHeight)?He(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};U.y1=U.y1*T-k[0],U.y2=U.y2*T+k[2],U.x1=U.x1*T-k[3],U.x2=U.x2*T+k[1];const G=v.collisionPadding;if(G&&(U.x1-=G[0]*T,U.y1-=G[1]*T,U.x2+=G[2]*T,U.y2+=G[3]*T),A){const H=new L(U.x1,U.y1),Q=new L(U.x2,U.y1),ie=new L(U.x1,U.y2),ce=new L(U.x2,U.y2),ze=A*Math.PI/180;H._rotate(ze),Q._rotate(ze),ie._rotate(ze),ce._rotate(ze),U.x1=Math.min(H.x,Q.x,ie.x,ce.x),U.x2=Math.max(H.x,Q.x,ie.x,ce.x),U.y1=Math.min(H.y,Q.y,ie.y,ce.y),U.y2=Math.max(H.y,Q.y,ie.y,ce.y)}t.emplaceBack(n.x,n.y,U.x1,U.y1,U.x2,U.y2,c,f,_)}this.boxEndIndex=t.length}}class ew{constructor(t=[],n=(c,f)=>c<f?-1:c>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:c}=this,f=n[t];for(;t>0;){const _=t-1>>1,v=n[_];if(c(f,v)>=0)break;n[t]=v,t=_}n[t]=f}_down(t){const{data:n,compare:c}=this,f=this.length>>1,_=n[t];for(;t<f;){let v=1+(t<<1);const T=v+1;if(T<this.length&&c(n[T],n[v])<0&&(v=T),c(n[v],_)>=0)break;n[t]=n[v],t=v}n[t]=_}}function tw(i,t=1,n=!1){const c=xd.fromPoints(i[0]),f=Math.min(c.width(),c.height());let _=f/2;const v=new ew([],rw),{minX:T,minY:k,maxX:M,maxY:A}=c;if(f===0)return new L(T,k);for(let G=T;G<M;G+=f)for(let H=k;H<A;H+=f)v.push(new _f(G+_,H+_,_,i));let F=(function(G){let H=0,Q=0,ie=0;const ce=G[0];for(let ze=0,pe=ce.length,be=pe-1;ze<pe;be=ze++){const Ue=ce[ze],We=ce[be],it=Ue.x*We.y-We.x*Ue.y;Q+=(Ue.x+We.x)*it,ie+=(Ue.y+We.y)*it,H+=3*it}return new _f(Q/H,ie/H,0,G)})(i),U=v.length;for(;v.length;){const G=v.pop();(G.d>F.d||!F.d)&&(F=G,n&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),G.max-F.d<=t||(_=G.h/2,v.push(new _f(G.p.x-_,G.p.y-_,_,i)),v.push(new _f(G.p.x+_,G.p.y-_,_,i)),v.push(new _f(G.p.x-_,G.p.y+_,_,i)),v.push(new _f(G.p.x+_,G.p.y+_,_,i)),U+=4)}return n&&(console.log(`num probes: ${U}`),console.log(`best distance: ${F.d}`)),F.p}function rw(i,t){return t.max-i.max}function _f(i,t,n,c){this.p=new L(i,t),this.h=n,this.d=(function(f,_){let v=!1,T=1/0;for(let k=0;k<_.length;k++){const M=_[k];for(let A=0,F=M.length,U=F-1;A<F;U=A++){const G=M[A],H=M[U];G.y>f.y!=H.y>f.y&&f.x<(H.x-G.x)*(f.y-G.y)/(H.y-G.y)+G.x&&(v=!v),T=Math.min(T,hp(f,G,H))}}return(v?1:-1)*Math.sqrt(T)})(this.p,c),this.max=this.d+this.h*Math.SQRT2}var as;w.aE=void 0,(as=w.aE||(w.aE={}))[as.center=1]="center",as[as.left=2]="left",as[as.right=3]="right",as[as.top=4]="top",as[as.bottom=5]="bottom",as[as["top-left"]=6]="top-left",as[as["top-right"]=7]="top-right",as[as["bottom-left"]=8]="bottom-left",as[as["bottom-right"]=9]="bottom-right";const gy=Number.POSITIVE_INFINITY;function Ov(i,t){return t[1]!==gy?(function(n,c,f){let _=0,v=0;switch(c=Math.abs(c),f=Math.abs(f),n){case"top-right":case"top-left":case"top":v=f-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-f}switch(n){case"top-right":case"bottom-right":case"right":_=-c;break;case"top-left":case"bottom-left":case"left":_=c}return[_,v]})(i,t[0],t[1]):(function(n,c){let f=0,_=0;c<0&&(c=0);const v=c/Math.SQRT2;switch(n){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-c;break;case"top":_=c-7}switch(n){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=c;break;case"right":f=-c}return[f,_]})(i,t[0])}function jv(i,t,n){var c;const f=i.layout,_=(c=f.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(t,{},n);if(_){const T=_.values,k=[];for(let M=0;M<T.length;M+=2){const A=k[M]=T[M],F=T[M+1].map((U=>U*Jn));A.startsWith("top")?F[1]-=7:A.startsWith("bottom")&&(F[1]+=7),k[M+1]=F}return new qn(k)}const v=f.get("text-variable-anchor");if(v){let T;T=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},n)*Jn,gy]:f.get("text-offset").evaluate(t,{},n).map((M=>M*Jn));const k=[];for(const M of v)k.push(M,Ov(M,T));return new qn(k)}return null}function yy(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nw(i,t,n,c,f,_,v,T,k,M,A,F){let U=_.textMaxSize.evaluate(t,{});U===void 0&&(U=v);const G=i.layers[0].layout,H=G.get("icon-offset").evaluate(t,{},A),Q=Bv(n.horizontal),ie=v/24,ce=i.tilePixelRatio*ie,ze=i.tilePixelRatio*U/24,pe=i.tilePixelRatio*T,be=i.tilePixelRatio*G.get("symbol-spacing"),Ue=G.get("text-padding")*i.tilePixelRatio,We=(function(gr,er,Nt,jr=1){const On=gr.get("icon-padding").evaluate(er,{},Nt),yi=On&&On.values;return[yi[0]*jr,yi[1]*jr,yi[2]*jr,yi[3]*jr]})(G,t,A,i.tilePixelRatio),it=G.get("text-max-angle")/180*Math.PI,Tt=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",yt=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",wt=G.get("symbol-placement"),qt=be/2,xt=G.get("icon-text-fit");let St;c&&xt!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(St=dt(c,n.vertical,xt,G.get("icon-text-fit-padding"),H,ie)),Q&&(c=dt(c,Q,xt,G.get("icon-text-fit-padding"),H,ie)));const tt=A?F.line.getGranularityForZoomLevel(A.z):1,ir=(gr,er)=>{er.x<0||er.x>=ft||er.y<0||er.y>=ft||(function(Nt,jr,On,yi,os,to,ra,Zi,Mn,Pi,Gi,qi,Os,ro,Ci,na,_i,ki,Ei,ai,bn,cl,vf,ul,aw){const xf=Nt.addToLineVertexArray(jr,On);let bd,bf,wf,Sf,Zv=0,Gv=0,qv=0,Wv=0,Py=-1,Cy=-1;const eu={};let Hv=rl("");if(Nt.allowVerticalPlacement&&yi.vertical){const Ps=Zi.layout.get("text-rotate").evaluate(bn,{},ul)+90;wf=new sg(Mn,jr,Pi,Gi,qi,yi.vertical,Os,ro,Ci,Ps),ra&&(Sf=new sg(Mn,jr,Pi,Gi,qi,ra,_i,ki,Ci,Ps))}if(os){const Ps=Zi.layout.get("icon-rotate").evaluate(bn,{}),no=Zi.layout.get("icon-text-fit")!=="none",wd=Lv(os,Ps,vf,no),dl=ra?Lv(ra,Ps,vf,no):void 0;bf=new sg(Mn,jr,Pi,Gi,qi,os,_i,ki,!1,Ps),Zv=4*wd.length;const Sd=Nt.iconSizeData;let tc=null;Sd.kind==="source"?(tc=[ct*Zi.layout.get("icon-size").evaluate(bn,{})],tc[0]>at&&Nr(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Sd.kind==="composite"&&(tc=[ct*cl.compositeIconSizes[0].evaluate(bn,{},ul),ct*cl.compositeIconSizes[1].evaluate(bn,{},ul)],(tc[0]>at||tc[1]>at)&&Nr(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,wd,tc,ai,Ei,bn,w.ao.none,jr,xf.lineStartIndex,xf.lineLength,-1,ul),Py=Nt.icon.placedSymbolArray.length-1,dl&&(Gv=4*dl.length,Nt.addSymbols(Nt.icon,dl,tc,ai,Ei,bn,w.ao.vertical,jr,xf.lineStartIndex,xf.lineLength,-1,ul),Cy=Nt.icon.placedSymbolArray.length-1)}const Kv=Object.keys(yi.horizontal);for(const Ps of Kv){const no=yi.horizontal[Ps];if(!bd){Hv=rl(no.text);const dl=Zi.layout.get("text-rotate").evaluate(bn,{},ul);bd=new sg(Mn,jr,Pi,Gi,qi,no,Os,ro,Ci,dl)}const wd=no.positionedLines.length===1;if(qv+=Nv(Nt,jr,no,to,Zi,Ci,bn,na,xf,yi.vertical?w.ao.horizontal:w.ao.horizontalOnly,wd?Kv:[Ps],eu,Py,cl,ul),wd)break}yi.vertical&&(Wv+=Nv(Nt,jr,yi.vertical,to,Zi,Ci,bn,na,xf,w.ao.vertical,["vertical"],eu,Cy,cl,ul));const ow=bd?bd.boxStartIndex:Nt.collisionBoxArray.length,lw=bd?bd.boxEndIndex:Nt.collisionBoxArray.length,cw=wf?wf.boxStartIndex:Nt.collisionBoxArray.length,uw=wf?wf.boxEndIndex:Nt.collisionBoxArray.length,hw=bf?bf.boxStartIndex:Nt.collisionBoxArray.length,dw=bf?bf.boxEndIndex:Nt.collisionBoxArray.length,fw=Sf?Sf.boxStartIndex:Nt.collisionBoxArray.length,pw=Sf?Sf.boxEndIndex:Nt.collisionBoxArray.length;let hl=-1;const og=(Ps,no)=>Ps&&Ps.circleDiameter?Math.max(Ps.circleDiameter,no):no;hl=og(bd,hl),hl=og(wf,hl),hl=og(bf,hl),hl=og(Sf,hl);const Xv=hl>-1?1:0;Xv&&(hl*=aw/Jn),Nt.glyphOffsetArray.length>=Gt.MAX_GLYPHS&&Nr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bn.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,bn.sortKey);const mw=jv(Zi,bn,ul),[gw,yw]=(function(Ps,no){const wd=Ps.length,dl=no==null?void 0:no.values;if((dl==null?void 0:dl.length)>0)for(let Sd=0;Sd<dl.length;Sd+=2){const tc=dl[Sd+1];Ps.emplaceBack(w.aE[dl[Sd]],tc[0],tc[1])}return[wd,Ps.length]})(Nt.textAnchorOffsets,mw);Nt.symbolInstances.emplaceBack(jr.x,jr.y,eu.right>=0?eu.right:-1,eu.center>=0?eu.center:-1,eu.left>=0?eu.left:-1,eu.vertical||-1,Py,Cy,Hv,ow,lw,cw,uw,hw,dw,fw,pw,Pi,qv,Wv,Zv,Gv,Xv,0,Os,hl,gw,yw)})(i,er,gr,n,c,f,St,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,ce,[Ue,Ue,Ue,Ue],Tt,k,pe,We,yt,H,t,_,M,A,v)};if(wt==="line")for(const gr of Iv(t.geometry,0,0,ft,ft)){const er=Tn(gr,tt),Nt=J1(er,be,it,n.vertical||Q,c,24,ze,i.overscaling,ft);for(const jr of Nt)Q&&iw(i,Q.text,qt,jr)||ir(er,jr)}else if(wt==="line-center"){for(const gr of t.geometry)if(gr.length>1){const er=Tn(gr,tt),Nt=Q1(er,it,n.vertical||Q,c,24,ze);Nt&&ir(er,Nt)}}else if(t.type==="Polygon")for(const gr of Rl(t.geometry,0)){const er=tw(gr,16);ir(Tn(gr[0],tt,!0),new Ju(er.x,er.y,0))}else if(t.type==="LineString")for(const gr of t.geometry){const er=Tn(gr,tt);ir(er,new Ju(er[0].x,er[0].y,0))}else if(t.type==="Point")for(const gr of t.geometry)for(const er of gr)ir([er],new Ju(er.x,er.y,0))}function Nv(i,t,n,c,f,_,v,T,k,M,A,F,U,G,H){const Q=(function(ze,pe,be,Ue,We,it,Tt,yt){const wt=Ue.layout.get("text-rotate").evaluate(it,{})*Math.PI/180,qt=[];for(const xt of pe.positionedLines)for(const St of xt.positionedGlyphs){if(!St.rect)continue;const tt=St.rect||{};let ir=4,gr=!0,er=1,Nt=0;const jr=(We||yt)&&St.vertical,On=St.metrics.advance*St.scale/2;if(yt&&pe.verticalizable&&(Nt=xt.lineOffset/2-(St.imageName?-(Jn-St.metrics.width*St.scale)/2:(St.scale-1)*Jn)),St.imageName){const ki=Tt[St.imageName];gr=ki.sdf,er=ki.pixelRatio,ir=1/er}const yi=We?[St.x+On,St.y]:[0,0];let os=We?[0,0]:[St.x+On+be[0],St.y+be[1]-Nt],to=[0,0];jr&&(to=os,os=[0,0]);const ra=St.metrics.isDoubleResolution?2:1,Zi=(St.metrics.left-ir)*St.scale-On+os[0],Mn=(-St.metrics.top-ir)*St.scale+os[1],Pi=Zi+tt.w/ra*St.scale/er,Gi=Mn+tt.h/ra*St.scale/er,qi=new L(Zi,Mn),Os=new L(Pi,Mn),ro=new L(Zi,Gi),Ci=new L(Pi,Gi);if(jr){const ki=new L(-On,On- -17),Ei=-Math.PI/2,ai=12-On,bn=new L(22-ai,-(St.imageName?ai:0)),cl=new L(...to);qi._rotateAround(Ei,ki)._add(bn)._add(cl),Os._rotateAround(Ei,ki)._add(bn)._add(cl),ro._rotateAround(Ei,ki)._add(bn)._add(cl),Ci._rotateAround(Ei,ki)._add(bn)._add(cl)}if(wt){const ki=Math.sin(wt),Ei=Math.cos(wt),ai=[Ei,-ki,ki,Ei];qi._matMult(ai),Os._matMult(ai),ro._matMult(ai),Ci._matMult(ai)}const na=new L(0,0),_i=new L(0,0);qt.push({tl:qi,tr:Os,bl:ro,br:Ci,tex:tt,writingMode:pe.writingMode,glyphOffset:yi,sectionIndex:St.sectionIndex,isSDF:gr,pixelOffsetTL:na,pixelOffsetBR:_i,minFontScaleX:0,minFontScaleY:0})}return qt})(0,n,T,f,_,v,c,i.allowVerticalPlacement),ie=i.textSizeData;let ce=null;ie.kind==="source"?(ce=[ct*f.layout.get("text-size").evaluate(v,{})],ce[0]>at&&Nr(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ie.kind==="composite"&&(ce=[ct*G.compositeTextSizes[0].evaluate(v,{},H),ct*G.compositeTextSizes[1].evaluate(v,{},H)],(ce[0]>at||ce[1]>at)&&Nr(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,Q,ce,T,_,v,M,t,k.lineStartIndex,k.lineLength,U,H);for(const ze of A)F[ze]=i.text.placedSymbolArray.length-1;return 4*Q.length}function Bv(i){for(const t in i)return i[t];return null}function iw(i,t,n,c){const f=i.compareText;if(t in f){const _=f[t];for(let v=_.length-1;v>=0;v--)if(c.dist(_[v])<n)return!0}else f[t]=[];return f[t].push(c),!1}const $v=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _y{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,c]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const _=$v[15&c];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[T]=new Uint32Array(t,4,1);return new _y(T,v,_,t)}constructor(t,n=64,c=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const _=$v.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,T=t*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-T%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+k,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+k),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+k,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=n,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return vy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:T}=this,k=[0,_.length-1,0],M=[];for(;k.length;){const A=k.pop()||0,F=k.pop()||0,U=k.pop()||0;if(F-U<=T){for(let ie=U;ie<=F;ie++){const ce=v[2*ie],ze=v[2*ie+1];ce>=t&&ce<=c&&ze>=n&&ze<=f&&M.push(_[ie])}continue}const G=U+F>>1,H=v[2*G],Q=v[2*G+1];H>=t&&H<=c&&Q>=n&&Q<=f&&M.push(_[G]),(A===0?t<=H:n<=Q)&&(k.push(U),k.push(G-1),k.push(1-A)),(A===0?c>=H:f>=Q)&&(k.push(G+1),k.push(F),k.push(1-A))}return M}within(t,n,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:v}=this,T=[0,f.length-1,0],k=[],M=c*c;for(;T.length;){const A=T.pop()||0,F=T.pop()||0,U=T.pop()||0;if(F-U<=v){for(let ie=U;ie<=F;ie++)Vv(_[2*ie],_[2*ie+1],t,n)<=M&&k.push(f[ie]);continue}const G=U+F>>1,H=_[2*G],Q=_[2*G+1];Vv(H,Q,t,n)<=M&&k.push(f[G]),(A===0?t-c<=H:n-c<=Q)&&(T.push(U),T.push(G-1),T.push(1-A)),(A===0?t+c>=H:n+c>=Q)&&(T.push(G+1),T.push(F),T.push(1-A))}return k}}function vy(i,t,n,c,f,_){if(f-c<=n)return;const v=c+f>>1;Uv(i,t,v,c,f,_),vy(i,t,n,c,v-1,1-_),vy(i,t,n,v+1,f,1-_)}function Uv(i,t,n,c,f,_){for(;f>c;){if(f-c>600){const M=f-c+1,A=n-c+1,F=Math.log(M),U=.5*Math.exp(2*F/3),G=.5*Math.sqrt(F*U*(M-U)/M)*(A-M/2<0?-1:1);Uv(i,t,n,Math.max(c,Math.floor(n-A*U/M+G)),Math.min(f,Math.floor(n+(M-A)*U/M+G)),_)}const v=t[2*n+_];let T=c,k=f;for(Np(i,t,c,n),t[2*f+_]>v&&Np(i,t,c,f);T<k;){for(Np(i,t,T,k),T++,k--;t[2*T+_]<v;)T++;for(;t[2*k+_]>v;)k--}t[2*c+_]===v?Np(i,t,c,k):(k++,Np(i,t,k,f)),k<=n&&(c=k+1),n<=k&&(f=k-1)}}function Np(i,t,n,c){xy(i,n,c),xy(t,2*n,2*c),xy(t,2*n+1,2*c+1)}function xy(i,t,n){const c=i[t];i[t]=i[n],i[n]=c}function Vv(i,t,n,c){const f=i-n,_=t-c;return f*f+_*_}var by;w.cx=void 0,(by=w.cx||(w.cx={})).create="create",by.load="load",by.fullLoad="fullLoad";let ag=null,Bp=[];const wy=1e3/60,Sy="loadTime",Ty="fullLoadTime",sw={mark(i){performance.mark(i)},frame(i){const t=i;ag!=null&&Bp.push(t-ag),ag=t},clearMetrics(){ag=null,Bp=[],performance.clearMeasures(Sy),performance.clearMeasures(Ty);for(const i in w.cx)performance.clearMarks(w.cx[i])},getPerformanceMetrics(){performance.measure(Sy,w.cx.create,w.cx.load),performance.measure(Ty,w.cx.create,w.cx.fullLoad);const i=performance.getEntriesByName(Sy)[0].duration,t=performance.getEntriesByName(Ty)[0].duration,n=Bp.length,c=1/(Bp.reduce(((_,v)=>_+v),0)/n/1e3),f=Bp.filter((_=>_>wy)).reduce(((_,v)=>_+(v-wy)/wy),0);return{loadTime:i,fullLoadTime:t,fps:c,percentDroppedFrames:f/(n+f)*100,totalFrames:n}}};w.$=ft,w.A=Se,w.B=function([i,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(n),y:i*Math.sin(t)*Math.sin(n),z:i*Math.cos(n)}},w.C=Vs,w.D=Lt,w.E=zt,w.F=Wr,w.G=Gl,w.H=function(i){if(Yi==null){const t=i.navigator?i.navigator.userAgent:null;Yi=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Yi},w.I=gd,w.J=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new K1((()=>this.process())),this.subscription=Et(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=jn(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise(((n,c)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=t?Et(t.signal,"abort",(()=>{_==null||_.unsubscribe(),delete this.resolveRejects[f];const k={id:f,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)}),X1):null;this.resolveRejects[f]={resolve:k=>{_==null||_.unsubscribe(),n(k)},reject:k=>{_==null||_.unsubscribe(),c(k)}};const v=[],T=Object.assign(Object.assign({},i),{id:f,sourceMapId:this.mapId,origin:location.origin,data:ts(i.data,v)});this.target.postMessage(T,{transfer:v})}))}receive(i){const t=i.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const c=this.abortControllers[n];return delete this.abortControllers[n],void(c&&c.abort())}if(jn(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return l(this,void 0,void 0,(function*(){if(t.type==="<response>"){const f=this.resolveRejects[i];return delete this.resolveRejects[i],f?void(t.error?f.reject(Fi(t.error)):f.resolve(Fi(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Fi(t.data),c=new AbortController;this.abortControllers[i]=c;try{const f=yield this.messageHandlers[t.type](t.sourceMapId,n,c);this.completeTask(i,null,f)}catch(f){this.completeTask(i,f)}}))}completeTask(i,t,n){const c=[];delete this.abortControllers[i];const f={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ts(t):null,data:ts(n,c)};this.target.postMessage(f,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},w.K=ne,w.L=function(){var i=new Se(16);return Se!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},w.M=function(i,t,n){var c,f,_,v,T,k,M,A,F,U,G,H,Q=n[0],ie=n[1],ce=n[2];return t===i?(i[12]=t[0]*Q+t[4]*ie+t[8]*ce+t[12],i[13]=t[1]*Q+t[5]*ie+t[9]*ce+t[13],i[14]=t[2]*Q+t[6]*ie+t[10]*ce+t[14],i[15]=t[3]*Q+t[7]*ie+t[11]*ce+t[15]):(f=t[1],_=t[2],v=t[3],T=t[4],k=t[5],M=t[6],A=t[7],F=t[8],U=t[9],G=t[10],H=t[11],i[0]=c=t[0],i[1]=f,i[2]=_,i[3]=v,i[4]=T,i[5]=k,i[6]=M,i[7]=A,i[8]=F,i[9]=U,i[10]=G,i[11]=H,i[12]=c*Q+T*ie+F*ce+t[12],i[13]=f*Q+k*ie+U*ce+t[13],i[14]=_*Q+M*ie+G*ce+t[14],i[15]=v*Q+A*ie+H*ce+t[15]),i},w.N=function(i,t,n){var c=n[0],f=n[1],_=n[2];return i[0]=t[0]*c,i[1]=t[1]*c,i[2]=t[2]*c,i[3]=t[3]*c,i[4]=t[4]*f,i[5]=t[5]*f,i[6]=t[6]*f,i[7]=t[7]*f,i[8]=t[8]*_,i[9]=t[9]*_,i[10]=t[10]*_,i[11]=t[11]*_,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},w.O=function(i,t,n){var c=t[0],f=t[1],_=t[2],v=t[3],T=t[4],k=t[5],M=t[6],A=t[7],F=t[8],U=t[9],G=t[10],H=t[11],Q=t[12],ie=t[13],ce=t[14],ze=t[15],pe=n[0],be=n[1],Ue=n[2],We=n[3];return i[0]=pe*c+be*T+Ue*F+We*Q,i[1]=pe*f+be*k+Ue*U+We*ie,i[2]=pe*_+be*M+Ue*G+We*ce,i[3]=pe*v+be*A+Ue*H+We*ze,i[4]=(pe=n[4])*c+(be=n[5])*T+(Ue=n[6])*F+(We=n[7])*Q,i[5]=pe*f+be*k+Ue*U+We*ie,i[6]=pe*_+be*M+Ue*G+We*ce,i[7]=pe*v+be*A+Ue*H+We*ze,i[8]=(pe=n[8])*c+(be=n[9])*T+(Ue=n[10])*F+(We=n[11])*Q,i[9]=pe*f+be*k+Ue*U+We*ie,i[10]=pe*_+be*M+Ue*G+We*ce,i[11]=pe*v+be*A+Ue*H+We*ze,i[12]=(pe=n[12])*c+(be=n[13])*T+(Ue=n[14])*F+(We=n[15])*Q,i[13]=pe*f+be*k+Ue*U+We*ie,i[14]=pe*_+be*M+Ue*G+We*ce,i[15]=pe*v+be*A+Ue*H+We*ze,i},w.P=L,w.Q=function(i,t){const n={};for(let c=0;c<t.length;c++){const f=t[c];f in i&&(n[f]=i[f])}return n},w.R=ws,w.S=Qu,w.T=$u,w.U=xv,w.V=vv,w.W=Pe,w.X=Le,w.Y=xe,w.Z=eo,w._=l,w.a=K,w.a$=Mt,w.a0=function(i,t){var n,c,f,_,v;if(!i)return t??{};if(!t)return i;let T=Object.assign({},i);if(t.removeAll&&(T={removeAll:!0}),t.remove){const k=new Set(t.remove);T.add&&(T.add=T.add.filter((A=>!k.has(A.id)))),T.update&&(T.update=T.update.filter((A=>!k.has(A.id))));const M=new Set(((n=i.add)!==null&&n!==void 0?n:[]).map((A=>A.id)));t.remove=t.remove.filter((A=>!M.has(A)))}if(t.remove){const k=new Set(T.remove?T.remove.concat(t.remove):t.remove);T.remove=Array.from(k.values())}if(t.add){const k=T.add?T.add.concat(t.add):t.add,M=new Map(k.map((A=>[A.id,A])));T.add=Array.from(M.values())}if(t.update){const k=new Map((c=T.update)===null||c===void 0?void 0:c.map((M=>[M.id,M])));for(const M of t.update){const A=(f=k.get(M.id))!==null&&f!==void 0?f:{id:M.id};M.newGeometry&&(A.newGeometry=M.newGeometry),M.addOrUpdateProperties&&(A.addOrUpdateProperties=((_=A.addOrUpdateProperties)!==null&&_!==void 0?_:[]).concat(M.addOrUpdateProperties)),M.removeProperties&&(A.removeProperties=((v=A.removeProperties)!==null&&v!==void 0?v:[]).concat(M.removeProperties)),M.removeAllProperties&&(A.removeAllProperties=!0),k.set(M.id,A)}T.update=Array.from(k.values())}return T.remove&&T.add&&(T.remove=T.remove.filter((k=>T.add.findIndex((M=>M.id===k))===-1))),T},w.a1=Op,w.a2=xd,w.a3=25,w.a4=my,w.a5=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((n=>{t.onloadstart=()=>{n(t)};for(const c of i){const f=window.document.createElement("source");Oe(c)||(t.crossOrigin="Anonymous"),f.src=c,t.appendChild(f)}}))},w.a6=st,w.a7=function(){return yr++},w.a8=j,w.a9=Gt,w.aA=function(i){let t=1/0,n=1/0,c=-1/0,f=-1/0;for(const _ of i)t=Math.min(t,_.x),n=Math.min(n,_.y),c=Math.max(c,_.x),f=Math.max(f,_.y);return[t,n,c,f]},w.aB=Jn,w.aC=Ct,w.aD=function(i,t,n,c,f=!1){if(!n[0]&&!n[1])return[0,0];const _=f?c==="map"?-i.bearingInRadians:0:c==="viewport"?i.bearingInRadians:0;if(_){const v=Math.sin(_),T=Math.cos(_);n=[n[0]*T-n[1]*v,n[0]*v+n[1]*T]}return[f?n[0]:Ct(t,n[0],i.zoom),f?n[1]:Ct(t,n[1],i.zoom)]},w.aF=Vt,w.aG=yy,w.aH=d,w.aI=_y,w.aJ=wn,w.aK=Yn,w.aL=he,w.aM=mr,w.aN=nn,w.aO=Lr,w.aP=gt,w.aQ=wv,w.aR=Ke,w.aS=Je,w.aT=function(i){var t=new Se(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},w.aU=function(i,t,n){return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i},w.aV=function(i,t){var n=t[0],c=t[1],f=t[2],_=n*n+c*c+f*f;return _>0&&(_=1/Math.sqrt(_)),i[0]=t[0]*_,i[1]=t[1]*_,i[2]=t[2]*_,i},w.aW=At,w.aX=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},w.aY=function(i,t,n){return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i[2]=t[2]*n[2],i[3]=t[3]*n[3],i},w.aZ=lt,w.a_=function(i,t,n){const c=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return c===0?null:(-(i[0]*n[0]+i[1]*n[1]+i[2]*n[2])-n[3])/c},w.aa=pa,w.ab=Ya,w.ac=Cv,w.ad=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,c,f,_)=>{const v=f||_;return t[c]=!v||v.toLowerCase(),""})),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},w.ae=vt,w.af=function(i){return Math.pow(2,i)},w.ag=Ye,w.ah=Kt,w.ai=85.051129,w.aj=bv,w.ak=function(i){return Math.log(i)/Math.LN2},w.al=function(i){var t=i[0],n=i[1];return t*t+n*n},w.am=function(i,t){const n=[];for(const c in i)c in t||n.push(c);return n},w.an=function(i,t){let n=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:_,maxZoom:v}=i,T=f?Kt(zn.interpolationFactor(f,t,_,v),0,1):0;i.kind==="camera"?c=Vs.number(i.minSize,i.maxSize,T):n=T}return{uSizeT:n,uSize:c}},w.ap=function(i,{uSize:t,uSizeT:n},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/ct:i.kind==="composite"?Vs.number(c/ct,f/ct,n):t},w.aq=function(i,t){var n=t[0],c=t[1],f=t[2],_=t[3],v=t[4],T=t[5],k=t[6],M=t[7],A=t[8],F=t[9],U=t[10],G=t[11],H=t[12],Q=t[13],ie=t[14],ce=t[15],ze=n*T-c*v,pe=n*k-f*v,be=n*M-_*v,Ue=c*k-f*T,We=c*M-_*T,it=f*M-_*k,Tt=A*Q-F*H,yt=A*ie-U*H,wt=A*ce-G*H,qt=F*ie-U*Q,xt=F*ce-G*Q,St=U*ce-G*ie,tt=ze*St-pe*xt+be*qt+Ue*wt-We*yt+it*Tt;return tt?(i[0]=(T*St-k*xt+M*qt)*(tt=1/tt),i[1]=(f*xt-c*St-_*qt)*tt,i[2]=(Q*it-ie*We+ce*Ue)*tt,i[3]=(U*We-F*it-G*Ue)*tt,i[4]=(k*wt-v*St-M*yt)*tt,i[5]=(n*St-f*wt+_*yt)*tt,i[6]=(ie*be-H*it-ce*pe)*tt,i[7]=(A*it-U*be+G*pe)*tt,i[8]=(v*xt-T*wt+M*Tt)*tt,i[9]=(c*wt-n*xt-_*Tt)*tt,i[10]=(H*We-Q*be+ce*ze)*tt,i[11]=(F*be-A*We-G*ze)*tt,i[12]=(T*yt-v*qt-k*Tt)*tt,i[13]=(n*qt-c*yt+f*Tt)*tt,i[14]=(Q*pe-H*Ue-ie*ze)*tt,i[15]=(A*Ue-F*pe+U*ze)*tt,i):null},w.ar=Zt,w.as=function(i){var t=i[0],n=i[1];return Math.sqrt(t*t+n*n)},w.at=function(i){return i[0]=0,i[1]=0,i},w.au=function(i,t,n){return i[0]=t[0]*n,i[1]=t[1]*n,i},w.av=Ve,w.aw=Ht,w.ax=function(i,t,n,c){const f=t.y-i.y,_=t.x-i.x,v=c.y-n.y,T=c.x-n.x,k=v*_-T*f;if(k===0)return null;const M=(T*(i.y-n.y)-v*(i.x-n.x))/k;return new L(i.x+M*_,i.y+M*f)},w.ay=Iv,w.az=up,w.b=Ri,w.b$=class extends g{},w.b0=function(i,t,n){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i},w.b1=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]},w.b2=Tv,w.b3=yf,w.b4=function(i,t,n,c,f){var _=1/Math.tan(t/2);if(i[0]=_/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0){var v=1/(c-f);i[10]=(f+c)*v,i[14]=2*f*c*v}else i[10]=-1,i[14]=-2*c;return i},w.b5=function(i){var t=new Se(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},w.b6=function(i,t,n){var c=Math.sin(n),f=Math.cos(n),_=t[0],v=t[1],T=t[2],k=t[3],M=t[4],A=t[5],F=t[6],U=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=_*f+M*c,i[1]=v*f+A*c,i[2]=T*f+F*c,i[3]=k*f+U*c,i[4]=M*f-_*c,i[5]=A*f-v*c,i[6]=F*f-T*c,i[7]=U*f-k*c,i},w.b7=function(i,t,n){var c=Math.sin(n),f=Math.cos(n),_=t[4],v=t[5],T=t[6],k=t[7],M=t[8],A=t[9],F=t[10],U=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=_*f+M*c,i[5]=v*f+A*c,i[6]=T*f+F*c,i[7]=k*f+U*c,i[8]=M*f-_*c,i[9]=A*f-v*c,i[10]=F*f-T*c,i[11]=U*f-k*c,i},w.b8=function(){const i=new Float32Array(16);return Ye(i),i},w.b9=function(){const i=new Float64Array(16);return Ye(i),i},w.bA=function(i,t){const n=Ie(i,360),c=Ie(t,360),f=c-n,_=c>n?f-360:f+360;return Math.abs(f)<Math.abs(_)?f:_},w.bB=function(i){return i[0]=0,i[1]=0,i[2]=0,i},w.bC=function(i,t,n,c){const f=Math.sqrt(i*i+t*t),_=Math.sqrt(n*n+c*c);i/=f,t/=f,n/=_,c/=_;const v=Math.acos(i*n+t*c);return-t*n+i*c>0?v:-v},w.bD=function(i,t){const n=Ie(i,2*Math.PI),c=Ie(t,2*Math.PI);return Math.min(Math.abs(n-c),Math.abs(n-c+2*Math.PI),Math.abs(n-c-2*Math.PI))},w.bE=function(){const i={},t=Ce.$version;for(const n in Ce.$root){const c=Ce.$root[n];if(c.required){let f=null;f=n==="version"?t:c.type==="array"?[]:{},f!=null&&(i[n]=f)}}return i},w.bF=_a,w.bG=ve,w.bH=function i(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let c=0;c<t.length;c++)if(!i(t[c],n[c]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const c in t)if(!i(t[c],n[c]))return!1;return!0}return t===n},w.bI=function(i){i=i.slice();const t=Object.create(null);for(let n=0;n<i.length;n++)t[i[n].id]=i[n];for(let n=0;n<i.length;n++)"ref"in i[n]&&(i[n]=rr(i[n],t[i[n].ref]));return i},w.bJ=function(i){if(i.type==="custom")return new H1(i);switch(i.type){case"background":return new G1(i);case"circle":return new Im(i);case"color-relief":return new Ut(i);case"fill":return new Wu(i);case"fill-extrusion":return new oy(i);case"heatmap":return new Rm(i);case"hillshade":return new ss(i);case"line":return new Xc(i);case"raster":return new W1(i);case"symbol":return new Hr(i)}},w.bK=ln,w.bL=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let n=[];try{if(!Dt(i.version,t.version))return[{command:"setStyle",args:[t]}];Dt(i.center,t.center)||n.push({command:"setCenter",args:[t.center]}),Dt(i.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),Dt(i.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Dt(i.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),Dt(i.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),Dt(i.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),Dt(i.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),Dt(i.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),Dt(i.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),Dt(i.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),Dt(i.light,t.light)||n.push({command:"setLight",args:[t.light]}),Dt(i.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),Dt(i.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),Dt(i.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const c={},f=[];(function(v,T,k,M){let A;for(A in T=T||{},v=v||{})Object.prototype.hasOwnProperty.call(v,A)&&(Object.prototype.hasOwnProperty.call(T,A)||Kr(A,k,M));for(A in T)Object.prototype.hasOwnProperty.call(T,A)&&(Object.prototype.hasOwnProperty.call(v,A)?Dt(v[A],T[A])||(v[A].type==="geojson"&&T[A].type==="geojson"&&Tr(v,T,A)?Xt(k,{command:"setGeoJSONSourceData",args:[A,T[A].data]}):dn(A,T,k,M)):Cr(A,T,k))})(i.sources,t.sources,f,c);const _=[];i.layers&&i.layers.forEach((v=>{"source"in v&&c[v.source]?n.push({command:"removeLayer",args:[v.id]}):_.push(v)})),n=n.concat(f),(function(v,T,k){T=T||[];const M=(v=v||[]).map(ar),A=T.map(ar),F=v.reduce(en,{}),U=T.reduce(en,{}),G=M.slice(),H=Object.create(null);let Q,ie,ce,ze,pe;for(let be=0,Ue=0;be<M.length;be++)Q=M[be],Object.prototype.hasOwnProperty.call(U,Q)?Ue++:(Xt(k,{command:"removeLayer",args:[Q]}),G.splice(G.indexOf(Q,Ue),1));for(let be=0,Ue=0;be<A.length;be++)Q=A[A.length-1-be],G[G.length-1-be]!==Q&&(Object.prototype.hasOwnProperty.call(F,Q)?(Xt(k,{command:"removeLayer",args:[Q]}),G.splice(G.lastIndexOf(Q,G.length-Ue),1)):Ue++,ze=G[G.length-be],Xt(k,{command:"addLayer",args:[U[Q],ze]}),G.splice(G.length-be,0,Q),H[Q]=!0);for(let be=0;be<A.length;be++)if(Q=A[be],ie=F[Q],ce=U[Q],!H[Q]&&!Dt(ie,ce))if(Dt(ie.source,ce.source)&&Dt(ie["source-layer"],ce["source-layer"])&&Dt(ie.type,ce.type)){for(pe in cr(ie.layout,ce.layout,k,Q,null,"setLayoutProperty"),cr(ie.paint,ce.paint,k,Q,null,"setPaintProperty"),Dt(ie.filter,ce.filter)||Xt(k,{command:"setFilter",args:[Q,ce.filter]}),Dt(ie.minzoom,ce.minzoom)&&Dt(ie.maxzoom,ce.maxzoom)||Xt(k,{command:"setLayerZoomRange",args:[Q,ce.minzoom,ce.maxzoom]}),ie)Object.prototype.hasOwnProperty.call(ie,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?cr(ie[pe],ce[pe],k,Q,pe.slice(6),"setPaintProperty"):Dt(ie[pe],ce[pe])||Xt(k,{command:"setLayerProperty",args:[Q,pe,ce[pe]]}));for(pe in ce)Object.prototype.hasOwnProperty.call(ce,pe)&&!Object.prototype.hasOwnProperty.call(ie,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?cr(ie[pe],ce[pe],k,Q,pe.slice(6),"setPaintProperty"):Dt(ie[pe],ce[pe])||Xt(k,{command:"setLayerProperty",args:[Q,pe,ce[pe]]}))}else Xt(k,{command:"removeLayer",args:[Q]}),ze=G[G.lastIndexOf(Q)+1],Xt(k,{command:"addLayer",args:[ce,ze]})})(_,t.layers,n)}catch(c){console.warn("Unable to compute style diff:",c),n=[{command:"setStyle",args:[t]}]}return n},w.bM=function(i){const t=[],n=i.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},w.bN=lr,w.bO=ci,w.bP=class extends Ni{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},w.bQ=Nn,w.bR=class extends Ni{constructor(i,t){super(i,t),this.current=Bi}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},w.bS=Fn,w.bT=class extends Ni{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},w.bU=class extends Ni{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},w.bV=De,w.bW=function(i,t){var n=Math.sin(t),c=Math.cos(t);return i[0]=c,i[1]=n,i[2]=0,i[3]=-n,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},w.bX=function(i,t,n){var c=t[0],f=t[1],_=t[2];return i[0]=c*n[0]+f*n[3]+_*n[6],i[1]=c*n[1]+f*n[4]+_*n[7],i[2]=c*n[2]+f*n[5]+_*n[8],i},w.bY=function(i,t,n,c,f,_,v){var T=1/(t-n),k=1/(c-f),M=1/(_-v);return i[0]=-2*T,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*k,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*M,i[11]=0,i[12]=(t+n)*T,i[13]=(f+c)*k,i[14]=(v+_)*M,i[15]=1,i},w.bZ=class extends Ni{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(4*i.length);for(let n=0;n<i.length;n++)t[4*n]=i[n].r,t[4*n+1]=i[n].g,t[4*n+2]=i[n].b,t[4*n+3]=i[n].a;this.gl.uniform4fv(this.location,t)}}},w.b_=class extends Ni{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(i);this.gl.uniform1fv(this.location,t)}}},w.ba=function(){return new Float64Array(16)},w.bb=function(i,t,n){const c=new Float64Array(4);return or(c,i,t-90,n),c},w.bc=function(i,t,n,c){var f,_,v,T,k,M=t[0],A=t[1],F=t[2],U=t[3],G=n[0],H=n[1],Q=n[2],ie=n[3];return(_=M*G+A*H+F*Q+U*ie)<0&&(_=-_,G=-G,H=-H,Q=-Q,ie=-ie),1-_>Me?(f=Math.acos(_),v=Math.sin(f),T=Math.sin((1-c)*f)/v,k=Math.sin(c*f)/v):(T=1-c,k=c),i[0]=T*M+k*G,i[1]=T*A+k*H,i[2]=T*F+k*Q,i[3]=T*U+k*ie,i},w.bd=function(i){const t=new Float64Array(9);var n,c,f,_,v,T,k,M,A,F,U,G,H,Q,ie,ce,ze,pe;F=(f=(c=i)[0])*(k=f+f),U=(_=c[1])*k,H=(v=c[2])*k,Q=v*(M=_+_),ce=(T=c[3])*k,ze=T*M,pe=T*(A=v+v),(n=t)[0]=1-(G=_*M)-(ie=v*A),n[3]=U-pe,n[6]=H+ze,n[1]=U+pe,n[4]=1-F-ie,n[7]=Q-ce,n[2]=H-ze,n[5]=Q+ce,n[8]=1-F-G;const be=gt(-Math.asin(Kt(t[2],-1,1)));let Ue,We;return Math.hypot(t[5],t[8])<.001?(Ue=0,We=-gt(Math.atan2(t[3],t[4]))):(Ue=gt(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),We=gt(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Ue,pitch:be+90,bearing:We}},w.be=function(i,t){return i.roll==t.roll&&i.pitch==t.pitch&&i.bearing==t.bearing},w.bf=Pr,w.bg=Ka,w.bh=Sn,w.bi=Qn,w.bj=Br,w.bk=Qe,w.bl=jt,w.bm=hi,w.bn=function(i,t,n,c,f){return Qe(c,f,Kt((i-t)/(n-t),0,1))},w.bo=Ie,w.bp=function(){return new Float64Array(3)},w.bq=function(i,t,n,c){return i[0]=t[0]+n[0]*c,i[1]=t[1]+n[1]*c,i[2]=t[2]+n[2]*c,i},w.br=or,w.bs=function(i,t,n){var c=n[0],f=n[1],_=n[2],v=n[3],T=t[0],k=t[1],M=t[2],A=f*M-_*k,F=_*T-c*M,U=c*k-f*T;return i[0]=T+v*(A+=A)+f*(U+=U)-_*(F+=F),i[1]=k+v*F+_*A-c*U,i[2]=M+v*U+c*F-f*A,i},w.bt=function(i,t,n){const c=(f=[i[0],i[1],i[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((A=f[8])*(v=f[4])-(T=f[5])*(M=f[7]))+f[1]*(-A*(_=f[3])+T*(k=f[6]))+f[2]*(M*_-v*k);var f,_,v,T,k,M,A;if(c===0)return null;const F=At([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),U=At([],[n[0],n[1],n[2]],[i[0],i[1],i[2]]),G=At([],[i[0],i[1],i[2]],[t[0],t[1],t[2]]),H=Ke([],F,-i[3]);return Je(H,H,Ke([],U,-t[3])),Je(H,H,Ke([],G,-n[3])),Ke(H,H,1/c),H},w.bu=fy,w.bv=function(){return new Float64Array(4)},w.bw=function(i,t,n,c){var f=[],_=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],_[0]=f[0]*Math.cos(c)-f[1]*Math.sin(c),_[1]=f[0]*Math.sin(c)+f[1]*Math.cos(c),_[2]=f[2],i[0]=_[0]+n[0],i[1]=_[1]+n[1],i[2]=_[2]+n[2],i},w.bx=function(i,t,n,c){var f=[],_=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],_[0]=f[0],_[1]=f[1]*Math.cos(c)-f[2]*Math.sin(c),_[2]=f[1]*Math.sin(c)+f[2]*Math.cos(c),i[0]=_[0]+n[0],i[1]=_[1]+n[1],i[2]=_[2]+n[2],i},w.by=function(i,t,n,c){var f=[],_=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],_[0]=f[2]*Math.sin(c)+f[0]*Math.cos(c),_[1]=f[1],_[2]=f[2]*Math.cos(c)-f[0]*Math.sin(c),i[0]=_[0]+n[0],i[1]=_[1]+n[1],i[2]=_[2]+n[2],i},w.bz=function(i,t,n){var c=Math.sin(n),f=Math.cos(n),_=t[0],v=t[1],T=t[2],k=t[3],M=t[8],A=t[9],F=t[10],U=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=_*f-M*c,i[1]=v*f-A*c,i[2]=T*f-F*c,i[3]=k*f-U*c,i[8]=_*c+M*f,i[9]=v*c+A*f,i[10]=T*c+F*f,i[11]=k*c+U*f,i},w.c=Te,w.c0=Hm,w.c1=class extends s{},w.c2=rd,w.c3=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},w.c4=yp,w.c5=function(i,t,n){var c=t[0],f=t[1],_=t[2],v=n[3]*c+n[7]*f+n[11]*_+n[15];return i[0]=(n[0]*c+n[4]*f+n[8]*_+n[12])/(v=v||1),i[1]=(n[1]*c+n[5]*f+n[9]*_+n[13])/v,i[2]=(n[2]*c+n[6]*f+n[10]*_+n[14])/v,i},w.c6=class extends Fu{},w.c7=class extends z{},w.c8=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},w.c9=function(i,t){var n=i[0],c=i[1],f=i[2],_=i[3],v=i[4],T=i[5],k=i[6],M=i[7],A=i[8],F=i[9],U=i[10],G=i[11],H=i[12],Q=i[13],ie=i[14],ce=i[15],ze=t[0],pe=t[1],be=t[2],Ue=t[3],We=t[4],it=t[5],Tt=t[6],yt=t[7],wt=t[8],qt=t[9],xt=t[10],St=t[11],tt=t[12],ir=t[13],gr=t[14],er=t[15];return Math.abs(n-ze)<=Me*Math.max(1,Math.abs(n),Math.abs(ze))&&Math.abs(c-pe)<=Me*Math.max(1,Math.abs(c),Math.abs(pe))&&Math.abs(f-be)<=Me*Math.max(1,Math.abs(f),Math.abs(be))&&Math.abs(_-Ue)<=Me*Math.max(1,Math.abs(_),Math.abs(Ue))&&Math.abs(v-We)<=Me*Math.max(1,Math.abs(v),Math.abs(We))&&Math.abs(T-it)<=Me*Math.max(1,Math.abs(T),Math.abs(it))&&Math.abs(k-Tt)<=Me*Math.max(1,Math.abs(k),Math.abs(Tt))&&Math.abs(M-yt)<=Me*Math.max(1,Math.abs(M),Math.abs(yt))&&Math.abs(A-wt)<=Me*Math.max(1,Math.abs(A),Math.abs(wt))&&Math.abs(F-qt)<=Me*Math.max(1,Math.abs(F),Math.abs(qt))&&Math.abs(U-xt)<=Me*Math.max(1,Math.abs(U),Math.abs(xt))&&Math.abs(G-St)<=Me*Math.max(1,Math.abs(G),Math.abs(St))&&Math.abs(H-tt)<=Me*Math.max(1,Math.abs(H),Math.abs(tt))&&Math.abs(Q-ir)<=Me*Math.max(1,Math.abs(Q),Math.abs(ir))&&Math.abs(ie-gr)<=Me*Math.max(1,Math.abs(ie),Math.abs(gr))&&Math.abs(ce-er)<=Me*Math.max(1,Math.abs(ce),Math.abs(er))},w.cA=function(i,t){K.REGISTERED_PROTOCOLS[i]=t},w.cB=function(i){delete K.REGISTERED_PROTOCOLS[i]},w.cC=function(i,t){const n={};for(let f=0;f<i.length;f++){const _=t&&t[i[f].id]||op(i[f]);t&&(t[i[f].id]=_);let v=n[_];v||(v=n[_]=[]),v.push(i[f])}const c=[];for(const f in n)c.push(n[f]);return c},w.cD=kt,w.cE=Pv,w.cF=kv,w.cG=Qm,w.cH=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=ft/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],n=t.layout,c=t._unevaluatedLayout._values,f={layoutIconSize:c["icon-size"].possiblyEvaluate(new Wr(i.bucket.zoom+1),i.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Wr(i.bucket.zoom+1),i.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Wr(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:A}=i.bucket.textSizeData;f.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Wr(M),i.canonical),c["text-size"].possiblyEvaluate(new Wr(A),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:A}=i.bucket.iconSizeData;f.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Wr(M),i.canonical),c["icon-size"].possiblyEvaluate(new Wr(A),i.canonical)]}const _=n.get("text-line-height")*Jn,v=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",T=n.get("text-keep-upright"),k=n.get("text-size");for(const M of i.bucket.features){const A=n.get("text-font").evaluate(M,{},i.canonical).join(","),F=k.evaluate(M,{},i.canonical),U=f.layoutTextSize.evaluate(M,{},i.canonical),G=f.layoutIconSize.evaluate(M,{},i.canonical),H={horizontal:{},vertical:void 0},Q=M.text;let ie,ce=[0,0];if(Q){const be=Q.toString(),Ue=n.get("text-letter-spacing").evaluate(M,{},i.canonical)*Jn,We=qh(be)?Ue:0,it=n.get("text-anchor").evaluate(M,{},i.canonical),Tt=jv(t,M,i.canonical);if(!Tt){const xt=n.get("text-radial-offset").evaluate(M,{},i.canonical);ce=xt?Ov(it,[xt*Jn,gy]):n.get("text-offset").evaluate(M,{},i.canonical).map((St=>St*Jn))}let yt=v?"center":n.get("text-justify").evaluate(M,{},i.canonical);const wt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(M,{},i.canonical)*Jn:1/0,qt=()=>{i.bucket.allowVerticalPlacement&&ql(be)&&(H.vertical=Yu(Q,i.glyphMap,i.glyphPositions,i.imagePositions,A,wt,_,it,"left",We,ce,w.ao.vertical,!0,U,F))};if(!v&&Tt){const xt=new Set;if(yt==="auto")for(let tt=0;tt<Tt.values.length;tt+=2)xt.add(yy(Tt.values[tt]));else xt.add(yt);let St=!1;for(const tt of xt)if(!H.horizontal[tt])if(St)H.horizontal[tt]=H.horizontal[0];else{const ir=Yu(Q,i.glyphMap,i.glyphPositions,i.imagePositions,A,wt,_,"center",tt,We,ce,w.ao.horizontal,!1,U,F);ir&&(H.horizontal[tt]=ir,St=ir.positionedLines.length===1)}qt()}else{yt==="auto"&&(yt=yy(it));const xt=Yu(Q,i.glyphMap,i.glyphPositions,i.imagePositions,A,wt,_,it,yt,We,ce,w.ao.horizontal,!1,U,F);xt&&(H.horizontal[yt]=xt),qt(),ql(be)&&v&&T&&(H.vertical=Yu(Q,i.glyphMap,i.glyphPositions,i.imagePositions,A,wt,_,it,yt,We,ce,w.ao.vertical,!1,U,F))}}let ze=!1;if(M.icon&&M.icon.name){const be=i.imageMap[M.icon.name];be&&(ie=Ee(i.imagePositions[M.icon.name],n.get("icon-offset").evaluate(M,{},i.canonical),n.get("icon-anchor").evaluate(M,{},i.canonical)),ze=!!be.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ze:i.bucket.sdfIcons!==ze&&Nr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(be.pixelRatio!==i.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const pe=Bv(H.horizontal)||H.vertical;i.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||ie)&&nw(i.bucket,M,H,ie,i.imageMap,f,U,G,ce,ze,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},w.cI=hd,w.cJ=ld,w.cK=Ao,w.cL=cf,w.cM=md,w.cN=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},w.cO=function(i,t,n,c,f){return l(this,void 0,void 0,(function*(){if(Le())try{return yield xe(i,t,n,c,f)}catch{}return(function(_,v,T,k,M){const A=_.width,F=_.height;Be&&Xe||(Be=new OffscreenCanvas(A,F),Xe=Be.getContext("2d",{willReadFrequently:!0})),Be.width=A,Be.height=F,Xe.drawImage(_,0,0,A,F);const U=Xe.getImageData(v,T,k,M);return Xe.clearRect(0,0,A,F),U.data})(i,t,n,c,f)}))},w.cP=Ui,w.cQ=N,w.cR=cd,w.cS=ea,w.cT=Bl,w.cU=function(i,t){const n=new Map;if(i!=null)if(i.type==="Feature")n.set(jp(i,t),i);else for(const c of i.features)n.set(jp(c,t),c);return n},w.cV=function(i,t){if(i==null)return!0;if(i.type==="Feature")return jp(i,t)!=null;if(i.type==="FeatureCollection"){const n=new Set;for(const c of i.features){const f=jp(c,t);if(f==null||n.has(f))return!1;n.add(f)}return!0}return!1},w.cW=function(i,t,n){var c,f,_,v;if(t.removeAll&&i.clear(),t.remove)for(const T of t.remove)i.delete(T);if(t.add)for(const T of t.add){const k=jp(T,n);k!=null&&i.set(k,T)}if(t.update)for(const T of t.update){let k=i.get(T.id);if(k==null)continue;const M=!T.removeAllProperties&&(((c=T.removeProperties)===null||c===void 0?void 0:c.length)>0||((f=T.addOrUpdateProperties)===null||f===void 0?void 0:f.length)>0);if((T.newGeometry||T.removeAllProperties||M)&&(k=Object.assign({},k),i.set(T.id,k),M&&(k.properties=Object.assign({},k.properties))),T.newGeometry&&(k.geometry=T.newGeometry),T.removeAllProperties)k.properties={};else if(((_=T.removeProperties)===null||_===void 0?void 0:_.length)>0)for(const A of T.removeProperties)Object.prototype.hasOwnProperty.call(k.properties,A)&&delete k.properties[A];if(((v=T.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0)for(const{key:A,value:F}of T.addOrUpdateProperties)k.properties[A]=F}},w.cX=Ms,w.ca=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},w.cb=i=>i.type==="symbol",w.cc=i=>i.type==="circle",w.cd=i=>i.type==="heatmap",w.ce=i=>i.type==="line",w.cf=i=>i.type==="fill",w.cg=i=>i.type==="fill-extrusion",w.ch=i=>i.type==="hillshade",w.ci=i=>i.type==="color-relief",w.cj=i=>i.type==="raster",w.ck=i=>i.type==="background",w.cl=i=>i.type==="custom",w.cm=tr,w.cn=function(i,t,n){const c=_t(t.x-n.x,t.y-n.y),f=_t(i.x-n.x,i.y-n.y);var _,v;return gt(Math.atan2(c[0]*f[1]-c[1]*f[0],(_=c)[0]*(v=f)[0]+_[1]*v[1]))},w.co=fr,w.cp=function(i,t){return _r[t]&&(i instanceof MouseEvent||i instanceof WheelEvent)},w.cq=function(i,t){return Bt[t]&&"touches"in i},w.cr=function(i){return Bt[i]||_r[i]},w.cs=function(i,t,n){var c=t[0],f=t[1];return i[0]=n[0]*c+n[4]*f+n[12],i[1]=n[1]*c+n[5]*f+n[13],i},w.ct=function(i,t){const{x:n,y:c}=Op.fromLngLat(t);return!(i<0||i>25||c<0||c>=1||n<0||n>=1)},w.cu=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},w.cv=class extends Co{},w.cw=sw,w.cy=function(i){return i.message===Sr},w.cz=ue,w.d=Oe,w.e=sr,w.f=i=>l(void 0,void 0,void 0,(function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),w.g=X,w.h=i=>new Promise(((t,n)=>{const c=new Image;c.onload=()=>{t(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame((()=>{c.src=Zn}))},c.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(i)],{type:"image/png"});c.src=i.byteLength?URL.createObjectURL(f):Zn})),w.i=jn,w.j=(i,t)=>Ae(sr(i,{type:"json"}),t),w.k=et,w.l=nt,w.m=Ae,w.n=(i,t)=>Ae(sr(i,{type:"arrayBuffer"}),t),w.o=function(i){return new md(i).readFields(Ym,[])},w.p=Fp,w.q=Qs,w.r=fi,w.s=Et,w.t=Wl,w.u=Fr,w.v=Ce,w.w=Nr,w.x=Gh,w.y=ga,w.z=Ga})),b("worker",["./shared"],(function(w){class l{constructor(K){this.keyCache={},K&&this.replace(K)}replace(K){this._layerConfigs={},this._layers={},this.update(K,[])}update(K,X){for(const ue of K){this._layerConfigs[ue.id]=ue;const ve=this._layers[ue.id]=w.bJ(ue);ve._featureFilter=w.aa(ve.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(const ue of X)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const ne=w.cC(Object.values(this._layerConfigs),this.keyCache);for(const ue of ne){const ve=ue.map((et=>this._layers[et.id])),Ae=ve[0];if(Ae.visibility==="none")continue;const Oe=Ae.source||"";let Re=this.familiesBySource[Oe];Re||(Re=this.familiesBySource[Oe]={});const qe=Ae.sourceLayer||"_geojsonTileLayer";let nt=Re[qe];nt||(nt=Re[qe]=[]),nt.push(ve)}}}class L{constructor(K){const X={},ne=[];for(const Oe in K){const Re=K[Oe],qe=X[Oe]={};for(const nt in Re){const et=Re[+nt];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const zt={x:0,y:0,w:et.bitmap.width+2,h:et.bitmap.height+2};ne.push(zt),qe[nt]={rect:zt,metrics:et.metrics}}}const{w:ue,h:ve}=w.p(ne),Ae=new w.q({width:ue||1,height:ve||1});for(const Oe in K){const Re=K[Oe];for(const qe in Re){const nt=Re[+qe];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;const et=X[Oe][qe].rect;w.q.copy(nt.bitmap,Ae,{x:0,y:0},{x:et.x+1,y:et.y+1},nt.bitmap)}}this.image=Ae,this.positions=X}}w.cD("GlyphAtlas",L);class N{constructor(K){this.tileID=new w.Z(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),this.uid=K.uid,this.zoom=K.zoom,this.pixelRatio=K.pixelRatio,this.tileSize=K.tileSize,this.source=K.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=K.showCollisionBoxes,this.collectResourceTiming=!!K.collectResourceTiming,this.returnDependencies=!!K.returnDependencies,this.promoteId=K.promoteId,this.inFlightDependencies=[],this.globalState=K.globalState}parse(K,X,ne,ue,ve){return w._(this,void 0,void 0,(function*(){this.status="parsing",this.data=K,this.collisionBoxArray=new w.a8;const Ae=new w.cE(Object.keys(K.layers).sort()),Oe=new w.cF(this.tileID,this.promoteId);Oe.bucketLayerIDs=[];const Re={},qe={featureIndex:Oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne,subdivisionGranularity:ve},nt=X.familiesBySource[this.source];for(const cr in nt){const ar=K.layers[cr];if(!ar)continue;ar.version===1&&w.w(`Vector tile source "${this.source}" layer "${cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const en=Ae.encode(cr),st=[];for(let _n=0;_n<ar.length;_n++){const $r=ar.feature(_n),vi=Oe.getId($r,cr);st.push({feature:$r,id:vi,index:_n,sourceLayerIndex:en})}for(const _n of nt[cr]){const $r=_n[0];$r.source!==this.source&&w.w(`layer.source = ${$r.source} does not equal this.source = ${this.source}`),$r.minzoom&&this.zoom<Math.floor($r.minzoom)||$r.maxzoom&&this.zoom>=$r.maxzoom||$r.visibility!=="none"&&(Z(_n,this.zoom,ne,this.globalState),(Re[$r.id]=$r.createBucket({index:Oe.bucketLayerIDs.length,layers:_n,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:en,sourceID:this.source,globalState:this.globalState})).populate(st,qe,this.tileID.canonical),Oe.bucketLayerIDs.push(_n.map((vi=>vi.id))))}}const et=w.bN(qe.glyphDependencies,(cr=>Object.keys(cr).map(Number)));this.inFlightDependencies.forEach((cr=>cr==null?void 0:cr.abort())),this.inFlightDependencies=[];let zt=Promise.resolve({});if(Object.keys(et).length){const cr=new AbortController;this.inFlightDependencies.push(cr),zt=ue.sendAsync({type:"GG",data:{stacks:et,source:this.source,tileID:this.tileID,type:"glyphs"}},cr)}const Ce=Object.keys(qe.iconDependencies);let $t=Promise.resolve({});if(Ce.length){const cr=new AbortController;this.inFlightDependencies.push(cr),$t=ue.sendAsync({type:"GI",data:{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"}},cr)}const rr=Object.keys(qe.patternDependencies);let Dt=Promise.resolve({});if(rr.length){const cr=new AbortController;this.inFlightDependencies.push(cr),Dt=ue.sendAsync({type:"GI",data:{icons:rr,source:this.source,tileID:this.tileID,type:"patterns"}},cr)}const[Xt,Cr,Kr]=yield Promise.all([zt,$t,Dt]),dn=new L(Xt),Tr=new w.cG(Cr,Kr);for(const cr in Re){const ar=Re[cr];ar instanceof w.a9?(Z(ar.layers,this.zoom,ne,this.globalState),w.cH({bucket:ar,glyphMap:Xt,glyphPositions:dn.positions,imageMap:Cr,imagePositions:Tr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:qe.subdivisionGranularity})):ar.hasPattern&&(ar instanceof w.cI||ar instanceof w.cJ||ar instanceof w.cK)&&(Z(ar.layers,this.zoom,ne,this.globalState),ar.addFeatures(qe,this.tileID.canonical,Tr.patternPositions))}return this.status="done",{buckets:Object.values(Re).filter((cr=>!cr.isEmpty())),featureIndex:Oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dn.image,imageAtlas:Tr,glyphMap:this.returnDependencies?Xt:null,iconMap:this.returnDependencies?Cr:null,glyphPositions:this.returnDependencies?dn.positions:null}}))}}function Z(Te,K,X,ne){const ue=new w.F(K);for(const ve of Te)ve.setGlobalState(ne),ve.recalculate(ue,X)}class V{constructor(K,X,ne){this.actor=K,this.layerIndex=X,this.availableImages=ne,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(K,X){return w._(this,void 0,void 0,(function*(){const ne=yield w.n(K.request,X);try{return{vectorTile:new w.cL(new w.cM(ne.data)),rawData:ne.data,cacheControl:ne.cacheControl,expires:ne.expires}}catch(ue){const ve=new Uint8Array(ne.data);let Ae=`Unable to parse the tile at ${K.request.url}, `;throw Ae+=ve[0]===31&&ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ue.message}`,new Error(Ae)}}))}loadTile(K){return w._(this,void 0,void 0,(function*(){const X=K.uid,ne=!!(K&&K.request&&K.request.collectResourceTiming)&&new w.cN(K.request),ue=new N(K);this.loading[X]=ue;const ve=new AbortController;ue.abort=ve;try{const Ae=yield this.loadVectorTile(K,ve);if(delete this.loading[X],!Ae)return null;const Oe=Ae.rawData,Re={};Ae.expires&&(Re.expires=Ae.expires),Ae.cacheControl&&(Re.cacheControl=Ae.cacheControl);const qe={};if(ne){const et=ne.finish();et&&(qe.resourceTiming=JSON.parse(JSON.stringify(et)))}ue.vectorTile=Ae.vectorTile;const nt=ue.parse(Ae.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);this.loaded[X]=ue,this.fetching[X]={rawTileData:Oe,cacheControl:Re,resourceTiming:qe};try{const et=yield nt;return w.e({rawTileData:Oe.slice(0)},et,Re,qe)}finally{delete this.fetching[X]}}catch(Ae){throw delete this.loading[X],ue.status="done",this.loaded[X]=ue,Ae}}))}reloadTile(K){return w._(this,void 0,void 0,(function*(){const X=K.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ne=this.loaded[X];if(ne.showCollisionBoxes=K.showCollisionBoxes,ne.globalState=K.globalState,ne.status==="parsing"){const ue=yield ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);let ve;if(this.fetching[X]){const{rawTileData:Ae,cacheControl:Oe,resourceTiming:Re}=this.fetching[X];delete this.fetching[X],ve=w.e({rawTileData:Ae.slice(0)},ue,Oe,Re)}else ve=ue;return ve}if(ne.status==="done"&&ne.vectorTile)return ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity)}))}abortTile(K){return w._(this,void 0,void 0,(function*(){const X=this.loading,ne=K.uid;X&&X[ne]&&X[ne].abort&&(X[ne].abort.abort(),delete X[ne])}))}removeTile(K){return w._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[K.uid]&&delete this.loaded[K.uid]}))}}class ee{constructor(){this.loaded={}}loadTile(K){return w._(this,void 0,void 0,(function*(){const{uid:X,encoding:ne,rawImageData:ue,redFactor:ve,greenFactor:Ae,blueFactor:Oe,baseShift:Re}=K,qe=ue.width+2,nt=ue.height+2,et=w.b(ue)?new w.R({width:qe,height:nt},yield w.cO(ue,-1,-1,qe,nt)):ue,zt=new w.cP(X,et,ne,ve,Ae,Oe,Re);return this.loaded=this.loaded||{},this.loaded[X]=zt,zt}))}removeTile(K){const X=this.loaded,ne=K.uid;X&&X[ne]&&delete X[ne]}}var q,_e,fe=(function(){if(_e)return q;function Te(X,ne){if(X.length!==0){K(X[0],ne);for(var ue=1;ue<X.length;ue++)K(X[ue],!ne)}}function K(X,ne){for(var ue=0,ve=0,Ae=0,Oe=X.length,Re=Oe-1;Ae<Oe;Re=Ae++){var qe=(X[Ae][0]-X[Re][0])*(X[Re][1]+X[Ae][1]),nt=ue+qe;ve+=Math.abs(ue)>=Math.abs(qe)?ue-nt+qe:qe-nt+ue,ue=nt}ue+ve>=0!=!!ne&&X.reverse()}return _e=1,q=function X(ne,ue){var ve,Ae=ne&&ne.type;if(Ae==="FeatureCollection")for(ve=0;ve<ne.features.length;ve++)X(ne.features[ve],ue);else if(Ae==="GeometryCollection")for(ve=0;ve<ne.geometries.length;ve++)X(ne.geometries[ve],ue);else if(Ae==="Feature")X(ne.geometry,ue);else if(Ae==="Polygon")Te(ne.coordinates,ue);else if(Ae==="MultiPolygon")for(ve=0;ve<ne.coordinates.length;ve++)Te(ne.coordinates[ve],ue);return ne}})(),Pe=w.cQ(fe);class Le extends w.cS{constructor(K,X){super(new w.cM,0,X,[],[]),this.feature=K,this.type=K.type,this.properties=K.tags?K.tags:{},"id"in K&&(typeof K.id=="string"?this.id=parseInt(K.id,10):typeof K.id!="number"||isNaN(K.id)||(this.id=K.id))}loadGeometry(){const K=[],X=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ne of X){const ue=[];for(const ve of ne)ue.push(new w.P(ve[0],ve[1]));K.push(ue)}return K}}class Me extends w.cR{constructor(K,X){super(new w.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=X?X.version:1,this.extent=X?X.extent:4096,this.length=K.length,this.features=K}feature(K){return new Le(this.features[K],this.extent)}}function Se(Te,K){K.writeVarintField(15,Te.version||1),K.writeStringField(1,Te.name||""),K.writeVarintField(5,Te.extent||4096);const X={keys:[],values:[],keycache:{},valuecache:{}};for(let ve=0;ve<Te.length;ve++)X.feature=Te.feature(ve),K.writeMessage(2,De,X);const ne=X.keys;for(const ve of ne)K.writeStringField(3,ve);const ue=X.values;for(const ve of ue)K.writeMessage(4,Je,ve)}function De(Te,K){if(!Te.feature)return;const X=Te.feature;X.id!==void 0&&K.writeVarintField(1,X.id),K.writeMessage(2,Ye,Te),K.writeVarintField(3,X.type),K.writeMessage(4,ut,X)}function Ye(Te,K){var X;for(const ne in(X=Te.feature)==null?void 0:X.properties){let ue=Te.feature.properties[ne],ve=Te.keycache[ne];if(ue===null)continue;ve===void 0&&(Te.keys.push(ne),ve=Te.keys.length-1,Te.keycache[ne]=ve),K.writeVarint(ve),typeof ue!="string"&&typeof ue!="boolean"&&typeof ue!="number"&&(ue=JSON.stringify(ue));const Ae=typeof ue+":"+ue;let Oe=Te.valuecache[Ae];Oe===void 0&&(Te.values.push(ue),Oe=Te.values.length-1,Te.valuecache[Ae]=Oe),K.writeVarint(Oe)}}function ot(Te,K){return(K<<3)+(7&Te)}function lt(Te){return Te<<1^Te>>31}function ut(Te,K){const X=Te.loadGeometry(),ne=Te.type;let ue=0,ve=0;for(const Ae of X){let Oe=1;ne===1&&(Oe=Ae.length),K.writeVarint(ot(1,Oe));const Re=ne===3?Ae.length-1:Ae.length;for(let qe=0;qe<Re;qe++){qe===1&&ne!==1&&K.writeVarint(ot(2,Re-1));const nt=Ae[qe].x-ue,et=Ae[qe].y-ve;K.writeVarint(lt(nt)),K.writeVarint(lt(et)),ue+=nt,ve+=et}Te.type===3&&K.writeVarint(ot(7,1))}}function Je(Te,K){const X=typeof Te;X==="string"?K.writeStringField(1,Te):X==="boolean"?K.writeBooleanField(7,Te):X==="number"&&(Te%1!=0?K.writeDoubleField(3,Te):Te<0?K.writeSVarintField(6,Te):K.writeVarintField(5,Te))}const Ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},At=Math.fround||(Rt=new Float32Array(1),Te=>(Rt[0]=+Te,Rt[0]));var Rt;class Mt{constructor(K){this.options=Object.assign(Object.create(Ke),K),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(K){const{log:X,minZoom:ne,maxZoom:ue}=this.options;X&&console.time("total time");const ve=`prepare ${K.length} points`;X&&console.time(ve),this.points=K;const Ae=[];for(let Re=0;Re<K.length;Re++){const qe=K[Re];if(!qe.geometry)continue;const[nt,et]=qe.geometry.coordinates,zt=At(or(nt)),Ce=At(Zt(et));Ae.push(zt,Ce,1/0,Re,-1,1),this.options.reduce&&Ae.push(0)}let Oe=this.trees[ue+1]=this._createTree(Ae);X&&console.timeEnd(ve);for(let Re=ue;Re>=ne;Re--){const qe=+Date.now();Oe=this.trees[Re]=this._createTree(this._cluster(Oe,Re)),X&&console.log("z%d: %d clusters in %dms",Re,Oe.numItems,+Date.now()-qe)}return X&&console.timeEnd("total time"),this}getClusters(K,X){let ne=((K[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,K[1]));let ve=K[2]===180?180:((K[2]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)ne=-180,ve=180;else if(ne>ve){const et=this.getClusters([ne,ue,180,Ae],X),zt=this.getClusters([-180,ue,ve,Ae],X);return et.concat(zt)}const Oe=this.trees[this._limitZoom(X)],Re=Oe.range(or(ne),Zt(Ae),or(ve),Zt(ue)),qe=Oe.data,nt=[];for(const et of Re){const zt=this.stride*et;nt.push(qe[zt+5]>1?Ht(qe,zt,this.clusterProps):this.points[qe[zt+3]])}return nt}getChildren(K){const X=this._getOriginId(K),ne=this._getOriginZoom(K),ue="No cluster with the specified id.",ve=this.trees[ne];if(!ve)throw new Error(ue);const Ae=ve.data;if(X*this.stride>=Ae.length)throw new Error(ue);const Oe=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),Re=ve.within(Ae[X*this.stride],Ae[X*this.stride+1],Oe),qe=[];for(const nt of Re){const et=nt*this.stride;Ae[et+4]===K&&qe.push(Ae[et+5]>1?Ht(Ae,et,this.clusterProps):this.points[Ae[et+3]])}if(qe.length===0)throw new Error(ue);return qe}getLeaves(K,X,ne){const ue=[];return this._appendLeaves(ue,K,X=X||10,ne=ne||0,0),ue}getTile(K,X,ne){const ue=this.trees[this._limitZoom(K)],ve=Math.pow(2,K),{extent:Ae,radius:Oe}=this.options,Re=Oe/Ae,qe=(ne-Re)/ve,nt=(ne+1+Re)/ve,et={features:[]};return this._addTileFeatures(ue.range((X-Re)/ve,qe,(X+1+Re)/ve,nt),ue.data,X,ne,ve,et),X===0&&this._addTileFeatures(ue.range(1-Re/ve,qe,1,nt),ue.data,ve,ne,ve,et),X===ve-1&&this._addTileFeatures(ue.range(0,qe,Re/ve,nt),ue.data,-1,ne,ve,et),et.features.length?et:null}getClusterExpansionZoom(K){let X=this._getOriginZoom(K)-1;for(;X<=this.options.maxZoom;){const ne=this.getChildren(K);if(X++,ne.length!==1)break;K=ne[0].properties.cluster_id}return X}_appendLeaves(K,X,ne,ue,ve){const Ae=this.getChildren(X);for(const Oe of Ae){const Re=Oe.properties;if(Re&&Re.cluster?ve+Re.point_count<=ue?ve+=Re.point_count:ve=this._appendLeaves(K,Re.cluster_id,ne,ue,ve):ve<ue?ve++:K.push(Oe),K.length===ne)break}return ve}_createTree(K){const X=new w.aI(K.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ne=0;ne<K.length;ne+=this.stride)X.add(K[ne],K[ne+1]);return X.finish(),X.data=K,X}_addTileFeatures(K,X,ne,ue,ve,Ae){for(const Oe of K){const Re=Oe*this.stride,qe=X[Re+5]>1;let nt,et,zt;if(qe)nt=zr(X,Re,this.clusterProps),et=X[Re],zt=X[Re+1];else{const rr=this.points[X[Re+3]];nt=rr.properties;const[Dt,Xt]=rr.geometry.coordinates;et=or(Dt),zt=Zt(Xt)}const Ce={type:1,geometry:[[Math.round(this.options.extent*(et*ve-ne)),Math.round(this.options.extent*(zt*ve-ue))]],tags:nt};let $t;$t=qe||this.options.generateId?X[Re+3]:this.points[X[Re+3]].id,$t!==void 0&&(Ce.id=$t),Ae.features.push(Ce)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(Math.floor(+K),this.options.maxZoom+1))}_cluster(K,X){const{radius:ne,extent:ue,reduce:ve,minPoints:Ae}=this.options,Oe=ne/(ue*Math.pow(2,X)),Re=K.data,qe=[],nt=this.stride;for(let et=0;et<Re.length;et+=nt){if(Re[et+2]<=X)continue;Re[et+2]=X;const zt=Re[et],Ce=Re[et+1],$t=K.within(Re[et],Re[et+1],Oe),rr=Re[et+5];let Dt=rr;for(const Xt of $t){const Cr=Xt*nt;Re[Cr+2]>X&&(Dt+=Re[Cr+5])}if(Dt>rr&&Dt>=Ae){let Xt,Cr=zt*rr,Kr=Ce*rr,dn=-1;const Tr=(et/nt<<5)+(X+1)+this.points.length;for(const cr of $t){const ar=cr*nt;if(Re[ar+2]<=X)continue;Re[ar+2]=X;const en=Re[ar+5];Cr+=Re[ar]*en,Kr+=Re[ar+1]*en,Re[ar+4]=Tr,ve&&(Xt||(Xt=this._map(Re,et,!0),dn=this.clusterProps.length,this.clusterProps.push(Xt)),ve(Xt,this._map(Re,ar)))}Re[et+4]=Tr,qe.push(Cr/Dt,Kr/Dt,1/0,Tr,-1,Dt),ve&&qe.push(dn)}else{for(let Xt=0;Xt<nt;Xt++)qe.push(Re[et+Xt]);if(Dt>1)for(const Xt of $t){const Cr=Xt*nt;if(!(Re[Cr+2]<=X)){Re[Cr+2]=X;for(let Kr=0;Kr<nt;Kr++)qe.push(Re[Cr+Kr])}}}}return qe}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,X,ne){if(K[X+5]>1){const Ae=this.clusterProps[K[X+6]];return ne?Object.assign({},Ae):Ae}const ue=this.points[K[X+3]].properties,ve=this.options.map(ue);return ne&&ve===ue?Object.assign({},ve):ve}}function Ht(Te,K,X){return{type:"Feature",id:Te[K+3],properties:zr(Te,K,X),geometry:{type:"Point",coordinates:[(ne=Te[K],360*(ne-.5)),_t(Te[K+1])]}};var ne}function zr(Te,K,X){const ne=Te[K+5],ue=ne>=1e4?`${Math.round(ne/1e3)}k`:ne>=1e3?Math.round(ne/100)/10+"k":ne,ve=Te[K+6],Ae=ve===-1?{}:Object.assign({},X[ve]);return Object.assign(Ae,{cluster:!0,cluster_id:Te[K+3],point_count:ne,point_count_abbreviated:ue})}function or(Te){return Te/360+.5}function Zt(Te){const K=Math.sin(Te*Math.PI/180),X=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return X<0?0:X>1?1:X}function _t(Te){const K=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function ft(Te,K,X,ne){let ue=ne;const ve=K+(X-K>>1);let Ae,Oe=X-K;const Re=Te[K],qe=Te[K+1],nt=Te[X],et=Te[X+1];for(let zt=K+3;zt<X;zt+=3){const Ce=Ct(Te[zt],Te[zt+1],Re,qe,nt,et);if(Ce>ue)Ae=zt,ue=Ce;else if(Ce===ue){const $t=Math.abs(zt-ve);$t<Oe&&(Ae=zt,Oe=$t)}}ue>ne&&(Ae-K>3&&ft(Te,K,Ae,ne),Te[Ae+2]=ue,X-Ae>3&&ft(Te,Ae,X,ne))}function Ct(Te,K,X,ne,ue,ve){let Ae=ue-X,Oe=ve-ne;if(Ae!==0||Oe!==0){const Re=((Te-X)*Ae+(K-ne)*Oe)/(Ae*Ae+Oe*Oe);Re>1?(X=ue,ne=ve):Re>0&&(X+=Ae*Re,ne+=Oe*Re)}return Ae=Te-X,Oe=K-ne,Ae*Ae+Oe*Oe}function Ie(Te,K,X,ne){const ue={id:Te??null,type:K,geometry:X,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(K==="Point"||K==="MultiPoint"||K==="LineString")Qe(ue,X);else if(K==="Polygon")Qe(ue,X[0]);else if(K==="MultiLineString")for(const ve of X)Qe(ue,ve);else if(K==="MultiPolygon")for(const ve of X)Qe(ue,ve[0]);return ue}function Qe(Te,K){for(let X=0;X<K.length;X+=3)Te.minX=Math.min(Te.minX,K[X]),Te.minY=Math.min(Te.minY,K[X+1]),Te.maxX=Math.max(Te.maxX,K[X]),Te.maxY=Math.max(Te.maxY,K[X+1])}function jt(Te,K,X,ne){if(!K.geometry)return;const ue=K.geometry.coordinates;if(ue&&ue.length===0)return;const ve=K.geometry.type,Ae=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2);let Oe=[],Re=K.id;if(X.promoteId?Re=K.properties[X.promoteId]:X.generateId&&(Re=ne||0),ve==="Point")tr(ue,Oe);else if(ve==="MultiPoint")for(const qe of ue)tr(qe,Oe);else if(ve==="LineString")fr(ue,Oe,Ae,!1);else if(ve==="MultiLineString"){if(X.lineMetrics){for(const qe of ue)Oe=[],fr(qe,Oe,Ae,!1),Te.push(Ie(Re,"LineString",Oe,K.properties));return}Kt(ue,Oe,Ae,!1)}else if(ve==="Polygon")Kt(ue,Oe,Ae,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(const qe of K.geometry.geometries)jt(Te,{id:Re,geometry:qe,properties:K.properties},X,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const qe of ue){const nt=[];Kt(qe,nt,Ae,!0),Oe.push(nt)}}Te.push(Ie(Re,ve,Oe,K.properties))}function tr(Te,K){K.push(Lr(Te[0]),sr(Te[1]),0)}function fr(Te,K,X,ne){let ue,ve,Ae=0;for(let Re=0;Re<Te.length;Re++){const qe=Lr(Te[Re][0]),nt=sr(Te[Re][1]);K.push(qe,nt,0),Re>0&&(Ae+=ne?(ue*nt-qe*ve)/2:Math.sqrt(Math.pow(qe-ue,2)+Math.pow(nt-ve,2))),ue=qe,ve=nt}const Oe=K.length-3;K[2]=1,ft(K,0,Oe,X),K[Oe+2]=1,K.size=Math.abs(Ae),K.start=0,K.end=K.size}function Kt(Te,K,X,ne){for(let ue=0;ue<Te.length;ue++){const ve=[];fr(Te[ue],ve,X,ne),K.push(ve)}}function Lr(Te){return Te/360+.5}function sr(Te){const K=Math.sin(Te*Math.PI/180),X=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return X<0?0:X>1?1:X}function yr(Te,K,X,ne,ue,ve,Ae,Oe){if(ne/=K,ve>=(X/=K)&&Ae<ne)return Te;if(Ae<X||ve>=ne)return null;const Re=[];for(const qe of Te){const nt=qe.geometry;let et=qe.type;const zt=ue===0?qe.minX:qe.minY,Ce=ue===0?qe.maxX:qe.maxY;if(zt>=X&&Ce<ne){Re.push(qe);continue}if(Ce<X||zt>=ne)continue;let $t=[];if(et==="Point"||et==="MultiPoint")lr(nt,$t,X,ne,ue);else if(et==="LineString")ci(nt,$t,X,ne,ue,!1,Oe.lineMetrics);else if(et==="MultiLineString")Vr(nt,$t,X,ne,ue,!1);else if(et==="Polygon")Vr(nt,$t,X,ne,ue,!0);else if(et==="MultiPolygon")for(const rr of nt){const Dt=[];Vr(rr,Dt,X,ne,ue,!0),Dt.length&&$t.push(Dt)}if($t.length){if(Oe.lineMetrics&&et==="LineString"){for(const rr of $t)Re.push(Ie(qe.id,et,rr,qe.tags));continue}et!=="LineString"&&et!=="MultiLineString"||($t.length===1?(et="LineString",$t=$t[0]):et="MultiLineString"),et!=="Point"&&et!=="MultiPoint"||(et=$t.length===3?"Point":"MultiPoint"),Re.push(Ie(qe.id,et,$t,qe.tags))}}return Re.length?Re:null}function lr(Te,K,X,ne,ue){for(let ve=0;ve<Te.length;ve+=3){const Ae=Te[ve+ue];Ae>=X&&Ae<=ne&&Nr(K,Te[ve],Te[ve+1],Te[ve+2])}}function ci(Te,K,X,ne,ue,ve,Ae){let Oe=ln(Te);const Re=ue===0?Cn:jn;let qe,nt,et=Te.start;for(let Dt=0;Dt<Te.length-3;Dt+=3){const Xt=Te[Dt],Cr=Te[Dt+1],Kr=Te[Dt+2],dn=Te[Dt+3],Tr=Te[Dt+4],cr=ue===0?Xt:Cr,ar=ue===0?dn:Tr;let en=!1;Ae&&(qe=Math.sqrt(Math.pow(Xt-dn,2)+Math.pow(Cr-Tr,2))),cr<X?ar>X&&(nt=Re(Oe,Xt,Cr,dn,Tr,X),Ae&&(Oe.start=et+qe*nt)):cr>ne?ar<ne&&(nt=Re(Oe,Xt,Cr,dn,Tr,ne),Ae&&(Oe.start=et+qe*nt)):Nr(Oe,Xt,Cr,Kr),ar<X&&cr>=X&&(nt=Re(Oe,Xt,Cr,dn,Tr,X),en=!0),ar>ne&&cr<=ne&&(nt=Re(Oe,Xt,Cr,dn,Tr,ne),en=!0),!ve&&en&&(Ae&&(Oe.end=et+qe*nt),K.push(Oe),Oe=ln(Te)),Ae&&(et+=qe)}let zt=Te.length-3;const Ce=Te[zt],$t=Te[zt+1],rr=ue===0?Ce:$t;rr>=X&&rr<=ne&&Nr(Oe,Ce,$t,Te[zt+2]),zt=Oe.length-3,ve&&zt>=3&&(Oe[zt]!==Oe[0]||Oe[zt+1]!==Oe[1])&&Nr(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&K.push(Oe)}function ln(Te){const K=[];return K.size=Te.size,K.start=Te.start,K.end=Te.end,K}function Vr(Te,K,X,ne,ue,ve){for(const Ae of Te)ci(Ae,K,X,ne,ue,ve,!1)}function Nr(Te,K,X,ne){Te.push(K,X,ne)}function Cn(Te,K,X,ne,ue,ve){const Ae=(ve-K)/(ne-K);return Nr(Te,ve,X+(ue-X)*Ae,1),Ae}function jn(Te,K,X,ne,ue,ve){const Ae=(ve-X)/(ue-X);return Nr(Te,K+(ne-K)*Ae,ve,1),Ae}function Yi(Te,K){const X=[];for(let ne=0;ne<Te.length;ne++){const ue=Te[ne],ve=ue.type;let Ae;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")Ae=Ri(ue.geometry,K);else if(ve==="MultiLineString"||ve==="Polygon"){Ae=[];for(const Oe of ue.geometry)Ae.push(Ri(Oe,K))}else if(ve==="MultiPolygon"){Ae=[];for(const Oe of ue.geometry){const Re=[];for(const qe of Oe)Re.push(Ri(qe,K));Ae.push(Re)}}X.push(Ie(ue.id,ve,Ae,ue.tags))}return X}function Ri(Te,K){const X=[];X.size=Te.size,Te.start!==void 0&&(X.start=Te.start,X.end=Te.end);for(let ne=0;ne<Te.length;ne+=3)X.push(Te[ne]+K,Te[ne+1],Te[ne+2]);return X}function Zn(Te,K){if(Te.transformed)return Te;const X=1<<Te.z,ne=Te.x,ue=Te.y;for(const ve of Te.features){const Ae=ve.geometry,Oe=ve.type;if(ve.geometry=[],Oe===1)for(let Re=0;Re<Ae.length;Re+=2)ve.geometry.push(xe(Ae[Re],Ae[Re+1],K,X,ne,ue));else for(let Re=0;Re<Ae.length;Re++){const qe=[];for(let nt=0;nt<Ae[Re].length;nt+=2)qe.push(xe(Ae[Re][nt],Ae[Re][nt+1],K,X,ne,ue));ve.geometry.push(qe)}}return Te.transformed=!0,Te}function xe(Te,K,X,ne,ue,ve){return[Math.round(X*(Te*ne-ue)),Math.round(X*(K*ne-ve))]}function Be(Te,K,X,ne,ue){const ve=K===ue.maxZoom?0:ue.tolerance/((1<<K)*ue.extent),Ae={features:[],numPoints:0,numSimplified:0,numFeatures:Te.length,source:null,x:X,y:ne,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Oe of Te)Xe(Ae,Oe,ve,ue);return Ae}function Xe(Te,K,X,ne){const ue=K.geometry,ve=K.type,Ae=[];if(Te.minX=Math.min(Te.minX,K.minX),Te.minY=Math.min(Te.minY,K.minY),Te.maxX=Math.max(Te.maxX,K.maxX),Te.maxY=Math.max(Te.maxY,K.maxY),ve==="Point"||ve==="MultiPoint")for(let Oe=0;Oe<ue.length;Oe+=3)Ae.push(ue[Oe],ue[Oe+1]),Te.numPoints++,Te.numSimplified++;else if(ve==="LineString")Et(Ae,ue,Te,X,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(let Oe=0;Oe<ue.length;Oe++)Et(Ae,ue[Oe],Te,X,ve==="Polygon",Oe===0);else if(ve==="MultiPolygon")for(let Oe=0;Oe<ue.length;Oe++){const Re=ue[Oe];for(let qe=0;qe<Re.length;qe++)Et(Ae,Re[qe],Te,X,!0,qe===0)}if(Ae.length){let Oe=K.tags||null;if(ve==="LineString"&&ne.lineMetrics){Oe={};for(const qe in K.tags)Oe[qe]=K.tags[qe];Oe.mapbox_clip_start=ue.start/ue.size,Oe.mapbox_clip_end=ue.end/ue.size}const Re={geometry:Ae,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:Oe};K.id!==null&&(Re.id=K.id),Te.features.push(Re)}}function Et(Te,K,X,ne,ue,ve){const Ae=ne*ne;if(ne>0&&K.size<(ue?Ae:ne))return void(X.numPoints+=K.length/3);const Oe=[];for(let Re=0;Re<K.length;Re+=3)(ne===0||K[Re+2]>Ae)&&(X.numSimplified++,Oe.push(K[Re],K[Re+1])),X.numPoints++;ue&&(function(Re,qe){let nt=0;for(let et=0,zt=Re.length,Ce=zt-2;et<zt;Ce=et,et+=2)nt+=(Re[et]-Re[Ce])*(Re[et+1]+Re[Ce+1]);if(nt>0===qe)for(let et=0,zt=Re.length;et<zt/2;et+=2){const Ce=Re[et],$t=Re[et+1];Re[et]=Re[zt-2-et],Re[et+1]=Re[zt-1-et],Re[zt-2-et]=Ce,Re[zt-1-et]=$t}})(Oe,ve),Te.push(Oe)}const vt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class gt{constructor(K,X){const ne=(X=this.options=(function(ve,Ae){for(const Oe in Ae)ve[Oe]=Ae[Oe];return ve})(Object.create(vt),X)).debug;if(ne&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let ue=(function(ve,Ae){const Oe=[];if(ve.type==="FeatureCollection")for(let Re=0;Re<ve.features.length;Re++)jt(Oe,ve.features[Re],Ae,Re);else jt(Oe,ve.type==="Feature"?ve:{geometry:ve},Ae);return Oe})(K,X);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ue=(function(ve,Ae){const Oe=Ae.buffer/Ae.extent;let Re=ve;const qe=yr(ve,1,-1-Oe,Oe,0,-1,2,Ae),nt=yr(ve,1,1-Oe,2+Oe,0,-1,2,Ae);return(qe||nt)&&(Re=yr(ve,1,-Oe,1+Oe,0,-1,2,Ae)||[],qe&&(Re=Yi(qe,1).concat(Re)),nt&&(Re=Re.concat(Yi(nt,-1)))),Re})(ue,X),ue.length&&this.splitTile(ue,0,0,0),ne&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(K,X,ne,ue,ve,Ae,Oe){const Re=[K,X,ne,ue],qe=this.options,nt=qe.debug;for(;Re.length;){ue=Re.pop(),ne=Re.pop(),X=Re.pop(),K=Re.pop();const et=1<<X,zt=Bt(X,ne,ue);let Ce=this.tiles[zt];if(!Ce&&(nt>1&&console.time("creation"),Ce=this.tiles[zt]=Be(K,X,ne,ue,qe),this.tileCoords.push({z:X,x:ne,y:ue}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ne,ue,Ce.numFeatures,Ce.numPoints,Ce.numSimplified),console.timeEnd("creation"));const en=`z${X}`;this.stats[en]=(this.stats[en]||0)+1,this.total++}if(Ce.source=K,ve==null){if(X===qe.indexMaxZoom||Ce.numPoints<=qe.indexMaxPoints)continue}else{if(X===qe.maxZoom||X===ve)continue;if(ve!=null){const en=ve-X;if(ne!==Ae>>en||ue!==Oe>>en)continue}}if(Ce.source=null,K.length===0)continue;nt>1&&console.time("clipping");const $t=.5*qe.buffer/qe.extent,rr=.5-$t,Dt=.5+$t,Xt=1+$t;let Cr=null,Kr=null,dn=null,Tr=null,cr=yr(K,et,ne-$t,ne+Dt,0,Ce.minX,Ce.maxX,qe),ar=yr(K,et,ne+rr,ne+Xt,0,Ce.minX,Ce.maxX,qe);K=null,cr&&(Cr=yr(cr,et,ue-$t,ue+Dt,1,Ce.minY,Ce.maxY,qe),Kr=yr(cr,et,ue+rr,ue+Xt,1,Ce.minY,Ce.maxY,qe),cr=null),ar&&(dn=yr(ar,et,ue-$t,ue+Dt,1,Ce.minY,Ce.maxY,qe),Tr=yr(ar,et,ue+rr,ue+Xt,1,Ce.minY,Ce.maxY,qe),ar=null),nt>1&&console.timeEnd("clipping"),Re.push(Cr||[],X+1,2*ne,2*ue),Re.push(Kr||[],X+1,2*ne,2*ue+1),Re.push(dn||[],X+1,2*ne+1,2*ue),Re.push(Tr||[],X+1,2*ne+1,2*ue+1)}}getTile(K,X,ne){K=+K,X=+X,ne=+ne;const ue=this.options,{extent:ve,debug:Ae}=ue;if(K<0||K>24)return null;const Oe=1<<K,Re=Bt(K,X=X+Oe&Oe-1,ne);if(this.tiles[Re])return Zn(this.tiles[Re],ve);Ae>1&&console.log("drilling down to z%d-%d-%d",K,X,ne);let qe,nt=K,et=X,zt=ne;for(;!qe&&nt>0;)nt--,et>>=1,zt>>=1,qe=this.tiles[Bt(nt,et,zt)];return qe&&qe.source?(Ae>1&&(console.log("found parent tile z%d-%d-%d",nt,et,zt),console.time("drilling down")),this.splitTile(qe.source,nt,et,zt,K,X,ne),Ae>1&&console.timeEnd("drilling down"),this.tiles[Re]?Zn(this.tiles[Re],ve):null):null}}function Bt(Te,K,X){return 32*((1<<Te)*X+K)+Te}class _r extends V{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(K,X){return w._(this,void 0,void 0,(function*(){const ne=K.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ue=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!ue)return null;const ve=new Me(ue.features,{version:2,extent:w.$});let Ae=(function(Oe){const Re=new w.cM;return(function(qe,nt){for(const et in qe.layers)nt.writeMessage(3,Se,qe.layers[et])})(Oe,Re),Re.finish()})(ve);return Ae.byteOffset===0&&Ae.byteLength===Ae.buffer.byteLength||(Ae=new Uint8Array(Ae)),{vectorTile:ve,rawData:Ae.buffer}}))}loadData(K){return w._(this,void 0,void 0,(function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();const ne=!!(K&&K.request&&K.request.collectResourceTiming)&&new w.cN(K.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(K,this._pendingRequest);const ue=yield this._pendingData;this._geoJSONIndex=K.cluster?new Mt((function({superclusterOptions:Ae,clusterProperties:Oe}){if(!Oe||!Ae)return Ae;const Re={},qe={},nt={accumulated:null,zoom:0},et={properties:null},zt=Object.keys(Oe);for(const Ce of zt){const[$t,rr]=Oe[Ce],Dt=w.cT(rr),Xt=w.cT(typeof $t=="string"?[$t,["accumulated"],["get",Ce]]:$t);Re[Ce]=Dt.value,qe[Ce]=Xt.value}return Ae.map=Ce=>{et.properties=Ce;const $t={};for(const rr of zt)$t[rr]=Re[rr].evaluate(nt,et);return $t},Ae.reduce=(Ce,$t)=>{et.properties=$t;for(const rr of zt)nt.accumulated=Ce[rr],Ce[rr]=qe[rr].evaluate(nt,et)},Ae})(K)).load(ue.features):(function(Ae,Oe){return new gt(Ae,Oe)})(ue,K.geojsonVtOptions),this.loaded={};const ve={data:ue};if(ne){const Ae=ne.finish();Ae&&(ve.resourceTiming={},ve.resourceTiming[K.source]=JSON.parse(JSON.stringify(Ae)))}return ve}catch(ue){if(delete this._pendingRequest,w.cy(ue))return{abandoned:!0};throw ue}}))}getData(){return w._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(K){const X=this.loaded;return X&&X[K.uid]?super.reloadTile(K):this.loadTile(K)}loadAndProcessGeoJSON(K,X){return w._(this,void 0,void 0,(function*(){let ne=yield this.loadGeoJSON(K,X);if(delete this._pendingRequest,typeof ne!="object")throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(Pe(ne,!0),K.filter){const ue=w.cT(K.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map((Ae=>`${Ae.key}: ${Ae.message}`)).join(", "));ne={type:"FeatureCollection",features:ne.features.filter((Ae=>ue.value.evaluate({zoom:0},Ae)))}}return ne}))}loadGeoJSON(K,X){return w._(this,void 0,void 0,(function*(){const{promoteId:ne}=K;if(K.request){const ue=yield w.j(K.request,X);return this._dataUpdateable=w.cV(ue.data,ne)?w.cU(ue.data,ne):void 0,ue.data}if(typeof K.data=="string")try{const ue=JSON.parse(K.data);return this._dataUpdateable=w.cV(ue,ne)?w.cU(ue,ne):void 0,ue}catch{throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`)}if(!K.dataDiff)throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${K.source}`);return w.cW(this._dataUpdateable,K.dataDiff,ne),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(K){return w._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(K){return this._geoJSONIndex.getClusterExpansionZoom(K.clusterId)}getClusterChildren(K){return this._geoJSONIndex.getChildren(K.clusterId)}getClusterLeaves(K){return this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset)}}class Sr{constructor(K){this.self=K,this.actor=new w.J(K),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,ne)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=ne},this.self.addProtocol=w.cA,this.self.removeProtocol=w.cB,this.self.registerRTLTextPlugin=X=>{w.cX.setMethods(X)},this.actor.registerMessageHandler("LDT",((X,ne)=>this._getDEMWorkerSource(X,ne.source).loadTile(ne))),this.actor.registerMessageHandler("RDT",((X,ne)=>w._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(X,ne.source).removeTile(ne)})))),this.actor.registerMessageHandler("GCEZ",((X,ne)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(X,ne.type,ne.source).getClusterExpansionZoom(ne)})))),this.actor.registerMessageHandler("GCC",((X,ne)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(X,ne.type,ne.source).getClusterChildren(ne)})))),this.actor.registerMessageHandler("GCL",((X,ne)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(X,ne.type,ne.source).getClusterLeaves(ne)})))),this.actor.registerMessageHandler("LD",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).loadData(ne))),this.actor.registerMessageHandler("GD",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).getData())),this.actor.registerMessageHandler("LT",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).loadTile(ne))),this.actor.registerMessageHandler("RT",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).reloadTile(ne))),this.actor.registerMessageHandler("AT",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).abortTile(ne))),this.actor.registerMessageHandler("RMT",((X,ne)=>this._getWorkerSource(X,ne.type,ne.source).removeTile(ne))),this.actor.registerMessageHandler("RS",((X,ne)=>w._(this,void 0,void 0,(function*(){if(!this.workerSources[X]||!this.workerSources[X][ne.type]||!this.workerSources[X][ne.type][ne.source])return;const ue=this.workerSources[X][ne.type][ne.source];delete this.workerSources[X][ne.type][ne.source],ue.removeSource!==void 0&&ue.removeSource(ne)})))),this.actor.registerMessageHandler("RM",(X=>w._(this,void 0,void 0,(function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})))),this.actor.registerMessageHandler("SR",((X,ne)=>w._(this,void 0,void 0,(function*(){this.referrer=ne})))),this.actor.registerMessageHandler("SRPS",((X,ne)=>this._syncRTLPluginState(X,ne))),this.actor.registerMessageHandler("IS",((X,ne)=>w._(this,void 0,void 0,(function*(){this.self.importScripts(ne)})))),this.actor.registerMessageHandler("SI",((X,ne)=>this._setImages(X,ne))),this.actor.registerMessageHandler("UL",((X,ne)=>w._(this,void 0,void 0,(function*(){this._getLayerIndex(X).update(ne.layers,ne.removedIds)})))),this.actor.registerMessageHandler("SL",((X,ne)=>w._(this,void 0,void 0,(function*(){this._getLayerIndex(X).replace(ne)}))))}_setImages(K,X){return w._(this,void 0,void 0,(function*(){this.availableImages[K]=X;for(const ne in this.workerSources[K]){const ue=this.workerSources[K][ne];for(const ve in ue)ue[ve].availableImages=X}}))}_syncRTLPluginState(K,X){return w._(this,void 0,void 0,(function*(){return yield w.cX.syncState(X,this.self.importScripts)}))}_getAvailableImages(K){let X=this.availableImages[K];return X||(X=[]),X}_getLayerIndex(K){let X=this.layerIndexes[K];return X||(X=this.layerIndexes[K]=new l),X}_getWorkerSource(K,X,ne){if(this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][X]||(this.workerSources[K][X]={}),!this.workerSources[K][X][ne]){const ue={sendAsync:(ve,Ae)=>(ve.targetMapId=K,this.actor.sendAsync(ve,Ae))};switch(X){case"vector":this.workerSources[K][X][ne]=new V(ue,this._getLayerIndex(K),this._getAvailableImages(K));break;case"geojson":this.workerSources[K][X][ne]=new _r(ue,this._getLayerIndex(K),this._getAvailableImages(K));break;default:this.workerSources[K][X][ne]=new this.externalWorkerSourceTypes[X](ue,this._getLayerIndex(K),this._getAvailableImages(K))}}return this.workerSources[K][X][ne]}_getDEMWorkerSource(K,X){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][X]||(this.demWorkerSources[K][X]=new ee),this.demWorkerSources[K][X]}}return w.i(self)&&(self.worker=new Sr(self)),Sr})),b("index",["exports","./shared"],(function(w,l){var L="5.7.1";function N(){var g=new l.A(4);return l.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let Z,V;const ee={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,e,s){const h=requestAnimationFrame((y=>{p(),e(y)})),{unsubscribe:p}=l.s(g.signal,"abort",(()=>{p(),cancelAnimationFrame(h),s(l.c())}),!1)},frameAsync(g){return new Promise(((e,s)=>{this.frame(g,e,s)}))},getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,s.drawImage(g,0,0,g.width,g.height),s},resolveURL:g=>(Z||(Z=document.createElement("a")),Z.href=g,Z.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(V==null&&(V=matchMedia("(prefers-reduced-motion: reduce)")),V.matches)}};class q{static testProp(e){if(!q.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in q.docStyle)return e[s];return e[0]}static create(e,s,h){const p=window.document.createElement(e);return s!==void 0&&(p.className=s),h&&h.appendChild(p),p}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){q.docStyle&&q.selectProp&&(q.userSelect=q.docStyle[q.selectProp],q.docStyle[q.selectProp]="none")}static enableDrag(){q.docStyle&&q.selectProp&&(q.docStyle[q.selectProp]=q.userSelect)}static setTransform(e,s){e.style[q.transformProp]=s}static addEventListener(e,s,h,p={}){e.addEventListener(s,h,"passive"in p?p:p.capture)}static removeEventListener(e,s,h,p={}){e.removeEventListener(s,h,"passive"in p?p:p.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",q.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",q.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",q.suppressClickInternal,!0)}),0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,h){const p=s.boundingClientRect;return new l.P((h.clientX-p.left)/s.x-e.clientLeft,(h.clientY-p.top)/s.y-e.clientTop)}static mousePos(e,s){const h=q.getScale(e);return q.getPoint(e,h,s)}static touchPos(e,s){const h=[],p=q.getScale(e);for(let y=0;y<s.length;y++)h.push(q.getPoint(e,p,s[y]));return h}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const s=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),h=s.querySelectorAll("script");for(const p of h)p.remove();return q.clean(s),s.innerHTML}static isPossiblyDangerous(e,s){const h=s.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!h.includes("javascript:")&&!h.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const s=e.children;for(const h of s)q.removeAttributes(h),q.clean(h)}static removeAttributes(e){for(const{name:s,value:h}of e.attributes)q.isPossiblyDangerous(s,h)&&e.removeAttribute(s)}}q.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,q.selectProp=q.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),q.transformProp=q.testProp(["transform","WebkitTransform"]);const _e={supported:!1,testSupport:function(g){!Le&&Pe&&(Me?Se(g):fe=g)}};let fe,Pe,Le=!1,Me=!1;function Se(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Pe),g.isContextLost())return;_e.supported=!0}catch{}g.deleteTexture(e),Le=!0}var De;typeof document<"u"&&(Pe=document.createElement("img"),Pe.onload=()=>{fe&&Se(fe),fe=null,Me=!0},Pe.onerror=()=>{Le=!0,fe=null},Pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(g){let e,s,h,p;g.resetRequestQueue=()=>{e=[],s=0,h=0,p={}},g.addThrottleControl=I=>{const z=h++;return p[z]=I,z},g.removeThrottleControl=I=>{delete p[I],S()},g.getImage=(I,z,D=!0)=>new Promise(((B,j)=>{_e.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),l.e(I,{type:"image"}),e.push({abortController:z,requestParameters:I,supportImageRefresh:D,state:"queued",onError:$=>{j($)},onSuccess:$=>{B($)}}),S()}));const y=I=>l._(this,void 0,void 0,(function*(){I.state="running";const{requestParameters:z,supportImageRefresh:D,onError:B,onSuccess:j,abortController:$}=I,W=D===!1&&!l.i(self)&&!l.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce(((ae,oe)=>ae&&oe==="accept"),!0));s++;const re=W?E(z,$):l.m(z,$);try{const ae=yield re;delete I.abortController,I.state="completed",ae.data instanceof HTMLImageElement||l.b(ae.data)?j(ae):ae.data&&j({data:yield(se=ae.data,typeof createImageBitmap=="function"?l.f(se):l.h(se)),cacheControl:ae.cacheControl,expires:ae.expires})}catch(ae){delete I.abortController,B(ae)}finally{s--,S()}var se})),S=()=>{const I=(()=>{for(const z of Object.keys(p))if(p[z]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=s;z<I&&e.length>0;z++){const D=e.shift();D.abortController.signal.aborted?z--:y(D)}},E=(I,z)=>new Promise(((D,B)=>{const j=new Image,$=I.url,W=I.credentials;W&&W==="include"?j.crossOrigin="use-credentials":(W&&W==="same-origin"||!l.d($))&&(j.crossOrigin="anonymous"),z.signal.addEventListener("abort",(()=>{j.src="",B(l.c())})),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,D({data:j})},j.onerror=()=>{j.onerror=j.onload=null,z.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=$}))})(De||(De={})),De.resetRequestQueue();class Ye{constructor(e){this._transformRequestFn=e??null}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ot(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:h,url:p}of g){const y=`${h}${p}`;s.indexOf(y)===-1&&(s.push(y),e.push({id:h,url:p}))}}return e}function lt(g,e,s){try{const h=new URL(g);return h.pathname+=`${e}${s}`,h.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ut(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class Je extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:h}of this.requestors)h(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const h=s.spriteData;s.data=new l.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let h=!0;const p=s.data||s.spriteData;return this._validateStretch(s.stretchX,p&&p.width)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchX" value`))),h=!1),this._validateStretch(s.stretchY,p&&p.height)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchY" value`))),h=!1),this._validateContent(s.content,s)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "content" value`))),h=!1),h}_validateStretch(e,s){if(!e)return!0;let h=0;for(const p of e){if(p[0]<h||p[1]<p[0]||s<p[1])return!1;h=p[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const h=s.spriteData,p=h&&h.width||s.data.width,y=h&&h.height||s.data.height;return!(e[0]<0||p<e[0]||e[1]<0||y<e[1]||e[2]<0||p<e[2]||e[3]<0||y<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,h=!0){const p=this.getImage(e);if(h&&(p.data.width!==s.data.width||p.data.height!==s.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=p.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((s,h)=>{let p=!0;if(!this.isLoaded())for(const y of e)this.images[y]||(p=!1);this.isLoaded()||p?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})}))}_getImagesForIds(e){const s={};for(const h of e){let p=this.getImage(h);p||(this.fire(new l.l("styleimagemissing",{id:h})),p=this.getImage(h)),p?s[h]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:l.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],h=this.getImage(e);if(!h)return null;if(s&&s.position.version===h.version)return s.position;if(s)s.position.version=h.version;else{const p={w:h.data.width+2,h:h.data.height+2,x:0,y:0},y=new l.I(p,h);this.patterns[e]={bin:p,position:y}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const y in this.patterns)e.push(this.patterns[y].bin);const{w:s,h}=l.p(e),p=this.atlasImage;p.resize({width:s||1,height:h||1});for(const y in this.patterns){const{bin:S}=this.patterns[y],E=S.x+1,I=S.y+1,z=this.getImage(y).data,D=z.width,B=z.height;l.R.copy(z,p,{x:0,y:0},{x:E,y:I},{width:D,height:B}),l.R.copy(z,p,{x:0,y:B-1},{x:E,y:I-1},{width:D,height:1}),l.R.copy(z,p,{x:0,y:0},{x:E,y:I+B},{width:D,height:1}),l.R.copy(z,p,{x:D-1,y:0},{x:E-1,y:I},{width:1,height:B}),l.R.copy(z,p,{x:0,y:0},{x:E+D,y:I},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const h=this.getImage(s);h||l.w(`Image with ID: "${s}" was not found`),ut(h)&&this.updateImage(s,h)}}}const Ke=1e20;function At(g,e,s,h,p,y,S,E,I){for(let z=e;z<e+h;z++)Rt(g,s*y+z,y,p,S,E,I);for(let z=s;z<s+p;z++)Rt(g,z*y+e,1,h,S,E,I)}function Rt(g,e,s,h,p,y,S){y[0]=0,S[0]=-Ke,S[1]=Ke,p[0]=g[e];for(let E=1,I=0,z=0;E<h;E++){p[E]=g[e+E*s];const D=E*E;do{const B=y[I];z=(p[E]-p[B]+D-B*B)/(E-B)/2}while(z<=S[I]&&--I>-1);I++,y[I]=E,S[I]=z,S[I+1]=Ke}for(let E=0,I=0;E<h;E++){for(;S[I+1]<E;)I++;const z=y[I],D=E-z;g[e+E*s]=p[z]+D*D}}class Mt{constructor(e,s,h){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={},this.lang=h}setURL(e){this.url=e}getGlyphs(e){return l._(this,void 0,void 0,(function*(){const s=[];for(const y in e)for(const S of e[y])s.push(this._getAndCacheGlyphsPromise(y,S));const h=yield Promise.all(s),p={};for(const{stack:y,id:S,glyph:E}of h)p[y]||(p[y]={}),p[y][S]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};return p}))}_getAndCacheGlyphsPromise(e,s){return l._(this,void 0,void 0,(function*(){let h=this.entries[e];h||(h=this.entries[e]={glyphs:{},requests:{},ranges:{}});let p=h.glyphs[s];if(p!==void 0)return{stack:e,id:s,glyph:p};if(p=this._tinySDF(h,e,s),p)return h.glyphs[s]=p,{stack:e,id:s,glyph:p};const y=Math.floor(s/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[y])return{stack:e,id:s,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[y]){const E=Mt.loadGlyphRange(e,y,this.url,this.requestManager);h.requests[y]=E}const S=yield h.requests[y];for(const E in S)this._doesCharSupportLocalGlyph(+E)||(h.glyphs[+E]=S[+E]);return h.ranges[y]=!0,{stack:e,id:s,glyph:S[s]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||l.u["CJK Unified Ideographs"](e)||l.u["Hangul Syllables"](e)||l.u.Hiragana(e)||l.u.Katakana(e)||l.u["CJK Symbols and Punctuation"](e)||l.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,s,h){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let y=e.tinySDF;if(!y){let E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),y=e.tinySDF=new Mt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:p,fontWeight:E})}const S=y.draw(String.fromCharCode(h));return{id:h,bitmap:new l.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Mt.loadGlyphRange=function(g,e,s,h){return l._(this,void 0,void 0,(function*(){const p=256*e,y=p+255,S=h.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${p}-${y}`),"Glyphs"),E=yield l.n(S,new AbortController);if(!E||!E.data)throw new Error(`Could not load glyph range. range: ${e}, ${p}-${y}`);const I={};for(const z of l.o(E.data))I[z.id]=z;return I}))},Mt.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:s=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:S="normal",lang:E=null}={}){this.buffer=e,this.cutoff=h,this.radius=s,this.lang=E;const I=this.size=g+4*e,z=this._createCanvas(I),D=this.ctx=z.getContext("2d",{willReadFrequently:!0});D.font=`${S} ${y} ${g}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(g),S=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),I=Math.min(this.size-this.buffer,S+Math.ceil(h)),z=E+2*this.buffer,D=I+2*this.buffer,B=Math.max(z*D,0),j=new Uint8ClampedArray(B),$={data:j,width:z,height:D,glyphWidth:E,glyphHeight:I,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(E===0||I===0)return $;const{ctx:W,buffer:re,gridInner:se,gridOuter:ae}=this;this.lang&&(W.lang=this.lang),W.clearRect(re,re,E,I),W.fillText(g,re,re+S);const oe=W.getImageData(re,re,E,I);ae.fill(Ke,0,B),se.fill(0,0,B);for(let de=0;de<I;de++)for(let le=0;le<E;le++){const ge=oe.data[4*(de*E+le)+3]/255;if(ge===0)continue;const we=(de+re)*z+le+re;if(ge===1)ae[we]=0,se[we]=Ke;else{const he=.5-ge;ae[we]=he>0?he*he:0,se[we]=he<0?he*he:0}}At(ae,0,0,z,D,z,this.f,this.v,this.z),At(se,re,re,E,I,z,this.f,this.v,this.z);for(let de=0;de<B;de++){const le=Math.sqrt(ae[de])-Math.sqrt(se[de]);j[de]=Math.round(255-255*(le/this.radius+this.cutoff))}return $}};class Ht{constructor(){this.specification=l.v.light.position}possiblyEvaluate(e,s){return l.B(e.expression.evaluate(s))}interpolate(e,s,h){return{x:l.C.number(e.x,s.x,h),y:l.C.number(e.y,s.y,h),z:l.C.number(e.z,s.z,h)}}}let zr;class or extends l.E{constructor(e){super(),zr=zr||new l.r({anchor:new l.D(l.v.light.anchor),position:new Ht,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.t(zr),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(l.x,e,s))for(const h in e){const p=e[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),p):this._transitionable.setValue(h,p)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,h){return(!h||h.validate!==!1)&&l.y(this,e.call(l.z,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const Zt=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class _t extends l.E{constructor(e){super(),this._transitionable=new l.t(Zt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0))}setSky(e,s={}){if(!this._validate(l.G,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in e){const p=e[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),p):this._transitionable.setValue(h,p)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,h={}){return(h==null?void 0:h.validate)!==!1&&l.y(this,e.call(l.z,l.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ft{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const h=e.join(",")+String(s);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(e,s)),this.dashEntry[h]}getDashRanges(e,s,h){const p=[];let y=e.length%2==1?-e[e.length-1]*h:0,S=e[0]*h,E=!0;p.push({left:y,right:S,isDash:E,zeroLength:e[0]===0});let I=e[0];for(let z=1;z<e.length;z++){E=!E;const D=e[z];y=I*h,I+=D,S=I*h,p.push({left:y,right:S,isDash:E,zeroLength:D===0})}return p}addRoundDash(e,s,h){const p=s/2;for(let y=-h;y<=h;y++){const S=this.width*(this.nextRow+h+y);let E=0,I=e[E];for(let z=0;z<this.width;z++){z/I.right>1&&(I=e[++E]);const D=Math.abs(z-I.left),B=Math.abs(z-I.right),j=Math.min(D,B);let $;const W=y/h*(p+1);if(I.isDash){const re=p-Math.abs(W);$=Math.sqrt(j*j+re*re)}else $=p-Math.sqrt(j*j+W*W);this.data[S+z]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let E=e.length-1;E>=0;--E){const I=e[E],z=e[E+1];I.zeroLength?e.splice(E,1):z&&z.isDash===I.isDash&&(z.left=I.left,e.splice(E,1))}const s=e[0],h=e[e.length-1];s.isDash===h.isDash&&(s.left=h.left-this.width,h.right=s.right+this.width);const p=this.width*this.nextRow;let y=0,S=e[y];for(let E=0;E<this.width;E++){E/S.right>1&&(S=e[++y]);const I=Math.abs(E-S.left),z=Math.abs(E-S.right),D=Math.min(I,z);this.data[p+E]=Math.max(0,Math.min(255,(S.isDash?D:-D)+128))}}addDash(e,s){const h=s?7:0,p=2*h+1;if(this.nextRow+p>this.height)return l.w("LineAtlas out of space"),null;let y=0;for(let E=0;E<e.length;E++)y+=e[E];if(y!==0){const E=this.width/y,I=this.getDashRanges(e,this.width,E);s?this.addRoundDash(I,E,h):this.addRegularDash(I)}const S={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:y};return this.nextRow+=p,this.dirty=!0,S}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const Ct="maplibre_preloaded_worker_pool";class Ie{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ie.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((s=>{s.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ct]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(ee.hardwareConcurrency/2);let jt,tr;function fr(){return jt||(jt=new Ie),jt}Ie.workerCount=l.H(globalThis)?Math.max(Math.min(Qe,3),1):1;class Kt{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const h=this.workerPool.acquire(s);for(let p=0;p<h.length;p++){const y=new l.J(h[p],s);y.name=`Worker ${p}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const h=[];for(const p of this.actors)h.push(p.sendAsync({type:e,data:s}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((s=>{s.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const h of this.actors)h.registerMessageHandler(e,s)}}function Lr(){return tr||(tr=new Kt(fr(),l.K),tr.registerMessageHandler("GR",((g,e,s)=>l.m(e,s)))),tr}function sr(g,e){const s=l.L();return l.M(s,s,[1,1,0]),l.N(s,s,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?l.O(s,s,g.calculatePosMatrix(e.toUnwrapped())):s}function yr(g,e,s,h,p,y,S){var E;const I=(function(j,$,W){if(j)for(const re of j){const se=$[re];if(se&&se.source===W&&se.type==="fill-extrusion")return!0}else for(const re in $){const se=$[re];if(se.source===W&&se.type==="fill-extrusion")return!0}return!1})((E=p==null?void 0:p.layers)!==null&&E!==void 0?E:null,e,g.id),z=y.maxPitchScaleFactor(),D=g.tilesIn(h,z,I);D.sort(lr);const B=[];for(const j of D)B.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(e,s,g._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,p,y,z,sr(g.transform,j.tileID),S?($,W)=>S(j.tileID,$,W):void 0)});return(function(j,$){for(const W in j)for(const re of j[W])ci(re,$);return j})((function(j){const $={},W={};for(const re of j){const se=re.queryResults,ae=re.wrappedTileID,oe=W[ae]=W[ae]||{};for(const de in se){const le=se[de],ge=oe[de]=oe[de]||{},we=$[de]=$[de]||[];for(const he of le)ge[he.featureIndex]||(ge[he.featureIndex]=!0,we.push(he))}}return $})(B),g)}function lr(g,e){const s=g.tileID,h=e.tileID;return s.overscaledZ-h.overscaledZ||s.canonical.y-h.canonical.y||s.wrap-h.wrap||s.canonical.x-h.canonical.x}function ci(g,e){const s=g.feature,h=e.getFeatureState(s.layer["source-layer"],s.id);s.source=s.layer.source,s.layer["source-layer"]&&(s.sourceLayer=s.layer["source-layer"]),s.state=h}function ln(g,e,s){return l._(this,void 0,void 0,(function*(){let h=g;if(g.url?h=(yield l.j(e.transformRequest(g.url,"Source"),s)).data:yield ee.frameAsync(s),!h)return null;const p=l.Q(l.e(h,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(p.vectorLayerIds=h.vector_layers.map((y=>y.id))),p}))}class Vr{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof l.S?new l.S(e.lng,e.lat):l.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof l.S?new l.S(e.lng,e.lat):l.S.convert(e),this}extend(e){const s=this._sw,h=this._ne;let p,y;if(e instanceof l.S)p=e,y=e;else{if(!(e instanceof Vr))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Vr.convert(e)):this.extend(l.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(l.S.convert(e)):this;if(p=e._sw,y=e._ne,!p||!y)return this}return s||h?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),h.lng=Math.max(y.lng,h.lng),h.lat=Math.max(y.lat,h.lat)):(this._sw=new l.S(p.lng,p.lat),this._ne=new l.S(y.lng,y.lat)),this}getCenter(){return new l.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.S(this.getWest(),this.getNorth())}getSouthEast(){return new l.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:h}=l.S.convert(e);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(e){return e instanceof Vr?e:e&&new Vr(e)}static fromLngLat(e,s=0){const h=360*s/40075017,p=h/Math.cos(Math.PI/180*e.lat);return new Vr(new l.S(e.lng-p,e.lat-h),new l.S(e.lng+p,e.lat+h))}adjustAntiMeridian(){const e=new l.S(this._sw.lng,this._sw.lat),s=new l.S(this._ne.lng,this._ne.lat);return new Vr(e,e.lng>s.lng?new l.S(s.lng+360,s.lat):s)}}class Nr{constructor(e,s,h){this.bounds=Vr.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=h||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),h=Math.floor(l.V(this.bounds.getWest())*s),p=Math.floor(l.U(this.bounds.getNorth())*s),y=Math.ceil(l.V(this.bounds.getEast())*s),S=Math.ceil(l.U(this.bounds.getSouth())*s);return e.x>=h&&e.x<y&&e.y>=p&&e.y<S}}class Cn extends l.E{constructor(e,s,h,p){if(super(),this.id=e,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.Q(s,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ln(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(l.e(this,e),e.bounds&&(this.tileBounds=new Nr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new l.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(e){return l._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};h.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((y,S)=>{e.reloadPromise={resolve:y,reject:S}}))}else e.actor=this.dispatcher.getActor(),p="LT";e.abortController=new AbortController;try{const y=yield e.actor.sendAsync({type:p,data:h},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,y)}catch(y){if(delete e.abortController,e.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const h=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(h.resolve).catch(h.reject)}}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class jn extends l.E{constructor(e,s,h,p){super(),this.id=e,this.dispatcher=h,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},s),l.e(this,l.Q(s,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield ln(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(l.e(this,s),s.bounds&&(this.tileBounds=new Nr(s.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(s){this._tileJSONRequest=null,this.fire(new l.k(s))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return l.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return l._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const h=yield De.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&(h.cacheControl||h.expires)&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const p=this.map.painter.context,y=p.gl,S=h.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new l.T(p,S,y.RGBA,{useMipmap:!0}),e.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}}))}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class Yi extends jn{constructor(e,s,h,p){super(e,s,h,p),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return l._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const p=yield De.getImage(h,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(p&&p.data){const y=p.data;this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&e.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const S=l.b(y)&&l.W()?y:yield this.readImageNow(y),E={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:E});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(p){if(delete e.abortController,e.aborted)e.state="unloaded";else if(p)throw e.state="errored",p}}))}readImageNow(e){return l._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&l.X()){const s=e.width+2,h=e.height+2;try{return new l.R({width:s,height:h},yield l.Y(e,-1,-1,s,h))}catch{}}return ee.getImageData(e,1)}))}_getNeighboringTiles(e){const s=e.canonical,h=Math.pow(2,s.z),p=(s.x-1+h)%h,y=s.x===0?e.wrap-1:e.wrap,S=(s.x+1+h)%h,E=s.x+1===h?e.wrap+1:e.wrap,I={};return I[new l.Z(e.overscaledZ,y,s.z,p,s.y).key]={backfilled:!1},I[new l.Z(e.overscaledZ,E,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(I[new l.Z(e.overscaledZ,y,s.z,p,s.y-1).key]={backfilled:!1},I[new l.Z(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},I[new l.Z(e.overscaledZ,E,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<h&&(I[new l.Z(e.overscaledZ,y,s.z,p,s.y+1).key]={backfilled:!1},I[new l.Z(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},I[new l.Z(e.overscaledZ,E,s.z,S,s.y+1).key]={backfilled:!1}),I}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class Ri extends l.E{constructor(e,s,h,p){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:s.data},this.actor=h.getActor(),this.setEventedParent(p),this._data=s.data,this._options=l.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId,s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(s.buffer!==void 0?s.buffer:128),tolerance:this._pixelsToTileUnits(s.tolerance!==void 0?s.tolerance:.375),extent:l.$,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(s.clusterMaxZoom),minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.$,radius:this._pixelsToTileUnits(s.clusterRadius||50),log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(l.$/this.tileSize)}_getClusterMaxZoom(e){const s=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${s}"`),s}load(){return l._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=l.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return l._(this,void 0,void 0,(function*(){const e=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map((s=>s.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,(function*(){const e=new Vr,s=yield this.getData();let h;switch(s.type){case"FeatureCollection":h=s.features.map((p=>this.getCoordinatesFromGeometry(p.geometry))).flat(1/0);break;case"Feature":h=this.getCoordinatesFromGeometry(s.geometry);break;default:h=this.getCoordinatesFromGeometry(s)}if(h.length==0)return e;for(let p=0;p<h.length-1;p+=2)e.extend([h[p],h[p+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:h}})}_updateWorkerData(){return l._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:e,diff:s}=this._pendingWorkerUpdate;if(!e&&!s)return void l.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const h=l.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(h.request=this.map._requestManager.transformRequest(ee.resolveURL(e),"Source"),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):s&&(h.dataDiff=s,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:h});if(this._isUpdatingWorker=!1,this._removed||p.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));this._data=p.data;let y=null;p.resourceTiming&&p.resourceTiming[this.id]&&(y=p.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&l.e(S,{resourceTiming:y}),this.fire(new l.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(p){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(p))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return l._(this,void 0,void 0,(function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const h={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const p=yield this.actor.sendAsync({type:s,data:h},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(p,this.map.painter,s==="RT")}))}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Zn extends l.E{constructor(e,s,h,p){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=h,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(e){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield De.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new l.k(s))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(l.a1.fromLngLat);var h;return this.tileID=(function(p){const y=l.a2.fromPoints(p),S=y.width(),E=y.height(),I=Math.max(S,E),z=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),D=Math.pow(2,z);return new l.a4(z,Math.floor((y.minX+y.maxX)/2*D),Math.floor((y.minY+y.maxY)/2*D))})(s),this.terrainTileRanges=this._getOverlappingTileRanges(s),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=s.map((p=>this.tileID.getTilePoint(p)._round())),this.flippedWindingOrder=((h=this.tileCoords)[1].x-h[0].x)*(h[2].y-h[0].y)-(h[1].y-h[0].y)*(h[2].x-h[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.texture||(this.texture=new l.T(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let h=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,h=!0)}h&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return l._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:s,minY:h,maxX:p,maxY:y}=l.a2.fromPoints(e),S={};for(let E=0;E<=l.a3;E++){const I=Math.pow(2,E),z=Math.floor(s*I),D=Math.floor(h*I),B=Math.floor(p*I),j=Math.floor(y*I);S[E]={minTileX:z,minTileY:D,maxTileX:B,maxTileY:j}}return S}}class xe extends Zn{constructor(e,s,h,p){super(e,s,h,p),this.roundZoom=!0,this.type="video",this.options=s}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield l.a5(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new l.k(s))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new l.k(new l.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let h=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,h=!0)}h&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Be extends Zn{constructor(e,s,h,p){super(e,s,h,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some((y=>!Array.isArray(y)||y.length!==2||y.some((S=>typeof S!="number"))))||this.fire(new l.k(new l.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a6(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.k(new l.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,h=s.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.T(s,this.canvas,h.RGBA,{premultiply:!0});let p=!1;for(const y in this.tiles){const S=this.tiles[y];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,p=!0)}p&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Xe={},Et=g=>{switch(g){case"geojson":return Ri;case"image":return Zn;case"raster":return jn;case"raster-dem":return Yi;case"vector":return Cn;case"video":return xe;case"canvas":return Be}return Xe[g]},vt="RTLPluginLoaded";class gt extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Lr()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((s=>{throw this.status="error",s}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return l._(this,arguments,void 0,(function*(s,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ee.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return l._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(vt))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Bt=null;function _r(){return Bt||(Bt=new gt),Bt}class Sr{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=l.a7(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(p,y){const S={};if(!y)return S;for(const E of p){const I=E.layerIds.map((z=>y.getLayer(z))).filter(Boolean);if(I.length!==0){E.layers=I,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((z=>I.filter((D=>D.id===z))[0])));for(const z of I)S[z.id]=E}}return S})(e.buckets,s==null?void 0:s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof l.a9){if(this.hasSymbolBuckets=!0,!h)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof l.a9&&y.hasRTLText){this.hasRTLText=!0,_r().lazyLoad();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(y))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new l.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const h in this.buckets){const p=this.buckets[h];p.uploadPending()&&p.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,h,p,y,S,E,I,z,D,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:y,scale:S,tileSize:this.tileSize,pixelPosMatrix:D,transform:I,params:E,queryPadding:this.queryPadding*z,getElevation:B},e,s,h):{}}querySourceFeatures(e,s){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const p=h.loadVTLayers(),y=s&&s.sourceLayer?s.sourceLayer:"",S=p._geojsonTileLayer||p[y];if(!S)return;const E=l.aa(s&&s.filter),{z:I,x:z,y:D}=this.tileID.canonical,B={z:I,x:z,y:D};for(let j=0;j<S.length;j++){const $=S.feature(j);if(E.needGeometry){const se=l.ab($,!0);if(!E.filter(new l.F(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!E.filter(new l.F(this.tileID.overscaledZ),$))continue;const W=h.getId($,y),re=new l.ac($,I,z,D,W);re.tile=B,e.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const h=l.ad(e.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const h=Date.now();let p=!1;if(this.expirationTime>h)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const y=this.expirationTime-s;y?this.expirationTime=h+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const y=this.buckets[p],S=y.layers[0].sourceLayer||"_geojsonTileLayer",E=h[S],I=e[S];if(!E||!I||Object.keys(I).length===0)continue;y.update(I,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=s&&s.style&&s.style.getLayer(p);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ee.now()+e}setDependencies(e,s){const h={};for(const p of s)h[p]=!0;this.dependencies[e]=h}hasDependency(e,s){for(const h of e){const p=this.dependencies[h];if(p){for(const y of s)if(p[y])return!0}}return!1}}class Te{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,h){const p=e.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:s,timeout:void 0};if(h!==void 0&&(y.timeout=setTimeout((()=>{this.remove(e,y)}),h)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const h=e.wrapped().key,p=s===void 0?0:this.data[h].indexOf(s),y=this.data[h][p];return this.data[h].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(y.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const h in this.data)for(const p of this.data[h])e(p.value)||s.push(p);for(const h of s)this.remove(h.value.tileID,h)}}class K{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,h){const p=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},l.e(this.stateChanges[e][p],h),this.deletedStates[e]===null){this.deletedStates[e]={};for(const y in this.state[e])y!==p&&(this.deletedStates[e][y]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][p]===null){this.deletedStates[e][p]={};for(const y in this.state[e][p])h[y]||(this.deletedStates[e][p][y]=null)}else for(const y in h)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][y]===null&&delete this.deletedStates[e][p][y]}removeFeatureState(e,s,h){if(this.deletedStates[e]===null)return;const p=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},h&&s!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][h]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(h in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][h]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,s){const h=String(s),p=l.e({},(this.state[e]||{})[h],(this.stateChanges[e]||{})[h]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const y=this.deletedStates[e][s];if(y===null)return{};for(const S in y)delete p[S]}return p}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const h={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const S in this.stateChanges[p])this.state[p][S]||(this.state[p][S]={}),l.e(this.state[p][S],this.stateChanges[p][S]),y[S]=this.state[p][S];h[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const S in this.state[p])y[S]={},this.state[p][S]={};else for(const S in this.deletedStates[p]){if(this.deletedStates[p][S]===null)this.state[p][S]={};else for(const E of Object.keys(this.deletedStates[p][S]))delete this.state[p][S][E];y[S]=this.state[p][S]}h[p]=h[p]||{},l.e(h[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const p in e)e[p].setFeatureState(h,s)}}const X=89.25;function ne(g,e){const s=l.ah(e.lat,-l.ai,l.ai);return new l.P(l.V(e.lng)*g,l.U(s)*g)}function ue(g,e){return new l.a1(e.x/g,e.y/g).toLngLat()}function ve(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(l.ae(90-g.pitch)),Math.tan(l.ae(X-g.pitch)))}function Ae(g,e){const s=g.canonical,h=e/l.af(s.z),p=s.x+Math.pow(2,s.z)*g.wrap,y=l.ag(new Float64Array(16));return l.M(y,y,[p*h,s.y*h,0]),l.N(y,y,[h/l.$,h/l.$,1]),y}function Oe(g,e,s,h,p){const y=l.a1.fromLngLat(g,e),S=p*l.aj(1,g.lat),E=S*Math.cos(l.ae(s)),I=Math.sqrt(S*S-E*E),z=I*Math.sin(l.ae(-h)),D=I*Math.cos(l.ae(-h));return new l.a1(y.x+z,y.y+D,y.z+E)}function Re(g,e,s){const h=e.intersectsFrustum(g);if(!s||h===0)return h;const p=e.intersectsPlane(s);return p===0?0:h===2&&p===2?2:1}function qe(g,e,s){let h=0;const p=(s-e)/10;for(let y=0;y<10;y++)h+=p*Math.pow(Math.cos(e+(y+.5)/10*(s-e)),g);return h}function nt(g,e){return function(s,h,p,y,S){const E=2*((g-1)/l.ak(Math.cos(l.ae(X-S))/Math.cos(l.ae(X)))-1),I=Math.acos(p/y),z=2*qe(E-1,0,l.ae(S/2)),D=Math.min(l.ae(X),I+l.ae(S/2)),B=qe(E-1,Math.min(D,I-l.ae(S/2)),D),j=Math.atan(h/p),$=Math.hypot(h,p);let W=s;return W+=l.ak(y/$/Math.max(.5,Math.cos(l.ae(S/2)))),W+=E*l.ak(Math.cos(j))/2,W-=l.ak(Math.max(1,B/z/e))/2,W}}const et=nt(9.314,3);function zt(g,e){const s=(e.roundZoom?Math.round:Math.floor)(g.zoom+l.ak(g.tileSize/e.tileSize));return Math.max(0,s)}function Ce(g,e){const s=g.getCameraFrustum(),h=g.getClippingPlane(),p=g.screenPointToMercatorCoordinate(g.getCameraPoint()),y=l.a1.fromLngLat(g.center,g.elevation);p.z=y.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const S=g.getCoveringTilesDetailsProvider(),E=S.allowVariableZoom(g,e),I=zt(g,e),z=e.minzoom||0,D=e.maxzoom!==void 0?e.maxzoom:g.maxZoom,B=Math.min(Math.max(0,I),D),j=Math.pow(2,B),$=[j*p.x,j*p.y,0],W=[j*y.x,j*y.y,0],re=Math.hypot(y.x-p.x,y.y-p.y),se=Math.abs(y.z-p.z),ae=Math.hypot(re,se),oe=ge=>({zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),de=[],le=[];if(g.renderWorldCopies&&S.allowWorldCopies())for(let ge=1;ge<=3;ge++)de.push(oe(-ge)),de.push(oe(ge));for(de.push(oe(0));de.length>0;){const ge=de.pop(),we=ge.x,he=ge.y;let ke=ge.fullyVisible;const $e={x:we,y:he,z:ge.zoom},je=S.getTileBoundingVolume($e,ge.wrap,g.elevation,e);if(!ke){const mt=Re(s,je,h);if(mt===0)continue;ke=mt===2}const Ne=S.distanceToTile2d(p.x,p.y,$e,je);let Ze=I;E&&(Ze=(e.calculateTileZoom||et)(g.zoom+l.ak(g.tileSize/e.tileSize),Ne,se,ae,g.fov)),Ze=(e.roundZoom?Math.round:Math.floor)(Ze),Ze=Math.max(0,Ze);const ht=Math.min(Ze,D);if(ge.wrap=S.getWrap(y,$e,ge.wrap),ge.zoom>=ht){if(ge.zoom<z)continue;const mt=B-ge.zoom,rt=$[0]-.5-(we<<mt),Ft=$[1]-.5-(he<<mt),br=e.reparseOverscaled?Math.max(ge.zoom,Ze):ge.zoom;le.push({tileID:new l.Z(ge.zoom===D?br:ge.zoom,ge.wrap,ge.zoom,we,he),distanceSq:l.al([W[0]-.5-we,W[1]-.5-he]),tileDistanceToCamera:Math.sqrt(rt*rt+Ft*Ft)})}else for(let mt=0;mt<4;mt++)de.push({zoom:ge.zoom+1,x:(we<<1)+mt%2,y:(he<<1)+(mt>>1),wrap:ge.wrap,fullyVisible:ke})}return le.sort(((ge,we)=>ge.distanceSq-we.distanceSq)).map((ge=>ge.tileID))}const $t=l.a2.fromPoints([new l.P(0,0),new l.P(l.$,l.$)]);class rr extends l.E{constructor(e,s,h){super(),this.id=e,this.dispatcher=h,this.on("data",(p=>this._dataHandler(p))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((p,y,S,E)=>{const I=new(Et(y.type))(p,y,S,E);if(I.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${I.id}`);return I})(e,s,h,this),this._tiles={},this._cache=new Te(0,(p=>this._unloadTile(p))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new K,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,h){return l._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,h)}catch(p){e.state="errored",p.status!==404?this._source.fire(new l.k(p,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new l.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const h=this._tiles[s];h.upload(e),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Dt).map((e=>e.key))}getRenderableIds(e){const s=[];for(const h in this._tiles)this._isIdRenderable(h,e)&&s.push(this._tiles[h]);return e?s.sort(((h,p)=>{const y=h.tileID,S=p.tileID,E=new l.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),I=new l.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-S.overscaledZ||I.y-E.y||I.x-E.x})).map((h=>h.tileID.key)):s.map((h=>h.tileID)).sort(Dt).map((h=>h.key))}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)e?this._reloadTile(s,"expired"):this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(e,s){return l._(this,void 0,void 0,(function*(){const h=this._tiles[e];h&&(h.state!=="loading"&&(h.state=s),yield this._loadTile(h,e,s))}))}_tileLoaded(e,s,h){e.timeAdded=ee.now(),h==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const y=s[p];if(e.neighboringTiles&&e.neighboringTiles[y]){const S=this.getTileByID(y);h(e,S),h(S,e)}}function h(p,y){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let S=y.tileID.canonical.x-p.tileID.canonical.x;const E=y.tileID.canonical.y-p.tileID.canonical.y,I=Math.pow(2,p.tileID.canonical.z),z=y.tileID.key;S===0&&E===0||Math.abs(E)>1||(Math.abs(S)>1&&(Math.abs(S+I)===1?S+=I:Math.abs(S-I)===1&&(S-=I)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,S,E),p.neighboringTiles&&p.neighboringTiles[z]&&(p.neighboringTiles[z].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,h,p){for(const y in this._tiles){let S=this._tiles[y];if(p[y]||!S.hasData()||S.tileID.overscaledZ<=s||S.tileID.overscaledZ>h)continue;let E=S.tileID;for(;S&&S.tileID.overscaledZ>s+1;){const z=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[z.key],S&&S.hasData()&&(E=z)}let I=E;for(;I.overscaledZ>s;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]||e[I.canonical.key]){p[E.key]=E;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const h=this._loadedParentTiles[e.key];return h&&h.tileID.overscaledZ>=s?h:null}for(let h=e.overscaledZ-1;h>=s;h--){const p=e.scaledTo(h),y=this._getLoadedTile(p);if(y)return y}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,h=Math.ceil(e.height/this._source.tileSize)+1,p=Math.floor(s*h*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(y)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const h={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),h[y.tileID.key]=y}this._tiles=h;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(e,s,h,p,y,S){const E={},I={},z=Object.keys(e),D=ee.now();for(const B of z){const j=e[B],$=this._tiles[B];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=D)continue;const W=this.findLoadedParent(j,s),re=this.findLoadedSibling(j),se=W||re||null;se&&(this._addTile(se.tileID),E[se.tileID.key]=se.tileID),I[B]=j}this._retainLoadedChildren(I,p,h,e);for(const B in E)e[B]||(this._coveredTiles[B]=!0,e[B]=E[B]);if(S){const B={},j={};for(const $ of y)this._tiles[$.key].hasData()?B[$.key]=$:j[$.key]=$;for(const $ in j){const W=j[$].children(this._source.maxzoom);this._tiles[W[0].key]&&this._tiles[W[1].key]&&this._tiles[W[2].key]&&this._tiles[W[3].key]&&(B[W[0].key]=e[W[0].key]=W[0],B[W[1].key]=e[W[1].key]=W[1],B[W[2].key]=e[W[2].key]=W[2],B[W[3].key]=e[W[3].key]=W[3],delete j[$])}for(const $ in j){const W=j[$],re=this.findLoadedParent(W,this._source.minzoom),se=this.findLoadedSibling(W),ae=re||se||null;if(ae){B[ae.tileID.key]=e[ae.tileID.key]=ae.tileID;for(const oe in B)B[oe].isChildOf(ae.tileID)&&delete B[oe]}}for(const $ in this._tiles)B[$]||(this._coveredTiles[$]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let h;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((D=>new l.Z(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y))):(h=Ce(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(h=h.filter((D=>this._source.hasTile(D))))):h=[];const p=zt(e,this._source),y=Math.max(p-rr.maxOverzooming,this._source.minzoom),S=Math.max(p+rr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const D={};for(const B of h)if(B.canonical.z>this._source.minzoom){const j=B.scaledTo(B.canonical.z-1);D[j.key]=j;const $=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));D[$.key]=$}h=h.concat(Object.values(D))}const E=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,E&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(h,p);Xt(this._source.type)&&this._updateCoveredAndRetainedTiles(I,y,S,p,h,s);for(const D in I)this._tiles[D].clearFadeHold();const z=l.am(this._tiles,I);for(const D of z){const B=this._tiles[D];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var h;const p={},y={},S=Math.max(s-rr.maxOverzooming,this._source.minzoom),E=Math.max(s+rr.maxUnderzooming,this._source.minzoom),I={};for(const z of e){const D=this._addTile(z);p[z.key]=z,D.hasData()||s<this._source.maxzoom&&(I[z.key]=z)}this._retainLoadedChildren(I,s,E,p);for(const z of e){let D=this._tiles[z.key];if(D.hasData())continue;if(s+1>this._source.maxzoom){const j=z.children(this._source.maxzoom)[0],$=this.getTile(j);if($&&$.hasData()){p[j.key]=j;continue}}else{const j=z.children(this._source.maxzoom);if(p[j[0].key]&&p[j[1].key]&&p[j[2].key]&&p[j[3].key])continue}let B=D.wasRequested();for(let j=z.overscaledZ-1;j>=S;--j){const $=z.scaledTo(j);if(y[$.key])break;if(y[$.key]=!0,D=this.getTile($),!D&&B&&(D=this._addTile($)),D){const W=D.hasData();if((W||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||B)&&(p[$.key]=$),B=D.wasRequested(),W)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let h,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){h=this._loadedParentTiles[p.key];break}s.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(h=this._getLoadedTile(y),h)break;p=y}for(const y of s)this._loadedParentTiles[y]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,h=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=h}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const h=s;return s||(s=new Sr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,h||this._source.fire(new l.l("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const h=s.getExpiryTimeout();h&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),h))}refreshTiles(e){for(const s in this._tiles)(this._isIdRenderable(s)||this._tiles[s].state=="errored")&&e.some((h=>h.equals(this._tiles[s].tileID.canonical)))&&this._reloadTile(s,"expired")}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,h){const p=[],y=this.transform;if(!y)return p;const S=y.getCoveringTilesDetailsProvider().allowWorldCopies(),E=h?y.getCameraQueryGeometry(e):e,I=$=>y.screenPointToMercatorCoordinate($,this.terrain),z=this.transformBbox(e,I,!S),D=this.transformBbox(E,I,!S),B=this.getIds(),j=l.a2.fromPoints(D);for(let $=0;$<B.length;$++){const W=this._tiles[B[$]];if(W.holdingForFade())continue;const re=S?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],se=Math.pow(2,y.zoom-W.tileID.overscaledZ),ae=s*W.queryPadding*l.$/W.tileSize/se;for(const oe of re){const de=j.map((le=>oe.getTilePoint(new l.a1(le.x,le.y))));if(de.expandBy(ae),de.intersects($t)){const le=z.map((we=>oe.getTilePoint(we))),ge=D.map((we=>oe.getTilePoint(we)));p.push({tile:W,tileID:S?oe:oe.unwrapTo(0),queryGeometry:le,cameraQueryGeometry:ge,scale:se})}}}return p}transformBbox(e,s,h){let p=e.map(s);if(h){const y=l.a2.fromPoints(e);y.shrinkBy(.001*Math.min(y.width(),y.height()));const S=y.map(s);l.a2.fromPoints(p).covers(S)||(p=p.map((E=>E.x>.5?new l.a1(E.x-1,E.y,E.z):E)))}return p}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map((h=>this._tiles[h].tileID));return this.transform&&this.transform.populateCache(s),s}hasTransition(){if(this._source.hasTransition())return!0;if(Xt(this._source.type)){const e=ee.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,h){this._state.updateState(e=e||"_geojsonTileLayer",s,h)}removeFeatureState(e,s,h){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,h)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,h){const p=this._tiles[e];p&&p.setDependencies(s,h)}reloadTilesForDependencies(e,s){for(const h in this._tiles)this._tiles[h].hasDependency(e,s)&&this._reloadTile(h,"reloading");this._cache.filter((h=>!h.hasDependency(e,s)))}}function Dt(g,e){const s=Math.abs(2*g.wrap)-+(g.wrap<0),h=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||h-s||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function Xt(g){return g==="raster"||g==="image"||g==="video"}rr.maxOverzooming=10,rr.maxUnderzooming=3;class Cr{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=l.ah(e,0,1);let s=1,h=this._distances[s];const p=e*this.paddedLength+this.padding;for(;h<p&&s<this._distances.length;)h=this._distances[++s];const y=s-1,S=this._distances[y],E=h-S,I=E>0?(p-S)/E:0;return this.points[y].mult(1-I).add(this.points[s].mult(I))}}function Kr(g,e){let s=!0;return g==="always"||g!=="never"&&e!=="never"||(s=!1),s}class dn{constructor(e,s,h){const p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(e/h),this.yCellCount=Math.ceil(s/h);for(let S=0;S<this.xCellCount*this.yCellCount;S++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,h,p,y){this._forEachCell(s,h,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y)}insertCircle(e,s,h,p){this._forEachCell(s-p,h-p,s+p,h+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(h),this.circles.push(p)}_insertBoxCell(e,s,h,p,y,S){this.boxCells[y].push(S)}_insertCircleCell(e,s,h,p,y,S){this.circleCells[y].push(S)}_query(e,s,h,p,y,S,E){if(h<0||e>this.width||p<0||s>this.height)return[];const I=[];if(e<=0&&s<=0&&this.width<=h&&this.height<=p){if(y)return[{key:null,x1:e,y1:s,x2:h,y2:p}];for(let z=0;z<this.boxKeys.length;z++)I.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const D=this.circles[3*z],B=this.circles[3*z+1],j=this.circles[3*z+2];I.push({key:this.circleKeys[z],x1:D-j,y1:B-j,x2:D+j,y2:B+j})}}else this._forEachCell(e,s,h,p,this._queryCell,I,{hitTest:y,overlapMode:S,seenUids:{box:{},circle:{}}},E);return I}query(e,s,h,p){return this._query(e,s,h,p,!1,null)}hitTest(e,s,h,p,y,S){return this._query(e,s,h,p,!0,y,S).length>0}hitTestCircle(e,s,h,p,y){const S=e-h,E=e+h,I=s-h,z=s+h;if(E<0||S>this.width||z<0||I>this.height)return!1;const D=[];return this._forEachCell(S,I,E,z,this._queryCellCircle,D,{hitTest:!0,overlapMode:p,circle:{x:e,y:s,radius:h},seenUids:{box:{},circle:{}}},y),D.length>0}_queryCell(e,s,h,p,y,S,E,I){const{seenUids:z,hitTest:D,overlapMode:B}=E,j=this.boxCells[y];if(j!==null){const W=this.bboxes;for(const re of j)if(!z.box[re]){z.box[re]=!0;const se=4*re,ae=this.boxKeys[re];if(e<=W[se+2]&&s<=W[se+3]&&h>=W[se+0]&&p>=W[se+1]&&(!I||I(ae))&&(!D||!Kr(B,ae.overlapMode))&&(S.push({key:ae,x1:W[se],y1:W[se+1],x2:W[se+2],y2:W[se+3]}),D))return!0}}const $=this.circleCells[y];if($!==null){const W=this.circles;for(const re of $)if(!z.circle[re]){z.circle[re]=!0;const se=3*re,ae=this.circleKeys[re];if(this._circleAndRectCollide(W[se],W[se+1],W[se+2],e,s,h,p)&&(!I||I(ae))&&(!D||!Kr(B,ae.overlapMode))){const oe=W[se],de=W[se+1],le=W[se+2];if(S.push({key:ae,x1:oe-le,y1:de-le,x2:oe+le,y2:de+le}),D)return!0}}}return!1}_queryCellCircle(e,s,h,p,y,S,E,I){const{circle:z,seenUids:D,overlapMode:B}=E,j=this.boxCells[y];if(j!==null){const W=this.bboxes;for(const re of j)if(!D.box[re]){D.box[re]=!0;const se=4*re,ae=this.boxKeys[re];if(this._circleAndRectCollide(z.x,z.y,z.radius,W[se+0],W[se+1],W[se+2],W[se+3])&&(!I||I(ae))&&!Kr(B,ae.overlapMode))return S.push(!0),!0}}const $=this.circleCells[y];if($!==null){const W=this.circles;for(const re of $)if(!D.circle[re]){D.circle[re]=!0;const se=3*re,ae=this.circleKeys[re];if(this._circlesCollide(W[se],W[se+1],W[se+2],z.x,z.y,z.radius)&&(!I||I(ae))&&!Kr(B,ae.overlapMode))return S.push(!0),!0}}}_forEachCell(e,s,h,p,y,S,E,I){const z=this._convertToXCellCoord(e),D=this._convertToYCellCoord(s),B=this._convertToXCellCoord(h),j=this._convertToYCellCoord(p);for(let $=z;$<=B;$++)for(let W=D;W<=j;W++)if(y.call(this,e,s,h,p,this.xCellCount*W+$,S,E,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,h,p,y,S){const E=p-e,I=y-s,z=h+S;return z*z>E*E+I*I}_circleAndRectCollide(e,s,h,p,y,S,E){const I=(S-p)/2,z=Math.abs(e-(p+I));if(z>I+h)return!1;const D=(E-y)/2,B=Math.abs(s-(y+D));if(B>D+h)return!1;if(z<=I||B<=D)return!0;const j=z-I,$=B-D;return j*j+$*$<=h*h}}function Tr(g,e,s){const h=l.L();if(!g){const{vecSouth:B,vecEast:j}=ar(e),$=N();$[0]=j[0],$[1]=j[1],$[2]=B[0],$[3]=B[1],p=$,(D=(S=(y=$)[0])*(z=y[3])-(I=y[2])*(E=y[1]))&&(p[0]=z*(D=1/D),p[1]=-E*D,p[2]=-I*D,p[3]=S*D),h[0]=$[0],h[1]=$[1],h[4]=$[2],h[5]=$[3]}var p,y,S,E,I,z,D;return l.N(h,h,[1/s,1/s,1]),h}function cr(g,e,s,h){if(g){const p=l.L();if(!e){const{vecSouth:y,vecEast:S}=ar(s);p[0]=S[0],p[1]=S[1],p[4]=y[0],p[5]=y[1]}return l.N(p,p,[h,h,1]),p}return s.pixelsToClipSpaceMatrix}function ar(g){const e=Math.cos(g.rollInRadians),s=Math.sin(g.rollInRadians),h=Math.cos(g.pitchInRadians),p=Math.cos(g.bearingInRadians),y=Math.sin(g.bearingInRadians),S=l.ar();S[0]=-p*h*s-y*e,S[1]=-y*h*s+p*e;const E=l.as(S);E<1e-9?l.at(S):l.au(S,S,1/E);const I=l.ar();I[0]=p*h*e-y*s,I[1]=y*h*e+p*s;const z=l.as(I);return z<1e-9?l.at(I):l.au(I,I,1/z),{vecEast:I,vecSouth:S}}function en(g,e,s,h){let p;h?(p=[g,e,h(g,e),1],l.aw(p,p,s)):(p=[g,e,0,1],xl(p,p,s));const y=p[3];return{point:new l.P(p[0]/y,p[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function st(g,e){return .5+g/e*.5}function _n(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function $r(g,e,s,h,p,y,S,E,I,z,D,B,j){const $=s?g.textSizeData:g.iconSizeData,W=l.an($,e.transform.zoom),re=[256/e.width*2+1,256/e.height*2+1],se=s?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;se.clear();const ae=g.lineVertexArray,oe=s?g.text.placedSymbolArray:g.icon.placedSymbolArray,de=e.transform.width/e.transform.height;let le=!1;for(let ge=0;ge<oe.length;ge++){const we=oe.get(ge);if(we.hidden||we.writingMode===l.ao.vertical&&!le){la(we.numGlyphs,se);continue}le=!1;const he=new l.P(we.anchorX,we.anchorY),ke={getElevation:j,pitchedLabelPlaneMatrix:h,lineVertexArray:ae,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:he,unwrappedTileID:I,width:z,height:D,translation:B},$e=lo(we.anchorX,we.anchorY,ke);if(!_n($e.point,re)){la(we.numGlyphs,se);continue}const je=st(e.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),Ne=l.ap($,W,we),Ze=y?Ne*e.transform.getPitchedTextCorrection(we.anchorX,we.anchorY,I)/je:Ne*je,ht=Pt({projectionContext:ke,pitchedLabelPlaneMatrixInverse:p,symbol:we,fontSize:Ze,flip:!1,keepUpright:S,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:de,rotateToLine:E});le=ht.useVertical,(ht.notEnoughRoom||le||ht.needsFlipping&&Pt({projectionContext:ke,pitchedLabelPlaneMatrixInverse:p,symbol:we,fontSize:Ze,flip:!0,keepUpright:S,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:de,rotateToLine:E}).notEnoughRoom)&&la(we.numGlyphs,se)}s?g.text.dynamicLayoutVertexBuffer.updateData(se):g.icon.dynamicLayoutVertexBuffer.updateData(se)}function vi(g,e,s,h,p,y,S,E){const I=y.glyphStartIndex+y.numGlyphs,z=y.lineStartIndex,D=y.lineStartIndex+y.lineLength,B=e.getoffsetX(y.glyphStartIndex),j=e.getoffsetX(I-1),$=Ma(g*B,s,h,p,y.segment,z,D,E,S);if(!$)return null;const W=Ma(g*j,s,h,p,y.segment,z,D,E,S);return W?E.projectionCache.anyProjectionOccluded?null:{first:$,last:W}:null}function oa(g,e,s,h){return g===l.ao.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*h?{useVertical:!0}:(g===l.ao.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function Pt(g){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:s,symbol:h,fontSize:p,flip:y,keepUpright:S,glyphOffsetArray:E,dynamicLayoutVertexArray:I,aspectRatio:z,rotateToLine:D}=g,B=p/24,j=h.lineOffsetX*B,$=h.lineOffsetY*B;let W;if(h.numGlyphs>1){const re=h.glyphStartIndex+h.numGlyphs,se=h.lineStartIndex,ae=h.lineStartIndex+h.lineLength,oe=vi(B,E,j,$,y,h,D,e);if(!oe)return{notEnoughRoom:!0};const de=oo(oe.first.point.x,oe.first.point.y,e,s),le=oo(oe.last.point.x,oe.last.point.y,e,s);if(S&&!y){const ge=oa(h.writingMode,de,le,z);if(ge)return ge}W=[oe.first];for(let ge=h.glyphStartIndex+1;ge<re-1;ge++){const we=Ma(B*E.getoffsetX(ge),j,$,y,h.segment,se,ae,e,D);if(!we)return{notEnoughRoom:!0};W.push(we)}W.push(oe.last)}else{if(S&&!y){const se=ri(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ae=h.lineStartIndex+h.segment+1,oe=new l.P(e.lineVertexArray.getx(ae),e.lineVertexArray.gety(ae)),de=ri(oe.x,oe.y,e),le=de.signedDistanceFromCamera>0?de.point:Dr(e.tileAnchorPoint,oe,se,1,e),ge=oo(se.x,se.y,e,s),we=oo(le.x,le.y,e,s),he=oa(h.writingMode,ge,we,z);if(he)return he}const re=Ma(B*E.getoffsetX(h.glyphStartIndex),j,$,y,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,e,D);if(!re||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[re]}for(const re of W)l.av(I,re.point,re.angle);return{}}function Dr(g,e,s,h,p){const y=g.add(g.sub(e)._unit()),S=ri(y.x,y.y,p).point,E=s.sub(S);return s.add(E._mult(h/E.mag()))}function pr(g,e,s){const h=e.projectionCache;if(h.projections[g])return h.projections[g];const p=new l.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),y=ri(p.x,p.y,e);if(y.signedDistanceFromCamera>0)return h.projections[g]=y.point,h.anyProjectionOccluded=h.anyProjectionOccluded||y.isOccluded,y.point;const S=g-s.direction;return Dr(s.distanceFromAnchor===0?e.tileAnchorPoint:new l.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),p,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function ri(g,e,s){const h=g+s.translation[0],p=e+s.translation[1];let y;return s.pitchWithMap?(y=en(h,p,s.pitchedLabelPlaneMatrix,s.getElevation),y.isOccluded=!1):(y=s.transform.projectTileCoordinates(h,p,s.unwrappedTileID,s.getElevation),y.point.x=(.5*y.point.x+.5)*s.width,y.point.y=(.5*-y.point.y+.5)*s.height),y}function oo(g,e,s,h){if(s.pitchWithMap){const p=[g,e,0,1];return l.aw(p,p,h),s.transform.projectTileCoordinates(p[0]/p[3],p[1]/p[3],s.unwrappedTileID,s.getElevation).point}return{x:g/s.width*2-1,y:1-e/s.height*2}}function lo(g,e,s){return s.transform.projectTileCoordinates(g,e,s.unwrappedTileID,s.getElevation)}function xr(g,e,s){return g._unit()._perp()._mult(e*s)}function hc(g,e,s,h,p,y,S,E,I){if(E.projectionCache.offsets[g])return E.projectionCache.offsets[g];const z=s.add(e);if(g+I.direction<h||g+I.direction>=p)return E.projectionCache.offsets[g]=z,z;const D=pr(g+I.direction,E,I),B=xr(D.sub(s),S,I.direction),j=s.add(B),$=D.add(B);return E.projectionCache.offsets[g]=l.ax(y,z,j,$)||z,E.projectionCache.offsets[g]}function Ma(g,e,s,h,p,y,S,E,I){const z=h?g-e:g+e;let D=z>0?1:-1,B=0;h&&(D*=-1,B=Math.PI),D<0&&(B+=Math.PI);let j,$=D>0?y+p:y+p+1;E.projectionCache.cachedAnchorPoint?j=E.projectionCache.cachedAnchorPoint:(j=ri(E.tileAnchorPoint.x,E.tileAnchorPoint.y,E).point,E.projectionCache.cachedAnchorPoint=j);let W,re,se=j,ae=j,oe=0,de=0;const le=Math.abs(z),ge=[];let we;for(;oe+de<=le;){if($+=D,$<y||$>=S)return null;oe+=de,ae=se,re=W;const $e={absOffsetX:le,direction:D,distanceFromAnchor:oe,previousVertex:ae};if(se=pr($,E,$e),s===0)ge.push(ae),we=se.sub(ae);else{let je;const Ne=se.sub(ae);je=Ne.mag()===0?xr(pr($+D,E,$e).sub(se),s,D):xr(Ne,s,D),re||(re=ae.add(je)),W=hc($,je,se,y,S,re,s,E,$e),ge.push(re),we=W.sub(re)}de=we.mag()}const he=we._mult((le-oe)/de)._add(re||ae),ke=B+Math.atan2(se.y-ae.y,se.x-ae.x);return ge.push(he),{point:he,angle:I?ke:0,path:ge}}const dc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function la(g,e){for(let s=0;s<g;s++){const h=e.length;e.resize(h+4),e.float32.set(dc,3*h)}}function xl(g,e,s){const h=e[0],p=e[1];return g[0]=s[0]*h+s[4]*p+s[12],g[1]=s[1]*h+s[5]*p+s[13],g[3]=s[3]*h+s[7]*p+s[15],g}const kr=100;class pu{constructor(e,s=new dn(e.width+200,e.height+200,25),h=new dn(e.width+200,e.height+200,25)){this.transform=e,this.grid=s,this.ignoredGrid=h,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+kr,this.screenBottomBoundary=e.height+kr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,h,p,y,S,E,I,z,D,B,j){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+I[0],e.anchorPointY+I[1],y,D,j),W=h*$.perspectiveRatio;let re;if(S||E)re=this._projectCollisionBox(e,W,p,y,S,E,I,$,D,B,j);else{const we=$.x+(B?B.x*W:0),he=$.y+(B?B.y*W:0);re={allPointsOccluded:!1,box:[we+e.x1*W,he+e.y1*W,we+e.x2*W,he+e.y2*W]}}const[se,ae,oe,de]=re.box,le=S?re.allPointsOccluded:$.isOccluded;let ge=le;return ge||(ge=$.perspectiveRatio<this.perspectiveRatioCutoff),ge||(ge=!this.isInsideGrid(se,ae,oe,de)),ge||s!=="always"&&this.grid.hitTest(se,ae,oe,de,s,z)?{box:[se,ae,oe,de],placeable:!1,offscreen:!1,occluded:le}:{box:[se,ae,oe,de],placeable:!0,offscreen:this.isOffscreen(se,ae,oe,de),occluded:le}}placeCollisionCircles(e,s,h,p,y,S,E,I,z,D,B,j,$,W){const re=[],se=new l.P(s.anchorX,s.anchorY),ae=this.getPerspectiveRatio(se.x,se.y,S,W),oe=(z?y*this.transform.getPitchedTextCorrection(s.anchorX,s.anchorY,S)/ae:y*ae)/l.aB,de={getElevation:W,pitchedLabelPlaneMatrix:E,lineVertexArray:h,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:$},le=vi(oe,p,s.lineOffsetX*oe,s.lineOffsetY*oe,!1,s,!1,de);let ge=!1,we=!1,he=!0;if(le){const ke=.5*B*ae+j,$e=new l.P(-100,-100),je=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Ne=new Cr,Ze=le.first,ht=le.last;let mt=[];for(let br=Ze.path.length-1;br>=1;br--)mt.push(Ze.path[br]);for(let br=1;br<ht.path.length;br++)mt.push(ht.path[br]);const rt=2.5*ke;if(z){const br=this.projectPathToScreenSpace(mt,de);mt=br.some((Zr=>Zr.signedDistanceFromCamera<=0))?[]:br.map((Zr=>Zr.point))}let Ft=[];if(mt.length>0){const br=mt[0].clone(),Zr=mt[0].clone();for(let nn=1;nn<mt.length;nn++)br.x=Math.min(br.x,mt[nn].x),br.y=Math.min(br.y,mt[nn].y),Zr.x=Math.max(Zr.x,mt[nn].x),Zr.y=Math.max(Zr.y,mt[nn].y);Ft=br.x>=$e.x&&Zr.x<=je.x&&br.y>=$e.y&&Zr.y<=je.y?[mt]:Zr.x<$e.x||br.x>je.x||Zr.y<$e.y||br.y>je.y?[]:l.ay([mt],$e.x,$e.y,je.x,je.y)}for(const br of Ft){Ne.reset(br,.25*ke);let Zr=0;Zr=Ne.length<=.5*ke?1:Math.ceil(Ne.paddedLength/rt)+1;for(let nn=0;nn<Zr;nn++){const Qr=nn/Math.max(Zr-1,1),un=Ne.lerp(Qr),xn=un.x+kr,mr=un.y+kr;re.push(xn,mr,ke,0);const Xr=xn-ke,Dn=mr-ke,Ln=xn+ke,Kn=mr+ke;if(he=he&&this.isOffscreen(Xr,Dn,Ln,Kn),we=we||this.isInsideGrid(Xr,Dn,Ln,Kn),e!=="always"&&this.grid.hitTestCircle(xn,mr,ke,e,D)&&(ge=!0,!I))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!I&&ge||!we||ae<this.perspectiveRatioCutoff?[]:re,offscreen:he,collisionDetected:ge}}projectPathToScreenSpace(e,s){const h=(function(p,y){const S=l.L();return l.aq(S,y.pitchedLabelPlaneMatrix),p.map((E=>{const I=en(E.x,E.y,S,y.getElevation),z=y.transform.projectTileCoordinates(I.point.x,I.point.y,y.unwrappedTileID,y.getElevation);return z.point.x=(.5*z.point.x+.5)*y.width,z.point.y=(.5*-z.point.y+.5)*y.height,z}))})(e,s);return(function(p){let y=0,S=0,E=0,I=0;for(let z=0;z<p.length;z++)p[z].isOccluded?(E=z+1,I=0):(I++,I>S&&(S=I,y=E));return p.slice(y,y+S)})(h)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[],h=new l.a2;for(const B of e){const j=new l.P(B.x+kr,B.y+kr);h.extend(j),s.push(j)}const{minX:p,minY:y,maxX:S,maxY:E}=h,I=this.grid.query(p,y,S,E).concat(this.ignoredGrid.query(p,y,S,E)),z={},D={};for(const B of I){const j=B.key;if(z[j.bucketInstanceId]===void 0&&(z[j.bucketInstanceId]={}),z[j.bucketInstanceId][j.featureIndex])continue;const $=[new l.P(B.x1,B.y1),new l.P(B.x2,B.y1),new l.P(B.x2,B.y2),new l.P(B.x1,B.y2)];l.az(s,$)&&(z[j.bucketInstanceId][j.featureIndex]=!0,D[j.bucketInstanceId]===void 0&&(D[j.bucketInstanceId]=[]),D[j.bucketInstanceId].push(j.featureIndex))}return D}insertCollisionBox(e,s,h,p,y,S){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:S,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,h,p,y,S){const E=h?this.ignoredGrid:this.grid,I={bucketInstanceId:p,featureIndex:y,collisionGroupID:S,overlapMode:s};for(let z=0;z<e.length;z+=4)E.insertCircle(I,e[z],e[z+1],e[z+2])}projectAndGetPerspectiveRatio(e,s,h,p,y){if(y){let S;p?(S=[e,s,p(e,s),1],l.aw(S,S,y)):(S=[e,s,0,1],xl(S,S,y));const E=S[3];return{x:(S[0]/E+1)/2*this.transform.width+kr,y:(-S[1]/E+1)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E*.5,isOccluded:!1,signedDistanceFromCamera:E}}{const S=this.transform.projectTileCoordinates(e,s,h,p);return{x:(S.point.x+1)/2*this.transform.width+kr,y:(1-S.point.y)/2*this.transform.height+kr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,s,h,p){const y=this.transform.projectTileCoordinates(e,s,h,p);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(e,s,h,p){return h<kr||e>=this.screenRightBoundary||p<kr||s>this.screenBottomBoundary}isInsideGrid(e,s,h,p){return h>=0&&e<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=l.ag([]);return l.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,h,p,y,S,E,I,z,D,B){let j=1,$=0,W=0,re=1;const se=e.anchorPointX+E[0],ae=e.anchorPointY+E[1];if(S&&!y){const mt=this.projectAndGetPerspectiveRatio(se+1,ae,p,z,B),rt=mt.x-I.x,Ft=Math.atan((mt.y-I.y)/rt)+(rt<0?Math.PI:0),br=Math.sin(Ft),Zr=Math.cos(Ft);j=Zr,$=br,W=-br,re=Zr}else if(!S&&y){const mt=ar(this.transform);j=mt.vecEast[0],$=mt.vecEast[1],W=mt.vecSouth[0],re=mt.vecSouth[1]}let oe=I.x,de=I.y,le=s;y&&(oe=se,de=ae,le=Math.pow(2,-(this.transform.zoom-h.overscaledZ)),le*=this.transform.getPitchedTextCorrection(se,ae,p),D||(le*=l.ah(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),D&&(oe+=j*D.x*le+W*D.y*le,de+=$*D.x*le+re*D.y*le);const ge=e.x1*le,we=e.x2*le,he=(ge+we)/2,ke=e.y1*le,$e=e.y2*le,je=(ke+$e)/2,Ne=[{offsetX:ge,offsetY:ke},{offsetX:he,offsetY:ke},{offsetX:we,offsetY:ke},{offsetX:we,offsetY:je},{offsetX:we,offsetY:$e},{offsetX:he,offsetY:$e},{offsetX:ge,offsetY:$e},{offsetX:ge,offsetY:je}];let Ze=[];for(const{offsetX:mt,offsetY:rt}of Ne)Ze.push(new l.P(oe+j*mt+W*rt,de+$*mt+re*rt));let ht=!1;if(y){const mt=Ze.map((rt=>this.projectAndGetPerspectiveRatio(rt.x,rt.y,p,z,B)));ht=mt.some((rt=>!rt.isOccluded)),Ze=mt.map((rt=>new l.P(rt.x,rt.y)))}else ht=!0;return{box:l.aA(Ze),allPointsOccluded:!ht}}}class xi{constructor(e,s,h,p){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):p&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class an{constructor(e,s,h,p,y){this.text=new xi(e?e.text:null,s,h,y),this.icon=new xi(e?e.icon:null,s,p,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fc{constructor(e,s,h){this.text=e,this.icon=s,this.skipFade=h}}class pc{constructor(e,s,h,p,y){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=h,this.bucketIndex=p,this.tileID=y}}class mu{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:h=>h.collisionGroupID===s}}return this.collisionGroups[e]}}function Ns(g,e,s,h,p){const{horizontalAlign:y,verticalAlign:S}=l.aH(g);return new l.P(-(y-.5)*e+h[0]*p,-(S-.5)*s+h[1]*p)}class ui{constructor(e,s,h,p,y){this.transform=e.clone(),this.terrain=s,this.collisionIndex=new pu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new mu(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(h,p)=>s.getElevation(e,h,p):null}getBucketParts(e,s,h,p){const y=h.getBucket(s),S=h.latestFeatureIndex;if(!y||!S||s.id!==y.layerIds[0])return;const E=h.collisionBoxArray,I=y.layers[0].layout,z=y.layers[0].paint,D=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),B=h.tileSize/l.$,j=h.tileID.toUnwrapped(),$=I.get("text-rotation-alignment")==="map",W=l.aC(h,1,this.transform.zoom),re=l.aD(this.collisionIndex.transform,h,z.get("text-translate"),z.get("text-translate-anchor")),se=l.aD(this.collisionIndex.transform,h,z.get("icon-translate"),z.get("icon-translate-anchor")),ae=Tr($,this.transform,W);this.retainedQueryData[y.bucketInstanceId]=new pc(y.bucketInstanceId,S,y.sourceLayerIndex,y.index,h.tileID);const oe={bucket:y,layout:I,translationText:re,translationIcon:se,unwrappedTileID:j,pitchedLabelPlaneMatrix:ae,scale:D,textPixelRatio:B,holdingForFade:h.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:l.an(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(const de of y.sortKeyRanges){const{sortKey:le,symbolInstanceStart:ge,symbolInstanceEnd:we}=de;e.push({sortKey:le,symbolInstanceStart:ge,symbolInstanceEnd:we,parameters:oe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(e,s,h,p,y,S,E,I,z,D,B,j,$,W,re,se,ae,oe,de,le){const ge=l.aE[e.textAnchor],we=[e.textOffset0,e.textOffset1],he=Ns(ge,h,p,we,y),ke=this.collisionIndex.placeCollisionBox(s,j,I,z,D,E,S,se,B.predicate,de,he,le);if((!oe||this.collisionIndex.placeCollisionBox(oe,j,I,z,D,E,S,ae,B.predicate,de,he,le).placeable)&&ke.placeable){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&($e=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:we,width:h,height:p,anchor:ge,textBoxScale:y,prevAnchor:$e},this.markUsedJustification(W,ge,$,re),W.allowVerticalPlacement&&(this.markUsedOrientation(W,re,$),this.placedOrientations[$.crossTileID]=re),{shift:he,placedGlyphBoxes:ke}}}placeLayerBucketPart(e,s,h){const{bucket:p,layout:y,translationText:S,translationIcon:E,unwrappedTileID:I,pitchedLabelPlaneMatrix:z,textPixelRatio:D,holdingForFade:B,collisionBoxArray:j,partiallyEvaluatedTextSize:$,collisionGroup:W}=e.parameters,re=y.get("text-optional"),se=y.get("icon-optional"),ae=l.aF(y,"text-overlap","text-allow-overlap"),oe=ae==="always",de=l.aF(y,"icon-overlap","icon-allow-overlap"),le=de==="always",ge=y.get("text-rotation-alignment")==="map",we=y.get("text-pitch-alignment")==="map",he=y.get("icon-text-fit")!=="none",ke=y.get("symbol-z-order")==="viewport-y",$e=oe&&(le||!p.hasIconData()||se),je=le&&(oe||!p.hasTextData()||re);!p.collisionArrays&&j&&p.deserializeCollisionBoxes(j);const Ne=this.retainedQueryData[p.bucketInstanceId].tileID,Ze=this._getTerrainElevationFunc(Ne),ht=this.transform.getFastPathSimpleProjectionMatrix(Ne),mt=(rt,Ft,br)=>{var Zr,nn;if(s[rt.crossTileID])return;if(B)return void(this.placements[rt.crossTileID]=new fc(!1,!1,!1));let Qr=!1,un=!1,xn=!0,mr=null,Xr={box:null,placeable:!1,offscreen:null,occluded:!1},Dn={placeable:!1},Ln=null,Kn=null,Ti=null,zs=0,Ha=0,ba=0;Ft.textFeatureIndex?zs=Ft.textFeatureIndex:rt.useRuntimeCollisionCircles&&(zs=rt.featureIndex),Ft.verticalTextFeatureIndex&&(Ha=Ft.verticalTextFeatureIndex);const tl=Ft.textBox;if(tl){const ji=Fn=>{let Nn=l.ao.horizontal;if(p.allowVerticalPlacement&&!Fn&&this.prevPlacement){const Bi=this.prevPlacement.placedOrientations[rt.crossTileID];Bi&&(this.placedOrientations[rt.crossTileID]=Bi,Nn=Bi,this.markUsedOrientation(p,Nn,rt))}return Nn},Xs=(Fn,Nn)=>{if(p.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&Ft.verticalTextBox){for(const Bi of p.writingModes)if(Bi===l.ao.vertical?(Xr=Nn(),Dn=Xr):Xr=Fn(),Xr&&Xr.placeable)break}else Xr=Fn()},Ni=rt.textAnchorOffsetStartIndex,Ka=rt.textAnchorOffsetEndIndex;if(Ka===Ni){const Fn=(Nn,Bi)=>{const Bn=this.collisionIndex.placeCollisionBox(Nn,ae,D,Ne,I,we,ge,S,W.predicate,Ze,void 0,ht);return Bn&&Bn.placeable&&(this.markUsedOrientation(p,Bi,rt),this.placedOrientations[rt.crossTileID]=Bi),Bn};Xs((()=>Fn(tl,l.ao.horizontal)),(()=>{const Nn=Ft.verticalTextBox;return p.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&Nn?Fn(Nn,l.ao.vertical):{box:null,offscreen:null}})),ji(Xr&&Xr.placeable)}else{let Fn=l.aE[(nn=(Zr=this.prevPlacement)===null||Zr===void 0?void 0:Zr.variableOffsets[rt.crossTileID])===null||nn===void 0?void 0:nn.anchor];const Nn=(Bn,Uc,Xl)=>{const Xn=Bn.x2-Bn.x1,bs=Bn.y2-Bn.y1,Ys=rt.textBoxScale,Yh=he&&de==="never"?Uc:null;let is=null,Qh=ae==="never"?1:2,Vc="never";Fn&&Qh++;for(let Xa=0;Xa<Qh;Xa++){for(let Yl=Ni;Yl<Ka;Yl++){const wa=p.textAnchorOffsets.get(Yl);if(Fn&&wa.textAnchor!==Fn)continue;const Ya=this.attemptAnchorPlacement(wa,Bn,Xn,bs,Ys,ge,we,D,Ne,I,W,Vc,rt,p,Xl,S,E,Yh,Ze);if(Ya&&(is=Ya.placedGlyphBoxes,is&&is.placeable))return Qr=!0,mr=Ya.shift,is}Fn?Fn=null:Vc=ae}return h&&!is&&(is={box:this.collisionIndex.placeCollisionBox(tl,"always",D,Ne,I,we,ge,S,W.predicate,Ze,void 0,ht).box,offscreen:!1,placeable:!1,occluded:!1}),is};Xs((()=>Nn(tl,Ft.iconBox,l.ao.horizontal)),(()=>{const Bn=Ft.verticalTextBox;return p.allowVerticalPlacement&&(!Xr||!Xr.placeable)&&rt.numVerticalGlyphVertices>0&&Bn?Nn(Bn,Ft.verticalIconBox,l.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Xr&&(Qr=Xr.placeable,xn=Xr.offscreen);const Bi=ji(Xr&&Xr.placeable);if(!Qr&&this.prevPlacement){const Bn=this.prevPlacement.variableOffsets[rt.crossTileID];Bn&&(this.variableOffsets[rt.crossTileID]=Bn,this.markUsedJustification(p,Bn.anchor,rt,Bi))}}}if(Ln=Xr,Qr=Ln&&Ln.placeable,xn=Ln&&Ln.offscreen,rt.useRuntimeCollisionCircles){const ji=p.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex),Xs=l.ap(p.textSizeData,$,ji),Ni=y.get("text-padding");Kn=this.collisionIndex.placeCollisionCircles(ae,ji,p.lineVertexArray,p.glyphOffsetArray,Xs,I,z,h,we,W.predicate,rt.collisionCircleDiameter,Ni,S,Ze),Kn.circles.length&&Kn.collisionDetected&&!h&&l.w("Collisions detected, but collision boxes are not shown"),Qr=oe||Kn.circles.length>0&&!Kn.collisionDetected,xn=xn&&Kn.offscreen}if(Ft.iconFeatureIndex&&(ba=Ft.iconFeatureIndex),Ft.iconBox){const ji=Xs=>this.collisionIndex.placeCollisionBox(Xs,de,D,Ne,I,we,ge,E,W.predicate,Ze,he&&mr?mr:void 0,ht);Dn&&Dn.placeable&&Ft.verticalIconBox?(Ti=ji(Ft.verticalIconBox),un=Ti.placeable):(Ti=ji(Ft.iconBox),un=Ti.placeable),xn=xn&&Ti.offscreen}const rl=re||rt.numHorizontalGlyphVertices===0&&rt.numVerticalGlyphVertices===0,Eo=se||rt.numIconVertices===0;rl||Eo?Eo?rl||(un=un&&Qr):Qr=un&&Qr:un=Qr=un&&Qr;const nl=un&&Ti.placeable;if(Qr&&Ln.placeable&&this.collisionIndex.insertCollisionBox(Ln.box,ae,y.get("text-ignore-placement"),p.bucketInstanceId,Dn&&Dn.placeable&&Ha?Ha:zs,W.ID),nl&&this.collisionIndex.insertCollisionBox(Ti.box,de,y.get("icon-ignore-placement"),p.bucketInstanceId,ba,W.ID),Kn&&Qr&&this.collisionIndex.insertCollisionCircles(Kn.circles,ae,y.get("text-ignore-placement"),p.bucketInstanceId,zs,W.ID),h&&this.storeCollisionData(p.bucketInstanceId,br,Ft,Ln,Ti,Kn),rt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[rt.crossTileID]=new fc((Qr||$e)&&!(Ln!=null&&Ln.occluded),(un||je)&&!(Ti!=null&&Ti.occluded),xn||p.justReloaded),s[rt.crossTileID]=!0};if(ke){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const rt=p.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ft=rt.length-1;Ft>=0;--Ft){const br=rt[Ft];mt(p.symbolInstances.get(br),p.collisionArrays[br],br)}}else for(let rt=e.symbolInstanceStart;rt<e.symbolInstanceEnd;rt++)mt(p.symbolInstances.get(rt),p.collisionArrays[rt],rt);p.justReloaded=!1}storeCollisionData(e,s,h,p,y,S){if(h.textBox||h.iconBox){let E,I;this.collisionBoxArrays.has(e)?E=this.collisionBoxArrays.get(e):(E=new Map,this.collisionBoxArrays.set(e,E)),E.has(s)?I=E.get(s):(I={text:null,icon:null},E.set(s,I)),h.textBox&&(I.text=p.box),h.iconBox&&(I.icon=y.box)}if(S){let E=this.collisionCircleArrays[e];E===void 0&&(E=this.collisionCircleArrays[e]=[]);for(let I=0;I<S.circles.length;I+=4)E.push(S.circles[I+0]-kr),E.push(S.circles[I+1]-kr),E.push(S.circles[I+2]),E.push(S.collisionDetected?1:0)}}markUsedJustification(e,s,h,p){let y;y=p===l.ao.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[l.aG(s)];const S=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const E of S)E>=0&&(e.text.placedSymbolArray.get(E).crossTileID=y>=0&&E!==y?0:h.crossTileID)}markUsedOrientation(e,s,h){const p=s===l.ao.horizontal||s===l.ao.horizontalOnly?s:0,y=s===l.ao.vertical?s:0,S=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const E of S)e.text.placedSymbolArray.get(E).placedOrientation=p;h.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let h=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(e):1,y=s?s.opacities:{},S=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const I in this.placements){const z=this.placements[I],D=y[I];D?(this.opacities[I]=new an(D,p,z.text,z.icon),h=h||z.text!==D.text.placed||z.icon!==D.icon.placed):(this.opacities[I]=new an(null,p,z.text,z.icon,z.skipFade),h=h||z.text||z.icon)}for(const I in y){const z=y[I];if(!this.opacities[I]){const D=new an(z,p,!1,!1);D.isHidden()||(this.opacities[I]=D,h=h||z.text.placed||z.icon.placed)}}for(const I in S)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=S[I]);for(const I in E)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=E[I]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const h={};for(const p of s){const y=p.getBucket(e);y&&p.latestFeatureIndex&&e.id===y.layerIds[0]&&this.updateBucketOpacities(y,p.tileID,h,p.collisionBoxArray)}}updateBucketOpacities(e,s,h,p){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const y=e.layers[0],S=y.layout,E=new an(null,0,!1,!1,!0),I=S.get("text-allow-overlap"),z=S.get("icon-allow-overlap"),D=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=S.get("text-rotation-alignment")==="map",j=S.get("text-pitch-alignment")==="map",$=S.get("icon-text-fit")!=="none",W=new an(null,0,I&&(z||!e.hasIconData()||S.get("icon-optional")),z&&(I||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&p&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(p);const re=(ae,oe,de)=>{for(let le=0;le<oe/4;le++)ae.opacityVertexArray.emplaceBack(de);ae.hasVisibleVertices=ae.hasVisibleVertices||de!==Sl},se=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ae=0;ae<e.symbolInstances.length;ae++){const oe=e.symbolInstances.get(ae),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:le,crossTileID:ge}=oe;let we=this.opacities[ge];h[ge]?we=E:we||(we=W,this.opacities[ge]=we),h[ge]=!0;const he=oe.numIconVertices>0,ke=this.placedOrientations[oe.crossTileID],$e=ke===l.ao.vertical,je=ke===l.ao.horizontal||ke===l.ao.horizontalOnly;if(de>0||le>0){const Ze=wl(we.text);re(e.text,de,$e?Sl:Ze),re(e.text,le,je?Sl:Ze);const ht=we.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach((Ft=>{Ft>=0&&(e.text.placedSymbolArray.get(Ft).hidden=ht||$e?1:0)})),oe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=ht||je?1:0);const mt=this.variableOffsets[oe.crossTileID];mt&&this.markUsedJustification(e,mt.anchor,oe,ke);const rt=this.placedOrientations[oe.crossTileID];rt&&(this.markUsedJustification(e,"left",oe,rt),this.markUsedOrientation(e,rt,oe))}if(he){const Ze=wl(we.icon),ht=!($&&oe.verticalPlacedIconSymbolIndex&&$e);oe.placedIconSymbolIndex>=0&&(re(e.icon,oe.numIconVertices,ht?Ze:Sl),e.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=we.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(re(e.icon,oe.numVerticalIconVertices,ht?Sl:Ze),e.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}const Ne=se&&se.has(ae)?se.get(ae):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ze=e.collisionArrays[ae];if(Ze){let ht=new l.P(0,0);if(Ze.textBox||Ze.verticalTextBox){let mt=!0;if(D){const rt=this.variableOffsets[ge];rt?(ht=Ns(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textBoxScale),B&&ht._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):mt=!1}if(Ze.textBox||Ze.verticalTextBox){let rt;Ze.textBox&&(rt=$e),Ze.verticalTextBox&&(rt=je),_h(e.textCollisionBox.collisionVertexArray,we.text.placed,!mt||rt,Ne.text,ht.x,ht.y)}}if(Ze.iconBox||Ze.verticalIconBox){const mt=!!(!je&&Ze.verticalIconBox);let rt;Ze.iconBox&&(rt=mt),Ze.verticalIconBox&&(rt=!mt),_h(e.iconCollisionBox.collisionVertexArray,we.icon.placed,rt,Ne.icon,$?ht.x:0,$?ht.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const h=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*h>e}setStale(){this.stale=!0}}function _h(g,e,s,h,p,y){h&&h.length!==0||(h=[0,0,0,0]);const S=h[0]-kr,E=h[1]-kr,I=h[2]-kr,z=h[3]-kr;g.emplaceBack(e?1:0,s?1:0,p||0,y||0,S,E),g.emplaceBack(e?1:0,s?1:0,p||0,y||0,I,E),g.emplaceBack(e?1:0,s?1:0,p||0,y||0,I,z),g.emplaceBack(e?1:0,s?1:0,p||0,y||0,S,z)}const ks=Math.pow(2,25),Zd=Math.pow(2,24),bl=Math.pow(2,17),Gd=Math.pow(2,16),gu=Math.pow(2,9),yu=Math.pow(2,8),mc=Math.pow(2,1);function wl(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,s=Math.floor(127*g.opacity);return s*ks+e*Zd+s*bl+e*Gd+s*gu+e*yu+s*mc+e}const Sl=0;class vh{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,h,p,y){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(S,p,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort(((E,I)=>E.sortKey-I.sortKey)));this._currentPartIndex<S.length;)if(s.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,y())return!0;return!1}}class gc{constructor(e,s,h,p,y,S,E,I){this.placement=new ui(e,s,S,E,I),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(e,s,h){const p=ee.now(),y=()=>!this._forceFullPlacement&&ee.now()-p>2;for(;this._currentPlacementIndex>=0;){const S=s[e[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=E)&&(!S.maxzoom||S.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new vh(S)),this._inProgressLayer.continuePlacement(h[S.source],this.placement,this._showCollisionBoxes,S,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const No=512/l.$/2;class yc{constructor(e,s,h){this.tileID=e,this.bucketInstanceId=h,this._symbolsByKey={};const p=new Map;for(let y=0;y<s.length;y++){const S=s.get(y),E=S.key,I=p.get(E);I?I.push(S):p.set(E,[S])}for(const[y,S]of p){const E={positions:S.map((I=>({x:Math.floor(I.anchorX*No),y:Math.floor(I.anchorY*No)}))),crossTileIDs:S.map((I=>I.crossTileID))};if(E.positions.length>128){const I=new l.aI(E.positions.length,16,Uint16Array);for(const{x:z,y:D}of E.positions)I.add(z,D);I.finish(),delete E.positions,E.index=I}this._symbolsByKey[y]=E}}getScaledCoordinates(e,s){const{x:h,y:p,z:y}=this.tileID.canonical,{x:S,y:E,z:I}=s.canonical,z=No/Math.pow(2,I-y),D=(E*l.$+e.anchorY)*z,B=p*l.$*No;return{x:Math.floor((S*l.$+e.anchorX)*z-h*l.$*No),y:Math.floor(D-B)}}findMatches(e,s,h){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let y=0;y<e.length;y++){const S=e.get(y);if(S.crossTileID)continue;const E=this._symbolsByKey[S.key];if(!E)continue;const I=this.getScaledCoordinates(S,s);if(E.index){const z=E.index.range(I.x-p,I.y-p,I.x+p,I.y+p).sort();for(const D of z){const B=E.crossTileIDs[D];if(!h[B]){h[B]=!0,S.crossTileID=B;break}}}else if(E.positions)for(let z=0;z<E.positions.length;z++){const D=E.positions[z],B=E.crossTileIDs[z];if(Math.abs(D.x-I.x)<=p&&Math.abs(D.y-I.y)<=p&&!h[B]){h[B]=!0,S.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class Bo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const h in this.indexes){const p=this.indexes[h],y={};for(const S in p){const E=p[S];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),y[E.tileID.key]=E}this.indexes[h]=y}this.lng=e}addBucket(e,s,h){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const p=this.usedCrossTileIDs[e.overscaledZ];for(const y in this.indexes){const S=this.indexes[y];if(Number(y)>e.overscaledZ)for(const E in S){const I=S[E];I.tileID.isChildOf(e)&&I.findMatches(s.symbolInstances,e,p)}else{const E=S[e.scaledTo(Number(y)).key];E&&E.findMatches(s.symbolInstances,e,p)}}for(let y=0;y<s.symbolInstances.length;y++){const S=s.symbolInstances.get(y);S.crossTileID||(S.crossTileID=h.generate(),p[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new yc(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const h of s.getCrossTileIDsLists())for(const p of h)delete this.usedCrossTileIDs[e][p]}removeStaleBuckets(e){let s=!1;for(const h in this.indexes){const p=this.indexes[h];for(const y in p)e[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,p[y]),delete p[y],s=!0)}return s}}class co{constructor(){this.layerIndexes={},this.crossTileIDs=new Bo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,h){let p=this.layerIndexes[e.id];p===void 0&&(p=this.layerIndexes[e.id]=new Qf);let y=!1;const S={};p.handleWrapJump(h);for(const E of s){const I=E.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,I,this.crossTileIDs)&&(y=!0),S[I.bucketInstanceId]=!0)}return p.removeStaleBuckets(S)&&(y=!0),y}pruneUnusedLayers(e){const s={};e.forEach((h=>{s[h]=!0}));for(const h in this.layerIndexes)s[h]||delete this.layerIndexes[h]}}var qr="void main() {fragColor=vec4(1.0);}";const Es={prelude:Er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Er("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Er("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Er(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Er(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Er(qr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Er(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Er("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Er("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Er(qr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Er(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Er(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Er(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Er(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Er("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Er("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Er("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Er(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Er("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Er(g,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=e.match(/in ([\w]+) ([\w]+)/g),p=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=y?y.concat(p):p,E={};return{fragmentSource:g=g.replace(s,((I,z,D,B,j)=>(E[j]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${D} ${B} ${j};
#else
uniform ${D} ${B} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${D} ${B} ${j} = u_${j};
#endif
`))),vertexSource:e=e.replace(s,((I,z,D,B,j)=>{const $=B==="float"?"vec2":"vec4",W=j.match(/color/)?"color":$;return E[j]?z==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${D} ${$} a_${j};
out ${D} ${B} ${j};
#else
uniform ${D} ${B} u_${j};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${D} ${B} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${W}(a_${j}, u_${j}_t);
#else
    ${D} ${B} ${j} = u_${j};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${D} ${$} a_${j};
#else
uniform ${D} ${B} u_${j};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${D} ${B} ${j} = a_${j};
#else
    ${D} ${B} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${D} ${B} ${j} = unpack_mix_${W}(a_${j}, u_${j}_t);
#else
    ${D} ${B} ${j} = u_${j};
#endif
`})),staticAttributes:h,staticUniforms:S}}class Aa{constructor(e,s,h){this.vertexBuffer=e,this.indexBuffer=s,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ra=l.aJ([{name:"a_pos",type:"Int16",components:2}]);const ca="#define PROJECTION_MERCATOR",uo="mercator";class Pr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return uo}get shaderDefine(){return ca}get shaderPreludeCode(){return Es.projectionMercator}get vertexShaderPreludeCode(){return Es.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,s,h,p,y){if(this._cachedMesh)return this._cachedMesh;const S=new l.aL;S.emplaceBack(0,0),S.emplaceBack(l.$,0),S.emplaceBack(0,l.$),S.emplaceBack(l.$,l.$);const E=e.createVertexBuffer(S,Ra.members),I=l.aM.simpleSegment(0,0,4,2),z=new l.aN;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3);const D=e.createIndexBuffer(z);return this._cachedMesh=new Aa(E,D,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class ua{constructor(e=0,s=0,h=0,p=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(h)||h<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=h,this.right=p}interpolate(e,s,h){return s.top!=null&&e.top!=null&&(this.top=l.C.number(e.top,s.top,h)),s.bottom!=null&&e.bottom!=null&&(this.bottom=l.C.number(e.bottom,s.bottom,h)),s.left!=null&&e.left!=null&&(this.left=l.C.number(e.left,s.left,h)),s.right!=null&&e.right!=null&&(this.right=l.C.number(e.right,s.right,h)),this}getCenter(e,s){const h=l.ah((this.left+e-this.right)/2,0,e),p=l.ah((this.top+s-this.bottom)/2,0,s);return new l.P(h,p)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new ua(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bs(g,e){if(!g.renderWorldCopies||g.lngRange)return;const s=e.lng-g.center.lng;e.lng+=s>180?-360:s<-180?360:0}function $s(g){return Math.max(0,Math.floor(g))}class kn{constructor(e,s,h,p,y,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=$s(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ua,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,s,h){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=$s(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new ua(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!h&&e.autoCalculateNearFarZ,s&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const s=l.aO(e,-180,180)*Math.PI/180;var h,p,y,S,E,I,z,D,B;this._bearingInRadians!==s&&(this._unmodified=!1,this._bearingInRadians=s,this._calcMatrices(),this._rotationMatrix=N(),h=this._rotationMatrix,y=-this._bearingInRadians,S=(p=this._rotationMatrix)[0],E=p[1],I=p[2],z=p[3],D=Math.sin(y),B=Math.cos(y),h[0]=S*B+I*D,h[1]=E*B+z*D,h[2]=S*-D+I*B,h[3]=E*-D+z*B)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const s=l.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==s&&(this._unmodified=!1,this._pitchInRadians=s,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const s=e/180*Math.PI;this._rollInRadians!==s&&(this._unmodified=!1,this._rollInRadians=s,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aP(this._fovInRadians)}setFov(e){e=l.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=l.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const s=this.getConstrained(this._center,e).zoom;this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this._tileZoom=Math.max(0,Math.floor(s)),this._scale=l.af(s),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,s){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=s,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,h){this._unmodified=!1,this._edgeInsets.interpolate(e,s,h),this._constrain(),this._calcMatrices()}resize(e,s,h=!0){this._width=e,this._height=s,h&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Vr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-l.ai,l.ai])}getConstrained(e,s){return this._callbacks.getConstrained(e,s)}getCameraQueryGeometry(e,s){if(s.length===1)return[s[0],e];{const{minX:h,minY:p,maxX:y,maxY:S}=l.a2.fromPoints(s).extend(e);return[new l.P(h,p),new l.P(y,p),new l.P(y,S),new l.P(h,S),new l.P(h,p)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:h}=this.getConstrained(this.center,this.zoom);this.setCenter(s),this.setZoom(h),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=l.ag(new Float64Array(16));l.N(e,e,[this._width/2,-this._height/2,1]),l.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=l.ag(new Float64Array(16)),l.N(e,e,[1,-1,1]),l.M(e,e,[-1,-1,0]),l.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,s,h,p){const y=h!==void 0?h:this.bearing,S=p=p!==void 0?p:this.pitch,E=l.a1.fromLngLat(e,s),I=-Math.cos(l.ae(S)),z=Math.sin(l.ae(S)),D=z*Math.sin(l.ae(y)),B=-z*Math.cos(l.ae(y));let j=this.elevation;const $=s-j;let W;I*$>=0||Math.abs(I)<.1?(W=1e4,j=s+W*I):W=-$/I;let re,se,ae=l.aQ(1,E.y),oe=0;do{if(oe+=1,oe>10)break;se=W/ae,re=new l.a1(E.x+D*se,E.y+B*se),ae=1/re.meterInMercatorCoordinateUnits()}while(Math.abs(W-se*ae)>1e-12);return{center:re.toLngLat(),elevation:j,zoom:l.ak(this.height/2/Math.tan(this.fovInRadians/2)/se/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const s=l.aj(1,this.center.lat)*this.worldSize,h=this.cameraToCenterDistance/s,p=l.a1.fromLngLat(this.center,this.elevation),y=Oe(this.center,this.elevation,this.pitch,this.bearing,h);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),l.aQ(y.z,p.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=l.aj(1,this.center.lat)*this.worldSize;return Oe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const s=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/s,e.canonical.y/s,1/s/l.$,1/s/l.$]}}class En{constructor(e,s){this.min=e,this.max=s,this.center=l.aR([],l.aS([],this.min,this.max),.5)}quadrant(e){const s=[e%2==0,e<2],h=l.aT(this.min),p=l.aT(this.max);for(let y=0;y<s.length;y++)h[y]=s[y]?this.min[y]:this.center[y],p[y]=s[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new En(h,p)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let s=!0;for(let h=0;h<e.planes.length;h++){const p=this.intersectsPlane(e.planes[h]);if(p===0)return 0;p===1&&(s=!1)}return s?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let s=e[3],h=e[3];for(let p=0;p<3;p++)e[p]>0?(s+=e[p]*this.min[p],h+=e[p]*this.max[p]):(h+=e[p]*this.min[p],s+=e[p]*this.max[p]);return s>=0?2:h<0?0:1}}class Gn{distanceToTile2d(e,s,h,p){const y=p.distanceX([e,s]),S=p.distanceY([e,s]);return Math.hypot(y,S)}getWrap(e,s,h){return h}getTileBoundingVolume(e,s,h,p){var y,S;let E=0,I=0;if(p!=null&&p.terrain){const D=new l.Z(e.z,s,e.z,e.x,e.y),B=p.terrain.getMinMaxElevation(D);E=(y=B.minElevation)!==null&&y!==void 0?y:Math.min(0,h),I=(S=B.maxElevation)!==null&&S!==void 0?S:Math.max(0,h)}const z=1<<e.z;return new En([s+e.x/z,e.y/z,E],[s+(e.x+1)/z,(e.y+1)/z,I])}allowVariableZoom(e,s){const h=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,p=l.ah(78.5-h/2,0,60);return!!s.terrain||e.pitch>p}allowWorldCopies(){return!0}prepareNextFrame(){}}class fn{constructor(e,s,h){this.points=e,this.planes=s,this.aabb=h}static fromInvProjectionMatrix(e,s=1,h=0,p,y){const S=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],E=Math.pow(2,h),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((j=>(function($,W,re,se){const ae=l.aw([],$,W),oe=1/ae[3]/re*se;return l.aY(ae,ae,[oe,oe,1/ae[3],oe])})(j,e,s,E)));p&&(function(j,$,W,re){const se=re?4:0,ae=re?0:4;let oe=0;const de=[],le=[];for(let he=0;he<4;he++){const ke=l.aU([],j[he+ae],j[he+se]),$e=l.aZ(ke);l.aR(ke,ke,1/$e),de.push($e),le.push(ke)}for(let he=0;he<4;he++){const ke=l.a_(j[he+se],le[he],W);oe=ke!==null&&ke>=0?Math.max(oe,ke):Math.max(oe,de[he])}const ge=(function(he,ke){const $e=l.aU([],he[ke[0]],he[ke[1]]),je=l.aU([],he[ke[2]],he[ke[1]]),Ne=[0,0,0,0];return l.aV(Ne,l.aW([],$e,je)),Ne[3]=-l.aX(Ne,he[ke[0]]),Ne})(j,$),we=(function(he,ke){const $e=l.a$(he),je=l.b0([],he,1/$e),Ne=l.aU([],ke,l.aR([],je,l.aX(ke,je))),Ze=l.a$(Ne);if(Ze>0){const ht=Math.sqrt(1-je[3]*je[3]),mt=l.aR([],je,-je[3]),rt=l.aS([],mt,l.aR([],Ne,ht/Ze));return l.b1(ke,rt)}return null})(W,ge);if(we!==null){const he=we/l.aX(le[0],ge);oe=Math.min(oe,he)}for(let he=0;he<4;he++){const ke=Math.min(oe,de[he]);j[he+ae]=[j[he+se][0]+le[he][0]*ke,j[he+se][1]+le[he][1]*ke,j[he+se][2]+le[he][2]*ke,1]}})(I,S[0],p,y);const z=S.map((j=>{const $=l.aU([],I[j[0]],I[j[1]]),W=l.aU([],I[j[2]],I[j[1]]),re=l.aV([],l.aW([],$,W)),se=-l.aX(re,I[j[1]]);return re.concat(se)})),D=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],B=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of I)for(let $=0;$<3;$++)D[$]=Math.min(D[$],j[$]),B[$]=Math.max(B[$],j[$]);return new fn(I,z,new En(D,B))}}class cn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,h){return this._helper.interpolatePadding(e,s,h)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,h=!0){this._helper.resize(e,s,h)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,s){}constructor(e,s,h,p,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,E)=>this.getConstrained(S,E)},e,s,h,p,y),this._coveringTilesDetailsProvider=new Gn}clone(){const e=new cn;return e.apply(this),e}apply(e,s,h){this._helper.apply(e,s,h)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const s=[new l.b2(0,e)];if(this._helper._renderWorldCopies){const h=this.screenPointToMercatorCoordinate(new l.P(0,0)),p=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),E=Math.floor(Math.min(h.x,p.x,y.x,S.x)),I=Math.floor(Math.max(h.x,p.x,y.x,S.x)),z=1;for(let D=E-z;D<=I+z;D++)D!==0&&s.push(new l.b2(D,e))}return s}getCameraFrustum(){return fn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const s=this.screenPointToLocation(this.centerPoint,e),h=e?e.getElevationForLngLatZoom(s,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(h)}setLocationAtPoint(e,s){const h=l.aj(this.elevation,this.center.lat),p=this.screenPointToMercatorCoordinateAtZ(s,h),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,h),S=l.a1.fromLngLat(e),E=new l.a1(S.x-(p.x-y.x),S.y-(p.y-y.y));this.setCenter(E==null?void 0:E.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,s){return s?this.coordinatePoint(l.a1.fromLngLat(e),s.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.a1.fromLngLat(e))}screenPointToLocation(e,s){var h;return(h=this.screenPointToMercatorCoordinate(e,s))===null||h===void 0?void 0:h.toLngLat()}screenPointToMercatorCoordinate(e,s){if(s){const h=s.pointCoordinate(e);if(h!=null)return h}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,s){const h=s||0,p=[e.x,e.y,0,1],y=[e.x,e.y,1,1];l.aw(p,p,this._pixelMatrixInverse),l.aw(y,y,this._pixelMatrixInverse);const S=p[3],E=y[3],I=p[1]/S,z=y[1]/E,D=p[2]/S,B=y[2]/E,j=D===B?0:(h-D)/(B-D);return new l.a1(l.C.number(p[0]/S,y[0]/E,j)/this.worldSize,l.C.number(I,z,j)/this.worldSize,h)}coordinatePoint(e,s=0,h=this._pixelMatrix){const p=[e.x*this.worldSize,e.y*this.worldSize,s,1];return l.aw(p,p,h),new l.P(p[0]/p[3],p[1]/p[3])}getBounds(){const e=Math.max(0,this._helper._height/2-ve(this));return new Vr().extend(this.screenPointToLocation(new l.P(0,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(e,s){return s?s.pointCoordinate(e)!=null:e.y>this.height/2-ve(this)}calculatePosMatrix(e,s=!1,h){var p;const y=(p=e.key)!==null&&p!==void 0?p:l.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=s?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(y)){const z=S.get(y);return h?z.f32:z.f64}const E=Ae(e,this.worldSize);l.O(E,s?this._alignedProjMatrix:this._viewProjMatrix,E);const I={f64:E,f32:new Float32Array(E)};return S.set(y,I),h?I.f32:I.f64}calculateFogMatrix(e){const s=e.key,h=this._fogMatrixCacheF32;if(h.has(s))return h.get(s);const p=Ae(e,this.worldSize);return l.O(p,this._fogMatrix,p),h.set(s,new Float32Array(p)),h.get(s)}getConstrained(e,s){s=l.ah(+s,this.minZoom,this.maxZoom);const h={center:new l.S(e.lng,e.lat),zoom:s};let p=this._helper._lngRange;if(!this._helper._renderWorldCopies&&p===null){const de=179.9999999999;p=[-de,de]}const y=this.tileSize*l.af(h.zoom);let S=0,E=y,I=0,z=y,D=0,B=0;const{x:j,y:$}=this.size;if(this._helper._latRange){const de=this._helper._latRange;S=l.U(de[1])*y,E=l.U(de[0])*y,E-S<$&&(D=$/(E-S))}p&&(I=l.aO(l.V(p[0])*y,0,y),z=l.aO(l.V(p[1])*y,0,y),z<I&&(z+=y),z-I<j&&(B=j/(z-I)));const{x:W,y:re}=ne(y,e);let se,ae;const oe=Math.max(B||0,D||0);if(oe){const de=new l.P(B?(z+I)/2:W,D?(E+S)/2:re);return h.center=ue(y,de).wrap(),h.zoom+=l.ak(oe),h}if(this._helper._latRange){const de=$/2;re-de<S&&(ae=S+de),re+de>E&&(ae=E-de)}if(p){const de=(I+z)/2;let le=W;this._helper._renderWorldCopies&&(le=l.aO(W,de-y/2,de+y/2));const ge=j/2;le-ge<I&&(se=I+ge),le+ge>z&&(se=z-ge)}if(se!==void 0||ae!==void 0){const de=new l.P(se??W,ae??re);h.center=ue(y,de).wrap()}return h}calculateCenterFromCameraLngLatAlt(e,s,h,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,h,p)}_calculateNearFarZIfNeeded(e,s,h){if(!this._helper.autoCalculateNearFarZ)return;const p=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=e-p*this._helper._pixelPerMeter/Math.cos(s),S=p<0?y:e,E=Math.PI/2+this.pitchInRadians,I=l.ae(this.fov)*(Math.abs(Math.cos(l.ae(this.roll)))*this.height+Math.abs(Math.sin(l.ae(this.roll)))*this.width)/this.height*(.5+h.y/this.height),z=Math.sin(I)*S/Math.sin(l.ah(Math.PI-E-I,.01,Math.PI-.01)),D=ve(this),B=Math.atan(D/this._helper.cameraToCenterDistance),j=l.ae(.75),$=B>j?2*B*(.5+h.y/(2*D)):j,W=Math.sin($)*S/Math.sin(l.ah(Math.PI-E-$,.01,Math.PI-.01)),re=Math.min(z,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-s)*re+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,s=ne(this.worldSize,this.center),h=s.x,p=s.y;this._helper._pixelPerMeter=l.aj(1,this.center.lat)*this.worldSize;const y=l.ae(Math.min(this.pitch,X)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let E;this._calculateNearFarZIfNeeded(S,y,e),E=new Float64Array(16),l.b4(E,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aq(this._invProjMatrix,E),E[8]=2*-e.x/this._helper._width,E[9]=2*e.y/this._helper._height,this._projectionMatrix=l.b5(E),l.N(E,E,[1,-1,1]),l.M(E,E,[0,0,-this._helper.cameraToCenterDistance]),l.b6(E,E,-this.rollInRadians),l.b7(E,E,this.pitchInRadians),l.b6(E,E,-this.bearingInRadians),l.M(E,E,[-h,-p,0]),this._mercatorMatrix=l.N([],E,[this.worldSize,this.worldSize,this.worldSize]),l.N(E,E,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,E),l.M(E,E,[0,0,-this.elevation]),this._viewProjMatrix=E,this._invViewProjMatrix=l.aq([],E);const I=[0,0,-1,1];l.aw(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),l.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,l.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.M(this._fogMatrix,this._fogMatrix,[-h,-p,0]),l.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,E);const z=this._helper._width%2/2,D=this._helper._height%2/2,B=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),$=h-Math.round(h)+B*z+j*D,W=p-Math.round(p)+B*D+j*z,re=new Float64Array(E);if(l.M(re,re,[$>.5?$-1:$,W>.5?W-1:W,0]),this._alignedProjMatrix=re,E=l.aq(new Float64Array(16),this._pixelMatrix),!E)throw new Error("failed to invert matrix");this._pixelMatrixInverse=E,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new l.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return l.aw(s,s,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=l.aj(1,this.center.lat)*this.worldSize;return Oe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,s){const h=l.a1.fromLngLat(e),p=[h.x*this.worldSize,h.y*this.worldSize,s,1];return l.aw(p,p,this._viewProjMatrix),p[2]/p[3]}getProjectionData(e){const{overscaledTileID:s,aligned:h,applyTerrainMatrix:p}=e,y=this._helper.getMercatorTileCoordinates(s),S=s?this.calculatePosMatrix(s,h,!0):null;let E;return E=s&&s.terrainRttPosMatrix32f&&p?s.terrainRttPosMatrix32f:S||l.b8(),{mainMatrix:E,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:E}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,s,h){return 1}transformLightDirection(e){return l.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,s,h,p){const y=this.calculatePosMatrix(h);let S;p?(S=[e,s,p(e,s),1],l.aw(S,S,y)):(S=[e,s,0,1],xl(S,S,y));const E=S[3];return{point:new l.P(S[0]/E,S[1]/E),signedDistanceFromCamera:E,isOccluded:!1}}populateCache(e){for(const s of e)this.calculatePosMatrix(s)}getMatrixForModel(e,s){const h=l.a1.fromLngLat(e,s),p=h.meterInMercatorCoordinateUnits(),y=l.b9();return l.M(y,y,[h.x,h.y,h.z]),l.b6(y,y,Math.PI),l.b7(y,y,Math.PI/2),l.N(y,y,[-p,p,p]),y}getProjectionDataForCustomLayer(e=!0){const s=new l.Z(0,0,0,0,0),h=this.getProjectionData({overscaledTileID:s,applyGlobeMatrix:e}),p=Ae(s,this.worldSize);l.O(p,this._viewProjMatrix,p),h.tileMercatorCoords=[0,0,1,1];const y=[l.$,l.$,this.worldSize/this._helper.pixelsPerMeter],S=l.ba();return l.N(S,p,y),h.fallbackMatrix=S,h.mainMatrix=S,h}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function xh(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function qn(g){if(g.useSlerp)if(g.k<1){const e=l.bb(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),s=l.bb(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),h=new Float64Array(4);l.bc(h,e,s,g.k);const p=l.bd(h);g.tr.setRoll(p.roll),g.tr.setPitch(p.pitch),g.tr.setBearing(p.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(l.C.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(l.C.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(l.C.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function ds(g,e,s,h,p){const y=p.padding,S=ne(p.worldSize,s.getNorthWest()),E=ne(p.worldSize,s.getNorthEast()),I=ne(p.worldSize,s.getSouthEast()),z=ne(p.worldSize,s.getSouthWest()),D=l.ae(-h),B=S.rotate(D),j=E.rotate(D),$=I.rotate(D),W=z.rotate(D),re=new l.P(Math.max(B.x,j.x,W.x,$.x),Math.max(B.y,j.y,W.y,$.y)),se=new l.P(Math.min(B.x,j.x,W.x,$.x),Math.min(B.y,j.y,W.y,$.y)),ae=re.sub(se),oe=(p.width-(y.left+y.right+e.left+e.right))/ae.x,de=(p.height-(y.top+y.bottom+e.top+e.bottom))/ae.y;if(de<0||oe<0)return void xh();const le=Math.min(l.ak(p.scale*Math.min(oe,de)),g.maxZoom),ge=l.P.convert(g.offset),we=new l.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(l.ae(h)),he=ge.add(we).mult(p.scale/l.af(le));return{center:ue(p.worldSize,S.add(I).div(2).sub(he)),zoom:le,bearing:h}}class hi{get useGlobeControls(){return!1}handlePanInertia(e,s){const h=e.mag(),p=Math.abs(ve(s));return{easingOffset:e.mult(Math.min(.75*p/h,1)),easingCenter:s.center}}handleMapControlsRollPitchBearingZoom(e,s){e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta),e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta)}handleMapControlsPan(e,s,h){e.around.distSqr(s.centerPoint)<.01||s.setLocationAtPoint(h,e.around)}cameraForBoxAndBearing(e,s,h,p,y){return ds(e,s,h,p,y)}handleJumpToCenterZoom(e,s){e.zoom!==(s.zoom!==void 0?+s.zoom:e.zoom)&&e.setZoom(+s.zoom),s.center!==void 0&&e.setCenter(l.S.convert(s.center))}handleEaseTo(e,s){const h=e.zoom,p=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},E=s.zoom!==void 0,I=!e.isPaddingEqual(s.padding);let z=!1;const D=E?+s.zoom:e.zoom;let B=e.centerPoint.add(s.offsetAsPoint);const j=e.screenPointToLocation(B),{center:$,zoom:W}=e.getConstrained(l.S.convert(s.center||j),D??h);Bs(e,$);const re=ne(e.worldSize,j),se=ne(e.worldSize,$).sub(re),ae=l.af(W-h);return z=W!==h,{easeFunc:oe=>{if(z&&e.setZoom(l.C.number(h,W,oe)),l.be(y,S)||qn({startEulerAngles:y,endEulerAngles:S,tr:e,k:oe,useSlerp:y.roll!=S.roll}),I&&(e.interpolatePadding(p,s.padding,oe),B=e.centerPoint.add(s.offsetAsPoint)),s.around)e.setLocationAtPoint(s.around,s.aroundPoint);else{const de=l.af(e.zoom-h),le=W>h?Math.min(2,ae):Math.max(.5,ae),ge=Math.pow(le,1-oe),we=ue(e.worldSize,re.add(se.mult(oe*ge)).mult(de));e.setLocationAtPoint(e.renderWorldCopies?we.wrap():we,B)}},isZooming:z,elevationCenter:$}}handleFlyTo(e,s){const h=s.zoom!==void 0,p=e.zoom,y=e.getConstrained(l.S.convert(s.center||s.locationAtOffset),h?+s.zoom:p),S=y.center,E=y.zoom;Bs(e,S);const I=ne(e.worldSize,s.locationAtOffset),z=ne(e.worldSize,S).sub(I),D=z.mag(),B=l.af(E-p);let j;if(s.minZoom!==void 0){const $=Math.min(+s.minZoom,p,E),W=e.getConstrained(S,$).zoom;j=l.af(W-p)}return{easeFunc:($,W,re,se)=>{e.setZoom($===1?E:p+l.ak(W));const ae=$===1?S:ue(e.worldSize,I.add(z.mult(re)).mult(W));e.setLocationAtPoint(e.renderWorldCopies?ae.wrap():ae,se)},scaleOfZoom:B,targetCenter:S,scaleOfMinZoom:j,pixelPathLength:D}}}class on{constructor(e,s,h){this.blendFunction=e,this.blendColor=s,this.mask=h}}on.Replace=[1,0],on.disabled=new on(on.Replace,l.bf.transparent,[!1,!1,!1,!1]),on.unblended=new on(on.Replace,l.bf.transparent,[!0,!0,!0,!0]),on.alphaBlended=new on([1,771],l.bf.transparent,[!0,!0,!0,!0]);const ho=2305;class nr{constructor(e,s,h){this.enable=e,this.mode=s,this.frontFace=h}}nr.disabled=new nr(!1,1029,ho),nr.backCCW=new nr(!0,1029,ho),nr.frontCCW=new nr(!0,1028,ho);class ur{constructor(e,s,h){this.func=e,this.mask=s,this.range=h}}ur.ReadOnly=!1,ur.ReadWrite=!0,ur.disabled=new ur(519,ur.ReadOnly,[0,1]);const fs=7680;class Ir{constructor(e,s,h,p,y,S){this.test=e,this.ref=s,this.mask=h,this.fail=p,this.depthFail=y,this.pass=S}}Ir.disabled=new Ir({func:519,mask:0},0,0,fs,fs,fs);const bi=new WeakMap;function ha(g){var e;if(bi.has(g))return bi.get(g);{const s=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return bi.set(g,s),s}}class da{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const s=e.context,h=s.gl;this._texFormat=h.RGBA,this._texType=h.UNSIGNED_BYTE;const p=new l.aL;p.emplaceBack(-1,-1),p.emplaceBack(2,-1),p.emplaceBack(-1,2);const y=new l.aN;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Aa(s.createVertexBuffer(p,Ra.members),s.createIndexBuffer(y),l.aM.simpleSegment(0,0,p.length,y.length)),this._resultBuffer=new Uint8Array(4),s.activeTexture.set(h.TEXTURE1);const S=h.createTexture();h.bindTexture(h.TEXTURE_2D,S),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=s.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),ha(h)&&(this._pbo=h.createBuffer(),h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.bufferData(h.PIXEL_PACK_BUFFER,4,h.STREAM_READ),h.bindBuffer(h.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,s){const h=this._updateCount;return this._readbackQueue?h>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():h>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,s),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,s=e.gl;e.activeTexture.set(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,s){const h=this._cachedRenderContext.context,p=h.gl;if(this._bindFramebuffer(),h.viewport.set([0,0,this._texWidth,this._texHeight]),h.clear({color:l.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(h,p.TRIANGLES,ur.disabled,Ir.disabled,on.unblended,nr.disabled,((y,S)=>({u_input:y,u_output_expected:S}))(e,s),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ha(p)){p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.readBuffer(p.COLOR_ATTACHMENT0),p.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),p.bindBuffer(p.PIXEL_PACK_BUFFER,null);const y=p.fenceSync(p.SYNC_GPU_COMMANDS_COMPLETE,0);p.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ha(e)){const s=e.clientWaitSync(this._readbackQueue.sync,0,0);if(s===e.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(s===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=da._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let s=0;return s+=e[0]/256,s+=e[1]/65536,s+=e[2]/16777216,e[3]<127&&(s=-s),s/128}}const Tl=l.$/128;function Pl(g,e){const s=g.granularity!==void 0?Math.max(g.granularity,1):1,h=s+(g.generateBorders?2:0),p=s+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),y=h+1,S=p+1,E=g.generateBorders?-1:0,I=g.generateBorders||g.extendToNorthPole?-1:0,z=s+(g.generateBorders?1:0),D=s+(g.generateBorders||g.extendToSouthPole?1:0),B=y*S,j=h*p*6,$=y*S>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=$||e==="32bit",re=new Int16Array(2*B);let se=0;for(let de=I;de<=D;de++)for(let le=E;le<=z;le++){let ge=le/s*l.$;le===-1&&(ge=-Tl),le===s+1&&(ge=l.$+Tl);let we=de/s*l.$;de===-1&&(we=g.extendToNorthPole?l.bh:-Tl),de===s+1&&(we=g.extendToSouthPole?l.bi:l.$+Tl),re[se++]=ge,re[se++]=we}const ae=W?new Uint32Array(j):new Uint16Array(j);let oe=0;for(let de=0;de<p;de++)for(let le=0;le<h;le++){const ge=le+1+de*y,we=le+(de+1)*y,he=le+1+(de+1)*y;ae[oe++]=le+de*y,ae[oe++]=we,ae[oe++]=ge,ae[oe++]=ge,ae[oe++]=we,ae[oe++]=he}return{vertices:re.buffer.slice(0),indices:ae.buffer.slice(0),uses32bitIndices:W}}const fo=new l.aK({fill:new l.bj(128,2),line:new l.bj(512,0),tile:new l.bj(128,32),stencil:new l.bj(128,1),circle:3});class Cl{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Es.projectionGlobe}get vertexShaderPreludeCode(){return Es.projectionMercator.vertexSource}get subdivisionGranularity(){return fo}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new da(e));const s=l.U(this._errorQueryLatitudeDegrees),h=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,p=this._errorMeasurement.updateErrorLoop(s,h),y=ee.now();p!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=p,this._errorMeasurementLastChangeTime=y);const S=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bl(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,s,h,p,y){const S=(y==="stencil"?fo.stencil:fo.tile).getGranularityForZoomLevel(s.z);return this._getMesh(e,{granularity:S,generateBorders:h,extendToNorthPole:s.y===0&&p,extendToSouthPole:s.y===(1<<s.z)-1&&p})}_getMesh(e,s){const h=this._getMeshKey(s);if(h in this._tileMeshCache)return this._tileMeshCache[h];const p=(function(y,S){const E=Pl(S,"16bit"),I=l.aL.deserialize({arrayBuffer:E.vertices,length:E.vertices.byteLength/2/2}),z=l.aN.deserialize({arrayBuffer:E.indices,length:E.indices.byteLength/2/3});return new Aa(y.createVertexBuffer(I,Ra.members),y.createIndexBuffer(z),l.aM.simpleSegment(0,0,I.length,z.length))})(e,s);return this._tileMeshCache[h]=p,p}recalculate(e){}hasTransition(){const e=ee.now();let s=!1;return s=s||(e-this._errorMeasurementLastChangeTime)/1e3<.7,s=s||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,s}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Us=new l.r({type:new l.D(l.v.projection.type)});class kl extends l.E{constructor(e){super(),this._transitionable=new l.t(Us),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0)),this._mercatorProjection=new Pr,this._verticalPerspectiveProjection=new Cl}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof l.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,s,h,p,y){return this.currentProjection.getMeshFromTileID(e,s,h,p,y)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function $o(g){const e=za(g.worldSize,g.center.lat);return 2*Math.PI*e}function Is(g,e,s,h,p){const y=1/(1<<p),S=e/l.$*y+h*y,E=l.bo((g/l.$*y+s*y)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,z=Math.cos(I),D=new Float64Array(3);return D[0]=Math.sin(E)*z,D[1]=Math.sin(I),D[2]=Math.cos(E)*z,D}function Rn(g){return(function(e,s){const h=Math.cos(s),p=new Float64Array(3);return p[0]=Math.sin(e)*h,p[1]=Math.sin(s),p[2]=Math.cos(e)*h,p})(g.lng*Math.PI/180,g.lat*Math.PI/180)}function za(g,e){return g/(2*Math.PI)/Math.cos(e*Math.PI/180)}function El(g){const e=Math.asin(g[1])/Math.PI*180,s=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(s>1e-6){const h=g[0]/s,p=Math.acos(g[2]/s),y=(h>0?p:-p)/Math.PI*180;return new l.S(l.aO(y,-180,180),e)}return new l.S(0,e)}function Wn(g){return Math.cos(g*Math.PI/180)}function pn(g,e){const s=Wn(g),h=Wn(e);return l.ak(h/s)}function _u(g,e){const s=g.rotate(e.bearingInRadians),h=e.zoom+pn(e.center.lat,0),p=l.bk(1/Wn(e.center.lat),1/Wn(Math.min(Math.abs(e.center.lat),60)),l.bn(h,7,3,0,1)),y=360/$o({worldSize:e.worldSize,center:{lat:e.center.lat}});return new l.S(e.center.lng-s.x*y*p,l.ah(e.center.lat+s.y*y,-l.ai,l.ai))}function Da(g){const e=.5*g,s=Math.sin(e),h=Math.cos(e);return Math.log(s+h)-Math.log(h-s)}function bh(g,e,s,h){const p=g.lat+s*h;if(Math.abs(s)>1){const y=(Math.sign(g.lat+s)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,S=Math.abs(g.lat+s)*Math.PI/180,E=Da(y+h*(S-y)),I=Da(y),z=Da(S);return new l.S(g.lng+e*((E-I)/(z-I)),p)}return new l.S(g.lng+e*h,p)}class wh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,s,h,p){const y=`${e.z}_${e.x}_${e.y}_${p!=null&&p.terrain?"t":""}`,S=this._cache.get(y);if(S)return S;const E=this._cachePrevious.get(y);if(E)return this._cache.set(y,E),E;const I=this._boundingVolumeFactory(e,s,h,p);return this._cache.set(y,I),this._hadAnyChanges=!0,I}}class po{constructor(e,s,h,p){this.min=h,this.max=p,this.points=e,this.planes=s}static fromAabb(e,s){const h=[];for(let p=0;p<8;p++)h.push([1&~p?e[0]:s[0],(p>>1&1)==1?s[1]:e[1],(p>>2&1)==1?s[2]:e[2]]);return new po(h,[[-1,0,0,s[0]],[1,0,0,-e[0]],[0,-1,0,s[1]],[0,1,0,-e[1]],[0,0,-1,s[2]],[0,0,1,-e[2]]],e,s)}static fromCenterSizeAngles(e,s,h){const p=l.br([],h[0],h[1],h[2]),y=l.bs([],[s[0],0,0],p),S=l.bs([],[0,s[1],0],p),E=l.bs([],[0,0,s[2]],p),I=[...e],z=[...e];for(let B=0;B<8;B++)for(let j=0;j<3;j++){const $=e[j]+y[j]*(1&~B?-1:1)+S[j]*((B>>1&1)==1?1:-1)+E[j]*((B>>2&1)==1?1:-1);I[j]=Math.min(I[j],$),z[j]=Math.max(z[j],$)}const D=[];for(let B=0;B<8;B++){const j=[...e];l.aS(j,j,l.aR([],y,1&~B?-1:1)),l.aS(j,j,l.aR([],S,(B>>1&1)==1?1:-1)),l.aS(j,j,l.aR([],E,(B>>2&1)==1?1:-1)),D.push(j)}return new po(D,[[...y,-l.aX(y,D[0])],[...S,-l.aX(S,D[0])],[...E,-l.aX(E,D[0])],[-y[0],-y[1],-y[2],-l.aX(y,D[7])],[-S[0],-S[1],-S[2],-l.aX(S,D[7])],[-E[0],-E[1],-E[2],-l.aX(E,D[7])]],I,z)}intersectsFrustum(e){let s=!0;const h=this.points.length,p=this.planes.length,y=e.planes.length,S=e.points.length;for(let E=0;E<y;E++){const I=e.planes[E];let z=0;for(let D=0;D<h;D++){const B=this.points[D];I[0]*B[0]+I[1]*B[1]+I[2]*B[2]+I[3]>=0&&z++}if(z===0)return 0;z<h&&(s=!1)}if(s)return 2;for(let E=0;E<p;E++){const I=this.planes[E];let z=0;for(let D=0;D<S;D++){const B=e.points[D];I[0]*B[0]+I[1]*B[1]+I[2]*B[2]+I[3]>=0&&z++}if(z===0)return 0}return 1}intersectsPlane(e){const s=this.points.length;let h=0;for(let p=0;p<s;p++){const y=this.points[p];e[0]*y[0]+e[1]*y[1]+e[2]*y[2]+e[3]>=0&&h++}return h===s?2:h===0?0:1}}function zn(g,e,s){const h=g-e;return h<0?-h:Math.max(0,h-s)}function mo(g,e,s,h,p){const y=g-s;let S;return S=y<0?Math.min(-y,1+y-p):y>1?Math.min(Math.max(y-p,0),1-y):0,Math.max(S,zn(e,h,p))}class Vs{constructor(){this._boundingVolumeCache=new wh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,s,h,p){const y=1<<h.z,S=1/y,E=h.x/y,I=h.y/y;let z=2;return z=Math.min(z,mo(e,s,E,I,S)),z=Math.min(z,mo(e,s,E+.5,-I-S,S)),z=Math.min(z,mo(e,s,E+.5,2-I-S,S)),z}getWrap(e,s,h){const p=1<<s.z,y=1/p,S=s.x/p,E=zn(e.x,S,y),I=zn(e.x,S-1,y),z=zn(e.x,S+1,y),D=Math.min(E,I,z);return D===z?1:D===I?-1:0}allowVariableZoom(e,s){return zt(e,s)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,s,h,p){return this._boundingVolumeCache.getTileBoundingVolume(e,s,h,p)}_computeTileBoundingVolume(e,s,h,p){var y,S;let E=0,I=0;if(p!=null&&p.terrain){const z=new l.Z(e.z,s,e.z,e.x,e.y),D=p.terrain.getMinMaxElevation(z);E=(y=D.minElevation)!==null&&y!==void 0?y:Math.min(0,h),I=(S=D.maxElevation)!==null&&S!==void 0?S:Math.max(0,h)}if(E/=l.bu,I/=l.bu,E+=1,I+=1,e.z<=0)return po.fromAabb([-I,-I,-I],[I,I,I]);if(e.z===1)return po.fromAabb([e.x===0?-I:0,e.y===0?0:-I,-I],[e.x===0?0:I,e.y===0?I:0,I]);{const z=[Is(0,0,e.x,e.y,e.z),Is(l.$,0,e.x,e.y,e.z),Is(l.$,l.$,e.x,e.y,e.z),Is(0,l.$,e.x,e.y,e.z)],D=[];for(const Ne of z)D.push(l.aR([],Ne,I));if(I!==E)for(const Ne of z)D.push(l.aR([],Ne,E));e.y===0&&D.push([0,1,0]),e.y===(1<<e.z)-1&&D.push([0,-1,0]);const B=[1,1,1],j=[-1,-1,-1];for(const Ne of D)for(let Ze=0;Ze<3;Ze++)B[Ze]=Math.min(B[Ze],Ne[Ze]),j[Ze]=Math.max(j[Ze],Ne[Ze]);const $=Is(l.$/2,l.$/2,e.x,e.y,e.z),W=l.aW([],[0,1,0],$);l.aV(W,W);const re=l.aW([],$,W);l.aV(re,re);const se=l.aW([],z[2],z[1]);l.aV(se,se);const ae=l.aW([],z[0],z[3]);l.aV(ae,ae),D.push(l.aR([],$,I)),e.y>=(1<<e.z)/2&&D.push(l.aR([],Is(l.$/2,0,e.x,e.y,e.z),I)),e.y<(1<<e.z)/2&&D.push(l.aR([],Is(l.$/2,l.$,e.x,e.y,e.z),I));const oe=_c($,D),de=_c(re,D),le=[-$[0],-$[1],-$[2],oe.max],ge=[$[0],$[1],$[2],-oe.min],we=[-re[0],-re[1],-re[2],de.max],he=[re[0],re[1],re[2],-de.min],ke=[...se,0],$e=[...ae,0],je=[];return e.y===0?je.push(l.bt($e,ke,le),l.bt($e,ke,ge)):je.push(l.bt(we,ke,le),l.bt(we,ke,ge),l.bt(we,$e,le),l.bt(we,$e,ge)),e.y===(1<<e.z)-1?je.push(l.bt($e,ke,le),l.bt($e,ke,ge)):je.push(l.bt(he,ke,le),l.bt(he,ke,ge),l.bt(he,$e,le),l.bt(he,$e,ge)),new po(je,[le,ge,we,he,ke,$e],B,j)}}}function _c(g,e){let s=1/0,h=-1/0;for(const p of e){const y=l.aX(g,p);s=Math.min(s,y),h=Math.max(h,y)}return{min:s,max:h}}class vc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,h){return this._helper.interpolatePadding(e,s,h)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s){this._helper.resize(e,s)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=l.bv(),this._projectionMatrix=l.b9(),this._globeViewProjMatrix32f=l.b8(),this._globeViewProjMatrixNoCorrection=l.b9(),this._globeViewProjMatrixNoCorrectionInverted=l.b9(),this._globeProjMatrixInverted=l.b9(),this._cameraPosition=l.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._coveringTilesDetailsProvider=new Vs}clone(){const e=new vc;return e.apply(this),e}apply(e,s){this._globeLatitudeErrorCorrectionRadians=s||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=l.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:s,applyGlobeMatrix:h}=e,p=this._helper.getMercatorTileCoordinates(s);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:p,clippingPlane:this._cachedClippingPlane,projectionTransition:h?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const s=this.pitchInRadians,h=this.cameraToCenterDistance/e,p=Math.sin(s)*h,y=Math.cos(s)*h+1,S=1/Math.sqrt(p*p+y*y)*1;let E=-p,I=y;const z=Math.sqrt(E*E+I*I);E/=z,I/=z;const D=[0,E,I];l.bw(D,D,[0,0,0],-this.bearingInRadians),l.bx(D,D,[0,0,0],-1*this.center.lat*Math.PI/180),l.by(D,D,[0,0,0],this.center.lng*Math.PI/180);const B=1/l.aZ(D);return l.aR(D,D,B),[...D,-S*B]}isLocationOccluded(e){return!this.isSurfacePointVisible(Rn(e))}transformLightDirection(e){const s=this._helper._center.lng*Math.PI/180,h=this._helper._center.lat*Math.PI/180,p=Math.cos(h),y=[Math.sin(s)*p,Math.sin(h),Math.cos(s)*p],S=[y[2],0,-y[0]],E=[0,0,0];l.aW(E,S,y),l.aV(S,S),l.aV(E,E);const I=[0,0,0];return l.aV(I,[S[0]*e[0]+E[0]*e[1]+y[0]*e[2],S[1]*e[0]+E[1]*e[1]+y[1]*e[2],S[2]*e[0]+E[2]*e[1]+y[2]*e[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,s,h){const p=(function(E,I,z){const D=1/(1<<z.z);return new l.a1(E/l.$*D+z.x*D,I/l.$*D+z.y*D)})(e,s,h.canonical),y=(S=p.y,[l.bo(p.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(e,s,h,p){const y=h.canonical,S=Is(e,s,y.x,y.y,y.z),E=1+(p?p(e,s):0)/l.bu,I=[S[0]*E,S[1]*E,S[2]*E,1];l.aw(I,I,this._globeViewProjMatrixNoCorrection);const z=this._cachedClippingPlane,D=z[0]*S[0]+z[1]*S[1]+z[2]*S[2]+z[3]<0;return{point:new l.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:D}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=za(this.worldSize,this.center.lat),s=l.ba(),h=l.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),l.b4(s,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const p=this.centerOffset;s[8]=2*-p.x/this._helper._width,s[9]=2*p.y/this._helper._height,this._projectionMatrix=l.b5(s),this._globeProjMatrixInverted=l.ba(),l.aq(this._globeProjMatrixInverted,s),l.M(s,s,[0,0,-this.cameraToCenterDistance]),l.b6(s,s,this.rollInRadians),l.b7(s,s,-this.pitchInRadians),l.b6(s,s,this.bearingInRadians),l.M(s,s,[0,0,-e]);const y=l.bp();y[0]=e,y[1]=e,y[2]=e,l.b7(h,s,this.center.lat*Math.PI/180),l.bz(h,h,-this.center.lng*Math.PI/180),l.N(h,h,y),this._globeViewProjMatrixNoCorrection=h,l.b7(s,s,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bz(s,s,-this.center.lng*Math.PI/180),l.N(s,s,y),this._globeViewProjMatrix32f=new Float32Array(s),this._globeViewProjMatrixNoCorrectionInverted=l.ba(),l.aq(this._globeViewProjMatrixNoCorrectionInverted,h);const S=l.bp();this._cameraPosition=l.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,l.bw(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),l.bx(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),l.bw(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),l.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bx(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),l.by(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const E=l.b5(this._globeViewProjMatrixNoCorrectionInverted);l.N(E,E,[1,1,-1]),this._cachedFrustum=fn.fromInvProjectionMatrix(E,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){l.w("calculateFogMatrix is not supported on globe projection.");const s=l.ba();return l.ag(s),s}getVisibleUnwrappedCoordinates(e){return[new l.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){if(!this._globeViewProjMatrixNoCorrection)return 1;const h=Rn(e);l.aR(h,h,1+s/l.bu);const p=l.bv();return l.aw(p,[h[0],h[1],h[2],1],this._globeViewProjMatrixNoCorrection),p[2]/p[3]}populateCache(e){}getBounds(){const e=.5*this.width,s=.5*this.height,h=[new l.P(0,0),new l.P(e,0),new l.P(this.width,0),new l.P(this.width,s),new l.P(this.width,this.height),new l.P(e,this.height),new l.P(0,this.height),new l.P(0,s)],p=[];for(const B of h)p.push(this.unprojectScreenPoint(B));let y=0,S=0,E=0,I=0;const z=this.center;for(const B of p){const j=l.bA(z.lng,B.lng),$=l.bA(z.lat,B.lat);j<S&&(S=j),j>y&&(y=j),$<I&&(I=$),$>E&&(E=$)}const D=[z.lng+S,z.lat+I,z.lng+y,z.lat+E];return this.isSurfacePointOnScreen([0,1,0])&&(D[3]=90,D[0]=-180,D[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(D[1]=-90,D[0]=-180,D[2]=180),new Vr(D)}getConstrained(e,s){const h=l.ah(e.lat,-l.ai,l.ai),p=l.ah(+s,this.minZoom+pn(0,h),this.maxZoom);return{center:new l.S(e.lng,h),zoom:p}}calculateCenterFromCameraLngLatAlt(e,s,h,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,h,p)}setLocationAtPoint(e,s){const h=Rn(this.unprojectScreenPoint(s)),p=Rn(e),y=l.bp();l.bB(y);const S=l.bp();l.by(S,h,y,-this.center.lng*Math.PI/180),l.bx(S,S,y,this.center.lat*Math.PI/180);const E=p[0]*p[0]+p[2]*p[2],I=S[0]*S[0];if(E<I)return;const z=Math.sqrt(E-I),D=-z,B=l.bC(p[0],p[2],S[0],z),j=l.bC(p[0],p[2],S[0],D),$=l.bp();l.by($,p,y,-B);const W=l.bC($[1],$[2],S[1],S[2]),re=l.bp();l.by(re,p,y,-j);const se=l.bC(re[1],re[2],S[1],S[2]),ae=.5*Math.PI,oe=W>=-ae&&W<=ae,de=se>=-ae&&se<=ae;let le,ge;if(oe&&de){const $e=this.center.lng*Math.PI/180,je=this.center.lat*Math.PI/180;l.bD(B,$e)+l.bD(W,je)<l.bD(j,$e)+l.bD(se,je)?(le=B,ge=W):(le=j,ge=se)}else if(oe)le=B,ge=W;else{if(!de)return;le=j,ge=se}const we=le/Math.PI*180,he=ge/Math.PI*180,ke=this.center.lat;this.setCenter(new l.S(we,l.ah(he,-90,90))),this.setZoom(this.zoom+pn(ke,this.center.lat))}locationToScreenPoint(e,s){const h=Rn(e);if(s){const p=s.getElevationForLngLatZoom(e,this._helper._tileZoom);l.aR(h,h,1+p/l.bu)}return this._projectSurfacePointToScreen(h)}_projectSurfacePointToScreen(e){const s=l.bv();return l.aw(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],new l.P((.5*s[0]+.5)*this.width,(.5*-s[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,s){if(s){const h=s.pointCoordinate(e);if(h)return h}return l.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,s){var h;return(h=this.screenPointToMercatorCoordinate(e,s))===null||h===void 0?void 0:h.toLngLat()}isPointOnMapSurface(e,s){const h=this._cameraPosition,p=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(h,p)}getRayDirectionFromPixel(e){const s=l.bv();s[0]=e.x/this.width*2-1,s[1]=-1*(e.y/this.height*2-1),s[2]=1,s[3]=1,l.aw(s,s,this._globeViewProjMatrixNoCorrectionInverted),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3];const h=l.bp();h[0]=s[0]-this._cameraPosition[0],h[1]=s[1]-this._cameraPosition[1],h[2]=s[2]-this._cameraPosition[2];const p=l.bp();return l.aV(p,h),p}isSurfacePointVisible(e){const s=this._cachedClippingPlane;return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]+s[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const s=l.bv();return l.aw(s,[...e,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3],s[0]>-1&&s[0]<1&&s[1]>-1&&s[1]<1&&s[2]>-1&&s[2]<1}rayPlanetIntersection(e,s){const h=l.aX(e,s),p=l.bp(),y=l.bp();l.aR(y,s,h),l.aU(p,e,y);const S=1-l.aX(p,p);if(S<0)return null;const E=l.aX(e,e)-1,I=-h+(h<0?1:-1)*Math.sqrt(S),z=E/I,D=I;return{tMin:Math.min(z,D),tMax:Math.max(z,D)}}unprojectScreenPoint(e){const s=this._cameraPosition,h=this.getRayDirectionFromPixel(e),p=this.rayPlanetIntersection(s,h);if(p){const D=l.bp();l.aS(D,s,[h[0]*p.tMin,h[1]*p.tMin,h[2]*p.tMin]);const B=l.bp();return l.aV(B,D),El(B)}const y=this._cachedClippingPlane,S=y[0]*h[0]+y[1]*h[1]+y[2]*h[2],E=-l.b1(y,s)/S,I=l.bp();if(E>0)l.aS(I,s,[h[0]*E,h[1]*E,h[2]*E]);else{const D=l.bp();l.aS(D,s,[2*h[0],2*h[1],2*h[2]]);const B=l.b1(this._cachedClippingPlane,D);l.aU(I,D,[this._cachedClippingPlane[0]*B,this._cachedClippingPlane[1]*B,this._cachedClippingPlane[2]*B])}const z=(function(D){const B=l.bp();return B[0]=D[0]*-D[3],B[1]=D[1]*-D[3],B[2]=D[2]*-D[3],{center:B,radius:Math.sqrt(1-D[3]*D[3])}})(y);return El((function(D,B,j){const $=l.bp();l.aU($,j,D);const W=l.bp();return l.bq(W,D,$,B/l.a$($)),W})(z.center,z.radius,I))}getMatrixForModel(e,s){const h=l.S.convert(e),p=1/l.bu,y=l.b9();return l.bz(y,y,h.lng/180*Math.PI),l.b7(y,y,-h.lat/180*Math.PI),l.M(y,y,[0,0,1+s/l.bu]),l.b7(y,y,.5*Math.PI),l.N(y,y,[p,p,p]),y}getProjectionDataForCustomLayer(e=!0){const s=this.getProjectionData({overscaledTileID:new l.Z(0,0,0,0,0),applyGlobeMatrix:e});return s.tileMercatorCoords=[0,0,1,1],s}getFastPathSimpleProjectionMatrix(e){}}class xc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,s,h){return this._helper.interpolatePadding(e,s,h)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,s,h=!0){this._helper.resize(e,s,h)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,s){this._helper.overrideNearFarZ(e,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,s){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=s,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,s)=>this.getConstrained(e,s)}),this._globeness=1,this._mercatorTransform=new cn,this._verticalPerspectiveTransform=new vc}clone(){const e=new xc;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const s=this._mercatorTransform.getProjectionData(e),h=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?h.mainMatrix:s.mainMatrix,clippingPlane:h.clippingPlane,tileMercatorCoords:h.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:s.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return l.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,s,h){const p=this._mercatorTransform.getPitchedTextCorrection(e,s,h),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,s,h);return l.bk(p,y,this._globeness)}projectTileCoordinates(e,s,h,p){return this.currentTransform.projectTileCoordinates(e,s,h,p)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,s){return this.currentTransform.lngLatToCameraDepth(e,s)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,s){return this.currentTransform.getConstrained(e,s)}calculateCenterFromCameraLngLatAlt(e,s,h,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,s,h,p)}setLocationAtPoint(e,s){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,s),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,s),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,s){return this.currentTransform.locationToScreenPoint(e,s)}screenPointToMercatorCoordinate(e,s){return this.currentTransform.screenPointToMercatorCoordinate(e,s)}screenPointToLocation(e,s){return this.currentTransform.screenPointToLocation(e,s)}isPointOnMapSurface(e,s){return this.currentTransform.isPointOnMapSurface(e,s)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,s){return this.currentTransform.getMatrixForModel(e,s)}getProjectionDataForCustomLayer(e=!0){const s=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return s;const h=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return h.fallbackMatrix=s.mainMatrix,h}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class ni{get useGlobeControls(){return!0}handlePanInertia(e,s){const h=_u(e,s);return Math.abs(h.lng-s.center.lng)>180&&(h.lng=s.center.lng+179.5*Math.sign(h.lng-s.center.lng)),{easingCenter:h,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,s){const h=e.around,p=s.screenPointToLocation(h);e.bearingDelta&&s.setBearing(s.bearing+e.bearingDelta),e.pitchDelta&&s.setPitch(s.pitch+e.pitchDelta),e.rollDelta&&s.setRoll(s.roll+e.rollDelta);const y=s.zoom;e.zoomDelta&&s.setZoom(s.zoom+e.zoomDelta);const S=s.zoom-y;if(S===0)return;const E=l.bA(s.center.lng,p.lng),I=E/(Math.abs(E/180)+1),z=l.bA(s.center.lat,p.lat),D=s.getRayDirectionFromPixel(h),B=s.cameraPosition,j=-1*l.aX(B,D),$=l.bp();l.aS($,B,[D[0]*j,D[1]*j,D[2]*j]);const W=l.aZ($)-1,re=Math.exp(.5*-Math.max(W-.3,0)),se=za(s.worldSize,s.center.lat)/Math.min(s.width,s.height),ae=l.bn(se,.9,.5,1,.25),oe=(1-l.af(-S))*Math.min(re,ae),de=s.center.lat,le=s.zoom,ge=new l.S(s.center.lng+I*oe,l.ah(s.center.lat+z*oe,-l.ai,l.ai));s.setLocationAtPoint(p,h);const we=s.center,he=l.bn(Math.abs(E),45,85,0,1),ke=l.bn(se,.75,.35,0,1),$e=Math.pow(Math.max(he,ke),.25),je=l.bA(we.lng,ge.lng),Ne=l.bA(we.lat,ge.lat);s.setCenter(new l.S(we.lng+je*$e,we.lat+Ne*$e).wrap()),s.setZoom(le+pn(de,s.center.lat))}handleMapControlsPan(e,s,h){if(!e.panDelta)return;const p=s.center.lat,y=s.zoom;s.setCenter(_u(e.panDelta,s).wrap()),s.setZoom(y+pn(p,s.center.lat))}cameraForBoxAndBearing(e,s,h,p,y){const S=ds(e,s,h,p,y),E=s.left/y.width*2-1,I=(y.width-s.right)/y.width*2-1,z=s.top/y.height*-2+1,D=(y.height-s.bottom)/y.height*-2+1,B=l.bA(h.getWest(),h.getEast())<0,j=B?h.getEast():h.getWest(),$=B?h.getWest():h.getEast(),W=Math.max(h.getNorth(),h.getSouth()),re=Math.min(h.getNorth(),h.getSouth()),se=j+.5*l.bA(j,$),ae=W+.5*l.bA(W,re),oe=y.clone();oe.setCenter(S.center),oe.setBearing(S.bearing),oe.setPitch(0),oe.setRoll(0),oe.setZoom(S.zoom);const de=oe.modelViewProjectionMatrix,le=[Rn(h.getNorthWest()),Rn(h.getNorthEast()),Rn(h.getSouthWest()),Rn(h.getSouthEast()),Rn(new l.S($,ae)),Rn(new l.S(j,ae)),Rn(new l.S(se,W)),Rn(new l.S(se,re))],ge=Rn(S.center);let we=Number.POSITIVE_INFINITY;for(const he of le)E<0&&(we=ni.getLesserNonNegativeNonNull(we,ni.solveVectorScale(he,ge,de,"x",E))),I>0&&(we=ni.getLesserNonNegativeNonNull(we,ni.solveVectorScale(he,ge,de,"x",I))),z>0&&(we=ni.getLesserNonNegativeNonNull(we,ni.solveVectorScale(he,ge,de,"y",z))),D<0&&(we=ni.getLesserNonNegativeNonNull(we,ni.solveVectorScale(he,ge,de,"y",D)));if(Number.isFinite(we)&&we!==0)return S.zoom=oe.zoom+l.ak(we),S;xh()}handleJumpToCenterZoom(e,s){const h=e.center.lat,p=e.getConstrained(s.center?l.S.convert(s.center):e.center,e.zoom).center;e.setCenter(p.wrap());const y=s.zoom!==void 0?+s.zoom:e.zoom+pn(h,p.lat);e.zoom!==y&&e.setZoom(y)}handleEaseTo(e,s){const h=e.zoom,p=e.center,y=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},E={roll:s.roll===void 0?e.roll:s.roll,pitch:s.pitch===void 0?e.pitch:s.pitch,bearing:s.bearing===void 0?e.bearing:s.bearing},I=s.zoom!==void 0,z=!e.isPaddingEqual(s.padding);let D=!1;const B=s.center?l.S.convert(s.center):p,j=e.getConstrained(B,h).center;Bs(e,j);const $=e.clone();$.setCenter(j),$.setZoom(I?+s.zoom:h+pn(p.lat,B.lat)),$.setBearing(s.bearing);const W=new l.P(l.ah(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),l.ah(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(j,W);const re=(s.offset&&s.offsetAsPoint.mag())>0?$.center:j,se=I?+s.zoom:h+pn(p.lat,re.lat),ae=h+pn(p.lat,0),oe=se+pn(re.lat,0),de=l.bA(p.lng,re.lng),le=l.bA(p.lat,re.lat),ge=l.af(oe-ae);return D=se!==h,{easeFunc:we=>{if(l.be(S,E)||qn({startEulerAngles:S,endEulerAngles:E,tr:e,k:we,useSlerp:S.roll!=E.roll}),z&&e.interpolatePadding(y,s.padding,we),s.around)l.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(s.around,s.aroundPoint);else{const he=oe>ae?Math.min(2,ge):Math.max(.5,ge),ke=Math.pow(he,1-we),$e=bh(p,de,le,we*ke);e.setCenter($e.wrap())}if(D){const he=l.C.number(ae,oe,we)+pn(0,e.center.lat);e.setZoom(he)}},isZooming:D,elevationCenter:re}}handleFlyTo(e,s){const h=s.zoom!==void 0,p=e.center,y=e.zoom,S=e.padding,E=!e.isPaddingEqual(s.padding),I=e.getConstrained(l.S.convert(s.center||s.locationAtOffset),y).center,z=h?+s.zoom:e.zoom+pn(e.center.lat,I.lat),D=e.clone();D.setCenter(I),D.setZoom(z),D.setBearing(s.bearing);const B=new l.P(l.ah(e.centerPoint.x+s.offsetAsPoint.x,0,e.width),l.ah(e.centerPoint.y+s.offsetAsPoint.y,0,e.height));D.setLocationAtPoint(I,B);const j=D.center;Bs(e,j);const $=(function(le,ge,we){const he=Rn(ge),ke=Rn(we),$e=l.aX(he,ke),je=Math.acos($e),Ne=$o(le);return je/(2*Math.PI)*Ne})(e,p,j),W=y+pn(p.lat,0),re=z+pn(j.lat,0),se=l.af(re-W);let ae;if(typeof s.minZoom=="number"){const le=+s.minZoom+pn(j.lat,0),ge=Math.min(le,W,re)+pn(0,j.lat),we=e.getConstrained(j,ge).zoom+pn(j.lat,0);ae=l.af(we-W)}const oe=l.bA(p.lng,j.lng),de=l.bA(p.lat,j.lat);return{easeFunc:(le,ge,we,he)=>{const ke=bh(p,oe,de,we);E&&e.interpolatePadding(S,s.padding,le);const $e=le===1?j:ke;e.setCenter($e.wrap());const je=W+l.ak(ge);e.setZoom(le===1?z:je+pn(0,$e.lat))},scaleOfZoom:se,targetCenter:j,scaleOfMinZoom:ae,pixelPathLength:$}}static solveVectorScale(e,s,h,p,y){const S=p==="x"?[h[0],h[4],h[8],h[12]]:[h[1],h[5],h[9],h[13]],E=[h[3],h[7],h[11],h[15]],I=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],z=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],D=s[0]*S[0]+s[1]*S[1]+s[2]*S[2],B=s[0]*E[0]+s[1]*E[1]+s[2]*E[2];return D+y*z===I+y*B||E[3]*(I-D)+S[3]*(B-z)+I*B==D*z?null:(D+S[3]-y*B-y*E[3])/(D-I-y*B+y*z)}static getLesserNonNegativeNonNull(e,s){return s!==null&&s>=0&&s<e?s:e}}class qd{constructor(e){this._globe=e,this._mercatorCameraHelper=new hi,this._verticalPerspectiveCameraHelper=new ni}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,s){return this.currentHelper.handlePanInertia(e,s)}handleMapControlsRollPitchBearingZoom(e,s){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,s)}handleMapControlsPan(e,s,h){this.currentHelper.handleMapControlsPan(e,s,h)}cameraForBoxAndBearing(e,s,h,p,y){return this.currentHelper.cameraForBoxAndBearing(e,s,h,p,y)}handleJumpToCenterZoom(e,s){this.currentHelper.handleJumpToCenterZoom(e,s)}handleEaseTo(e,s){return this.currentHelper.handleEaseTo(e,s)}handleFlyTo(e,s){return this.currentHelper.handleFlyTo(e,s)}}const vu=(g,e)=>l.y(g,e&&e.filter((s=>s.identifier!=="source.canvas"))),Jf=l.bE();class Sh extends l.E{constructor(e,s={}){var h,p;super(),this._rtlPluginLoaded=()=>{for(const S in this.sourceCaches){const E=this.sourceCaches[S].getSource().type;E!=="vector"&&E!=="geojson"||this.sourceCaches[S].reload()}},this.map=e,this.dispatcher=new Kt(fr(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((S,E)=>this.getGlyphs(S,E))),this.dispatcher.registerMessageHandler("GI",((S,E)=>this.getImages(S,E))),this.imageManager=new Je,this.imageManager.setEventedParent(this);const y=((h=e._container)===null||h===void 0?void 0:h.lang)||typeof document<"u"&&((p=document.documentElement)===null||p===void 0?void 0:p.lang)||void 0;this.glyphManager=new Mt(e._requestManager,s.localIdeographFontFamily,y),this.lineAtlas=new ft(256,512),this.crossTileSymbolIndex=new co,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",l.bG()),_r().on(vt,this._rtlPluginLoaded),this.on("data",(S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const E=this.sourceCaches[S.sourceId];if(!E)return;const I=E.getSource();if(I&&I.vectorLayerIds)for(const z in this._layers){const D=this._layers[z];D.source===I.id&&this._validateLayer(D)}}))}setGlobalStateProperty(e,s){var h,p,y;this._checkLoaded();const S=s===null?(y=(p=(h=this.stylesheet.state)===null||h===void 0?void 0:h[e])===null||p===void 0?void 0:p.default)!==null&&y!==void 0?y:null:s;if(l.bH(S,this._globalState[e]))return this;this._globalState[e]=S,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const s=[];for(const h in e)!l.bH(this._globalState[h],e[h].default)&&(s.push(h),this._globalState[h]=e[h].default);this._applyGlobalStateChanges(s)}_applyGlobalStateChanges(e){if(e.length===0)return;const s=new Set;for(const h in this._layers){const p=this._layers[h],y=p.getLayoutAffectingGlobalStateRefs(),S=p.getPaintAffectingGlobalStateRefs();for(const E of e)if(y.has(E)&&s.add(p.source),S.has(E))for(const{name:I,value:z}of S.get(E))this._updatePaintProperty(p,I,z)}for(const h in this.sourceCaches)s.has(h)&&(this._reloadSource(h),this._changed=!0)}loadURL(e,s={},h){this.fire(new l.l("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const p=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;l.j(p,this._loadStyleRequest).then((S=>{this._loadStyleRequest=null,this._load(S.data,s,h)})).catch((S=>{this._loadStyleRequest=null,S&&!y.signal.aborted&&this.fire(new l.k(S))}))}loadJSON(e,s={},h){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ee.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,h)})).catch((()=>{}))}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(Jf,{validate:!1})}_load(e,s,h){var p,y;let S=s.transformStyle?s.transformStyle(h,e):e;if(!s.validate||!vu(this,l.z(S))){S=Object.assign({},S),this._loaded=!0,this.stylesheet=S;for(const E in S.sources)this.addSource(E,S.sources[E],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new or(this.stylesheet.light),this._setProjectionInternal(((p=this.stylesheet.projection)===null||p===void 0?void 0:p.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var e;const s=l.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",s),this._order=s.map((h=>h.id)),this._layers={},this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this._serializedLayers=null;for(const h of s){const p=l.bJ(h);p.setEventedParent(this,{layer:{id:h.id}}),p.setGlobalState(this._globalState),this._layers[h.id]=p}}_loadSprite(e,s=!1,h=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(y,S,E,I){return l._(this,void 0,void 0,(function*(){const z=ot(y),D=E>1?"@2x":"",B={},j={};for(const{id:$,url:W}of z){const re=S.transformRequest(lt(W,D,".json"),"SpriteJSON");B[$]=l.j(re,I);const se=S.transformRequest(lt(W,D,".png"),"SpriteImage");j[$]=De.getImage(se,I)}return yield Promise.all([...Object.values(B),...Object.values(j)]),(function($,W){return l._(this,void 0,void 0,(function*(){const re={};for(const se in $){re[se]={};const ae=ee.getImageCanvasContext((yield W[se]).data),oe=(yield $[se]).data;for(const de in oe){const{width:le,height:ge,x:we,y:he,sdf:ke,pixelRatio:$e,stretchX:je,stretchY:Ne,content:Ze,textFitWidth:ht,textFitHeight:mt}=oe[de];re[se][de]={data:null,pixelRatio:$e,sdf:ke,stretchX:je,stretchY:Ne,content:Ze,textFitWidth:ht,textFitHeight:mt,spriteData:{width:le,height:ge,x:we,y:he,context:ae}}}}return re}))})(B,j)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((y=>{if(this._spriteRequest=null,y)for(const S in y){this._spritesImagesIds[S]=[];const E=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter((I=>!(I in y))):[];for(const I of E)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in y[S]){const z=S==="default"?I:`${S}:${I}`;this._spritesImagesIds[S].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,y[S][I],!1):this.imageManager.addImage(z,y[S][I]),s&&(this._changedImages[z]=!0)}}})).catch((y=>{this._spriteRequest=null,p=y,this.fire(new l.k(p))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),h&&h(p)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const h=e.sourceLayer;if(!h)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(h)===-1)&&this.fire(new l.k(new Error(`Source layer "${h}" does not exist on source "${p.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const h=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?l.bK(h):h);const p=[];for(const y of e)if(h[y]){const S=s?l.bK(h[y]):h[y];p.push(S)}return p}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const h of s){const p=this._layers[h];p.type!=="custom"&&(e[h]=p.serialize())}return e}hasTransitions(){var e,s,h;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((s=this.sky)===null||s===void 0)&&s.hasTransition()||!((h=this.projection)===null||h===void 0)&&h.hasTransition())return!0;for(const p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(const p in this._layers)if(this._layers[p].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const p=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(p.length||y.length)&&this._updateWorkerLayers(p,y);for(const S in this._updatedSources){const E=this._updatedSources[S];if(E==="reload")this._reloadSource(S);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const h={};for(const p in this.sourceCaches){const y=this.sourceCaches[p];h[p]=y.used,y.used=!1}for(const p of this._order){const y=this._layers[p];y.recalculate(e,this._availableImages),!y.isHidden(e.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const p in h){const y=this.sourceCaches[p];!!h[p]!=!!y.used&&y.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,s&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var h;this._checkLoaded();const p=this.serialize();if(e=s.transformStyle?s.transformStyle(p,e):e,((h=s.validate)===null||h===void 0||h)&&vu(this,l.z(e)))return!1;(e=l.bK(e)).layers=l.bI(e.layers);const y=l.bL(p,e),S=this._getOperationsToPerform(y);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const E of S.operations)E();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],h=[];for(const p of e)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":s.push((()=>this.addLayer.apply(this,p.args)));break;case"removeLayer":s.push((()=>this.removeLayer.apply(this,p.args)));break;case"setPaintProperty":s.push((()=>this.setPaintProperty.apply(this,p.args)));break;case"setLayoutProperty":s.push((()=>this.setLayoutProperty.apply(this,p.args)));break;case"setFilter":s.push((()=>this.setFilter.apply(this,p.args)));break;case"addSource":s.push((()=>this.addSource.apply(this,p.args)));break;case"removeSource":s.push((()=>this.removeSource.apply(this,p.args)));break;case"setLayerZoomRange":s.push((()=>this.setLayerZoomRange.apply(this,p.args)));break;case"setLight":s.push((()=>this.setLight.apply(this,p.args)));break;case"setGeoJSONSourceData":s.push((()=>this.setGeoJSONSourceData.apply(this,p.args)));break;case"setGlyphs":s.push((()=>this.setGlyphs.apply(this,p.args)));break;case"setSprite":s.push((()=>this.setSprite.apply(this,p.args)));break;case"setTerrain":s.push((()=>this.map.setTerrain.apply(this,p.args)));break;case"setSky":s.push((()=>this.setSky.apply(this,p.args)));break;case"setProjection":this.setProjection.apply(this,p.args);break;case"setGlobalState":s.push((()=>this.setGlobalState.apply(this,p.args)));break;case"setTransition":s.push((()=>{}));break;default:h.push(p.command)}return{operations:s,unimplemented:h}}addImage(e,s){if(this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,h={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.z.source,`sources.${e}`,s,null,h))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[e]=new rr(e,s,this.dispatcher);p.style=this,p.setEventedParent(this,(()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:e}))),p.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===e)return this.fire(new l.k(new Error(`Source "${e}" cannot be removed while layer "${h}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const h=this.sourceCaches[e].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,h={}){this._checkLoaded();const p=e.id;if(this.getLayer(p))return void this.fire(new l.k(new Error(`Layer "${p}" already exists on this map.`)));let y;if(e.type==="custom"){if(vu(this,l.bM(e)))return;y=l.bJ(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(p,e.source),e=l.bK(e),e=l.e(e,{source:p})),this._validate(l.z.layer,`layers.${p}`,e,{arrayIndex:-1},h))return;y=l.bJ(e),this._validateLayer(y),y.setEventedParent(this,{layer:{id:p}})}const S=s?this._order.indexOf(s):this._order.length;if(s&&S===-1)this.fire(new l.k(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(S,0,p),this._layerOrderChanged=!0,this._layers[p]=y,this._removedLayers[p]&&y.source&&y.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new l.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const h=this._order.indexOf(e);this._order.splice(h,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new l.k(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(p,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const h=this._order.indexOf(e);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,h){this._checkLoaded();const p=this.getLayer(e);p?p.minzoom===s&&p.maxzoom===h||(s!=null&&(p.minzoom=s),h!=null&&(p.maxzoom=h),this._updateLayer(p)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,h={}){this._checkLoaded();const p=this.getLayer(e);if(p){if(!l.bH(p.filter,s))return s==null?(p.setFilter(void 0),void this._updateLayer(p)):void(this._validate(l.z.filter,`layers.${p.id}.filter`,s,null,h)||(p.setFilter(l.bK(s)),this._updateLayer(p)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return l.bK(this.getLayer(e).filter)}setLayoutProperty(e,s,h,p={}){this._checkLoaded();const y=this.getLayer(e);y?l.bH(y.getLayoutProperty(s),h)||(y.setLayoutProperty(s,h,p),this._updateLayer(y)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const h=this.getLayer(e);if(h)return h.getLayoutProperty(s);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,h,p={}){this._checkLoaded();const y=this.getLayer(e);y?l.bH(y.getPaintProperty(s),h)||this._updatePaintProperty(y,s,h,p):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,s,h,p={}){e.setPaintProperty(s,h,p)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const h=e.source,p=e.sourceLayer,y=this.sourceCaches[h];if(y===void 0)return void this.fire(new l.k(new Error(`The source '${h}' does not exist in the map's style.`)));const S=y.getSource().type;S==="geojson"&&p?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||p?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(p,e.id,s)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const h=e.source,p=this.sourceCaches[h];if(p===void 0)return void this.fire(new l.k(new Error(`The source '${h}' does not exist in the map's style.`)));const y=p.getSource().type,S=y==="vector"?e.sourceLayer:void 0;y!=="vector"||S?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(S,e.id,s):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,h=e.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||h?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),p.getFeatureState(h,e.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=l.bN(this.sourceCaches,(y=>y.serialize())),s=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,p=this.stylesheet;return l.bO({version:p.version,name:p.name,metadata:p.metadata,light:p.light,sky:p.sky,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,projection:p.projection,sources:e,layers:s,terrain:h},(y=>y!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=S=>this._layers[S].type==="fill-extrusion",h={},p=[];for(let S=this._order.length-1;S>=0;S--){const E=this._order[S];if(s(E)){h[E]=S;for(const I of e){const z=I[E];if(z)for(const D of z)p.push(D)}}}p.sort(((S,E)=>E.intersectionZ-S.intersectionZ));const y=[];for(let S=this._order.length-1;S>=0;S--){const E=this._order[S];if(s(E))for(let I=p.length-1;I>=0;I--){const z=p[I].feature;if(h[z.layer.id]<S)break;y.push(z),p.pop()}else for(const I of e){const z=I[E];if(z)for(const D of z)y.push(D.feature)}}return y}queryRenderedFeatures(e,s,h){s&&s.filter&&this._validate(l.z.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!(Array.isArray(s.layers)||s.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const z of s.layers){const D=this._layers[z];if(!D)return this.fire(new l.k(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];p[D.source]=!0}}const y=[];s.availableImages=this._availableImages;const S=this._serializedAllLayers(),E=s.layers instanceof Set?s.layers:Array.isArray(s.layers)?new Set(s.layers):null,I=Object.assign(Object.assign({},s),{layers:E});for(const z in this.sourceCaches)s.layers&&!p[z]||y.push(yr(this.sourceCaches[z],this._layers,S,e,I,h,this.map.terrain?(D,B,j)=>this.map.terrain.getElevation(D,B,j):void 0));return this.placement&&y.push((function(z,D,B,j,$,W,re){const se={},ae=W.queryRenderedSymbols(j),oe=[];for(const de of Object.keys(ae).map(Number))oe.push(re[de]);oe.sort(lr);for(const de of oe){const le=de.featureIndex.lookupSymbolFeatures(ae[de.bucketInstanceId],D,de.bucketIndex,de.sourceLayerIndex,$.filter,$.layers,$.availableImages,z);for(const ge in le){const we=se[ge]=se[ge]||[],he=le[ge];he.sort(((ke,$e)=>{const je=de.featureSortOrder;if(je){const Ne=je.indexOf(ke.featureIndex);return je.indexOf($e.featureIndex)-Ne}return $e.featureIndex-ke.featureIndex}));for(const ke of he)we.push(ke)}}return(function(de,le,ge){for(const we in de)for(const he of de[we])ci(he,ge[le[we].source]);return de})(se,z,B)})(this._layers,S,this.sourceCaches,e,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(e,s){s&&s.filter&&this._validate(l.z.filter,"querySourceFeatures.filter",s.filter,null,s);const h=this.sourceCaches[e];return h?(function(p,y){const S=p.getRenderableIds().map((z=>p.getTileByID(z))),E=[],I={};for(let z=0;z<S.length;z++){const D=S[z],B=D.tileID.canonical.key;I[B]||(I[B]=!0,D.querySourceFeatures(E,y))}return E})(h,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const h=this.light.getLight();let p=!1;for(const S in e)if(!l.bH(e[S],h[S])){p=!0;break}if(!p)return;const y={now:ee.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(y)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){this._checkLoaded();const h=this.getSky();let p=!1;if(!e&&!h)return;if(e&&!h)p=!0;else if(!e&&h)p=!0;else for(const S in e)if(!l.bH(e[S],h[S])){p=!0;break}if(!p)return;const y={now:ee.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(y)}_setProjectionInternal(e){const s=(function(h){if(Array.isArray(h)){const p=new kl({type:h});return{projection:p,transform:new xc,cameraHelper:new qd(p)}}switch(h){case"mercator":return{projection:new Pr,transform:new cn,cameraHelper:new hi};case"globe":{const p=new kl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:p,transform:new xc,cameraHelper:new qd(p)}}case"vertical-perspective":return{projection:new Cl,transform:new vc,cameraHelper:new ni};default:return l.w(`Unknown projection name: ${h}. Falling back to mercator projection.`),{projection:new Pr,transform:new cn,cameraHelper:new hi}}})(e);this.projection=s.projection,this.map.migrateProjection(s.transform,s.cameraHelper);for(const h in this.sourceCaches)this.sourceCaches[h].reload()}_validate(e,s,h,p,y={}){return(!y||y.validate!==!1)&&vu(this,e.call(l.z,l.e({key:s,style:this.serialize(),value:h,styleSpec:l.v},p)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),_r().off(vt,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const h=this.sourceCaches[s];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,h,p,y=!1){let S=!1,E=!1;const I={};for(const z of this._order){const D=this._layers[z];if(D.type!=="symbol")continue;if(!I[D.source]){const j=this.sourceCaches[D.source];I[D.source]=j.getRenderableIds(!0).map(($=>j.getTileByID($))).sort((($,W)=>W.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(W.tileID)?-1:1)))}const B=this.crossTileSymbolIndex.addLayer(D,I[D.source],e.center.lng);S=S||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ee.now(),e.zoom))&&(this.pauseablePlacement=new gc(e,this.map.terrain,this._order,y,s,h,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ee.now()),E=!0),S&&this.pauseablePlacement.placement.setStale()),E||S)for(const z of this._order){const D=this._layers[z];D.type==="symbol"&&this.placement.updateLayerOpacities(D,I[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ee.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return l._(this,void 0,void 0,(function*(){const h=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];return p&&p.setDependencies(s.tileID.key,s.type,s.icons),h}))}getGlyphs(e,s){return l._(this,void 0,void 0,(function*(){const h=yield this.glyphManager.getGlyphs(s.stacks),p=this.sourceCaches[s.source];return p&&p.setDependencies(s.tileID.key,s.type,[""]),h}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(l.z.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,h={},p){this._checkLoaded();const y=[{id:e,url:s}],S=[...ot(this.stylesheet.sprite),...y];this._validate(l.z.sprite,"sprite",S,null,h)||(this.stylesheet.sprite=S,this._loadSprite(y,!0,p))}removeSprite(e){this._checkLoaded();const s=ot(this.stylesheet.sprite);if(s.find((h=>h.id===e))){if(this._spritesImagesIds[e])for(const h of this._spritesImagesIds[e])this.imageManager.removeImage(h),this._changedImages[h]=!0;s.splice(s.findIndex((h=>h.id===e)),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ot(this.stylesheet.sprite)}setSprite(e,s={},h){this._checkLoaded(),e&&this._validate(l.z.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,h):(this._unloadSprite(),h&&h(null)))}}var ep=l.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,h,p,y,S,E,I,z){this.context=e;let D=this.boundPaintVertexBuffers.length!==p.length;for(let B=0;!D&&B<p.length;B++)this.boundPaintVertexBuffers[B]!==p[B]&&(D=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==h||D||this.boundIndexBuffer!==y||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==z?this.freshBind(s,h,p,y,S,E,I,z):(e.bindVertexArray.set(this.vao),E&&E.bind(),y&&y.dynamicDraw&&y.bind(),I&&I.bind(),z&&z.bind())}freshBind(e,s,h,p,y,S,E,I){const z=e.numAttributes,D=this.context,B=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=I,s.enableAttributes(B,e);for(const j of h)j.enableAttributes(B,e);S&&S.enableAttributes(B,e),E&&E.enableAttributes(B,e),I&&I.enableAttributes(B,e),s.bind(),s.setVertexAttribPointers(B,e,y);for(const j of h)j.bind(),j.setVertexAttribPointers(B,e,y);S&&(S.bind(),S.setVertexAttribPointers(B,e,y)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(B,e,y)),I&&(I.bind(),I.setVertexAttribPointers(B,e,y)),D.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const xu=(g,e,s,h,p)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:e,u_fog_color:s?s.properties.get("fog-color"):l.bf.white,u_fog_ground_blend:s?s.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?0:s?s.calculateFogBlendOpacity(h):0,u_horizon_color:s?s.properties.get("horizon-color"):l.bf.white,u_horizon_fog_blend:s?s.properties.get("horizon-fog-blend"):1,u_is_globe_mode:p?1:0}),Th={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Uo(g){const e=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const h=g[s].split(" ");e.push(h.pop())}return e}class Ph{constructor(e,s,h,p,y,S,E,I,z=[]){const D=e.gl;this.program=D.createProgram();const B=Uo(s.staticAttributes),j=h?h.getBinderAttributes():[],$=B.concat(j),W=Es.prelude.staticUniforms?Uo(Es.prelude.staticUniforms):[],re=E.staticUniforms?Uo(E.staticUniforms):[],se=s.staticUniforms?Uo(s.staticUniforms):[],ae=h?h.getBinderUniforms():[],oe=W.concat(re).concat(se).concat(ae),de=[];for(const je of oe)de.indexOf(je)<0&&de.push(je);const le=h?h.defines():[];ha(D)&&le.unshift("#version 300 es"),y&&le.push("#define OVERDRAW_INSPECTOR;"),S&&le.push("#define TERRAIN3D;"),I&&le.push(I),z&&le.push(...z);let ge=le.concat(Es.prelude.fragmentSource,E.fragmentSource,s.fragmentSource).join(`
`),we=le.concat(Es.prelude.vertexSource,E.vertexSource,s.vertexSource).join(`
`);ha(D)||(ge=(function(je){return je.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ge),we=(function(je){return je.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(we));const he=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);if(D.shaderSource(he,ge),D.compileShader(he),!D.getShaderParameter(he,D.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${D.getShaderInfoLog(he)}`);D.attachShader(this.program,he);const ke=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);if(D.shaderSource(ke,we),D.compileShader(ke),!D.getShaderParameter(ke,D.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${D.getShaderInfoLog(ke)}`);D.attachShader(this.program,ke),this.attributes={};const $e={};this.numAttributes=$.length;for(let je=0;je<this.numAttributes;je++)$[je]&&(D.bindAttribLocation(this.program,je,$[je]),this.attributes[$[je]]=je);if(D.linkProgram(this.program),!D.getProgramParameter(this.program,D.LINK_STATUS))throw new Error(`Program failed to link: ${D.getProgramInfoLog(this.program)}`);D.deleteShader(ke),D.deleteShader(he);for(let je=0;je<de.length;je++){const Ne=de[je];if(Ne&&!$e[Ne]){const Ze=D.getUniformLocation(this.program,Ne);Ze&&($e[Ne]=Ze)}}this.fixedUniforms=p(e,$e),this.terrainUniforms=((je,Ne)=>({u_depth:new l.bP(je,Ne.u_depth),u_terrain:new l.bP(je,Ne.u_terrain),u_terrain_dim:new l.bg(je,Ne.u_terrain_dim),u_terrain_matrix:new l.bR(je,Ne.u_terrain_matrix),u_terrain_unpack:new l.bS(je,Ne.u_terrain_unpack),u_terrain_exaggeration:new l.bg(je,Ne.u_terrain_exaggeration)}))(e,$e),this.projectionUniforms=((je,Ne)=>({u_projection_matrix:new l.bR(je,Ne.u_projection_matrix),u_projection_tile_mercator_coords:new l.bS(je,Ne.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bS(je,Ne.u_projection_clipping_plane),u_projection_transition:new l.bg(je,Ne.u_projection_transition),u_projection_fallback_matrix:new l.bR(je,Ne.u_projection_fallback_matrix)}))(e,$e),this.binderUniforms=h?h.getUniforms(e,$e):[]}draw(e,s,h,p,y,S,E,I,z,D,B,j,$,W,re,se,ae,oe,de){const le=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(h),e.setStencilMode(p),e.setColorMode(y),e.setCullFace(S),I){e.activeTexture.set(le.TEXTURE2),le.bindTexture(le.TEXTURE_2D,I.depthTexture),e.activeTexture.set(le.TEXTURE3),le.bindTexture(le.TEXTURE_2D,I.texture);for(const we in this.terrainUniforms)this.terrainUniforms[we].set(I[we])}if(z)for(const we in z)this.projectionUniforms[Th[we]].set(z[we]);if(E)for(const we in this.fixedUniforms)this.fixedUniforms[we].set(E[we]);se&&se.setUniforms(e,this.binderUniforms,W,{zoom:re});let ge=0;switch(s){case le.LINES:ge=2;break;case le.TRIANGLES:ge=3;break;case le.LINE_STRIP:ge=1}for(const we of $.get()){const he=we.vaos||(we.vaos={});(he[D]||(he[D]=new Wd)).bind(e,this,B,se?se.getPaintVertexBuffers():[],j,we.vertexOffset,ae,oe,de),le.drawElements(s,we.primitiveLength*ge,le.UNSIGNED_SHORT,we.primitiveOffset*ge*2)}}}function Il(g,e,s){const h=1/l.aC(s,1,e.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),y=s.tileSize*Math.pow(2,e.transform.tileZoom)/p,S=y*(s.tileID.canonical.x+s.tileID.wrap*p),E=y*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[h,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}const Zs=(g,e,s,h)=>{const p=g.style.light,y=p.properties.get("position"),S=[y.x,y.y,y.z],E=l.bV();p.properties.get("anchor")==="viewport"&&l.bW(E,g.transform.bearingInRadians),l.bX(S,S,E);const I=g.transform.transformLightDirection(S),z=p.properties.get("color");return{u_lightpos:S,u_lightpos_globe:I,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+e,u_opacity:s,u_fill_translate:h}},tp=(g,e,s,h,p,y,S)=>l.e(Zs(g,e,s,h),Il(y,g,S),{u_height_factor:-Math.pow(2,p.overscaledZ)/S.tileSize/8}),bu=(g,e,s,h)=>l.e(Il(e,g,s),{u_fill_translate:h}),Ml=(g,e)=>({u_world:g,u_fill_translate:e}),bc=(g,e,s,h,p)=>l.e(bu(g,e,s,p),{u_world:h}),rp=(g,e,s,h,p)=>{const y=g.transform;let S,E,I=0;if(s.paint.get("circle-pitch-alignment")==="map"){const z=l.aC(e,1,y.zoom);S=!0,E=[z,z],I=z/(l.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*p}else S=!1,E=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:E,u_globe_extrude_scale:I,u_translate:h}},wu=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),np=g=>({u_viewport_size:[g.width,g.height]}),Vo=(g,e=1)=>({u_color:g,u_overlay:0,u_overlay_scale:e}),Hd=(g,e,s,h)=>{const p=l.aC(g,1,e)/(l.$*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*h;return{u_extrude_scale:l.aC(g,1,e),u_intensity:s,u_globe_extrude_scale:p}},Ch=(g,e,s,h)=>{const p=l.L();l.bY(p,0,g.width,g.height,0,0,1);const y=g.context.gl;return{u_matrix:p,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:s,u_color_ramp:h,u_opacity:e.paint.get("heatmap-opacity")}},kh=(g,e,s)=>{const h=s.paint.get("hillshade-accent-color");let p;switch(s.paint.get("hillshade-method")){case"basic":p=4;break;case"combined":p=1;break;case"igor":p=2;break;case"multidirectional":p=3;break;default:p=0}const y=s.getIlluminationProperties();for(let S=0;S<y.directionRadians.length;S++)s.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[S]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:Eh(0,e.tileID),u_exaggeration:s.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:h,u_method:p,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},Al=(g,e)=>{const s=e.stride,h=l.L();return l.bY(h,0,l.$,-l.$,0,0,1),l.M(h,h,[0,-l.$,0]),{u_matrix:h,u_image:1,u_dimension:[s,s],u_zoom:g.overscaledZ,u_unpack:e.getUnpackVector()}};function Eh(g,e){const s=Math.pow(2,e.canonical.z),h=e.canonical.y;return[new l.a1(0,h/s).toLngLat().lat,new l.a1(0,(h+1)/s).toLngLat().lat]}const Ih=(g,e,s=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:s,u_opacity:g.paint.get("color-relief-opacity")}),wc=(g,e,s,h)=>{const p=g.transform;return{u_translation:Rh(g,e,s),u_ratio:h/l.aC(e,1,p.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Mh=(g,e,s,h,p)=>l.e(wc(g,e,s,h),{u_image:0,u_image_height:p}),Ah=(g,e,s,h,p)=>{const y=g.transform,S=yo(e,y);return{u_translation:Rh(g,e,s),u_texsize:e.imageAtlasTexture.size,u_ratio:h/l.aC(e,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[S,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},go=(g,e,s,h,p,y)=>{const S=g.lineAtlas,E=yo(e,g.transform),I=s.layout.get("line-cap")==="round",z=S.getDash(p.from,I),D=S.getDash(p.to,I),B=z.width*y.fromScale,j=D.width*y.toScale;return l.e(wc(g,e,s,h),{u_patternscale_a:[E/B,-z.height/2],u_patternscale_b:[E/j,-D.height/2],u_sdfgamma:S.width/(256*Math.min(B,j)*g.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:D.y,u_mix:y.t})};function yo(g,e){return 1/l.aC(g,1,e.tileZoom)}function Rh(g,e,s){return l.aD(g.transform,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Sc=(g,e,s,h,p)=>{return{u_tl_parent:g,u_scale_parent:e,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(S=h.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(y=h.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:ip(h.paint.get("raster-hue-rotate")),u_coords_top:[p[0].x,p[0].y,p[1].x,p[1].y],u_coords_bottom:[p[3].x,p[3].y,p[2].x,p[2].y]};var y,S};function ip(g){g*=Math.PI/180;const e=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const Rl=(g,e,s,h,p,y,S,E,I,z,D,B,j)=>{const $=S.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:$.width/$.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:E,u_coord_matrix:I,u_is_text:+D,u_pitch_with_map:+h,u_is_along_line:p,u_is_variable_anchor:y,u_texsize:B,u_texture:0,u_translation:z,u_pitched_scale:j}},zh=(g,e,s,h,p,y,S,E,I,z,D,B,j,$)=>{const W=S.transform;return l.e(Rl(g,e,s,h,p,y,S,E,I,z,D,B,$),{u_gamma_scale:h?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Tc=(g,e,s,h,p,y,S,E,I,z,D,B,j)=>l.e(zh(g,e,s,h,p,y,S,E,I,z,!0,D,0,j),{u_texsize_icon:B,u_texture_icon:1}),zl=(g,e)=>({u_opacity:g,u_color:e}),Kd=(g,e,s,h,p)=>l.e((function(y,S,E,I){const z=E.imageManager.getPattern(y.from.toString()),D=E.imageManager.getPattern(y.to.toString()),{width:B,height:j}=E.imageManager.getPixelSize(),$=Math.pow(2,I.tileID.overscaledZ),W=I.tileSize*Math.pow(2,E.transform.tileZoom)/$,re=W*(I.tileID.canonical.x+I.tileID.wrap*$),se=W*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[B,j],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/l.aC(I,1,E.transform.tileZoom),u_pixel_coord_upper:[re>>16,se>>16],u_pixel_coord_lower:[65535&re,65535&se]}})(s,p,e,h),{u_opacity:g}),Dl=(g,e)=>{},Dh={fillExtrusion:(g,e)=>({u_lightpos:new l.bT(g,e.u_lightpos),u_lightpos_globe:new l.bT(g,e.u_lightpos_globe),u_lightintensity:new l.bg(g,e.u_lightintensity),u_lightcolor:new l.bT(g,e.u_lightcolor),u_vertical_gradient:new l.bg(g,e.u_vertical_gradient),u_opacity:new l.bg(g,e.u_opacity),u_fill_translate:new l.bU(g,e.u_fill_translate)}),fillExtrusionPattern:(g,e)=>({u_lightpos:new l.bT(g,e.u_lightpos),u_lightpos_globe:new l.bT(g,e.u_lightpos_globe),u_lightintensity:new l.bg(g,e.u_lightintensity),u_lightcolor:new l.bT(g,e.u_lightcolor),u_vertical_gradient:new l.bg(g,e.u_vertical_gradient),u_height_factor:new l.bg(g,e.u_height_factor),u_opacity:new l.bg(g,e.u_opacity),u_fill_translate:new l.bU(g,e.u_fill_translate),u_image:new l.bP(g,e.u_image),u_texsize:new l.bU(g,e.u_texsize),u_pixel_coord_upper:new l.bU(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(g,e.u_pixel_coord_lower),u_scale:new l.bT(g,e.u_scale),u_fade:new l.bg(g,e.u_fade)}),fill:(g,e)=>({u_fill_translate:new l.bU(g,e.u_fill_translate)}),fillPattern:(g,e)=>({u_image:new l.bP(g,e.u_image),u_texsize:new l.bU(g,e.u_texsize),u_pixel_coord_upper:new l.bU(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(g,e.u_pixel_coord_lower),u_scale:new l.bT(g,e.u_scale),u_fade:new l.bg(g,e.u_fade),u_fill_translate:new l.bU(g,e.u_fill_translate)}),fillOutline:(g,e)=>({u_world:new l.bU(g,e.u_world),u_fill_translate:new l.bU(g,e.u_fill_translate)}),fillOutlinePattern:(g,e)=>({u_world:new l.bU(g,e.u_world),u_image:new l.bP(g,e.u_image),u_texsize:new l.bU(g,e.u_texsize),u_pixel_coord_upper:new l.bU(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(g,e.u_pixel_coord_lower),u_scale:new l.bT(g,e.u_scale),u_fade:new l.bg(g,e.u_fade),u_fill_translate:new l.bU(g,e.u_fill_translate)}),circle:(g,e)=>({u_camera_to_center_distance:new l.bg(g,e.u_camera_to_center_distance),u_scale_with_map:new l.bP(g,e.u_scale_with_map),u_pitch_with_map:new l.bP(g,e.u_pitch_with_map),u_extrude_scale:new l.bU(g,e.u_extrude_scale),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_globe_extrude_scale:new l.bg(g,e.u_globe_extrude_scale),u_translate:new l.bU(g,e.u_translate)}),collisionBox:(g,e)=>({u_pixel_extrude_scale:new l.bU(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_viewport_size:new l.bU(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new l.bQ(g,e.u_color),u_overlay:new l.bP(g,e.u_overlay),u_overlay_scale:new l.bg(g,e.u_overlay_scale)}),depth:Dl,clippingMask:Dl,heatmap:(g,e)=>({u_extrude_scale:new l.bg(g,e.u_extrude_scale),u_intensity:new l.bg(g,e.u_intensity),u_globe_extrude_scale:new l.bg(g,e.u_globe_extrude_scale)}),heatmapTexture:(g,e)=>({u_matrix:new l.bR(g,e.u_matrix),u_world:new l.bU(g,e.u_world),u_image:new l.bP(g,e.u_image),u_color_ramp:new l.bP(g,e.u_color_ramp),u_opacity:new l.bg(g,e.u_opacity)}),hillshade:(g,e)=>({u_image:new l.bP(g,e.u_image),u_latrange:new l.bU(g,e.u_latrange),u_exaggeration:new l.bg(g,e.u_exaggeration),u_altitudes:new l.b_(g,e.u_altitudes),u_azimuths:new l.b_(g,e.u_azimuths),u_accent:new l.bQ(g,e.u_accent),u_method:new l.bP(g,e.u_method),u_shadows:new l.bZ(g,e.u_shadows),u_highlights:new l.bZ(g,e.u_highlights)}),hillshadePrepare:(g,e)=>({u_matrix:new l.bR(g,e.u_matrix),u_image:new l.bP(g,e.u_image),u_dimension:new l.bU(g,e.u_dimension),u_zoom:new l.bg(g,e.u_zoom),u_unpack:new l.bS(g,e.u_unpack)}),colorRelief:(g,e)=>({u_image:new l.bP(g,e.u_image),u_unpack:new l.bS(g,e.u_unpack),u_dimension:new l.bU(g,e.u_dimension),u_elevation_stops:new l.bP(g,e.u_elevation_stops),u_color_stops:new l.bP(g,e.u_color_stops),u_color_ramp_size:new l.bP(g,e.u_color_ramp_size),u_opacity:new l.bg(g,e.u_opacity)}),line:(g,e)=>({u_translation:new l.bU(g,e.u_translation),u_ratio:new l.bg(g,e.u_ratio),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bU(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_translation:new l.bU(g,e.u_translation),u_ratio:new l.bg(g,e.u_ratio),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bU(g,e.u_units_to_pixels),u_image:new l.bP(g,e.u_image),u_image_height:new l.bg(g,e.u_image_height)}),linePattern:(g,e)=>({u_translation:new l.bU(g,e.u_translation),u_texsize:new l.bU(g,e.u_texsize),u_ratio:new l.bg(g,e.u_ratio),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_image:new l.bP(g,e.u_image),u_units_to_pixels:new l.bU(g,e.u_units_to_pixels),u_scale:new l.bT(g,e.u_scale),u_fade:new l.bg(g,e.u_fade)}),lineSDF:(g,e)=>({u_translation:new l.bU(g,e.u_translation),u_ratio:new l.bg(g,e.u_ratio),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bU(g,e.u_units_to_pixels),u_patternscale_a:new l.bU(g,e.u_patternscale_a),u_patternscale_b:new l.bU(g,e.u_patternscale_b),u_sdfgamma:new l.bg(g,e.u_sdfgamma),u_image:new l.bP(g,e.u_image),u_tex_y_a:new l.bg(g,e.u_tex_y_a),u_tex_y_b:new l.bg(g,e.u_tex_y_b),u_mix:new l.bg(g,e.u_mix)}),raster:(g,e)=>({u_tl_parent:new l.bU(g,e.u_tl_parent),u_scale_parent:new l.bg(g,e.u_scale_parent),u_buffer_scale:new l.bg(g,e.u_buffer_scale),u_fade_t:new l.bg(g,e.u_fade_t),u_opacity:new l.bg(g,e.u_opacity),u_image0:new l.bP(g,e.u_image0),u_image1:new l.bP(g,e.u_image1),u_brightness_low:new l.bg(g,e.u_brightness_low),u_brightness_high:new l.bg(g,e.u_brightness_high),u_saturation_factor:new l.bg(g,e.u_saturation_factor),u_contrast_factor:new l.bg(g,e.u_contrast_factor),u_spin_weights:new l.bT(g,e.u_spin_weights),u_coords_top:new l.bS(g,e.u_coords_top),u_coords_bottom:new l.bS(g,e.u_coords_bottom)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new l.bP(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(g,e.u_is_size_feature_constant),u_size_t:new l.bg(g,e.u_size_t),u_size:new l.bg(g,e.u_size),u_camera_to_center_distance:new l.bg(g,e.u_camera_to_center_distance),u_pitch:new l.bg(g,e.u_pitch),u_rotate_symbol:new l.bP(g,e.u_rotate_symbol),u_aspect_ratio:new l.bg(g,e.u_aspect_ratio),u_fade_change:new l.bg(g,e.u_fade_change),u_label_plane_matrix:new l.bR(g,e.u_label_plane_matrix),u_coord_matrix:new l.bR(g,e.u_coord_matrix),u_is_text:new l.bP(g,e.u_is_text),u_pitch_with_map:new l.bP(g,e.u_pitch_with_map),u_is_along_line:new l.bP(g,e.u_is_along_line),u_is_variable_anchor:new l.bP(g,e.u_is_variable_anchor),u_texsize:new l.bU(g,e.u_texsize),u_texture:new l.bP(g,e.u_texture),u_translation:new l.bU(g,e.u_translation),u_pitched_scale:new l.bg(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new l.bP(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(g,e.u_is_size_feature_constant),u_size_t:new l.bg(g,e.u_size_t),u_size:new l.bg(g,e.u_size),u_camera_to_center_distance:new l.bg(g,e.u_camera_to_center_distance),u_pitch:new l.bg(g,e.u_pitch),u_rotate_symbol:new l.bP(g,e.u_rotate_symbol),u_aspect_ratio:new l.bg(g,e.u_aspect_ratio),u_fade_change:new l.bg(g,e.u_fade_change),u_label_plane_matrix:new l.bR(g,e.u_label_plane_matrix),u_coord_matrix:new l.bR(g,e.u_coord_matrix),u_is_text:new l.bP(g,e.u_is_text),u_pitch_with_map:new l.bP(g,e.u_pitch_with_map),u_is_along_line:new l.bP(g,e.u_is_along_line),u_is_variable_anchor:new l.bP(g,e.u_is_variable_anchor),u_texsize:new l.bU(g,e.u_texsize),u_texture:new l.bP(g,e.u_texture),u_gamma_scale:new l.bg(g,e.u_gamma_scale),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_is_halo:new l.bP(g,e.u_is_halo),u_translation:new l.bU(g,e.u_translation),u_pitched_scale:new l.bg(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new l.bP(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bP(g,e.u_is_size_feature_constant),u_size_t:new l.bg(g,e.u_size_t),u_size:new l.bg(g,e.u_size),u_camera_to_center_distance:new l.bg(g,e.u_camera_to_center_distance),u_pitch:new l.bg(g,e.u_pitch),u_rotate_symbol:new l.bP(g,e.u_rotate_symbol),u_aspect_ratio:new l.bg(g,e.u_aspect_ratio),u_fade_change:new l.bg(g,e.u_fade_change),u_label_plane_matrix:new l.bR(g,e.u_label_plane_matrix),u_coord_matrix:new l.bR(g,e.u_coord_matrix),u_is_text:new l.bP(g,e.u_is_text),u_pitch_with_map:new l.bP(g,e.u_pitch_with_map),u_is_along_line:new l.bP(g,e.u_is_along_line),u_is_variable_anchor:new l.bP(g,e.u_is_variable_anchor),u_texsize:new l.bU(g,e.u_texsize),u_texsize_icon:new l.bU(g,e.u_texsize_icon),u_texture:new l.bP(g,e.u_texture),u_texture_icon:new l.bP(g,e.u_texture_icon),u_gamma_scale:new l.bg(g,e.u_gamma_scale),u_device_pixel_ratio:new l.bg(g,e.u_device_pixel_ratio),u_is_halo:new l.bP(g,e.u_is_halo),u_translation:new l.bU(g,e.u_translation),u_pitched_scale:new l.bg(g,e.u_pitched_scale)}),background:(g,e)=>({u_opacity:new l.bg(g,e.u_opacity),u_color:new l.bQ(g,e.u_color)}),backgroundPattern:(g,e)=>({u_opacity:new l.bg(g,e.u_opacity),u_image:new l.bP(g,e.u_image),u_pattern_tl_a:new l.bU(g,e.u_pattern_tl_a),u_pattern_br_a:new l.bU(g,e.u_pattern_br_a),u_pattern_tl_b:new l.bU(g,e.u_pattern_tl_b),u_pattern_br_b:new l.bU(g,e.u_pattern_br_b),u_texsize:new l.bU(g,e.u_texsize),u_mix:new l.bg(g,e.u_mix),u_pattern_size_a:new l.bU(g,e.u_pattern_size_a),u_pattern_size_b:new l.bU(g,e.u_pattern_size_b),u_scale_a:new l.bg(g,e.u_scale_a),u_scale_b:new l.bg(g,e.u_scale_b),u_pixel_coord_upper:new l.bU(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bU(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bg(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_texture:new l.bP(g,e.u_texture),u_ele_delta:new l.bg(g,e.u_ele_delta),u_fog_matrix:new l.bR(g,e.u_fog_matrix),u_fog_color:new l.bQ(g,e.u_fog_color),u_fog_ground_blend:new l.bg(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bg(g,e.u_fog_ground_blend_opacity),u_horizon_color:new l.bQ(g,e.u_horizon_color),u_horizon_fog_blend:new l.bg(g,e.u_horizon_fog_blend),u_is_globe_mode:new l.bg(g,e.u_is_globe_mode)}),terrainDepth:(g,e)=>({u_ele_delta:new l.bg(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_texture:new l.bP(g,e.u_texture),u_terrain_coords_id:new l.bg(g,e.u_terrain_coords_id),u_ele_delta:new l.bg(g,e.u_ele_delta)}),projectionErrorMeasurement:(g,e)=>({u_input:new l.bg(g,e.u_input),u_output_expected:new l.bg(g,e.u_output_expected)}),atmosphere:(g,e)=>({u_sun_pos:new l.bT(g,e.u_sun_pos),u_atmosphere_blend:new l.bg(g,e.u_atmosphere_blend),u_globe_position:new l.bT(g,e.u_globe_position),u_globe_radius:new l.bg(g,e.u_globe_radius),u_inv_proj_matrix:new l.bR(g,e.u_inv_proj_matrix)}),sky:(g,e)=>({u_sky_color:new l.bQ(g,e.u_sky_color),u_horizon_color:new l.bQ(g,e.u_horizon_color),u_horizon:new l.bU(g,e.u_horizon),u_horizon_normal:new l.bU(g,e.u_horizon_normal),u_sky_horizon_blend:new l.bg(g,e.u_sky_horizon_blend),u_sky_blend:new l.bg(g,e.u_sky_blend)})};class Lh{constructor(e,s,h){this.context=e;const p=e.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ll={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Gs{constructor(e,s,h,p){this.length=s.length,this.attributes=h,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=e;const y=e.gl;this.buffer=y.createBuffer(),e.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let h=0;h<this.attributes.length;h++){const p=s.attributes[this.attributes[h].name];p!==void 0&&e.enableVertexAttribArray(p)}}setVertexAttribPointers(e,s,h){for(let p=0;p<this.attributes.length;p++){const y=this.attributes[p],S=s.attributes[y.name];S!==void 0&&e.vertexAttribPointer(S,y.components,e[Ll[y.type]],!1,this.itemSize,y.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ur{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Su extends Ur{getDefault(){return l.bf.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Tu extends Ur{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Xd extends Ur{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Fh extends Ur{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Zo extends Ur{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Oh extends Ur{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class sp extends Ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class qs extends Ur{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Pc extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class Yd extends Ur{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class jh extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class Qd extends Ur{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Nh extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class Fl extends Ur{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Pu extends Ur{getDefault(){return l.bf.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Cu extends Ur{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class _o extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class La extends Ur{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Fa extends Ur{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class vo extends Ur{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class ps extends Ur{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Cc extends Ur{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Go extends Ur{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class kc extends Ur{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class xo extends Ur{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class qo extends Ur{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ec extends Ur{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ol extends Ur{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const h=this.gl;ha(h)?h.bindVertexArray(e):(s=h.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Ic extends Ur{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Bh extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Wo extends Ur{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Oa extends Ur{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class ja extends Oa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Mc extends Oa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Mr extends Oa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Ac="Framebuffer is not complete";class ap{constructor(e,s,h,p,y){this.context=e,this.width=s,this.height=h;const S=e.gl,E=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new ja(e,E),p)this.depthAttachment=y?new Mr(e,E):new Mc(e,E);else if(y)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Ac)}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const h=this.depthAttachment.get();h&&e.deleteRenderbuffer(h)}e.deleteFramebuffer(this.framebuffer)}}class jl{constructor(e){var s,h;if(this.gl=e,this.clearColor=new Su(this),this.clearDepth=new Tu(this),this.clearStencil=new Xd(this),this.colorMask=new Fh(this),this.depthMask=new Zo(this),this.stencilMask=new Oh(this),this.stencilFunc=new sp(this),this.stencilOp=new qs(this),this.stencilTest=new Pc(this),this.depthRange=new Yd(this),this.depthTest=new jh(this),this.depthFunc=new Qd(this),this.blend=new Nh(this),this.blendFunc=new Fl(this),this.blendColor=new Pu(this),this.blendEquation=new Cu(this),this.cullFace=new _o(this),this.cullFaceSide=new La(this),this.frontFace=new Fa(this),this.program=new vo(this),this.activeTexture=new ps(this),this.viewport=new Cc(this),this.bindFramebuffer=new Go(this),this.bindRenderbuffer=new kc(this),this.bindTexture=new xo(this),this.bindVertexBuffer=new qo(this),this.bindElementBuffer=new Ec(this),this.bindVertexArray=new Ol(this),this.pixelStoreUnpack=new Ic(this),this.pixelStoreUnpackPremultiplyAlpha=new Bh(this),this.pixelStoreUnpackFlipY=new Wo(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ha(e)){this.HALF_FLOAT=e.HALF_FLOAT;const p=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:p==null?void 0:p.RGBA16F_EXT,this.RGB16F=(h=e.RGB16F)!==null&&h!==void 0?h:p==null?void 0:p.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const p=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=p==null?void 0:p.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new Lh(this,e,s)}createVertexBuffer(e,s,h){return new Gs(this,e,s,h)}createRenderbuffer(e,s,h){const p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,e,s,h),this.bindRenderbuffer.set(null),y}createFramebuffer(e,s,h,p){return new ap(this,e,s,h,p)}clear({color:e,depth:s,stencil:h}){const p=this.gl;let y=0;e&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),h!==void 0&&(y|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),p.clear(y)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){l.bH(e.blendFunction,on.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ha(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return ha(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let bo;function $h(g,e,s,h,p){const y=g.context,S=g.transform,E=y.gl,I=g.useProgram("collisionBox"),z=[];let D=0,B=0;for(let ae=0;ae<h.length;ae++){const oe=h[ae],de=e.getTile(oe).getBucket(s);if(!de)continue;const le=p?de.textCollisionBox:de.iconCollisionBox,ge=de.collisionCircleArray;ge.length>0&&(z.push({circleArray:ge,circleOffset:B,coord:oe}),D+=ge.length/4,B=D),le&&I.draw(y,E.LINES,ur.disabled,Ir.disabled,g.colorModeForRenderPass(),nr.disabled,wu(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe),S.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),s.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,null,g.transform.zoom,null,null,le.collisionVertexBuffer)}if(!p||!z.length)return;const j=g.useProgram("collisionCircle"),$=new l.b$;$.resize(4*D),$._trim();let W=0;for(const ae of z)for(let oe=0;oe<ae.circleArray.length/4;oe++){const de=4*oe,le=ae.circleArray[de+0],ge=ae.circleArray[de+1],we=ae.circleArray[de+2],he=ae.circleArray[de+3];$.emplace(W++,le,ge,we,he,0),$.emplace(W++,le,ge,we,he,1),$.emplace(W++,le,ge,we,he,2),$.emplace(W++,le,ge,we,he,3)}(!bo||bo.length<2*D)&&(bo=(function(ae){const oe=2*ae,de=new l.c1;de.resize(oe),de._trim();for(let le=0;le<oe;le++){const ge=6*le;de.uint16[ge+0]=4*le+0,de.uint16[ge+1]=4*le+1,de.uint16[ge+2]=4*le+2,de.uint16[ge+3]=4*le+2,de.uint16[ge+4]=4*le+3,de.uint16[ge+5]=4*le+0}return de})(D));const re=y.createIndexBuffer(bo,!0),se=y.createVertexBuffer($,l.c0.members,!0);for(const ae of z){const oe=np(g.transform);j.draw(y,E.TRIANGLES,ur.disabled,Ir.disabled,g.colorModeForRenderPass(),nr.disabled,oe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ae.coord),null,s.id,se,re,l.aM.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,g.transform.zoom,null,null,null)}se.destroy(),re.destroy()}const Jd=l.ag(new Float32Array(16));function gn(g,e,s,h,p,y){const{horizontalAlign:S,verticalAlign:E}=l.aH(g);return new l.P((-(S-.5)*e/p+h[0])*y,(-(E-.5)*s/p+h[1])*y)}function Uh(g,e,s,h,p,y){const S=e.tileAnchorPoint.add(new l.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let E=h.mult(y);s||(E=E.rotate(-p));const I=S.add(E);return en(I.x,I.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(s){const E=ri(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),I=Math.atan(E.y/E.x)+(E.x<0?Math.PI:0);return g.add(h.rotate(I))}return g.add(h)}function Nl(g,e,s,h,p,y,S,E,I,z,D,B){const j=g.text.placedSymbolArray,$=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,re={};$.clear();for(let se=0;se<j.length;se++){const ae=j.get(se),oe=ae.hidden||!ae.crossTileID||g.allowVerticalPlacement&&!ae.placedOrientation?null:h[ae.crossTileID];if(oe){const de=new l.P(ae.anchorX,ae.anchorY),le={getElevation:B,width:p.width,height:p.height,pitchedLabelPlaneMatrix:y,pitchWithMap:s,transform:p,tileAnchorPoint:de,translation:z,unwrappedTileID:D},ge=s?lo(de.x,de.y,le):ri(de.x,de.y,le),we=st(p.cameraToCenterDistance,ge.signedDistanceFromCamera);let he=l.ap(g.textSizeData,E,ae)*we/l.aB;s&&(he*=g.tilePixelRatio/S);const{width:ke,height:$e,anchor:je,textOffset:Ne,textBoxScale:Ze}=oe,ht=gn(je,ke,$e,Ne,Ze,he),mt=p.getPitchedTextCorrection(de.x+z[0],de.y+z[1],D),rt=Uh(ge.point,le,e,ht,-p.bearingInRadians,mt),Ft=g.allowVerticalPlacement&&ae.placedOrientation===l.ao.vertical?Math.PI/2:0;for(let br=0;br<ae.numGlyphs;br++)l.av($,rt,Ft);I&&ae.associatedIconIndex>=0&&(re[ae.associatedIconIndex]={shiftedAnchor:rt,angle:Ft})}else la(ae.numGlyphs,$)}if(I){W.clear();const se=g.icon.placedSymbolArray;for(let ae=0;ae<se.length;ae++){const oe=se.get(ae);if(oe.hidden)la(oe.numGlyphs,W);else{const de=re[ae];if(de)for(let le=0;le<oe.numGlyphs;le++)l.av(W,de.shiftedAnchor,de.angle);else la(oe.numGlyphs,W)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData($)}function wo(g,e,s){return s.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Bl(g,e,s,h,p,y,S,E,I,z,D,B,j){const $=g.context,W=$.gl,re=g.transform,se=E==="map",ae=I==="map",oe=E!=="viewport"&&s.layout.get("symbol-placement")!=="point",de=se&&!ae&&!oe,le=!s.layout.get("symbol-sort-key").isConstant();let ge=!1;const we=g.getDepthModeForSublayer(0,ur.ReadOnly),he=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ke=[],$e=re.getCircleRadiusCorrection();for(const je of h){const Ne=e.getTile(je),Ze=Ne.getBucket(s);if(!Ze)continue;const ht=p?Ze.text:Ze.icon;if(!ht||!ht.segments.get().length||!ht.hasVisibleVertices)continue;const mt=ht.programConfigurations.get(s.id),rt=p||Ze.sdfIcons,Ft=p?Ze.textSizeData:Ze.iconSizeData,br=ae||re.pitch!==0,Zr=g.useProgram(wo(rt,p,Ze),mt),nn=l.an(Ft,re.zoom),Qr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(je);let un,xn,mr,Xr,Dn=[0,0],Ln=null;if(p)xn=Ne.glyphAtlasTexture,mr=W.LINEAR,un=Ne.glyphAtlasTexture.size,Ze.iconsInText&&(Dn=Ne.imageAtlasTexture.size,Ln=Ne.imageAtlasTexture,Xr=br||g.options.rotating||g.options.zooming||Ft.kind==="composite"||Ft.kind==="camera"?W.LINEAR:W.NEAREST);else{const Fn=s.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;xn=Ne.imageAtlasTexture,mr=rt||g.options.rotating||g.options.zooming||Fn||br?W.LINEAR:W.NEAREST,un=Ne.imageAtlasTexture.size}const Kn=l.aC(Ne,1,g.transform.zoom),Ti=Tr(se,g.transform,Kn),zs=l.L();l.aq(zs,Ti);const Ha=cr(ae,se,g.transform,Kn),ba=l.aD(re,Ne,y,S),tl=re.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),rl=he&&Ze.hasTextData(),Eo=s.layout.get("icon-text-fit")!=="none"&&rl&&Ze.hasIconData();if(oe){const Fn=g.style.map.terrain?(Bi,Bn)=>g.style.map.terrain.getElevation(je,Bi,Bn):null,Nn=s.layout.get("text-rotation-alignment")==="map";$r(Ze,g,p,Ti,zs,ae,z,Nn,je.toUnwrapped(),re.width,re.height,ba,Fn)}const nl=p&&he||Eo,ji=oe||nl?Jd:ae?Ti:g.transform.clipSpaceToPixelsMatrix,Xs=rt&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ni;Ni=rt?Ze.iconsInText?Tc(Ft.kind,nn,de,ae,oe,nl,g,ji,Ha,ba,un,Dn,$e):zh(Ft.kind,nn,de,ae,oe,nl,g,ji,Ha,ba,p,un,0,$e):Rl(Ft.kind,nn,de,ae,oe,nl,g,ji,Ha,ba,p,un,$e);const Ka={program:Zr,buffers:ht,uniformValues:Ni,projectionData:tl,atlasTexture:xn,atlasTextureIcon:Ln,atlasInterpolation:mr,atlasInterpolationIcon:Xr,isSDF:rt,hasHalo:Xs};if(le&&Ze.canOverlap){ge=!0;const Fn=ht.segments.get();for(const Nn of Fn)ke.push({segments:new l.aM([Nn]),sortKey:Nn.sortKey,state:Ka,terrainData:Qr})}else ke.push({segments:ht.segments,sortKey:0,state:Ka,terrainData:Qr})}ge&&ke.sort(((je,Ne)=>je.sortKey-Ne.sortKey));for(const je of ke){const Ne=je.state;if($.activeTexture.set(W.TEXTURE0),Ne.atlasTexture.bind(Ne.atlasInterpolation,W.CLAMP_TO_EDGE),Ne.atlasTextureIcon&&($.activeTexture.set(W.TEXTURE1),Ne.atlasTextureIcon&&Ne.atlasTextureIcon.bind(Ne.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),Ne.isSDF){const Ze=Ne.uniformValues;Ne.hasHalo&&(Ze.u_is_halo=1,Ho(Ne.buffers,je.segments,s,g,Ne.program,we,D,B,Ze,Ne.projectionData,je.terrainData)),Ze.u_is_halo=0}Ho(Ne.buffers,je.segments,s,g,Ne.program,we,D,B,Ne.uniformValues,Ne.projectionData,je.terrainData)}}function Ho(g,e,s,h,p,y,S,E,I,z,D){const B=h.context;p.draw(B,B.gl.TRIANGLES,y,S,E,nr.backCCW,I,D,z,s.id,g.layoutVertexBuffer,g.indexBuffer,e,s.paint,h.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Ko(g,e,s,h,p){const y=g.context,S=y.gl,E=Ir.disabled,I=new on([S.ONE,S.ONE],l.bf.transparent,[!0,!0,!0,!0]),z=e.getBucket(s);if(!z)return;const D=h.key;let B=s.heatmapFbos.get(D);B||(B=fa(y,e.tileSize,e.tileSize),s.heatmapFbos.set(D,B)),y.bindFramebuffer.set(B.framebuffer),y.viewport.set([0,0,e.tileSize,e.tileSize]),y.clear({color:l.bf.transparent});const j=z.programConfigurations.get(s.id),$=g.useProgram("heatmap",j,!p),W=g.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),re=g.style.map.terrain.getTerrainData(h);$.draw(y,S.TRIANGLES,ur.disabled,E,I,nr.disabled,Hd(e,g.transform.zoom,s.paint.get("heatmap-intensity"),1),re,W,s.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,s.paint,g.transform.zoom,j)}function Rc(g,e,s,h,p){const y=g.context,S=y.gl,E=g.transform;y.setColorMode(g.colorModeForRenderPass());const I=$l(y,e),z=s.key,D=e.heatmapFbos.get(z);if(!D)return;y.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,D.colorAttachment.get()),y.activeTexture.set(S.TEXTURE1),I.bind(S.LINEAR,S.CLAMP_TO_EDGE);const B=E.getProjectionData({overscaledTileID:s,applyTerrainMatrix:p,applyGlobeMatrix:!h});g.useProgram("heatmapTexture").draw(y,S.TRIANGLES,ur.disabled,Ir.disabled,g.colorModeForRenderPass(),nr.disabled,Ch(g,e,0,1),null,B,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,E.zoom),D.destroy(),e.heatmapFbos.delete(z)}function fa(g,e,s){var h,p;const y=g.gl,S=y.createTexture();y.bindTexture(y.TEXTURE_2D,S),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const E=(h=g.HALF_FLOAT)!==null&&h!==void 0?h:y.UNSIGNED_BYTE,I=(p=g.RGBA16F)!==null&&p!==void 0?p:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,I,e,s,0,y.RGBA,E,null);const z=g.createFramebuffer(e,s,!1,!1);return z.colorAttachment.set(S),z}function $l(g,e){return e.colorRampTexture||(e.colorRampTexture=new l.T(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function zc(g,e,s,h,p){if(!s||!h||!h.imageAtlas)return;const y=h.imageAtlas.patternPositions;let S=y[s.to.toString()],E=y[s.from.toString()];if(!S&&E&&(S=E),!E&&S&&(E=S),!S||!E){const I=p.getPaintProperty(e);S=y[I],E=y[I]}S&&E&&g.setConstantPatternPositions(S,E)}function ku(g,e,s,h,p,y,S,E){const I=g.context.gl,z="fill-pattern",D=s.paint.get(z),B=D&&D.constantOr(1),j=s.getCrossfadeParameters();let $,W,re,se,ae;const oe=g.transform,de=s.paint.get("fill-translate"),le=s.paint.get("fill-translate-anchor");S?(W=B&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=I.LINES):(W=B?"fillPattern":"fill",$=I.TRIANGLES);const ge=D.constantOr(null);for(const we of h){const he=e.getTile(we);if(B&&!he.patternsLoaded())continue;const ke=he.getBucket(s);if(!ke)continue;const $e=ke.programConfigurations.get(s.id),je=g.useProgram(W,$e),Ne=g.style.map.terrain&&g.style.map.terrain.getTerrainData(we);B&&(g.context.activeTexture.set(I.TEXTURE0),he.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),$e.updatePaintBuffers(j)),zc($e,z,ge,he,s);const Ze=oe.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),ht=l.aD(oe,he,de,le);if(S){se=ke.indexBuffer2,ae=ke.segments2;const rt=[I.drawingBufferWidth,I.drawingBufferHeight];re=W==="fillOutlinePattern"&&B?bc(g,j,he,rt,ht):Ml(rt,ht)}else se=ke.indexBuffer,ae=ke.segments,re=B?bu(g,j,he,ht):{u_fill_translate:ht};const mt=g.stencilModeForClipping(we);je.draw(g.context,$,p,mt,y,nr.backCCW,re,Ne,Ze,s.id,ke.layoutVertexBuffer,se,ae,s.paint,g.transform.zoom,$e)}}function Eu(g,e,s,h,p,y,S,E){const I=g.context,z=I.gl,D="fill-extrusion-pattern",B=s.paint.get(D),j=B.constantOr(1),$=s.getCrossfadeParameters(),W=s.paint.get("fill-extrusion-opacity"),re=B.constantOr(null),se=g.transform;for(const ae of h){const oe=e.getTile(ae),de=oe.getBucket(s);if(!de)continue;const le=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ae),ge=de.programConfigurations.get(s.id),we=g.useProgram(j?"fillExtrusionPattern":"fillExtrusion",ge);j&&(g.context.activeTexture.set(z.TEXTURE0),oe.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),ge.updatePaintBuffers($));const he=se.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!E,applyTerrainMatrix:!0});zc(ge,D,re,oe,s);const ke=l.aD(se,oe,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),$e=s.paint.get("fill-extrusion-vertical-gradient"),je=j?tp(g,$e,W,ke,ae,$,oe):Zs(g,$e,W,ke);we.draw(I,I.gl.TRIANGLES,p,y,S,nr.backCCW,je,le,he,s.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,s.paint,g.transform.zoom,ge,g.style.map.terrain&&de.centroidVertexBuffer)}}function pa(g,e,s,h,p,y,S,E,I){var z;const D=g.style.projection,B=g.context,j=g.transform,$=B.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${s.paint.get("hillshade-highlight-color").values.length}`],re=g.useProgram("hillshade",null,!1,W),se=!g.options.moving;for(const ae of h){const oe=e.getTile(ae),de=oe.fbo;if(!de)continue;const le=D.getMeshFromTileID(B,ae.canonical,E,!0,"raster"),ge=(z=g.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(ae);B.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,de.colorAttachment.get());const we=j.getProjectionData({overscaledTileID:ae,aligned:se,applyGlobeMatrix:!I,applyTerrainMatrix:!0});re.draw(B,$.TRIANGLES,y,p[ae.overscaledZ],S,nr.backCCW,kh(g,oe,s),ge,we,s.id,le.vertexBuffer,le.indexBuffer,le.segments)}}function Ul(g,e,s,h,p,y,S,E,I){var z;const D=g.style.projection,B=g.context,j=g.transform,$=B.gl,W=g.useProgram("colorRelief"),re=!g.options.moving;let se=!0,ae=0;for(const oe of h){const de=e.getTile(oe),le=de.dem;if(se){const je=$.getParameter($.MAX_TEXTURE_SIZE),{elevationTexture:Ne,colorTexture:Ze}=s.getColorRampTextures(B,je,le.getUnpackVector());B.activeTexture.set($.TEXTURE1),Ne.bind($.NEAREST,$.CLAMP_TO_EDGE),B.activeTexture.set($.TEXTURE4),Ze.bind($.LINEAR,$.CLAMP_TO_EDGE),se=!1,ae=Ne.size[0]}if(!le||!le.data)continue;const ge=le.stride,we=le.getPixels();if(B.activeTexture.set($.TEXTURE0),B.pixelStoreUnpackPremultiplyAlpha.set(!1),de.demTexture=de.demTexture||g.getTileTexture(ge),de.demTexture){const je=de.demTexture;je.update(we,{premultiply:!1}),je.bind($.LINEAR,$.CLAMP_TO_EDGE)}else de.demTexture=new l.T(B,we,$.RGBA,{premultiply:!1}),de.demTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const he=D.getMeshFromTileID(B,oe.canonical,E,!0,"raster"),ke=(z=g.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(oe),$e=j.getProjectionData({overscaledTileID:oe,aligned:re,applyGlobeMatrix:!I,applyTerrainMatrix:!0});W.draw(B,$.TRIANGLES,y,p[oe.overscaledZ],S,nr.backCCW,Ih(s,de.dem,ae),ke,$e,s.id,he.vertexBuffer,he.indexBuffer,he.segments)}}const Vl=[new l.P(0,0),new l.P(l.$,0),new l.P(l.$,l.$),new l.P(0,l.$)];function Na(g,e,s,h,p,y,S,E,I=!1,z=!1){const D=h[h.length-1].overscaledZ,B=g.context,j=B.gl,$=g.useProgram("raster"),W=g.transform,re=g.style.projection,se=g.colorModeForRenderPass(),ae=!g.options.moving;for(const oe of h){const de=g.getDepthModeForSublayer(oe.overscaledZ-D,s.paint.get("raster-opacity")===1?ur.ReadWrite:ur.ReadOnly,j.LESS),le=e.getTile(oe);le.registerFadeDuration(s.paint.get("raster-fade-duration"));const ge=e.findLoadedParent(oe,0),we=e.findLoadedSibling(oe),he=Dc(le,ge||we||null,e,s,g.transform,g.style.map.terrain);let ke,$e;const je=s.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;B.activeTexture.set(j.TEXTURE0),le.texture.bind(je,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(j.TEXTURE1),ge?(ge.texture.bind(je,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,ge.tileID.overscaledZ-le.tileID.overscaledZ),$e=[le.tileID.canonical.x*ke%1,le.tileID.canonical.y*ke%1]):le.texture.bind(je,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),le.texture.useMipmap&&B.extTextureFilterAnisotropic&&g.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const Ne=g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe),Ze=W.getProjectionData({overscaledTileID:oe,aligned:ae,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),ht=Sc($e||[0,0],ke||1,he,s,E),mt=re.getMeshFromTileID(B,oe.canonical,y,S,"raster");$.draw(B,j.TRIANGLES,de,p?p[oe.overscaledZ]:Ir.disabled,se,I?nr.frontCCW:nr.backCCW,ht,Ne,Ze,s.id,mt.vertexBuffer,mt.indexBuffer,mt.segments)}}function Dc(g,e,s,h,p,y){const S=h.paint.get("raster-fade-duration");if(!y&&S>0){const E=ee.now(),I=(E-g.timeAdded)/S,z=e?(E-e.timeAdded)/S:-1,D=s.getSource(),B=zt(p,{tileSize:D.tileSize,roundZoom:D.roundZoom}),j=!e||Math.abs(e.tileID.overscaledZ-B)>Math.abs(g.tileID.overscaledZ-B),$=j&&g.refreshedUponExpiration?1:l.ah(j?I:1-z,0,1);return g.refreshedUponExpiration&&I>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const Iu=new l.bf(1,0,0,1),ef=new l.bf(0,1,0,1),Lc=new l.bf(0,0,1,1),Vh=new l.bf(1,0,1,1),op=new l.bf(0,1,1,1);function Fc(g,e,s,h){Ws(g,0,e+s/2,g.transform.width,s,h)}function tn(g,e,s,h){Ws(g,e-s/2,0,s,g.transform.height,h)}function Ws(g,e,s,h,p,y){const S=g.context,E=S.gl;E.enable(E.SCISSOR_TEST),E.scissor(e*g.pixelRatio,s*g.pixelRatio,h*g.pixelRatio,p*g.pixelRatio),S.clear({color:y}),E.disable(E.SCISSOR_TEST)}function di(g,e,s){const h=g.context,p=h.gl,y=g.useProgram("debug"),S=ur.disabled,E=Ir.disabled,I=g.colorModeForRenderPass(),z="$debug",D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);h.activeTexture.set(p.TEXTURE0);const B=e.getTileByID(s.key).latestRawTileData,j=Math.floor((B&&B.byteLength||0)/1024),$=e.getTile(s).tileSize,W=512/Math.min($,512)*(s.overscaledZ/g.transform.zoom)*.5;let re=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(re+=` => ${s.overscaledZ}`),(function(ae,oe){ae.initDebugOverlayCanvas();const de=ae.debugOverlayCanvas,le=ae.context.gl,ge=ae.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,de.width,de.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(oe,5,5),ge.strokeText(oe,5,5),ae.debugOverlayTexture.update(de),ae.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)})(g,`${re} ${j}kB`);const se=g.transform.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(h,p.TRIANGLES,S,E,on.alphaBlended,nr.disabled,Vo(l.bf.transparent,W),null,se,z,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),y.draw(h,p.LINE_STRIP,S,E,I,nr.disabled,Vo(l.bf.red),D,se,z,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function ms(g,e,s,h){const{isRenderingGlobe:p}=h,y=g.context,S=y.gl,E=g.transform,I=g.colorModeForRenderPass(),z=g.getDepthModeFor3D(),D=g.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,g.width,g.height]);for(const B of s){const j=e.getTerrainMesh(B.tileID),$=g.renderToTexture.getTexture(B),W=e.getTerrainData(B.tileID);y.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,$.texture);const re=e.getMeshFrameDelta(E.zoom),se=E.calculateFogMatrix(B.tileID.toUnwrapped()),ae=xu(re,se,g.style.sky,E.pitch,p),oe=E.getProjectionData({overscaledTileID:B.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});D.draw(y,S.TRIANGLES,z,Ir.disabled,I,nr.backCCW,ae,W,oe,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function Ba(g,e){if(!e.mesh){const s=new l.aL;s.emplaceBack(-1,-1),s.emplaceBack(1,-1),s.emplaceBack(1,1),s.emplaceBack(-1,1);const h=new l.aN;h.emplaceBack(0,1,2),h.emplaceBack(0,2,3),e.mesh=new Aa(g.createVertexBuffer(s,Ra.members),g.createIndexBuffer(h),l.aM.simpleSegment(0,0,s.length,h.length))}return e.mesh}class ma{constructor(e,s){this.context=new jl(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=rr.maxUnderzooming+rr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new co}resize(e,s,h){if(this.width=Math.floor(e*h),this.height=Math.floor(s*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const e=this.context,s=new l.aL;s.emplaceBack(0,0),s.emplaceBack(l.$,0),s.emplaceBack(0,l.$),s.emplaceBack(l.$,l.$),this.tileExtentBuffer=e.createVertexBuffer(s,Ra.members),this.tileExtentSegments=l.aM.simpleSegment(0,0,4,2);const h=new l.aL;h.emplaceBack(0,0),h.emplaceBack(l.$,0),h.emplaceBack(0,l.$),h.emplaceBack(l.$,l.$),this.debugBuffer=e.createVertexBuffer(h,Ra.members),this.debugSegments=l.aM.simpleSegment(0,0,4,5);const p=new l.c6;p.emplaceBack(0,0,0,0),p.emplaceBack(l.$,0,l.$,0),p.emplaceBack(0,l.$,0,l.$),p.emplaceBack(l.$,l.$,l.$,l.$),this.rasterBoundsBuffer=e.createVertexBuffer(p,ep.members),this.rasterBoundsSegments=l.aM.simpleSegment(0,0,4,2);const y=new l.aL;y.emplaceBack(0,0),y.emplaceBack(l.$,0),y.emplaceBack(0,l.$),y.emplaceBack(l.$,l.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(y,Ra.members),this.rasterBoundsSegmentsPosOnly=l.aM.simpleSegment(0,0,4,5);const S=new l.aL;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,Ra.members),this.viewportSegments=l.aM.simpleSegment(0,0,4,2);const E=new l.c7;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(E);const I=new l.aN;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(I);const z=this.context.gl;this.stencilClearMode=new Ir({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.tileExtentMesh=new Aa(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=l.L();l.bY(h,0,this.width,this.height,0,0,1),l.N(h,h,[s.drawingBufferWidth,s.drawingBufferHeight,0]);const p={mainMatrix:h,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:h};this.useProgram("clippingMask",null,!0).draw(e,s.TRIANGLES,ur.disabled,this.stencilClearMode,on.disabled,nr.disabled,null,null,p,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s,h){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source,this.nextStencilID+s.length>256&&this.clearStencil();const p=this.context;p.setColorMode(on.disabled),p.setDepthMode(ur.disabled);const y={};for(const S of s)y[S.key]=this.nextStencilID++;this._renderTileMasks(y,s,h,!0),this._renderTileMasks(y,s,h,!1),this._tileClippingMaskIDs=y}_renderTileMasks(e,s,h,p){const y=this.context,S=y.gl,E=this.style.projection,I=this.transform,z=this.useProgram("clippingMask");for(const D of s){const B=e[D.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),$=E.getMeshFromTileID(this.context,D.canonical,p,!0,"stencil"),W=I.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!h,applyTerrainMatrix:!0});z.draw(y,S.TRIANGLES,ur.disabled,new Ir({func:S.ALWAYS,mask:0},B,255,S.KEEP,S.KEEP,S.REPLACE),on.disabled,h?nr.disabled:nr.backCCW,null,j,W,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,s=e.gl,h=this.style.projection,p=this.transform,y=this.useProgram("depth"),S=this.getDepthModeFor3D(),E=Ce(p,{tileSize:p.tileSize});for(const I of E){const z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),D=h.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),B=p.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(e,s.TRIANGLES,S,Ir.disabled,on.disabled,nr.backCCW,null,z,B,"$clipping",D.vertexBuffer,D.indexBuffer,D.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new Ir({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new Ir({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const s=this.context.gl,h=e.sort(((S,E)=>E.overscaledZ-S.overscaledZ)),p=h[h.length-1].overscaledZ,y=h[0].overscaledZ-p+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const S={};for(let E=0;E<y;E++)S[E+p]=new Ir({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[S,h]}return[{[p]:Ir.disabled},h]}stencilConfigForOverlapTwoPass(e){const s=this.context.gl,h=e.sort(((S,E)=>E.overscaledZ-S.overscaledZ)),p=h[h.length-1].overscaledZ,y=h[0].overscaledZ-p+1;if(this.clearStencil(),y>1){const S={},E={};for(let I=0;I<y;I++)S[I+p]=new Ir({func:s.GREATER,mask:255},y+1+I,255,s.KEEP,s.KEEP,s.REPLACE),E[I+p]=new Ir({func:s.GREATER,mask:255},1+I,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID=2*y+1,[S,E,h]}return this.nextStencilID=3,[{[p]:new Ir({func:s.GREATER,mask:255},2,255,s.KEEP,s.KEEP,s.REPLACE)},{[p]:new Ir({func:s.GREATER,mask:255},1,255,s.KEEP,s.KEEP,s.REPLACE)},h]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new on([e.CONSTANT_COLOR,e.ONE],new l.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?on.unblended:on.alphaBlended}getDepthModeForSublayer(e,s,h){if(!this.opaquePassEnabledForLayer())return ur.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ur(h||this.context.gl.LEQUAL,s,[p,p])}getDepthModeFor3D(){return new ur(this.context.gl.LEQUAL,ur.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){var h,p;this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ee.now()),this.imageManager.beginFrame();const y=this.style._order,S=this.style.sourceCaches,E={},I={},z={},D={isRenderingToTexture:!1,isRenderingGlobe:((h=e.projection)===null||h===void 0?void 0:h.transitionState)>0};for(const j in S){const $=S[j];$.used&&$.prepare(this.context),E[j]=$.getVisibleCoordinates(!1),I[j]=E[j].slice().reverse(),z[j]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of y){const $=this.style._layers[j];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const W=I[$.source];($.type==="custom"||W.length)&&this.renderLayer(this,S[$.source],$,W,D)}if((p=this.style.projection)===null||p===void 0||p.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?l.bf.black:l.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(j,$){const W=j.context,re=W.gl,se=((we,he,ke)=>{const $e=Math.cos(he.rollInRadians),je=Math.sin(he.rollInRadians),Ne=ve(he),Ze=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:we.properties.get("sky-color"),u_horizon_color:we.properties.get("horizon-color"),u_horizon:[(he.width/2-Ne*je)*ke,(he.height/2+Ne*$e)*ke],u_horizon_normal:[-je,$e],u_sky_horizon_blend:we.properties.get("sky-horizon-blend")*he.height/2*ke,u_sky_blend:Ze}})($,j.style.map.transform,j.pixelRatio),ae=new ur(re.LEQUAL,ur.ReadWrite,[0,1]),oe=Ir.disabled,de=j.colorModeForRenderPass(),le=j.useProgram("sky"),ge=Ba(W,$);le.draw(W,re.TRIANGLES,ae,oe,de,nr.disabled,se,null,void 0,"sky",ge.vertexBuffer,ge.indexBuffer,ge.segments)})(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],$=S[j.source],W=E[j.source];this._renderTileClippingMasks(j,W,!1),this.renderLayer(this,$,j,W,D)}this.renderPass="translucent";let B=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],$=S[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,D))continue;this.opaquePassEnabledForLayer()||B||(B=!0,D.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(j.type==="symbol"?z:I)[j.source];this._renderTileClippingMasks(j,E[j.source],!!this.renderToTexture),this.renderLayer(this,$,j,W,D)}if(D.isRenderingGlobe&&(function(j,$,W){const re=j.context,se=re.gl,ae=j.useProgram("atmosphere"),oe=new ur(se.LEQUAL,ur.ReadOnly,[0,1]),de=j.transform,le=(function(Ze,ht){const mt=Ze.properties.get("position"),rt=[-mt.x,-mt.y,-mt.z],Ft=l.ag(new Float64Array(16));return Ze.properties.get("anchor")==="map"&&(l.b6(Ft,Ft,ht.rollInRadians),l.b7(Ft,Ft,-ht.pitchInRadians),l.b6(Ft,Ft,ht.bearingInRadians),l.b7(Ft,Ft,ht.center.lat*Math.PI/180),l.bz(Ft,Ft,-ht.center.lng*Math.PI/180)),l.c5(rt,rt,Ft),rt})(W,j.transform),ge=de.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),we=$.properties.get("atmosphere-blend")*ge.projectionTransition;if(we===0)return;const he=za(de.worldSize,de.center.lat),ke=de.inverseProjectionMatrix,$e=new Float64Array(4);$e[3]=1,l.aw($e,$e,de.modelViewProjectionMatrix),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1,l.aw($e,$e,ke),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1;const je=((Ze,ht,mt,rt,Ft)=>({u_sun_pos:Ze,u_atmosphere_blend:ht,u_globe_position:mt,u_globe_radius:rt,u_inv_proj_matrix:Ft}))(le,we,[$e[0],$e[1],$e[2]],he,ke),Ne=Ba(re,$);ae.draw(re,se.TRIANGLES,oe,Ir.disabled,on.alphaBlended,nr.disabled,je,null,null,"atmosphere",Ne.vertexBuffer,Ne.indexBuffer,Ne.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=(function($,W){let re=null;const se=Object.values($._layers).flatMap((le=>le.source&&!le.isHidden(W)?[$.sourceCaches[le.source]]:[])),ae=se.filter((le=>le.getSource().type==="vector")),oe=se.filter((le=>le.getSource().type!=="vector")),de=le=>{(!re||re.getSource().maxzoom<le.getSource().maxzoom)&&(re=le)};return ae.forEach((le=>de(le))),re||oe.forEach((le=>de(le))),re})(this.style,this.transform.zoom);j&&(function($,W,re){for(let se=0;se<re.length;se++)di($,W,re[se])})(this,j,j.getVisibleCoordinates())}this.options.showPadding&&(function(j){const $=j.transform.padding;Fc(j,j.transform.height-($.top||0),3,Iu),Fc(j,$.bottom||0,3,ef),tn(j,$.left||0,3,Lc),tn(j,j.transform.width-($.right||0),3,Vh);const W=j.transform.centerPoint;(function(re,se,ae,oe){Ws(re,se-1,ae-10,2,20,oe),Ws(re,se-10,ae-1,20,2,oe)})(j,W.x,j.transform.height-W.y,op)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let p=this.terrainFacilitator.dirty;p||(p=e?!l.c8(s,h):!l.c9(s,h)),p||(p=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),p&&(l.ca(s,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(y,S){const E=y.context,I=E.gl,z=y.transform,D=on.unblended,B=new ur(I.LEQUAL,ur.ReadWrite,[0,1]),j=S.sourceCache.getRenderableTiles(),$=y.useProgram("terrainDepth");E.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),E.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),E.clear({color:l.bf.transparent,depth:1});for(const W of j){const re=S.getTerrainMesh(W.tileID),se=S.getTerrainData(W.tileID),ae=z.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),oe={u_ele_delta:S.getMeshFrameDelta(z.zoom)};$.draw(E,I.TRIANGLES,B,Ir.disabled,D,nr.backCCW,oe,se,ae,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}E.bindFramebuffer.set(null),E.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain),(function(y,S){const E=y.context,I=E.gl,z=y.transform,D=on.unblended,B=new ur(I.LEQUAL,ur.ReadWrite,[0,1]),j=S.getCoordsTexture(),$=S.sourceCache.getRenderableTiles(),W=y.useProgram("terrainCoords");E.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),E.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),E.clear({color:l.bf.transparent,depth:1}),S.coordsIndex=[];for(const re of $){const se=S.getTerrainMesh(re.tileID),ae=S.getTerrainData(re.tileID);E.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,j.texture);const oe={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(z.zoom)},de=z.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(E,I.TRIANGLES,B,Ir.disabled,D,nr.backCCW,oe,ae,de,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),S.coordsIndex.push(re.tileID.key)}E.bindFramebuffer.set(null),E.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain))}renderLayer(e,s,h,p,y){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||(p||[]).length)&&(this.id=h.id,l.cb(h)?(function(S,E,I,z,D,B){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=B,$=Ir.disabled,W=S.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(re,se,ae,oe,de,le,ge,we,he){const ke=se.transform,$e=se.style.map.terrain,je=de==="map",Ne=le==="map";for(const Ze of re){const ht=oe.getTile(Ze),mt=ht.getBucket(ae);if(!mt||!mt.text||!mt.text.segments.get().length)continue;const rt=l.an(mt.textSizeData,ke.zoom),Ft=l.aC(ht,1,se.transform.zoom),br=Tr(je,se.transform,Ft),Zr=ae.layout.get("icon-text-fit")!=="none"&&mt.hasIconData();if(rt){const nn=Math.pow(2,ke.zoom-ht.tileID.overscaledZ),Qr=$e?(un,xn)=>$e.getElevation(Ze,un,xn):null;Nl(mt,je,Ne,he,ke,br,nn,rt,Zr,l.aD(ke,ht,ge,we),Ze.toUnwrapped(),Qr)}}})(z,S,I,E,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),D),I.paint.get("icon-opacity").constantOr(1)!==0&&Bl(S,E,I,z,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),$,W,j),I.paint.get("text-opacity").constantOr(1)!==0&&Bl(S,E,I,z,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),$,W,j),E.map.showCollisionBoxes&&($h(S,E,I,z,!0),$h(S,E,I,z,!1))})(e,s,h,p,this.style.placement.variableOffsets,y):l.cc(h)?(function(S,E,I,z,D){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,j=I.paint.get("circle-opacity"),$=I.paint.get("circle-stroke-width"),W=I.paint.get("circle-stroke-opacity"),re=!I.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&($.constantOr(1)===0||W.constantOr(1)===0))return;const se=S.context,ae=se.gl,oe=S.transform,de=S.getDepthModeForSublayer(0,ur.ReadOnly),le=Ir.disabled,ge=S.colorModeForRenderPass(),we=[],he=oe.getCircleRadiusCorrection();for(let ke=0;ke<z.length;ke++){const $e=z[ke],je=E.getTile($e),Ne=je.getBucket(I);if(!Ne)continue;const Ze=I.paint.get("circle-translate"),ht=I.paint.get("circle-translate-anchor"),mt=l.aD(oe,je,Ze,ht),rt=Ne.programConfigurations.get(I.id),Ft=S.useProgram("circle",rt),br=Ne.layoutVertexBuffer,Zr=Ne.indexBuffer,nn=S.style.map.terrain&&S.style.map.terrain.getTerrainData($e),Qr={programConfiguration:rt,program:Ft,layoutVertexBuffer:br,indexBuffer:Zr,uniformValues:rp(S,je,I,mt,he),terrainData:nn,projectionData:oe.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!B,applyTerrainMatrix:!0})};if(re){const un=Ne.segments.get();for(const xn of un)we.push({segments:new l.aM([xn]),sortKey:xn.sortKey,state:Qr})}else we.push({segments:Ne.segments,sortKey:0,state:Qr})}re&&we.sort(((ke,$e)=>ke.sortKey-$e.sortKey));for(const ke of we){const{programConfiguration:$e,program:je,layoutVertexBuffer:Ne,indexBuffer:Ze,uniformValues:ht,terrainData:mt,projectionData:rt}=ke.state;je.draw(se,ae.TRIANGLES,de,le,ge,nr.backCCW,ht,mt,rt,I.id,Ne,Ze,ke.segments,I.paint,S.transform.zoom,$e)}})(e,s,h,p,y):l.cd(h)?(function(S,E,I,z,D){if(I.paint.get("heatmap-opacity")===0)return;const B=S.context,{isRenderingToTexture:j,isRenderingGlobe:$}=D;if(S.style.map.terrain){for(const W of z){const re=E.getTile(W);E.hasRenderableParent(W)||(S.renderPass==="offscreen"?Ko(S,re,I,W,$):S.renderPass==="translucent"&&Rc(S,I,W,j,$))}B.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?(function(W,re,se,ae){const oe=W.context,de=oe.gl,le=W.transform,ge=Ir.disabled,we=new on([de.ONE,de.ONE],l.bf.transparent,[!0,!0,!0,!0]);(function(he,ke,$e){const je=he.gl;he.activeTexture.set(je.TEXTURE1),he.viewport.set([0,0,ke.width/4,ke.height/4]);let Ne=$e.heatmapFbos.get(l.c2);Ne?(je.bindTexture(je.TEXTURE_2D,Ne.colorAttachment.get()),he.bindFramebuffer.set(Ne.framebuffer)):(Ne=fa(he,ke.width/4,ke.height/4),$e.heatmapFbos.set(l.c2,Ne))})(oe,W,se),oe.clear({color:l.bf.transparent});for(let he=0;he<ae.length;he++){const ke=ae[he];if(re.hasRenderableParent(ke))continue;const $e=re.getTile(ke),je=$e.getBucket(se);if(!je)continue;const Ne=je.programConfigurations.get(se.id),Ze=W.useProgram("heatmap",Ne),ht=le.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),mt=le.getCircleRadiusCorrection();Ze.draw(oe,de.TRIANGLES,ur.disabled,ge,we,nr.backCCW,Hd($e,le.zoom,se.paint.get("heatmap-intensity"),mt),null,ht,se.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,se.paint,le.zoom,Ne)}oe.viewport.set([0,0,W.width,W.height])})(S,E,I,z):S.renderPass==="translucent"&&(function(W,re){const se=W.context,ae=se.gl;se.setColorMode(W.colorModeForRenderPass());const oe=re.heatmapFbos.get(l.c2);oe&&(se.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,oe.colorAttachment.get()),se.activeTexture.set(ae.TEXTURE1),$l(se,re).bind(ae.LINEAR,ae.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(se,ae.TRIANGLES,ur.disabled,Ir.disabled,W.colorModeForRenderPass(),nr.disabled,Ch(W,re,0,1),null,null,re.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,re.paint,W.transform.zoom))})(S,I)})(e,s,h,p,y):l.ce(h)?(function(S,E,I,z,D){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,j=I.paint.get("line-opacity"),$=I.paint.get("line-width");if(j.constantOr(1)===0||$.constantOr(1)===0)return;const W=S.getDepthModeForSublayer(0,ur.ReadOnly),re=S.colorModeForRenderPass(),se=I.paint.get("line-dasharray"),ae=I.paint.get("line-pattern"),oe=ae.constantOr(1),de=I.paint.get("line-gradient"),le=I.getCrossfadeParameters(),ge=oe?"linePattern":se?"lineSDF":de?"lineGradient":"line",we=S.context,he=we.gl,ke=S.transform;let $e=!0;for(const je of z){const Ne=E.getTile(je);if(oe&&!Ne.patternsLoaded())continue;const Ze=Ne.getBucket(I);if(!Ze)continue;const ht=Ze.programConfigurations.get(I.id),mt=S.context.program.get(),rt=S.useProgram(ge,ht),Ft=$e||rt.program!==mt,br=S.style.map.terrain&&S.style.map.terrain.getTerrainData(je),Zr=ae.constantOr(null);if(Zr&&Ne.imageAtlas){const mr=Ne.imageAtlas,Xr=mr.patternPositions[Zr.to.toString()],Dn=mr.patternPositions[Zr.from.toString()];Xr&&Dn&&ht.setConstantPatternPositions(Xr,Dn)}const nn=ke.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Qr=ke.getPixelScale(),un=oe?Ah(S,Ne,I,Qr,le):se?go(S,Ne,I,Qr,se,le):de?Mh(S,Ne,I,Qr,Ze.lineClipsArray.length):wc(S,Ne,I,Qr);if(oe)we.activeTexture.set(he.TEXTURE0),Ne.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),ht.updatePaintBuffers(le);else if(se&&(Ft||S.lineAtlas.dirty))we.activeTexture.set(he.TEXTURE0),S.lineAtlas.bind(we);else if(de){const mr=Ze.gradients[I.id];let Xr=mr.texture;if(I.gradientVersion!==mr.version){let Dn=256;if(I.stepInterpolant){const Ln=E.getSource().maxzoom,Kn=je.canonical.z===Ln?Math.ceil(1<<S.transform.maxZoom-je.canonical.z):1;Dn=l.ah(l.c3(Ze.maxLineLength/l.$*1024*Kn),256,we.maxTextureSize)}mr.gradient=l.c4({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Dn,image:mr.gradient||void 0,clips:Ze.lineClipsArray}),mr.texture?mr.texture.update(mr.gradient):mr.texture=new l.T(we,mr.gradient,he.RGBA),mr.version=I.gradientVersion,Xr=mr.texture}we.activeTexture.set(he.TEXTURE0),Xr.bind(I.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}const xn=S.stencilModeForClipping(je);rt.draw(we,he.TRIANGLES,W,xn,re,nr.disabled,un,br,nn,I.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,I.paint,S.transform.zoom,ht,Ze.layoutVertexBuffer2),$e=!1}})(e,s,h,p,y):l.cf(h)?(function(S,E,I,z,D){const B=I.paint.get("fill-color"),j=I.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:$}=D,W=S.colorModeForRenderPass(),re=I.paint.get("fill-pattern"),se=S.opaquePassEnabledForLayer()&&!re.constantOr(1)&&B.constantOr(l.bf.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===se){const ae=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?ur.ReadWrite:ur.ReadOnly);ku(S,E,I,z,ae,W,!1,$)}if(S.renderPass==="translucent"&&I.paint.get("fill-antialias")){const ae=S.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,ur.ReadOnly);ku(S,E,I,z,ae,W,!0,$)}})(e,s,h,p,y):l.cg(h)?(function(S,E,I,z,D){const B=I.paint.get("fill-extrusion-opacity");if(B===0)return;const{isRenderingToTexture:j}=D;if(S.renderPass==="translucent"){const $=new ur(S.context.gl.LEQUAL,ur.ReadWrite,S.depthRangeFor3D);if(B!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))Eu(S,E,I,z,$,Ir.disabled,on.disabled,j),Eu(S,E,I,z,$,S.stencilModeFor3D(),S.colorModeForRenderPass(),j);else{const W=S.colorModeForRenderPass();Eu(S,E,I,z,$,Ir.disabled,W,j)}}})(e,s,h,p,y):l.ch(h)?(function(S,E,I,z,D){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,j=S.context,$=S.style.projection.useSubdivision,W=S.getDepthModeForSublayer(0,ur.ReadOnly),re=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(se,ae,oe,de,le,ge,we){const he=se.context,ke=he.gl;for(const $e of oe){const je=ae.getTile($e),Ne=je.dem;if(!Ne||!Ne.data||!je.needsHillshadePrepare)continue;const Ze=Ne.dim,ht=Ne.stride,mt=Ne.getPixels();if(he.activeTexture.set(ke.TEXTURE1),he.pixelStoreUnpackPremultiplyAlpha.set(!1),je.demTexture=je.demTexture||se.getTileTexture(ht),je.demTexture){const Ft=je.demTexture;Ft.update(mt,{premultiply:!1}),Ft.bind(ke.NEAREST,ke.CLAMP_TO_EDGE)}else je.demTexture=new l.T(he,mt,ke.RGBA,{premultiply:!1}),je.demTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);he.activeTexture.set(ke.TEXTURE0);let rt=je.fbo;if(!rt){const Ft=new l.T(he,{width:Ze,height:Ze,data:null},ke.RGBA);Ft.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),rt=je.fbo=he.createFramebuffer(Ze,Ze,!0,!1),rt.colorAttachment.set(Ft.texture)}he.bindFramebuffer.set(rt.framebuffer),he.viewport.set([0,0,Ze,Ze]),se.useProgram("hillshadePrepare").draw(he,ke.TRIANGLES,le,ge,we,nr.disabled,Al(je.tileID,Ne),null,null,de.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),je.needsHillshadePrepare=!1}})(S,E,z,I,W,Ir.disabled,re),j.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if($){const[se,ae,oe]=S.stencilConfigForOverlapTwoPass(z);pa(S,E,I,oe,se,W,re,!1,B),pa(S,E,I,oe,ae,W,re,!0,B)}else{const[se,ae]=S.getStencilConfigForOverlapAndUpdateStencilID(z);pa(S,E,I,ae,se,W,re,!1,B)}})(e,s,h,p,y):l.ci(h)?(function(S,E,I,z,D){if(S.renderPass!=="translucent"||!z.length)return;const{isRenderingToTexture:B}=D,j=S.style.projection.useSubdivision,$=S.getDepthModeForSublayer(0,ur.ReadOnly),W=S.colorModeForRenderPass();if(j){const[re,se,ae]=S.stencilConfigForOverlapTwoPass(z);Ul(S,E,I,ae,re,$,W,!1,B),Ul(S,E,I,ae,se,$,W,!0,B)}else{const[re,se]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Ul(S,E,I,se,re,$,W,!1,B)}})(e,s,h,p,y):l.cj(h)?(function(S,E,I,z,D){if(S.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!z.length)return;const{isRenderingToTexture:B}=D,j=E.getSource(),$=S.style.projection.useSubdivision;if(j instanceof Zn)Na(S,E,I,z,null,!1,!1,j.tileCoords,j.flippedWindingOrder,B);else if($){const[W,re,se]=S.stencilConfigForOverlapTwoPass(z);Na(S,E,I,se,W,!1,!0,Vl,!1,B),Na(S,E,I,se,re,!0,!0,Vl,!1,B)}else{const[W,re]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Na(S,E,I,re,W,!1,!0,Vl,!1,B)}})(e,s,h,p,y):l.ck(h)?(function(S,E,I,z,D){const B=I.paint.get("background-color"),j=I.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:$}=D,W=S.context,re=W.gl,se=S.style.projection,ae=S.transform,oe=ae.tileSize,de=I.paint.get("background-pattern");if(S.isPatternMissing(de))return;const le=!de&&B.a===1&&j===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==le)return;const ge=Ir.disabled,we=S.getDepthModeForSublayer(0,le==="opaque"?ur.ReadWrite:ur.ReadOnly),he=S.colorModeForRenderPass(),ke=S.useProgram(de?"backgroundPattern":"background"),$e=z||Ce(ae,{tileSize:oe,terrain:S.style.map.terrain});de&&(W.activeTexture.set(re.TEXTURE0),S.imageManager.bind(S.context));const je=I.getCrossfadeParameters();for(const Ne of $e){const Ze=ae.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),ht=de?Kd(j,S,de,{tileID:Ne,tileSize:oe},je):zl(j,B),mt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ne),rt=se.getMeshFromTileID(W,Ne.canonical,!1,!0,"raster");ke.draw(W,re.TRIANGLES,we,ge,he,nr.backCCW,ht,mt,Ze,I.id,rt.vertexBuffer,rt.indexBuffer,rt.segments)}})(e,0,h,p,y):l.cl(h)&&(function(S,E,I,z){const{isRenderingGlobe:D}=z,B=S.context,j=I.implementation,$=S.style.projection,W=S.transform,re=W.getProjectionDataForCustomLayer(D),se={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:re},ae=j.renderingMode?j.renderingMode:"2d";if(S.renderPass==="offscreen"){const oe=j.prerender;oe&&(S.setCustomLayerDefaults(),B.setColorMode(S.colorModeForRenderPass()),oe.call(j,B.gl,se),B.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),B.setColorMode(S.colorModeForRenderPass()),B.setStencilMode(Ir.disabled);const oe=ae==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,ur.ReadOnly);B.setDepthMode(oe),j.render(B.gl,se),B.setDirty(),S.setBaseState(),B.bindFramebuffer.set(null)}})(e,0,h,y))}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),h=this.imageManager.getPattern(e.to.toString());return!s||!h}useProgram(e,s,h=!1,p=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,S=this.style.projection,E=h?Es.projectionMercator:S.shaderPreludeCode,I=h?ca:S.shaderDefine,z=e+(s?s.cacheKey:"")+`/${h?uo:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(p?`/${p.join("/")}`:"");return this.cache[z]||(this.cache[z]=new Ph(this.context,Es[e],s,Dh[e],this._showOverdrawInspector,y,E,I,p)),this.cache[z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}function $a(g,e){let s,h=!1,p=null,y=null;const S=()=>{p=null,h&&(g.apply(y,s),p=setTimeout(S,e),h=!1)};return(...E)=>(h=!0,y=this,s=E,p||S(),p)}class Mu{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map((p=>p.split("="))).forEach((p=>{p[0]===this._hashName&&(h=p)})),(h&&h[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(!this._isValidHash(s))return!1;const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:h,pitch:+(s[4]||0)}),!0},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const h=s.join("/");let p=h;p.split("&").length>0&&(p=p.split("&")[0]),this._hashName&&(p=`${this._hashName}=${h}`);let y=window.location.hash.replace(p,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let S=window.location.href.replace(/(#.+)?$/,y);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=$a(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,p=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),S=Math.round(s.lng*y)/y,E=Math.round(s.lat*y)/y,I=this._map.getBearing(),z=this._map.getPitch();let D="";if(D+=e?`/${S}/${E}/${h}`:`${h}/${E}/${S}`,(I||z)&&(D+="/"+Math.round(10*I)/10),z&&(D+=`/${Math.round(z)}`),this._hashName){const B=this._hashName;let j=!1;const $=window.location.hash.slice(1).split("&").map((W=>{const re=W.split("=")[0];return re===B?(j=!0,`${re}=${D}`):W})).filter((W=>W));return j||$.push(`${B}=${D}`),`#${$.join("&")}`}return`#${D}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new l.S(+e[2],+e[1])}catch{return!1}const s=+e[0],h=+(e[3]||0),p=+(e[4]||0);return s>=this._map.getMinZoom()&&s<=this._map.getMaxZoom()&&h>=-180&&h<=180&&p>=this._map.getMinPitch()&&p<=this._map.getMaxPitch()}}const Ua={linearity:.3,easing:l.cm(0,0,.3,1)},Va=l.e({deceleration:2500,maxSpeed:1400},Ua),Zl=l.e({deceleration:20,maxSpeed:1400},Ua),Xo=l.e({deceleration:1e3,maxSpeed:360},Ua),Oc=l.e({deceleration:1e3,maxSpeed:90},Ua),Au=l.e({deceleration:1e3,maxSpeed:360},Ua);class Yo{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ee.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=ee.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,s.roll+=y.rollDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const y=rn(s.pan.mag(),h,l.e({},Va,e||{})),S=s.pan.mult(y.amount/s.pan.mag()),E=this._map.cameraHelper.handlePanInertia(S,this._map.transform);p.center=E.easingCenter,p.offset=E.easingOffset,ii(p,y)}if(s.zoom){const y=rn(s.zoom,h,Zl);p.zoom=this._map.transform.zoom+y.amount,ii(p,y)}if(s.bearing){const y=rn(s.bearing,h,Xo);p.bearing=this._map.transform.bearing+l.ah(y.amount,-179,179),ii(p,y)}if(s.pitch){const y=rn(s.pitch,h,Oc);p.pitch=this._map.transform.pitch+y.amount,ii(p,y)}if(s.roll){const y=rn(s.roll,h,Au);p.roll=this._map.transform.roll+l.ah(y.amount,-179,179),ii(p,y)}if(p.zoom||p.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;p.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),l.e(p,{noMoveStart:!0})}}function ii(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function rn(g,e,s){const{maxSpeed:h,linearity:p,deceleration:y}=s,S=l.ah(g*p/(e/1e3),-h,h),E=Math.abs(S)/(y*p);return{easing:s.easing,duration:1e3*E,amount:S*(E/2)}}class Or extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,h,p={}){h=h instanceof MouseEvent?h:new MouseEvent(e,h);const y=q.mousePos(s.getCanvas(),h),S=s.unproject(y);super(e,l.e({point:y,lngLat:S,originalEvent:h},p)),this._defaultPrevented=!1,this.target=s}}class gs extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,h){const p=e==="touchend"?h.changedTouches:h.touches,y=q.touchPos(s.getCanvasContainer(),p),S=y.map((I=>s.unproject(I))),E=y.reduce(((I,z,D,B)=>I.add(z.div(B.length))),new l.P(0,0));super(e,{points:y,point:E,lngLats:S,lngLat:s.unproject(E),originalEvent:h}),this._defaultPrevented=!1}}class si extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,h){super(e,{originalEvent:h}),this._defaultPrevented=!1}}class zi{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new si(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new Or(e.type,this._map,e))}mouseup(e){this._map.fire(new Or(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Or(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Or(e.type,this._map,e))}mouseover(e){this._map.fire(new Or(e.type,this._map,e))}mouseout(e){this._map.fire(new Or(e.type,this._map,e))}touchstart(e){return this._firePreventable(new gs(e.type,this._map,e))}touchmove(e){this._map.fire(new gs(e.type,this._map,e))}touchend(e){this._map.fire(new gs(e.type,this._map,e))}touchcancel(e){this._map.fire(new gs(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class So{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Or(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Or("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Or(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hs{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(l.P.convert(e),this._map.terrain)}}class wi{constructor(e,s){this._map=e,this._tr=new Hs(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(q.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const h=s;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=h,this._box||(this._box=q.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const y=Math.min(p.x,h.x),S=Math.max(p.x,h.x),E=Math.min(p.y,h.y),I=Math.max(p.y,h.y);q.setTransform(this._box,`translate(${y}px,${E}px)`),this._box.style.width=S-y+"px",this._box.style.height=I-E+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const h=this._startPos,p=s;if(this.reset(),q.suppressClick(),h.x!==p.x||h.y!==p.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:e})),{cameraAnimation:y=>y.fitScreenCoordinates(h,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new l.l(e,{originalEvent:s}))}}function Za(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const s={};for(let h=0;h<g.length;h++)s[g[h].identifier]=e[h];return s}class Zh{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),h.length===this.numTouches&&(this.centroid=(function(p){const y=new l.P(0,0);for(const S of p)y._add(S);return y.div(p.length)})(s),this.touches=Za(h,s)))}touchmove(e,s,h){if(this.aborted||!this.centroid)return;const p=Za(h,s);for(const y in this.touches){const S=p[y];(!S||S.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(e,s,h){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Di{constructor(e){this.singleTap=new Zh(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,h){this.singleTap.touchstart(e,s,h)}touchmove(e,s,h){this.singleTap.touchmove(e,s,h)}touchend(e,s,h){const p=this.singleTap.touchend(e,s,h);if(p){const y=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(p)<30;if(y&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Qi{constructor(e){this._tr=new Hs(e),this._zoomIn=new Di({numTouches:1,numTaps:2}),this._zoomOut=new Di({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,h){this._zoomIn.touchstart(e,s,h),this._zoomOut.touchstart(e,s,h)}touchmove(e,s,h){this._zoomIn.touchmove(e,s,h),this._zoomOut.touchmove(e,s,h)}touchend(e,s,h){const p=this._zoomIn.touchend(e,s,h),y=this._zoomOut.touchend(e,s,h),S=this._tr;return p?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(p)},{originalEvent:e})}):y?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(y)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qo{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.rollDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(s)?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const p=Array.isArray(s)?s[0]:s;return!this._moved&&p.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(h,p))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&q.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Hn=0,Ga=2,Gh={[Hn]:1,[Ga]:2};class Gl{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=q.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(s,h){const p=Gh[h];return s.buttons===void 0||(s.buttons&p)!==p})(e,this._eventButton)}isValidEndEvent(e){return q.mouseButton(e)===this._eventButton}}class lp{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class To{constructor(e=new Gl({checkCorrectEvent:()=>!0}),s=new lp){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=s}_executeRelevantHandler(e,s,h){return e instanceof MouseEvent?s(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?h(e):void 0}startMove(e){this._executeRelevantHandler(e,(s=>this.mouseMoveStateManager.startMove(s)),(s=>this.oneFingerTouchMoveStateManager.startMove(s)))}endMove(e){this._executeRelevantHandler(e,(s=>this.mouseMoveStateManager.endMove(s)),(s=>this.oneFingerTouchMoveStateManager.endMove(s)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(s=>this.mouseMoveStateManager.isValidStartEvent(s)),(s=>this.oneFingerTouchMoveStateManager.isValidStartEvent(s)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(s=>this.mouseMoveStateManager.isValidMoveEvent(s)),(s=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(s)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(s=>this.mouseMoveStateManager.isValidEndEvent(s)),(s=>this.oneFingerTouchMoveStateManager.isValidEndEvent(s)))}}const ga=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}};class ya{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,h){return this._calculateTransform(e,s,h)}touchmove(e,s,h){if(this._active){if(!this._shouldBePrevented(h.length))return e.preventDefault(),this._calculateTransform(e,s,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,h){this._calculateTransform(e,s,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,h){h.length>0&&(this._active=!0);const p=Za(h,s),y=new l.P(0,0),S=new l.P(0,0);let E=0;for(const z in p){const D=p[z],B=this._touches[z];B&&(y._add(D),S._add(D.sub(B)),E++,p[z]=D)}if(this._touches=p,this._shouldBePrevented(E)||!S.mag())return;const I=S.div(E);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(E),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ji{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,h){if(!this._firstTwoTouches)return;e.preventDefault();const[p,y]=this._firstTwoTouches,S=kt(h,s,p),E=kt(h,s,y);if(!S||!E)return;const I=this._aroundCenter?null:S.add(E).div(2);return this._move([S,E],I,e)}touchend(e,s,h){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,S=kt(h,s,p),E=kt(h,s,y);S&&E||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function kt(g,e,s){for(let h=0;h<g.length;h++)if(g[h].identifier===s)return e[h]}function es(g,e){return Math.log(g/e)/Math.LN2}class Li extends Ji{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const h=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(es(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:es(this._distance,h),pinchAround:s}}}function qa(g,e){return 180*g.angleWith(e)/Math.PI}class ts extends Ji{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,h){const p=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qa(this._vector,p),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,h=qa(e,this._startVector);return Math.abs(h)<s}}function Fi(g){return Math.abs(g.y)>Math.abs(g.x)}class _a extends Ji{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,h){super.touchstart(e,s,h),this._currentTouchCount=h.length}_start(e){this._lastPoints=e,Fi(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const p=e[0].sub(this._lastPoints[0]),y=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,y,h.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(p.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,h){if(this._valid!==void 0)return this._valid;const p=e.mag()>=2,y=s.mag()>=2;if(!p&&!y)return;if(!p||!y)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const S=e.y>0==s.y>0;return Fi(e)&&Fi(s)&&S}}const Fr={panStep:100,bearingStep:15,pitchStep:10};class ql{constructor(e){this._tr=new Hs(e);const s=Fr;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,h=0,p=0,y=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?h=-1:(e.preventDefault(),y=-1);break;case 39:e.shiftKey?h=1:(e.preventDefault(),y=1);break;case 38:e.shiftKey?p=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?p=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(h=0,p=0),{cameraAnimation:E=>{const I=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:qh,zoom:s?Math.round(I.zoom)+s*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+h*this._bearingStep,pitch:I.pitch+p*this._pitchStep,offset:[-y*this._panStep,-S*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qh(g){return g*(2-g)}const Si=4.000244140625,ys=1/450;class vn{constructor(e,s){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=e,this._tr=new Hs(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ys}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const h=ee.now(),p=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,s!==0&&s%Si==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=q.mousePos(this._map.getCanvas(),e),h=this._tr;this._aroundPoint=this._aroundCenter?h.transform.locationToScreenPoint(l.S.convert(h.center)):s,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const E=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=E),typeof this._targetZoom=="number"&&(this._targetZoom+=E)}if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Si?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&I!==0&&(I=1/I);const z=typeof this._targetZoom!="number"?e.scale:l.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),l.ak(z*I)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,h=this._startZoom,p=this._easing;let y,S=!1;if(this._type==="wheel"&&h&&p){const E=ee.now()-this._lastWheelEventTime,I=Math.min((E+5)/200,1),z=p(I);y=l.C.number(h,s,z),I<1?this._frameId||(this._frameId=!0):S=!0}else y=s,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!S,zoomDelta:y-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=l.co;if(this._prevEase){const h=this._prevEase,p=(ee.now()-h.start)/h.duration,y=h.easing(p+.01)-h.easing(p),S=.27/Math.sqrt(y*y+1e-4)*.01,E=Math.sqrt(.0729-S*S);s=l.cm(S,E,.25,1)}return this._prevEase={start:ee.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _s{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ru{constructor(e){this._tr=new Hs(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wh{constructor(){this._tap=new Di({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,h){if(!this._swipePoint)if(this._tapTime){const p=s[0],y=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(p)<30;y&&S?h.length>0&&(this._swipePoint=p,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(e,s,h)}touchmove(e,s,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const p=s[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,e.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(e,s,h)}touchend(e,s,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const p=this._tap.touchend(e,s,h);p&&(this._tapTime=e.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zu{constructor(e,s,h){this._el=e,this._mousePan=s,this._touchPan=h}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class jc{constructor(e,s,h,p){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=s,this._mousePitch=h,this._mouseRoll=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Hh{constructor(e,s,h,p){this._el=e,this._touchZoom=s,this._touchRotate=h,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Nc{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=q.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=s,this._container.appendChild(p);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=h,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(q.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Ms=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class Wr extends l.l{}function Po(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Kh{constructor(e,s){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,y)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=p.type==="renderFrame"?void 0:p,E={needsRenderFrame:!1},I={},z={};for(const{handlerName:j,handler:$,allowed:W}of this._handlers){if(!$.isEnabled())continue;let re;if(this._blockedByActive(z,W,j))$.reset();else if($[y||p.type]){if(l.cp(p,y||p.type)){const se=q.mousePos(this._map.getCanvas(),p);re=$[y||p.type](p,se)}else if(l.cq(p,y||p.type)){const se=this._getMapTouches(p.touches),ae=q.touchPos(this._map.getCanvas(),se);re=$[y||p.type](p,ae,se)}else l.cr(y||p.type)||(re=$[y||p.type](p));this.mergeHandlerResult(E,I,re,j,S),re&&re.needsRenderFrame&&this._triggerRenderFrame()}(re||$.isActive())&&(z[j]=$)}const D={};for(const j in this._previousActiveHandlers)z[j]||(D[j]=S);this._previousActiveHandlers=z,(Object.keys(D).length||Po(E))&&(this._changes.push([E,I,D]),this._triggerRenderFrame()),(Object.keys(z).length||Po(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=E;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Yo(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,S]of this._listeners)q.addEventListener(p,y,p===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,s,h]of this._listeners)q.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(e){const s=this._map,h=s.getCanvasContainer();this._add("mapEvent",new zi(s,e));const p=s.boxZoom=new wi(s,e);this._add("boxZoom",p),e.interactive&&e.boxZoom&&p.enable();const y=s.cooperativeGestures=new Nc(s,e.cooperativeGestures);this._add("cooperativeGestures",y),e.cooperativeGestures&&y.enable();const S=new Qi(s),E=new Ru(s);s.doubleClickZoom=new _s(E,S),this._add("tapZoom",S),this._add("clickZoom",E),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const I=new Wh;this._add("tapDragZoom",I);const z=s.touchPitch=new _a(s);this._add("touchPitch",z),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const D=()=>s.project(s.getCenter()),B=(function({enable:le,clickTolerance:ge,aroundCenter:we=!0,minPixelCenterThreshold:he=100,rotateDegreesPerPixelMoved:ke=.8},$e){const je=new Gl({checkCorrectEvent:Ne=>q.mouseButton(Ne)===0&&Ne.ctrlKey||q.mouseButton(Ne)===2&&!Ne.ctrlKey});return new Qo({clickTolerance:ge,move:(Ne,Ze)=>{const ht=$e();if(we&&Math.abs(ht.y-Ne.y)>he)return{bearingDelta:l.cn(new l.P(Ne.x,Ze.y),Ze,ht)};let mt=(Ze.x-Ne.x)*ke;return we&&Ze.y<ht.y&&(mt=-mt),{bearingDelta:mt}},moveStateManager:je,enable:le,assignEvents:ga})})(e,D),j=(function({enable:le,clickTolerance:ge,pitchDegreesPerPixelMoved:we=-.5}){const he=new Gl({checkCorrectEvent:ke=>q.mouseButton(ke)===0&&ke.ctrlKey||q.mouseButton(ke)===2});return new Qo({clickTolerance:ge,move:(ke,$e)=>({pitchDelta:($e.y-ke.y)*we}),moveStateManager:he,enable:le,assignEvents:ga})})(e),$=(function({enable:le,clickTolerance:ge,rollDegreesPerPixelMoved:we=.3},he){const ke=new Gl({checkCorrectEvent:$e=>q.mouseButton($e)===2&&$e.ctrlKey});return new Qo({clickTolerance:ge,move:($e,je)=>{const Ne=he();let Ze=(je.x-$e.x)*we;return je.y<Ne.y&&(Ze=-Ze),{rollDelta:Ze}},moveStateManager:ke,enable:le,assignEvents:ga})})(e,D);s.dragRotate=new jc(e,B,j,$),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const W=(function({enable:le,clickTolerance:ge}){const we=new Gl({checkCorrectEvent:he=>q.mouseButton(he)===0&&!he.ctrlKey});return new Qo({clickTolerance:ge,move:(he,ke)=>({around:ke,panDelta:ke.sub(he)}),activateOnStart:!0,moveStateManager:we,enable:le,assignEvents:ga})})(e),re=new ya(e,s);s.dragPan=new zu(h,W,re),this._add("mousePan",W),this._add("touchPan",re,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const se=new ts,ae=new Li;s.touchZoomRotate=new Hh(h,ae,se,I),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const oe=s.scrollZoom=new vn(s,(()=>this._triggerRenderFrame()));this._add("scrollZoom",oe,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const de=s.keyboard=new ql(s);this._add("keyboard",de),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new So(s))}_add(e,s,h){this._handlers.push({handlerName:e,handler:s,allowed:h}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ms(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,h){for(const p in e)if(p!==h&&(!s||s.indexOf(p)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const h of e)this._el.contains(h.target)&&s.push(h);return s}mergeHandlerResult(e,s,h,p,y){if(!h)return;l.e(e,h);const S={handlerName:p,originalEvent:h.originalEvent||y};h.zoomDelta!==void 0&&(s.zoom=S),h.panDelta!==void 0&&(s.drag=S),h.rollDelta!==void 0&&(s.roll=S),h.pitchDelta!==void 0&&(s.pitch=S),h.bearingDelta!==void 0&&(s.rotate=S)}_applyChanges(){const e={},s={},h={};for(const[p,y,S]of this._changes)p.panDelta&&(e.panDelta=(e.panDelta||new l.P(0,0))._add(p.panDelta)),p.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+p.pitchDelta),p.rollDelta&&(e.rollDelta=(e.rollDelta||0)+p.rollDelta),p.around!==void 0&&(e.around=p.around),p.pinchAround!==void 0&&(e.pinchAround=p.pinchAround),p.noInertia&&(e.noInertia=p.noInertia),l.e(s,y),l.e(h,S);this._updateMapTransform(e,s,h),this._changes=[]}_updateMapTransform(e,s,h){const p=this._map,y=p._getTransformForUpdate(),S=p.terrain;if(!(Po(e)||S&&this._terrainMovement))return this._fireEvents(s,h,!0);p._stop(!0);let{panDelta:E,zoomDelta:I,bearingDelta:z,pitchDelta:D,rollDelta:B,around:j,pinchAround:$}=e;$!==void 0&&(j=$),j=j||p.transform.centerPoint,S&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const W={panDelta:E,zoomDelta:I,rollDelta:B,pitchDelta:D,bearingDelta:z,around:j};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const re=j.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(E?j.sub(E):j);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,y),this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(E))):this._map.cameraHelper.handleMapControlsPan(W,y,re):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(W,y,re))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,y),this._map.cameraHelper.handleMapControlsPan(W,y,re)),p._applyUpdatedTransform(y),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,h,!0)}_fireEvents(e,s,h){const p=Ms(this._eventsInProgress),y=Ms(e),S={};for(const B in e){const{originalEvent:j}=e[B];this._eventsInProgress[B]||(S[`${B}start`]=j),this._eventsInProgress[B]=e[B]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const B in S)this._fireEvent(B,S[B]);y&&this._fireEvent("move",y.originalEvent);for(const B in e){const{originalEvent:j}=e[B];this._fireEvent(B,j)}const E={};let I;for(const B in this._eventsInProgress){const{handlerName:j,originalEvent:$}=this._eventsInProgress[B];this._handlersById[j].isActive()||(delete this._eventsInProgress[B],I=s[j]||$,E[`${B}end`]=I)}for(const B in E)this._fireEvent(B,E[B]);const z=Ms(this._eventsInProgress),D=(p||y)&&!z;if(D&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&B.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(B)}if(h&&D){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!B||!B.essential&&ee.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:I})),j(this._map.getBearing())&&this._map.resetNorth()):(j(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new l.l(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Wr("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Wl extends l.E{constructor(e,s,h){super(),this._renderFrameCallback=()=>{const p=Math.min((ee.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=h.bearingSnap,this.cameraHelper=s,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,s){e.apply(this.transform),this.transform=e,this.cameraHelper=s}getCenter(){return new l.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,s){return this.jumpTo({elevation:e},s),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,s,h){return e=l.P.convert(e).mult(-1),this.panTo(this.transform.center,l.e({offset:e},s),h)}panTo(e,s,h){return this.easeTo(l.e({center:e},s),h)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,h){return this.easeTo(l.e({zoom:e},s),h)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,s){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new l.l("movestart",s)).fire(new l.l("move",s)).fire(new l.l("moveend",s))),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,h){return this.easeTo(l.e({bearing:e},s),h)}resetNorth(e,s){return this.rotateTo(0,l.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}getRoll(){return this.transform.roll}setRoll(e,s){return this.jumpTo({roll:e},s),this}cameraForBounds(e,s){e=Vr.convert(e).adjustAntiMeridian();const h=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),h,s)}_cameraForBoxAndBearing(e,s,h,p){const y={top:0,bottom:0,right:0,left:0};if(typeof(p=l.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const z=p.padding;p.padding={top:z,bottom:z,right:z,left:z}}const S=l.e(y,p.padding);p.padding=S;const E=this.transform,I=new Vr(e,s);return this.cameraHelper.cameraForBoxAndBearing(p,S,I,h,E)}fitBounds(e,s,h){return this._fitInternal(this.cameraForBounds(e,s),s,h)}fitScreenCoordinates(e,s,h,p,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(e)),this.transform.screenPointToLocation(l.P.convert(s)),h,p),p,y)}_fitInternal(e,s,h){return e?(delete(s=l.e(e,s)).padding,s.linear?this.easeTo(s,h):this.flyTo(s,h)):this}jumpTo(e,s){this.stop();const h=this._getTransformForUpdate();let p=!1,y=!1,S=!1;const E=h.zoom;this.cameraHelper.handleJumpToCenterZoom(h,e);const I=h.zoom!==E;return"elevation"in e&&h.elevation!==+e.elevation&&h.setElevation(+e.elevation),"bearing"in e&&h.bearing!==+e.bearing&&(p=!0,h.setBearing(+e.bearing)),"pitch"in e&&h.pitch!==+e.pitch&&(y=!0,h.setPitch(+e.pitch)),"roll"in e&&h.roll!==+e.roll&&(S=!0,h.setRoll(+e.roll)),e.padding==null||h.isPaddingEqual(e.padding)||h.setPadding(e.padding),this._applyUpdatedTransform(h),this.fire(new l.l("movestart",s)).fire(new l.l("move",s)),I&&this.fire(new l.l("zoomstart",s)).fire(new l.l("zoom",s)).fire(new l.l("zoomend",s)),p&&this.fire(new l.l("rotatestart",s)).fire(new l.l("rotate",s)).fire(new l.l("rotateend",s)),y&&this.fire(new l.l("pitchstart",s)).fire(new l.l("pitch",s)).fire(new l.l("pitchend",s)),S&&this.fire(new l.l("rollstart",s)).fire(new l.l("roll",s)).fire(new l.l("rollend",s)),this.fire(new l.l("moveend",s))}calculateCameraOptionsFromTo(e,s,h,p=0){const y=l.a1.fromLngLat(e,s),S=l.a1.fromLngLat(h,p),E=S.x-y.x,I=S.y-y.y,z=S.z-y.z,D=Math.hypot(E,I,z);if(D===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(E,I),j=l.ak(this.transform.cameraToCenterDistance/D/this.transform.tileSize),$=180*Math.atan2(E,-I)/Math.PI;let W=180*Math.acos(B/D)/Math.PI;return W=z<0?90-W:90+W,{center:S.toLngLat(),elevation:p,zoom:j,pitch:W,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,s,h,p,y){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,s,h,p);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:h,pitch:p,roll:y}}easeTo(e,s){this._stop(!1,e.easeId),((e=l.e({offset:[0,0],duration:500,easing:l.co},e)).animate===!1||!e.essential&&ee.prefersReducedMotion)&&(e.duration=0);const h=this._getTransformForUpdate(),p=this.getBearing(),y=h.pitch,S=h.roll,E="bearing"in e?this._normalizeBearing(e.bearing,p):p,I="pitch"in e?+e.pitch:y,z="roll"in e?this._normalizeBearing(e.roll,S):S,D="padding"in e?e.padding:h.padding,B=l.P.convert(e.offset);let j,$;e.around&&(j=l.S.convert(e.around),$=h.locationToScreenPoint(j));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},re=this.cameraHelper.handleEaseTo(h,{bearing:E,pitch:I,roll:z,padding:D,around:j,aroundPoint:$,offsetAsPoint:B,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||p!==E,this._pitching=this._pitching||I!==y,this._rolling=this._rolling||z!==S,this._padding=!h.isPaddingEqual(D),this._zooming=this._zooming||re.isZooming,this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,W),this.terrain&&this._prepareElevation(re.elevationCenter),this._ease((se=>{re.easeFunc(se),this.terrain&&!e.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(h),this._fireMoveEvents(s)}),(se=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,se)}),e),this}_prepareEase(e,s,h={}){this._moving=!0,s||h.moving||this.fire(new l.l("movestart",e)),this._zooming&&!h.zooming&&this.fire(new l.l("zoomstart",e)),this._rotating&&!h.rotating&&this.fire(new l.l("rotatestart",e)),this._pitching&&!h.pitching&&this.fire(new l.l("pitchstart",e)),this._rolling&&!h.rolling&&this.fire(new l.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(h-(s-(h*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.setElevation(l.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const s=e.getCameraLngLat(),h=e.getCameraAltitude(),p=this.terrain?this.terrain.getElevationForLngLatZoom(s,e.zoom):0;if(h<p){const y=this.calculateCameraOptionsFromTo(s,p,e.center,e.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(s.push((p=>this._elevateCameraIfInsideTerrain(p))),this.transformCameraUpdate&&s.push((p=>this.transformCameraUpdate(p))),!s.length)return;const h=e.clone();for(const p of s){const y=h.clone(),{center:S,zoom:E,roll:I,pitch:z,bearing:D,elevation:B}=p(y);S&&y.setCenter(S),B!==void 0&&y.setElevation(B),E!==void 0&&y.setZoom(E),I!==void 0&&y.setRoll(I),z!==void 0&&y.setPitch(z),D!==void 0&&y.setBearing(D),h.apply(y)}this.transform.apply(h)}_fireMoveEvents(e){this.fire(new l.l("move",e)),this._zooming&&this.fire(new l.l("zoom",e)),this._rotating&&this.fire(new l.l("rotate",e)),this._pitching&&this.fire(new l.l("pitch",e)),this._rolling&&this.fire(new l.l("roll",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const h=this._zooming,p=this._rotating,y=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,h&&this.fire(new l.l("zoomend",e)),p&&this.fire(new l.l("rotateend",e)),y&&this.fire(new l.l("pitchend",e)),S&&this.fire(new l.l("rollend",e)),this.fire(new l.l("moveend",e))}flyTo(e,s){if(!e.essential&&ee.prefersReducedMotion){const Ze=l.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ze,s)}this.stop(),e=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.co},e);const h=this._getTransformForUpdate(),p=h.bearing,y=h.pitch,S=h.roll,E=h.padding,I="bearing"in e?this._normalizeBearing(e.bearing,p):p,z="pitch"in e?+e.pitch:y,D="roll"in e?this._normalizeBearing(e.roll,S):S,B="padding"in e?e.padding:h.padding,j=l.P.convert(e.offset);let $=h.centerPoint.add(j);const W=h.screenPointToLocation($),re=this.cameraHelper.handleFlyTo(h,{bearing:I,pitch:z,roll:D,padding:B,locationAtOffset:W,offsetAsPoint:j,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let se=e.curve;const ae=Math.max(h.width,h.height),oe=ae/re.scaleOfZoom,de=re.pixelPathLength;typeof re.scaleOfMinZoom=="number"&&(se=Math.sqrt(ae/re.scaleOfMinZoom/de*2));const le=se*se;function ge(Ze){const ht=(oe*oe-ae*ae+(Ze?-1:1)*le*le*de*de)/(2*(Ze?oe:ae)*le*de);return Math.log(Math.sqrt(ht*ht+1)-ht)}function we(Ze){return(Math.exp(Ze)-Math.exp(-Ze))/2}function he(Ze){return(Math.exp(Ze)+Math.exp(-Ze))/2}const ke=ge(!1);let $e=function(Ze){return he(ke)/he(ke+se*Ze)},je=function(Ze){return ae*((he(ke)*(we(ht=ke+se*Ze)/he(ht))-we(ke))/le)/de;var ht},Ne=(ge(!0)-ke)/se;if(Math.abs(de)<2e-6||!isFinite(Ne)){if(Math.abs(ae-oe)<1e-6)return this.easeTo(e,s);const Ze=oe<ae?-1:1;Ne=Math.abs(Math.log(oe/ae))/se,je=()=>0,$e=ht=>Math.exp(Ze*se*ht)}return e.duration="duration"in e?+e.duration:1e3*Ne/("screenSpeed"in e?+e.screenSpeed/se:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=p!==I,this._pitching=z!==y,this._rolling=D!==S,this._padding=!h.isPaddingEqual(B),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(re.targetCenter),this._ease((Ze=>{const ht=Ze*Ne,mt=1/$e(ht),rt=je(ht);this._rotating&&h.setBearing(l.C.number(p,I,Ze)),this._pitching&&h.setPitch(l.C.number(y,z,Ze)),this._rolling&&h.setRoll(l.C.number(S,D,Ze)),this._padding&&(h.interpolatePadding(E,B,Ze),$=h.centerPoint.add(j)),re.easeFunc(Ze,mt,rt,$),this.terrain&&!e.freezeElevation&&this._updateElevation(Ze),this._applyUpdatedTransform(h),this._fireMoveEvents(s)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,s)}return e||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(e,s,h){h.animate===!1||h.duration===0?(e(1),s()):(this._easeStart=ee.now(),this._easeOptions=h,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=l.aO(e,-180,180);const h=Math.abs(e-s);return Math.abs(e-360-s)<h&&(e-=360),Math.abs(e+360-s)<h&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(l.S.convert(e),this.transform.tileZoom):null}}const Hl={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Du{constructor(e=Hl){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=q.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=q.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const h=this._map._getUIString(`AttributionControl.${s}`);e.title=h,e.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((p=>typeof p!="string"?"":p))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const y=s[p];if(y.used||y.usedForTerrain){const S=y.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter((p=>String(p).trim())),e.sort(((p,y)=>p.length-y.length)),e=e.filter(((p,y)=>{for(let S=y+1;S<e.length;S++)if(e[S].indexOf(p)>=0)return!1;return!0}));const h=e.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,e.length?(this._innerContainer.innerHTML=q.sanitize(h),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Xh{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=q.create("div","maplibregl-ctrl");const s=q.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Oi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,h=s?this._queue.concat(s):this._queue;for(const p of h)if(p.id===e)return void(p.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const h of s)if(!h.cancelled&&(h.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Bc=l.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Lt extends l.E{constructor(e){super(),this._lastTilesetChange=ee.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const h={};for(const p of Ce(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))h[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.terrainRttPosMatrix32f=new Float64Array(16),l.bY(p.terrainRttPosMatrix32f,0,l.$,l.$,0,0,1),this._tiles[p.key]=new Sr(p,this.tileSize),this._lastTilesetChange=ee.now());for(const p in this._tiles)h[p]||delete this._tiles[p]}freeRtt(e){for(const s in this._tiles){const h=this._tiles[s];(!e||h.tileID.equals(e)||h.tileID.isChildOf(e)||e.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,s){return s?this._getTerrainCoordsForTileRanges(e,s):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const s={};for(const h of this._renderableTilesKeys){const p=this._tiles[h].tileID,y=e.clone(),S=l.ba();if(p.canonical.equals(e.canonical))l.bY(S,0,l.$,l.$,0,0,1);else if(p.canonical.isChildOf(e.canonical)){const E=p.canonical.z-e.canonical.z,I=p.canonical.x-(p.canonical.x>>E<<E),z=p.canonical.y-(p.canonical.y>>E<<E),D=l.$>>E;l.bY(S,0,D,D,0,0,1),l.M(S,S,[-I*D,-z*D,0])}else{if(!e.canonical.isChildOf(p.canonical))continue;{const E=e.canonical.z-p.canonical.z,I=e.canonical.x-(e.canonical.x>>E<<E),z=e.canonical.y-(e.canonical.y>>E<<E),D=l.$>>E;l.bY(S,0,l.$,l.$,0,0,1),l.M(S,S,[I*D,z*D,0]),l.N(S,S,[1/2**E,1/2**E,0])}}y.terrainRttPosMatrix32f=new Float32Array(S),s[h]=y}return s}_getTerrainCoordsForTileRanges(e,s){const h={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(!this._isWithinTileRanges(y,s))continue;const S=e.clone(),E=l.ba();if(y.canonical.z===e.canonical.z){const I=e.canonical.x-y.canonical.x,z=e.canonical.y-y.canonical.y;l.bY(E,0,l.$,l.$,0,0,1),l.M(E,E,[I*l.$,z*l.$,0])}else if(y.canonical.z>e.canonical.z){const I=y.canonical.z-e.canonical.z,z=y.canonical.x-(y.canonical.x>>I<<I),D=y.canonical.y-(y.canonical.y>>I<<I),B=e.canonical.x-(y.canonical.x>>I),j=e.canonical.y-(y.canonical.y>>I),$=l.$>>I;l.bY(E,0,$,$,0,0,1),l.M(E,E,[-z*$+B*l.$,-D*$+j*l.$,0])}else{const I=e.canonical.z-y.canonical.z,z=e.canonical.x-(e.canonical.x>>I<<I),D=e.canonical.y-(e.canonical.y>>I<<I),B=(e.canonical.x>>I)-y.canonical.x,j=(e.canonical.y>>I)-y.canonical.y,$=l.$<<I;l.bY(E,0,$,$,0,0,1),l.M(E,E,[z*l.$+B*$,D*l.$+j*$,0])}S.terrainRttPosMatrix32f=new Float32Array(E),h[p]=S}return h}getSourceTile(e,s){const h=this.sourceCache._source;let p=e.overscaledZ-this.deltaZoom;if(p>h.maxzoom&&(p=h.maxzoom),p<h.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(p).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!y||!y.dem)&&s)for(;p>=h.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(e.scaledTo(p--).key);return y}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,s){return s[e.canonical.z]&&e.canonical.x>=s[e.canonical.z].minTileX&&e.canonical.x<=s[e.canonical.z].maxTileX&&e.canonical.y>=s[e.canonical.z].minTileY&&e.canonical.y<=s[e.canonical.z].maxTileY}}class Yt{constructor(e,s,h){this._meshCache={},this.painter=e,this.sourceCache=new Lt(s),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,h,p=l.$){var y;if(!(s>=0&&s<p&&h>=0&&h<p))return 0;const S=this.getTerrainData(e),E=(y=S.tile)===null||y===void 0?void 0:y.dem;if(!E)return 0;const I=l.cs([],[s/p*l.$,h/p*l.$],S.u_terrain_matrix),z=[I[0]*E.dim,I[1]*E.dim],D=Math.floor(z[0]),B=Math.floor(z[1]),j=z[0]-D,$=z[1]-B;return E.get(D,B)*(1-j)*(1-$)+E.get(D+1,B)*j*(1-$)+E.get(D,B+1)*(1-j)*$+E.get(D+1,B+1)*j*$}getElevationForLngLatZoom(e,s){if(!l.ct(s,e.wrap()))return 0;const{tileID:h,mercatorX:p,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(h,p%l.$,y%l.$,l.$)}getElevation(e,s,h,p=l.$){return this.getDEMElevation(e,s,h,p)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const p=this.painter.context,y=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(p,y,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(p,new l.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ag([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new l.T(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const h=s&&s+s.tileID.key+e.key;if(h&&!this._demMatrixCache[h]){const p=this.sourceCache.sourceCache._source.maxzoom;let y=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=p?y=e.canonical.z-p:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>y<<y),E=e.canonical.y-(e.canonical.y>>y<<y),I=l.cu(new Float64Array(16),[1/(l.$<<y),1/(l.$<<y),0]);l.M(I,I,[S*l.$,E*l.$,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,h=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(s.context,{width:h,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(s.context,{width:h,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(h,p,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,h,p))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,S=0;y<this._coordsTextureSize;y++)for(let E=0;E<this._coordsTextureSize;E++,S+=4)s[S+0]=255&E,s[S+1]=255&y,s[S+2]=E>>8<<4|y>>8,s[S+3]=0;const h=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new l.T(e,h,e.gl.RGBA,{premultiply:!1});return p.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),h=this.painter.context,p=h.gl,y=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),E=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(y,E-S-1,1,1,p.RGBA,p.UNSIGNED_BYTE,s),h.bindFramebuffer.set(null);const I=s[0]+(s[2]>>4<<8),z=s[1]+((15&s[2])<<8),D=this.coordsIndex[255-s[3]],B=D&&this.sourceCache.getTileByID(D);if(!B)return null;const j=this._coordsTextureSize,$=(1<<B.tileID.canonical.z)*j;return new l.a1((B.tileID.canonical.x*j+I)/$+B.tileID.wrap,(B.tileID.canonical.y*j+z)/$,this.getElevation(B.tileID,I,z,j))}depthAtPoint(e){const s=new Uint8Array(4),h=this.painter.context,p=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,s),h.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(e){var s;const h=((s=this.painter.style.projection)===null||s===void 0?void 0:s.transitionState)>0,p=h&&e.canonical.y===0,y=h&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${p?"n":""}_${y?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const E=this.painter.context,I=new l.cv,z=new l.aN,D=this.meshSize,B=l.$/D,j=D*D;for(let he=0;he<=D;he++)for(let ke=0;ke<=D;ke++)I.emplaceBack(ke*B,he*B,0);for(let he=0;he<j;he+=D+1)for(let ke=0;ke<D;ke++)z.emplaceBack(ke+he,D+ke+he+1,D+ke+he+2),z.emplaceBack(ke+he,D+ke+he+2,ke+he+1);const $=I.length,W=$+(D+1),re=(D+1)*D,se=p?l.bh:0,ae=p?0:1,oe=y?l.bi:l.$,de=y?0:1;for(let he=0;he<=D;he++)I.emplaceBack(he*B,se,ae);for(let he=0;he<=D;he++)I.emplaceBack(he*B,oe,de);for(let he=0;he<D;he++)z.emplaceBack(re+he,W+he,W+he+1),z.emplaceBack(re+he,W+he+1,re+he+1),z.emplaceBack(0+he,$+he+1,$+he),z.emplaceBack(0+he,0+he+1,$+he+1);const le=I.length,ge=le+2*(D+1);for(const he of[0,1])for(let ke=0;ke<=D;ke++)for(const $e of[0,1])I.emplaceBack(he*l.$,ke*B,$e);for(let he=0;he<2*D;he+=2)z.emplaceBack(le+he,le+he+1,le+he+3),z.emplaceBack(le+he,le+he+3,le+he+2),z.emplaceBack(ge+he,ge+he+3,ge+he+1),z.emplaceBack(ge+he,ge+he+2,ge+he+3);const we=new Aa(E.createVertexBuffer(I,Bc.members),E.createIndexBuffer(z),l.aM.simpleSegment(0,0,I.length,z.length));return this._meshCache[S]=we,we}getMeshFrameDelta(e){return 2*Math.PI*l.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,s){var h;const{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(h=this.getMinMaxElevation(p).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,h={minElevation:null,maxElevation:null};return s&&s.dem&&(h.minElevation=s.dem.min*this.exaggeration,h.maxElevation=s.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(e,s){const h=l.a1.fromLngLat(e.wrap()),p=(1<<s)*l.$,y=h.x*p,S=h.y*p,E=Math.floor(y/l.$),I=Math.floor(S/l.$);return{tileID:new l.Z(s,0,s,E,I),mercatorX:y,mercatorY:S}}}class Wa{constructor(e,s,h){this._context=e,this._size=s,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(h.texture),{id:e,fbo:s,texture:h,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((s=>e.id!==s)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const va={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Kl{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new Wa(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((h=>!e._layers[h].isHidden(s))),this._coordsAscending={};for(const h in e.sourceCaches){this._coordsAscending[h]={};const p=e.sourceCaches[h].getVisibleCoordinates(),y=e.sourceCaches[h].getSource(),S=y instanceof Zn?y.terrainTileRanges:null;for(const E of p){const I=this.terrain.sourceCache.getTerrainCoords(E,S);for(const z in I)this._coordsAscending[h][z]||(this._coordsAscending[h][z]=[]),this._coordsAscending[h][z].push(I[z])}}this._coordsAscendingStr={};for(const h of e._order){const p=e._layers[h],y=p.source;if(va[p.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const S in this._coordsAscending[y])this._coordsAscendingStr[y][S]=this._coordsAscending[y][S].map((E=>E.key)).sort().join()}}for(const h of this._renderableTiles)for(const p in this._coordsAscendingStr){const y=this._coordsAscendingStr[p][h.tileID.key];y&&y!==h.rttCoords[p]&&(h.rtt=[])}}renderLayer(e,s){if(e.isHidden(this.painter.transform.zoom))return!1;const h=Object.assign(Object.assign({},s),{isRenderingToTexture:!0}),p=e.type,y=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(va[p]&&(this._prevType&&va[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(va[this._prevType]||va[p]&&S){this._prevType=p;const E=this._stacks.length-1,I=this._stacks[E]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(ms(this.painter,this.terrain,this._rttTiles,h),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[E]){const B=this.pool.getObjectForId(z.rtt[E].id);if(B.stamp===z.rtt[E].stamp){this.pool.useObject(B);continue}}const D=this.pool.getOrCreateFreeObject();this.pool.useObject(D),this.pool.stampObject(D),z.rtt[E]={id:D.id,stamp:D.stamp},y.context.bindFramebuffer.set(D.fbo.framebuffer),y.context.clear({color:l.bf.transparent,stencil:0}),y.currentStencilSource=void 0;for(let B=0;B<I.length;B++){const j=y.style._layers[I[B]],$=j.source?this._coordsAscending[j.source][z.tileID.key]:[z.tileID];y.context.viewport.set([0,0,D.fbo.width,D.fbo.height]),y._renderTileClippingMasks(j,$,!0),y.renderLayer(y,y.style.sourceCaches[j.source],j,$,h),j.source&&(z.rttCoords[j.source]=this._coordsAscendingStr[j.source][z.tileID.key])}}return ms(this.painter,this.terrain,this._rttTiles,h),this._rttTiles=[],this.pool.freeAllObjects(),va[p]}return!1}}const fi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Lu=L,pi={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Hl,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},As={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ks{constructor(e,s,h=!1){this.mousedown=y=>{this.startMove(y,q.mousePos(this.element,y)),q.addEventListener(window,"mousemove",this.mousemove),q.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,q.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHandler.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),q.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=s;const p=new To;this._rotatePitchHandler=new Qo({clickTolerance:3,move:(y,S)=>{const E=s.getBoundingClientRect(),I=new l.P((E.bottom-E.top)/2,(E.right-E.left)/2);return{bearingDelta:l.cn(new l.P(y.x,S.y),S,I),pitchDelta:h?-.5*(S.y-y.y):void 0}},moveStateManager:p,enable:!0,assignEvents:()=>{}}),this.map=e,q.addEventListener(s,"mousedown",this.mousedown),q.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(s,"touchcancel",this.reset)}startMove(e,s){this._rotatePitchHandler.dragStart(e,s),q.disableDrag()}move(e,s){const h=this.map,{bearingDelta:p,pitchDelta:y}=this._rotatePitchHandler.dragMove(e,s)||{};p&&h.setBearing(h.getBearing()+p),y&&h.setPitch(h.getPitch()+y)}off(){const e=this.element;q.removeEventListener(e,"mousedown",this.mousedown),q.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend),q.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(window,"mousemove",this.mousemove),q.removeEventListener(window,"mouseup",this.mouseup),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend)}}let Yr;function wn(g,e,s,h=!1){if(h||!s.getCoveringTilesDetailsProvider().allowWorldCopies())return g==null?void 0:g.wrap();const p=new l.S(g.lng,g.lat);if(g=new l.S(g.lng,g.lat),e){const y=new l.S(g.lng-360,g.lat),S=new l.S(g.lng+360,g.lat),E=s.locationToScreenPoint(g).distSqr(e);s.locationToScreenPoint(y).distSqr(e)<E?g=y:s.locationToScreenPoint(S).distSqr(e)<E&&(g=S)}for(;Math.abs(g.lng-s.center.lng)>180;){const y=s.locationToScreenPoint(g);if(y.x>=0&&y.y>=0&&y.x<=s.width&&y.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g.lng!==p.lng&&s.isPointOnMapSurface(s.locationToScreenPoint(g))?g:p}const Rs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vs(g,e,s){const h=g.classList;for(const p in Rs)h.remove(`maplibregl-${s}-anchor-${p}`);h.add(`maplibregl-${s}-anchor-${e}`)}class Co extends l.E{constructor(e){if(super(),this._onKeyPress=s=>{const h=s.code,p=s.charCode||s.keyCode;h!=="Space"&&h!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=s=>{const h=s.originalEvent.target,p=this._element;this._popup&&(h===p||p.contains(h))&&this.togglePopup()},this._update=s=>{if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=wn(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,`${Rs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${p}`),ee.frameAsync(new AbortController).then((()=>{this._updateOpacity(s&&s.type==="moveend")})).catch((()=>{}))},this._onMove=s=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=l.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div");const s=q.createNS("http://www.w3.org/2000/svg","svg"),h=41,p=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${h}px`),s.setAttributeNS(null,"width",`${p}px`),s.setAttributeNS(null,"viewBox",`0 0 ${p} ${h}`);const y=q.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const S=q.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const E=q.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ae of I){const oe=q.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",ae.rx),oe.setAttributeNS(null,"ry",ae.ry),E.appendChild(oe)}const z=q.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const D=q.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(D);const B=q.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const j=q.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(j);const $=q.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const W=q.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=q.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const se=q.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),W.appendChild(re),W.appendChild(se),S.appendChild(E),S.appendChild(z),S.appendChild(B),S.appendChild($),S.appendChild(W),s.appendChild(S),s.setAttributeNS(null,"height",h*this._scale+"px"),s.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(s),this._offset=l.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(s=>{s.preventDefault()})),this._element.addEventListener("mousedown",(s=>{s.preventDefault()})),vs(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=l.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const p=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,h;const p=(s=this._map)===null||s===void 0?void 0:s.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!p||y){const $=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==$&&(this._element.style.opacity=$))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const S=this._map,E=S.terrain.depthAtPoint(this._pos),I=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,I)-E<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/S.transform.pixelsPerMeter,D=Math.sin(S.getPitch()*Math.PI/180)*z,B=S.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),j=S.transform.lngLatToCameraDepth(this._lngLat,I+D)-B>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=l.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return(this._opacity===void 0||e===void 0&&s===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const Fu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let rs=0,ns=!1;const ko={maxWidth:100,unit:"metric"};function $c(g,e,s){const h=s&&s.maxWidth||100,p=g._container.clientHeight/2,y=g._container.clientWidth/2,S=g.unproject([y-h/2,p]),E=g.unproject([y+h/2,p]),I=Math.round(g.project(E).x-g.project(S).x),z=Math.min(h,I,g._container.clientWidth),D=S.distanceTo(E);if(s&&s.unit==="imperial"){const B=3.2808*D;B>5280?xa(e,z,B/5280,g._getUIString("ScaleControl.Miles")):xa(e,z,B,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?xa(e,z,D/1852,g._getUIString("ScaleControl.NauticalMiles")):D>=1e3?xa(e,z,D/1e3,g._getUIString("ScaleControl.Kilometers")):xa(e,z,D,g._getUIString("ScaleControl.Meters"))}function xa(g,e,s,h){const p=(function(y){const S=Math.pow(10,`${Math.floor(y)}`.length-1);let E=y/S;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:(function(I){const z=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*z)/z})(E),S*E})(s);g.style.width=e*(p/s)+"px",g.innerHTML=`${p}&nbsp;${h}`}const Ou={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Jo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xs(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,g),"top-left":new l.P(e,e),"top-right":new l.P(-e,e),bottom:new l.P(0,-g),"bottom-left":new l.P(e,-e),"bottom-right":new l.P(-e,-e),left:new l.P(g,0),right:new l.P(-g,0)}}if(g instanceof l.P||Array.isArray(g)){const e=l.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:l.P.convert(g.center||[0,0]),top:l.P.convert(g.top||[0,0]),"top-left":l.P.convert(g["top-left"]||[0,0]),"top-right":l.P.convert(g["top-right"]||[0,0]),bottom:l.P.convert(g.bottom||[0,0]),"bottom-left":l.P.convert(g["bottom-left"]||[0,0]),"bottom-right":l.P.convert(g["bottom-right"]||[0,0]),left:l.P.convert(g.left||[0,0]),right:l.P.convert(g.right||[0,0])}}return xs(new l.P(0,0))}const el=L;w.AJAXError=l.cz,w.Event=l.l,w.Evented=l.E,w.LngLat=l.S,w.MercatorCoordinate=l.a1,w.Point=l.P,w.addProtocol=l.cA,w.config=l.a,w.removeProtocol=l.cB,w.AttributionControl=Du,w.BoxZoomHandler=wi,w.CanvasSource=Be,w.CooperativeGesturesHandler=Nc,w.DoubleClickZoomHandler=_s,w.DragPanHandler=zu,w.DragRotateHandler=jc,w.EdgeInsets=ua,w.FullscreenControl=class extends l.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=q.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);q.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},w.GeoJSONSource=Ri,w.GeolocateControl=class extends l.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new l.S(e.coords.longitude,e.coords.latitude),h=e.coords.accuracy,p=this._map.getBearing(),y=l.e({bearing:p},this.options.fitBoundsOptions),S=Vr.fromLngLat(s,h);this._map.fitBounds(S,y,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new l.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ns)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=q.create("button","maplibregl-ctrl-geolocate",this._container),q.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Co({element:this._dotElement}),this._circleElement=q.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Co({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(s=>{const h=(s==null?void 0:s[0])instanceof ResizeObserverEntry;s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))}))}},this.options=l.e({},Fu,g)}onAdd(g){return this._map=g,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return l._(this,arguments,void 0,(function*(e=!1){if(Yr!==void 0&&!e)return Yr;if(window.navigator.permissions===void 0)return Yr=!!window.navigator.geolocation,Yr;try{Yr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Yr=!!window.navigator.geolocation}return Yr}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,rs=0,ns=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),s=g.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const g=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&g))return;const e=this._map.project(g),s=this._map.unproject([e.x+100,e.y]),h=g.distanceTo(s)/100,p=2*this._accuracy/h;this._circleElement.style.width=`${p.toFixed(2)}px`,this._circleElement.style.height=`${p.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rs--,ns=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),rs++,rs>1?(g={maximumAge:6e5,timeout:0},ns=!0):(g=this.options.positionOptions,ns=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},w.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const e=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=q.create("button","maplibregl-ctrl-globe",this._container),q.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},w.Hash=Mu,w.ImageSource=Zn,w.KeyboardHandler=ql,w.LngLatBounds=Vr,w.LogoControl=Xh,w.Map=class extends Wl{constructor(g){var e,s;l.cw.mark(l.cx.create);const h=Object.assign(Object.assign(Object.assign({},pi),g),{canvasContextAttributes:Object.assign(Object.assign({},pi.canvasContextAttributes),g.canvasContextAttributes)});if(h.minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const p=new cn,y=new hi;if(h.minZoom!==void 0&&p.setMinZoom(h.minZoom),h.maxZoom!==void 0&&p.setMaxZoom(h.maxZoom),h.minPitch!==void 0&&p.setMinPitch(h.minPitch),h.maxPitch!==void 0&&p.setMaxPitch(h.maxPitch),h.renderWorldCopies!==void 0&&p.setRenderWorldCopies(h.renderWorldCopies),super(p,y,{bearingSnap:h.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Oi,this._controls=[],this._mapId=l.a7(),this._contextLost=E=>{E.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:E}))},this._contextRestored=E=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:E}))},this._onMapScroll=E=>{if(E.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._maxTileCacheZoomLevels=h.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},h.canvasContextAttributes),this._trackResize=h.trackResize===!0,this._bearingSnap=h.bearingSnap,this._centerClampedToGround=h.centerClampedToGround,this._refreshExpiredTiles=h.refreshExpiredTiles===!0,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions===!0,this._collectResourceTiming=h.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},fi),h.locale),this._clickTolerance=h.clickTolerance,this._overridePixelRatio=h.pixelRatio,this._maxCanvasSize=h.maxCanvasSize,this.transformCameraUpdate=h.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=h.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=De.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ye(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let E=!1;const I=$a((z=>{this._trackResize&&!this._removed&&(this.resize(z),this.redraw())}),50);this._resizeObserver=new ResizeObserver((z=>{E?I(z):E=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Kh(this,h),this._hash=h.hash&&new Mu(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,elevation:h.elevation,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,roll:h.roll}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.e({},h.fitBoundsOptions,{duration:0}))));const S=typeof h.style=="string"||((s=(e=h.style)===null||e===void 0?void 0:e.projection)===null||s===void 0?void 0:s.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=h.localIdeographFontFamily,this._validateStyle=h.validateStyle,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new Du(typeof h.attributionControl=="boolean"?void 0:h.attributionControl)),h.maplibreLogo&&this.addControl(new Xh,h.logoPosition),this.on("style.load",(()=>{if(S||this._resizeTransform(),this.transform.unmodified){const E=l.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(E)}})),this.on("data",(E=>{this._update(E.dataType==="style"),this.fire(new l.l(`${E.dataType}data`,E))})),this.on("dataloading",(E=>{this.fire(new l.l(`${E.dataType}dataloading`,E))})),this.on("dataabort",(E=>{this.fire(new l.l("sourcedataabort",E))}))}_getMapId(){return this._mapId}setGlobalStateProperty(g,e){return this.style.setGlobalStateProperty(g,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const h=this._controlPositions[e];return e.indexOf("bottom")!==-1?h.insertBefore(s,h.firstChild):h.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}coveringTiles(g){return Ce(this.transform,g)}calculateCameraOptionsFromTo(g,e,s,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,s,h)}resize(g,e=!0){const[s,h]=this._containerDimensions(),p=this._getClampedPixelRatio(s,h);if(this._resizeCanvas(s,h,p),this.painter.resize(s,h,p),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const E=this._getClampedPixelRatio(s,h);this._resizeCanvas(s,h,E),this.painter.resize(s,h,E)}this._resizeTransform(e);const y=!this._moving;return y&&(this.stop(),this.fire(new l.l("movestart",g)).fire(new l.l("move",g))),this.fire(new l.l("resize",g)),y&&this.fire(new l.l("moveend",g)),this}_resizeTransform(g=!0){var e;const[s,h]=this._containerDimensions();this.transform.resize(s,h,g),(e=this._requestedCameraState)===null||e===void 0||e.resize(s,h,g)}_getClampedPixelRatio(g,e){const{0:s,1:h}=this._maxCanvasSize,p=this.getPixelRatio(),y=g*p,S=e*p;return Math.min(y>s?s/y:1,S>h?h/S:1)*p}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Vr.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(l.S.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(l.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,s){if(g==="mouseenter"||g==="mouseover"){let h=!1;return{layers:e,listener:s,delegates:{mousemove:y=>{const S=e.filter((I=>this.getLayer(I))),E=S.length!==0?this.queryRenderedFeatures(y.point,{layers:S}):[];E.length?h||(h=!0,s.call(this,new Or(g,this,y.originalEvent,{features:E}))):h=!1},mouseout:()=>{h=!1}}}}if(g==="mouseleave"||g==="mouseout"){let h=!1;return{layers:e,listener:s,delegates:{mousemove:S=>{const E=e.filter((I=>this.getLayer(I)));(E.length!==0?this.queryRenderedFeatures(S.point,{layers:E}):[]).length?h=!0:h&&(h=!1,s.call(this,new Or(g,this,S.originalEvent)))},mouseout:S=>{h&&(h=!1,s.call(this,new Or(g,this,S.originalEvent)))}}}}{const h=p=>{const y=e.filter((E=>this.getLayer(E))),S=y.length!==0?this.queryRenderedFeatures(p.point,{layers:y}):[];S.length&&(p.features=S,s.call(this,p),delete p.features)};return{layers:e,listener:s,delegates:{[g]:h}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,s){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const h=this._delegatedListeners[g];for(let p=0;p<h.length;p++){const y=h[p];if(y.listener===s&&y.layers.length===e.length&&y.layers.every((S=>e.includes(S)))){for(const S in y.delegates)this.off(S,y.delegates[S]);return void h.splice(p,1)}}}on(g,e,s){if(s===void 0)return super.on(g,e);const h=typeof e=="string"?[e]:e,p=this._createDelegatedListener(g,h,s);this._saveDelegatedListener(g,p);for(const y in p.delegates)this.on(y,p.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(g,h,s)}}}once(g,e,s){if(s===void 0)return super.once(g,e);const h=typeof e=="string"?[e]:e,p=this._createDelegatedListener(g,h,s);for(const y in p.delegates){const S=p.delegates[y];p.delegates[y]=(...E)=>{this._removeDelegatedListener(g,h,s),S(...E)}}this._saveDelegatedListener(g,p);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(g,e,s){return s===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let s;const h=g instanceof l.P||Array.isArray(g),p=h?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(h?{}:g)||{},p instanceof l.P||typeof p[0]=="number")s=[l.P.convert(p)];else{const y=l.P.convert(p[0]),S=l.P.convert(p[1]);s=[y,new l.P(S.x,y.y),S,new l.P(y.x,S.y),y]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){var s,h;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(g,e)));const p=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Sh(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,p):this.style.loadJSON(g,e,p),this):((h=(s=this.style)===null||s===void 0?void 0:s.projection)===null||h===void 0||h.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Sh(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,"Style");l.j(s,new AbortController).then((h=>{this._updateDiff(h.data,e)})).catch((h=>{h&&this.fire(new l.k(h))}))}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(s){l.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new l.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const h=this.style._layers[s];h.type==="hillshade"&&h.source===g.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),h.type==="color-relief"&&h.source===g.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Yt(this.painter,e,g),this.painter.renderToTexture=new Kl(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=s=>{var h;s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((h=s.source)===null||h===void 0?void 0:h.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const s=g[e]._tiles;for(const h in s){const p=s[h];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,e,s){if(s){const h=this.getSource(s);if(!h)throw new Error(`There is no source with ID "${s}", cannot set LOD parameters`);h.calculateTileZoom=nt(Math.max(1,g),Math.max(1,e))}else for(const h in this.style.sourceCaches)this.style.sourceCaches[h].getSource().calculateTileZoom=nt(Math.max(1,g),Math.max(1,e));return this._update(!0),this}refreshTiles(g,e){const s=this.style.sourceCaches[g];if(!s)throw new Error(`There is no source cache with ID "${g}", cannot refresh tile`);e===void 0?s.reload(!0):s.refreshTiles(e.map((h=>new l.a4(h.z,h.x,h.y))))}addImage(g,e,s={}){const{pixelRatio:h=1,sdf:p=!1,stretchX:y,stretchY:S,content:E,textFitWidth:I,textFitHeight:z}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||l.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:D,height:B,data:j}=e,$=e;return this.style.addImage(g,{data:new l.R({width:D,height:B},new Uint8Array(j)),pixelRatio:h,stretchX:y,stretchY:S,content:E,textFitWidth:I,textFitHeight:z,sdf:p,version:0,userImage:$}),$.onAdd&&$.onAdd(this,g),this}}{const{width:D,height:B,data:j}=ee.getImageData(e);this.style.addImage(g,{data:new l.R({width:D,height:B},j),pixelRatio:h,stretchX:y,stretchY:S,content:E,textFitWidth:I,textFitHeight:z,sdf:p,version:0})}}updateImage(g,e){const s=this.style.getImage(g);if(!s)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=e instanceof HTMLImageElement||l.b(e)?ee.getImageData(e):e,{width:p,height:y,data:S}=h;if(p===void 0||y===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||y!==s.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(e instanceof HTMLImageElement||l.b(e));return s.data.replace(S,E),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return De.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,s){return this.style.setLayerZoomRange(g,e,s),this._update(!0)}setFilter(g,e,s={}){return this.style.setFilter(g,e,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,s,h={}){return this.style.setPaintProperty(g,e,s,h),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,s,h={}){return this.style.setLayoutProperty(g,e,s,h),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,s,(h=>{h||this._update(!0)})),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,(s=>{s||this._update(!0)})),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=q.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=q.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),h=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],h);const p=this._controlContainer=q.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((S=>{y[S]=q.create("div",`maplibregl-ctrl-${S} `,p)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(h=>{e={requestedAttributes:g},h&&(e.statusMessage=h.statusMessage,e.type=h.type)}),{once:!0});let s=null;if(s=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!s){const h="Failed to initialize WebGL";throw e?(e.message=h,new Error(JSON.stringify(e))):new Error(h)}this.painter=new ma(s,this.transform),_e.testSupport(s)}migrateProjection(g,e){super.migrateProjection(g,e),this.painter.transform=g,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var e,s,h,p,y;const S=this._idleTriggered?this._fadeDuration:0,E=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,j=ee.now();this.style.zoomHistory.update(B,j);const $=new l.F(B,{now:j,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),W=$.crossFadingFactor();W===1&&W===this._crossFadingFactor||(I=!0,this._crossFadingFactor=W),this.style.update($)}const z=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0!==E;(h=this.style.projection)===null||h===void 0||h.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((p=this.style.projection)===null||p===void 0?void 0:p.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cw.mark(l.cx.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const D=this._sourcesDirty||this._styleDirty||this._placementDirty;return D||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,l.cw.mark(l.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),De.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),q.remove(this._canvasContainer),q.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cw.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ee.frame(this._frameRequest,(g=>{l.cw.frame(g),this._frameRequest=null;try{this._render(g)}catch(e){if(!l.cy(e)&&!(function(s){return s.message===Ac})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Lu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},w.MapMouseEvent=Or,w.MapTouchEvent=gs,w.MapWheelEvent=si,w.Marker=Co,w.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),h=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,s)=>{const h=this._map._getUIString(`NavigationControl.${s}`);e.title=h,e.setAttribute("aria-label",h)},this.options=l.e({},As,g),this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),q.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),q.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=q.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ks(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const s=q.create("button",g,this._container);return s.type="button",s.addEventListener("click",e),s}},w.Popup=class extends l.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=q.create("div","maplibregl-popup",this._map.getContainer()),this._tip=q.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=wn(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const s=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const p=xs(this.options.offset);if(!h){const S=this._container.offsetWidth,E=this._container.offsetHeight;let I;I=s.y+p.bottom.y<E?["top"]:s.y>this._map.transform.height-E?["bottom"]:[],s.x<S/2?I.push("left"):s.x>this._map.transform.width-S/2&&I.push("right"),h=I.length===0?"bottom":I.join("-")}let y=s.add(p[h]);this.options.subpixelPositioning||(y=y.round()),q.setTransform(this._container,`${Rs[h]} translate(${y.x}px,${y.y}px)`),vs(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Ou),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=l.S.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),s=document.createElement("body");let h;for(s.innerHTML=g;h=s.firstChild,h;)e.appendChild(h);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Jo);g&&g.focus()}},w.RasterDEMTileSource=Yi,w.RasterTileSource=jn,w.ScaleControl=class{constructor(g){this._onMove=()=>{$c(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,$c(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ko),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},w.ScrollZoomHandler=vn,w.Style=Sh,w.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=q.create("button","maplibregl-ctrl-terrain",this._container),q.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){q.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},w.TwoFingersTouchPitchHandler=_a,w.TwoFingersTouchRotateHandler=ts,w.TwoFingersTouchZoomHandler=Li,w.TwoFingersTouchZoomRotateHandler=Hh,w.VectorTileSource=Cn,w.VideoSource=xe,w.addSourceType=(g,e)=>l._(void 0,void 0,void 0,(function*(){if(Et(g))throw new Error(`A source type called "${g}" already exists.`);((s,h)=>{Xe[s]=h})(g,e)})),w.clearPrewarmedResources=function(){const g=jt;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Ct),jt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},w.createTileMesh=Pl,w.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},w.getRTLTextPluginStatus=function(){return _r().getRTLTextPluginStatus()},w.getVersion=function(){return el},w.getWorkerCount=function(){return Ie.workerCount},w.getWorkerUrl=function(){return l.a.WORKER_URL},w.importScriptInWorkers=function(g){return Lr().broadcast("IS",g)},w.prewarm=function(){fr().acquire(Ct)},w.setMaxParallelImageRequests=function(g){l.a.MAX_PARALLEL_IMAGE_REQUESTS=g},w.setRTLTextPlugin=function(g,e){return _r().setRTLTextPlugin(g,e)},w.setWorkerCount=function(g){Ie.workerCount=g},w.setWorkerUrl=function(g){l.a.WORKER_URL=g}}));var P=u;return P}))})(Tg)),Tg.exports}var yP=gP();const Oy=R_(yP),_P="https://api.maptiler.com/maps/019951a8-6432-7aea-b555-2ac65a59181f/style.json?key=Dh5hFFvt6R7cmui0rEtJ",vP="https://api.maptiler.com/maps/019951b2-24e8-7a45-8534-0731061b7984/style.json?key=Dh5hFFvt6R7cmui0rEtJ";function Ub(){return document.documentElement.classList.contains("dark")}function xP(){const r=getComputedStyle(document.documentElement).getPropertyValue("--color-accent").trim();return r.includes(" ")?`rgb(${r})`:r||"#0a5a82"}function Vx(){return Ub()?vP:_P}function bP(r,a){const u=r.lat,m=a/111,b=a/(111*Math.cos(u*Math.PI/180)),P=r.lon-b,w=r.lon+b,l=r.lat-m,L=r.lat+m;return[[P,l],[w,L]]}function wP({points:r=[],focus:a,onMoveEnd:u,onFitBounds:m}){const b=te.useRef(null),P=te.useRef(null),w=te.useRef([]),l=te.useRef(u);l.current=u;const L=te.useRef(m);return L.current=m,te.useEffect(()=>{if(!b.current)return;const N=new Oy.Map({container:b.current,style:Vx(),center:[15,62],zoom:4.3,minZoom:3,maxZoom:14,dragRotate:!1,pitchWithRotate:!1,attributionControl:{compact:!0}});P.current=N,N.once("load",()=>setTimeout(()=>N.resize(),0));const Z=new MutationObserver(()=>{const ee=Vx();N.setStyle(ee),N.once("styledata",()=>{})});Z.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});let V=!1;return N.on("movestart",ee=>{V=!!ee.originalEvent}),N.on("moveend",()=>{const ee=N.getBounds(),q=N.getCenter(),_e={bounds:{west:ee.getWest(),south:ee.getSouth(),east:ee.getEast(),north:ee.getNorth()},center:{lon:q.lng,lat:q.lat},zoom:N.getZoom()};V?(V=!1,l.current&&l.current(_e)):L.current&&L.current(_e)}),()=>{Z.disconnect(),w.current.forEach(ee=>ee.remove()),N.remove(),P.current=null}},[]),te.useEffect(()=>{const N=P.current;if(!N)return;const Z=xP();w.current.forEach(V=>V.remove()),w.current=[],r.forEach(V=>{const ee=document.createElement("div");ee.className="w-3 h-3 rounded-full shadow "+(Ub()?"ring-2 ring-black/60":"ring-2 ring-white/85"),ee.style.background=Z,ee.setAttribute("role","button"),ee.setAttribute("aria-label",V.name),ee.setAttribute("tabindex","0"),ee.addEventListener("keydown",_e=>{(_e.key==="Enter"||_e.key===" ")&&(_e.preventDefault(),ee.click())});const q=new Oy.Marker({element:ee}).setLngLat([V.lon,V.lat]).setPopup(new Oy.Popup({closeButton:!1}).setHTML(`<a href="/beach/${V.id}" style="text-decoration: none; color: inherit;">${V.name}</a>`)).addTo(N);w.current.push(q)})},[r]),te.useEffect(()=>{const N=P.current;if(!(!N||!(a!=null&&a.center)))if(N.stop(),a.radiusKm&&a.radiusKm>0){const Z=a.radiusKm,V=Z<=5,ee=V?Z*.65:Z,q=V?12:24,_e=V?16:12,fe=bP(a.center,ee);N.fitBounds(fe,{padding:q,maxZoom:_e})}else N.flyTo({center:[a.center.lon,a.center.lat],zoom:11})},[a]),Y.jsx("div",{className:"card p-0",children:Y.jsx("div",{ref:b,className:"w-full h-[260px] rounded-2xl overflow-hidden"})})}function SP(){const[r,a]=te.useState(null),[u,m]=te.useState(!1),[b,P]=te.useState(null),w=te.useCallback(()=>{if(!("geolocation"in navigator)){P("Geolocation not supported");return}m(!0),P(null),navigator.geolocation.getCurrentPosition(l=>{m(!1),a({lat:l.coords.latitude,lon:l.coords.longitude})},l=>{m(!1),P(l.message||"Failed to get location")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},[]);return{coords:r,loading:u,error:b,request:w}}function Zx(r,a){const m=(a.lat-r.lat)*Math.PI/180,b=(a.lon-r.lon)*Math.PI/180,P=r.lat*Math.PI/180,w=a.lat*Math.PI/180,l=Math.sin(m/2)**2+Math.cos(P)*Math.cos(w)*Math.sin(b/2)**2;return 2*6371*Math.asin(Math.min(1,Math.sqrt(l)))}function TP(r){return r<1?`${Math.round(r*1e3)} m`:`${r.toFixed(r<10?1:0)} km`}const PP={lat:59.3326,lon:18.0649},CP=10,kP=5;function EP(){const{t:r}=Ea(),{data:a,isLoading:u,isError:m,error:b,refetch:P}=Gg({queryKey:["beaches"],queryFn:Db,staleTime:300*1e3}),l=Ky(Ke=>Ke.search).trim().toLowerCase(),{coords:L,loading:N,request:Z}=SP(),[V,ee]=te.useState("default"),[q,_e]=te.useState(PP),[fe,Pe]=te.useState(CP),[Le,Me]=te.useState(null),Se=te.useMemo(()=>{if(!a)return[];const Ke=L||(V==="viewport"?null:q),At=a.map(Rt=>{const Mt=Ke?Zx({lat:Ke.lat,lon:Ke.lon},{lat:Rt.lat,lon:Rt.lon}):void 0;return{...Rt,_distanceKm:Mt}});return Ke?At.sort((Rt,Mt)=>(Rt._distanceKm??0)-(Mt._distanceKm??0)):At},[a,L,q,V]),De=te.useMemo(()=>l?Se.filter(Ke=>`${Ke.name} ${Ke.municipality??""}`.toLowerCase().includes(l)):Se,[Se,l]),Ye=te.useMemo(()=>l?De:V==="viewport"&&Le?De.filter(Ke=>Ke.lon>=Le.west&&Ke.lon<=Le.east&&Ke.lat>=Le.south&&Ke.lat<=Le.north):De.filter(Ke=>V==="default"||V==="nearby"?Zx(q,{lat:Ke.lat,lon:Ke.lon})<=fe:!0),[De,V,Le,q,fe,l]);te.useEffect(()=>{!a&&!u&&P()},[a,u,P]),te.useEffect(()=>{L&&(_e({lat:L.lat,lon:L.lon}),Pe(kP),Me(null),ee("nearby"))},[L]);const ot=async()=>{ee("default"),await Z()},lt=Ke=>{Me(Ke.bounds),ee("viewport")},ut=Ke=>{Me(Ke.bounds),ee("viewport")},Je=V==="viewport"||l?void 0:{center:{lon:q.lon,lat:q.lat},radiusKm:fe};return u?Y.jsxs("div",{className:"space-y-3",children:[Y.jsx("div",{className:"h-9 w-40 rounded-2xl bg-surface-muted animate-pulse"}),Y.jsx(jy,{}),Y.jsx(jy,{}),Y.jsx(jy,{})]}):m?Y.jsxs("div",{role:"alert",className:"rounded-2xl border border-border bg-surface-muted p-4",children:[Y.jsx("p",{className:"font-spectral text-lg",children:r("beachesList.loadError")}),Y.jsx("p",{className:"text-sm text-ink-muted mt-1",children:(b==null?void 0:b.message)??r("beachesList.pleaseRetry")}),Y.jsx("button",{onClick:()=>P(),className:"mt-3 w-full px-3 py-3 rounded-2xl border border-border bg-surface hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",children:r("beachesList.retry")})]}):Se.length?(l||V!=="default")&&Ye.length===0?Y.jsxs("div",{className:"rounded-2xl border border-border bg-surface-muted p-4",children:[Y.jsx("p",{className:"font-spectral text-lg",children:r("beachesList.noMatches")}),Y.jsx("p",{className:"text-sm text-ink-muted mt-1",children:r(l?"beachesList.emptyState":V==="viewport"?"beachesList.panOrZoom":"beachesList.widenRadius")})]}):Y.jsxs("div",{className:"space-y-4",children:[Y.jsx(wP,{points:Ye.map(Ke=>({id:Ke.id,name:Ke.name,lat:Ke.lat,lon:Ke.lon})),focus:Je,onMoveEnd:lt,onFitBounds:ut}),Y.jsx("div",{className:"px-0",children:Y.jsx("button",{className:"w-full px-3 py-2 rounded-2xl border border-border bg-surface-muted hover:bg-surface transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",onClick:ot,disabled:N,children:r(N?"beachesList.gettingLocation":"beachesList.requestLocation")})}),Y.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Ye.slice(0,50).map(Ke=>Y.jsx("li",{children:Y.jsx(ei,{to:`/beach/${Ke.id}`,className:"block rounded-2xl border border-border bg-surface-muted p-3 hover:bg-surface transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",children:Y.jsxs("div",{className:"flex items-start justify-between gap-3",children:[Y.jsxs("div",{className:"min-w-0",children:[Y.jsx("h3",{className:"font-spectral text-lg leading-tight truncate",children:Ke.name}),Y.jsxs("p",{className:"text-ink-muted text-sm",children:[Ke.municipality??"","  ",Ke.lat.toFixed(4),","," ",Ke.lon.toFixed(4)]})]}),typeof Ke._distanceKm=="number"&&Y.jsx("span",{className:"badge shrink-0",children:TP(Ke._distanceKm)})]})})},Ke.id))})]}):Y.jsxs("div",{className:"rounded-2xl border border-border bg-surface-muted p-4",children:[Y.jsx("p",{className:"font-spectral text-lg",children:r("beachesList.noBeachesFound")}),Y.jsx("p",{className:"text-sm text-ink-muted mt-1",children:r("beachesList.emptyState")})]})}function jy(){return Y.jsxs("div",{className:"rounded-2xl border border-border bg-surface-muted p-3",children:[Y.jsx("div",{className:"h-5 w-2/3 bg-surface animate-pulse rounded"}),Y.jsx("div",{className:"h-4 w-1/3 bg-surface animate-pulse rounded mt-2"})]})}function IP(){return Y.jsx(EP,{})}let MP={data:""},AP=r=>{if(typeof window=="object"){let a=(r?r.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return a.nonce=window.__nonce__,a.parentNode||(r||document.head).appendChild(a),a.firstChild}return r||MP},RP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,zP=/\/\*[^]*?\*\/|  +/g,Gx=/\n+/g,rh=(r,a)=>{let u="",m="",b="";for(let P in r){let w=r[P];P[0]=="@"?P[1]=="i"?u=P+" "+w+";":m+=P[1]=="f"?rh(w,P):P+"{"+rh(w,P[1]=="k"?"":a)+"}":typeof w=="object"?m+=rh(w,a?a.replace(/([^,])+/g,l=>P.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,L=>/&/.test(L)?L.replace(/&/g,l):l?l+" "+L:L)):P):w!=null&&(P=/^--/.test(P)?P:P.replace(/[A-Z]/g,"-$&").toLowerCase(),b+=rh.p?rh.p(P,w):P+":"+w+";")}return u+(a&&b?a+"{"+b+"}":b)+m},ru={},Vb=r=>{if(typeof r=="object"){let a="";for(let u in r)a+=u+Vb(r[u]);return a}return r},DP=(r,a,u,m,b)=>{let P=Vb(r),w=ru[P]||(ru[P]=(L=>{let N=0,Z=11;for(;N<L.length;)Z=101*Z+L.charCodeAt(N++)>>>0;return"go"+Z})(P));if(!ru[w]){let L=P!==r?r:(N=>{let Z,V,ee=[{}];for(;Z=RP.exec(N.replace(zP,""));)Z[4]?ee.shift():Z[3]?(V=Z[3].replace(Gx," ").trim(),ee.unshift(ee[0][V]=ee[0][V]||{})):ee[0][Z[1]]=Z[2].replace(Gx," ").trim();return ee[0]})(r);ru[w]=rh(b?{["@keyframes "+w]:L}:L,u?"":"."+w)}let l=u&&ru.g?ru.g:null;return u&&(ru.g=ru[w]),((L,N,Z,V)=>{V?N.data=N.data.replace(V,L):N.data.indexOf(L)===-1&&(N.data=Z?L+N.data:N.data+L)})(ru[w],a,m,l),w},LP=(r,a,u)=>r.reduce((m,b,P)=>{let w=a[P];if(w&&w.call){let l=w(u),L=l&&l.props&&l.props.className||/^go/.test(l)&&l;w=L?"."+L:l&&typeof l=="object"?l.props?"":rh(l,""):l===!1?"":l}return m+b+(w??"")},"");function Wg(r){let a=this||{},u=r.call?r(a.p):r;return DP(u.unshift?u.raw?LP(u,[].slice.call(arguments,1),a.p):u.reduce((m,b)=>Object.assign(m,b&&b.call?b(a.p):b),{}):u,AP(a.target),a.g,a.o,a.k)}let Zb,__,v_;Wg.bind({g:1});let du=Wg.bind({k:1});function FP(r,a,u,m){rh.p=a,Zb=r,__=u,v_=m}function gh(r,a){let u=this||{};return function(){let m=arguments;function b(P,w){let l=Object.assign({},P),L=l.className||b.className;u.p=Object.assign({theme:__&&__()},l),u.o=/ *go\d+/.test(L),l.className=Wg.apply(u,m)+(L?" "+L:"");let N=r;return r[0]&&(N=l.as||r,delete l.as),v_&&N[0]&&v_(l),Zb(N,l)}return b}}var OP=r=>typeof r=="function",zg=(r,a)=>OP(r)?r(a):r,jP=(()=>{let r=0;return()=>(++r).toString()})(),Gb=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let a=matchMedia("(prefers-reduced-motion: reduce)");r=!a||a.matches}return r}})(),NP=20,H_="default",qb=(r,a)=>{let{toastLimit:u}=r.settings;switch(a.type){case 0:return{...r,toasts:[a.toast,...r.toasts].slice(0,u)};case 1:return{...r,toasts:r.toasts.map(w=>w.id===a.toast.id?{...w,...a.toast}:w)};case 2:let{toast:m}=a;return qb(r,{type:r.toasts.find(w=>w.id===m.id)?1:0,toast:m});case 3:let{toastId:b}=a;return{...r,toasts:r.toasts.map(w=>w.id===b||b===void 0?{...w,dismissed:!0,visible:!1}:w)};case 4:return a.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(w=>w.id!==a.toastId)};case 5:return{...r,pausedAt:a.time};case 6:let P=a.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(w=>({...w,pauseDuration:w.pauseDuration+P}))}}},Pg=[],Wb={toasts:[],pausedAt:void 0,settings:{toastLimit:NP}},oc={},Hb=(r,a=H_)=>{oc[a]=qb(oc[a]||Wb,r),Pg.forEach(([u,m])=>{u===a&&m(oc[a])})},Kb=r=>Object.keys(oc).forEach(a=>Hb(r,a)),BP=r=>Object.keys(oc).find(a=>oc[a].toasts.some(u=>u.id===r)),Hg=(r=H_)=>a=>{Hb(a,r)},$P={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},UP=(r={},a=H_)=>{let[u,m]=te.useState(oc[a]||Wb),b=te.useRef(oc[a]);te.useEffect(()=>(b.current!==oc[a]&&m(oc[a]),Pg.push([a,m]),()=>{let w=Pg.findIndex(([l])=>l===a);w>-1&&Pg.splice(w,1)}),[a]);let P=u.toasts.map(w=>{var l,L,N;return{...r,...r[w.type],...w,removeDelay:w.removeDelay||((l=r[w.type])==null?void 0:l.removeDelay)||(r==null?void 0:r.removeDelay),duration:w.duration||((L=r[w.type])==null?void 0:L.duration)||(r==null?void 0:r.duration)||$P[w.type],style:{...r.style,...(N=r[w.type])==null?void 0:N.style,...w.style}}});return{...u,toasts:P}},VP=(r,a="blank",u)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:a,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...u,id:(u==null?void 0:u.id)||jP()}),vm=r=>(a,u)=>{let m=VP(a,r,u);return Hg(m.toasterId||BP(m.id))({type:2,toast:m}),m.id},Hi=(r,a)=>vm("blank")(r,a);Hi.error=vm("error");Hi.success=vm("success");Hi.loading=vm("loading");Hi.custom=vm("custom");Hi.dismiss=(r,a)=>{let u={type:3,toastId:r};a?Hg(a)(u):Kb(u)};Hi.dismissAll=r=>Hi.dismiss(void 0,r);Hi.remove=(r,a)=>{let u={type:4,toastId:r};a?Hg(a)(u):Kb(u)};Hi.removeAll=r=>Hi.remove(void 0,r);Hi.promise=(r,a,u)=>{let m=Hi.loading(a.loading,{...u,...u==null?void 0:u.loading});return typeof r=="function"&&(r=r()),r.then(b=>{let P=a.success?zg(a.success,b):void 0;return P?Hi.success(P,{id:m,...u,...u==null?void 0:u.success}):Hi.dismiss(m),b}).catch(b=>{let P=a.error?zg(a.error,b):void 0;P?Hi.error(P,{id:m,...u,...u==null?void 0:u.error}):Hi.dismiss(m)}),r};var ZP=1e3,GP=(r,a="default")=>{let{toasts:u,pausedAt:m}=UP(r,a),b=te.useRef(new Map).current,P=te.useCallback((V,ee=ZP)=>{if(b.has(V))return;let q=setTimeout(()=>{b.delete(V),w({type:4,toastId:V})},ee);b.set(V,q)},[]);te.useEffect(()=>{if(m)return;let V=Date.now(),ee=u.map(q=>{if(q.duration===1/0)return;let _e=(q.duration||0)+q.pauseDuration-(V-q.createdAt);if(_e<0){q.visible&&Hi.dismiss(q.id);return}return setTimeout(()=>Hi.dismiss(q.id,a),_e)});return()=>{ee.forEach(q=>q&&clearTimeout(q))}},[u,m,a]);let w=te.useCallback(Hg(a),[a]),l=te.useCallback(()=>{w({type:5,time:Date.now()})},[w]),L=te.useCallback((V,ee)=>{w({type:1,toast:{id:V,height:ee}})},[w]),N=te.useCallback(()=>{m&&w({type:6,time:Date.now()})},[m,w]),Z=te.useCallback((V,ee)=>{let{reverseOrder:q=!1,gutter:_e=8,defaultPosition:fe}=ee||{},Pe=u.filter(Se=>(Se.position||fe)===(V.position||fe)&&Se.height),Le=Pe.findIndex(Se=>Se.id===V.id),Me=Pe.filter((Se,De)=>De<Le&&Se.visible).length;return Pe.filter(Se=>Se.visible).slice(...q?[Me+1]:[0,Me]).reduce((Se,De)=>Se+(De.height||0)+_e,0)},[u]);return te.useEffect(()=>{u.forEach(V=>{if(V.dismissed)P(V.id,V.removeDelay);else{let ee=b.get(V.id);ee&&(clearTimeout(ee),b.delete(V.id))}})},[u,P]),{toasts:u,handlers:{updateHeight:L,startPause:l,endPause:N,calculateOffset:Z}}},qP=du`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,WP=du`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,HP=du`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,KP=gh("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${qP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${WP} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${HP} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,XP=du`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,YP=gh("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${XP} 1s linear infinite;
`,QP=du`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,JP=du`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,eC=gh("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${QP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${JP} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,tC=gh("div")`
  position: absolute;
`,rC=gh("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,nC=du`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iC=gh("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${nC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,sC=({toast:r})=>{let{icon:a,type:u,iconTheme:m}=r;return a!==void 0?typeof a=="string"?te.createElement(iC,null,a):a:u==="blank"?null:te.createElement(rC,null,te.createElement(YP,{...m}),u!=="loading"&&te.createElement(tC,null,u==="error"?te.createElement(KP,{...m}):te.createElement(eC,{...m})))},aC=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,oC=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,lC="0%{opacity:0;} 100%{opacity:1;}",cC="0%{opacity:1;} 100%{opacity:0;}",uC=gh("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,hC=gh("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,dC=(r,a)=>{let u=r.includes("top")?1:-1,[m,b]=Gb()?[lC,cC]:[aC(u),oC(u)];return{animation:a?`${du(m)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${du(b)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},fC=te.memo(({toast:r,position:a,style:u,children:m})=>{let b=r.height?dC(r.position||a||"top-center",r.visible):{opacity:0},P=te.createElement(sC,{toast:r}),w=te.createElement(hC,{...r.ariaProps},zg(r.message,r));return te.createElement(uC,{className:r.className,style:{...b,...u,...r.style}},typeof m=="function"?m({icon:P,message:w}):te.createElement(te.Fragment,null,P,w))});FP(te.createElement);var pC=({id:r,className:a,style:u,onHeightUpdate:m,children:b})=>{let P=te.useCallback(w=>{if(w){let l=()=>{let L=w.getBoundingClientRect().height;m(r,L)};l(),new MutationObserver(l).observe(w,{subtree:!0,childList:!0,characterData:!0})}},[r,m]);return te.createElement("div",{ref:P,className:a,style:u},b)},mC=(r,a)=>{let u=r.includes("top"),m=u?{top:0}:{bottom:0},b=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Gb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${a*(u?1:-1)}px)`,...m,...b}},gC=Wg`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,pg=16,yC=({reverseOrder:r,position:a="top-center",toastOptions:u,gutter:m,children:b,toasterId:P,containerStyle:w,containerClassName:l})=>{let{toasts:L,handlers:N}=GP(u,P);return te.createElement("div",{"data-rht-toaster":P||"",style:{position:"fixed",zIndex:9999,top:pg,left:pg,right:pg,bottom:pg,pointerEvents:"none",...w},className:l,onMouseEnter:N.startPause,onMouseLeave:N.endPause},L.map(Z=>{let V=Z.position||a,ee=N.calculateOffset(Z,{reverseOrder:r,gutter:m,defaultPosition:a}),q=mC(V,ee);return te.createElement(pC,{id:Z.id,key:Z.id,onHeightUpdate:N.updateHeight,className:Z.visible?gC:"",style:q},Z.type==="custom"?zg(Z.message,Z):b?b(Z):te.createElement(fC,{toast:Z,position:V}))}))},cu=Hi;function _C(r,a="long"){if(!r)return"";const u=new Date(r);if(Number.isNaN(u.getTime()))return String(r);if(a==="short")return u.toLocaleDateString("sv-SE",{year:"numeric",month:"2-digit",day:"2-digit"});const m=typeof navigator<"u"&&navigator.language||"sv-SE";return u.toLocaleDateString(m,{year:"numeric",month:"short",day:"numeric"})}function Xb(){const r=cc(a=>a.token);return Gg({queryKey:["favorites",r],enabled:!!r,queryFn:()=>Hf("/favorites"),staleTime:6e4})}function vC(){const r=fu(),a=cc.getState().token;return W_({mutationFn:u=>Hf("/favorites",{method:"POST",body:JSON.stringify({beachId:u})}),onSuccess:()=>{r.invalidateQueries({queryKey:["favorites",a]})}})}function Yb(){const r=fu(),a=cc.getState().token;return W_({mutationFn:u=>{const m=u.id?`/favorites/${u.id}`:`/favorites/by-beach/${u.beachId}`;return Hf(m,{method:"DELETE"})},onMutate:async u=>{await r.cancelQueries({queryKey:["favorites",a]});const m=r.getQueryData(["favorites",a]);if(m){const b=m.filter(P=>u.id?P._id!==u.id:P.beachId!==u.beachId);r.setQueryData(["favorites",a],b)}return{prev:m}},onError:(u,m,b)=>{b!=null&&b.prev&&r.setQueryData(["favorites",a],b.prev)},onSettled:()=>{r.invalidateQueries({queryKey:["favorites",a]})}})}function xC(){const r=fu(),a=cc.getState().token;return W_({mutationFn:u=>Hf("/favorites/reorder",{method:"PATCH",body:JSON.stringify({order:u})}),onSuccess:()=>{r.invalidateQueries({queryKey:["favorites",a]})}})}function bC(r){if(typeof r=="number")switch(r){case 1:return"kpi-excellent";case 2:return"kpi-good";case 3:return"kpi-sufficient";case 4:return"kpi-poor";default:return"kpi-unknown"}if(typeof r=="string"){const a=r.toLowerCase();if(a.includes("utmrkt"))return"kpi-excellent";if(a.includes("bra"))return"kpi-good";if(a.includes("tillfreds")||a.includes("sufficient"))return"kpi-sufficient";if(a.includes("dlig")||a.includes("poor"))return"kpi-poor"}return"kpi-unknown"}function wC(){const{t:r}=Ea(),{id:a}=a2(),u=Bd(),m=Oo(),{token:b}=cc(),{data:P,isLoading:w,isError:l,error:L}=Gg({queryKey:["beach",a],enabled:!!a,queryFn:()=>Lb(a),staleTime:300*1e3}),N=fu(),{data:Z}=Xb(),V=vC(),ee=Yb(),q=Z==null?void 0:Z.find(ot=>ot.beachId===a),_e=!!q;if(w)return Y.jsxs("section",{className:"p-4 space-y-4",children:[Y.jsx("div",{className:"h-7 w-2/3 bg-surface-muted rounded animate-pulse"}),Y.jsx("div",{className:"h-4 w-1/3 bg-surface-muted rounded animate-pulse"}),Y.jsxs("div",{className:"card p-4",children:[Y.jsx("div",{className:"h-4 w-1/2 bg-surface rounded animate-pulse"}),Y.jsx("div",{className:"h-4 w-1/3 bg-surface rounded animate-pulse mt-2"})]})]});if(l||!P)return Y.jsx("section",{className:"p-4",children:Y.jsxs("div",{className:"card p-4",children:[Y.jsx("p",{className:"font-spectral text-lg",children:r("loadError")}),Y.jsx("p",{className:"text-sm text-ink-muted mt-1",children:(L==null?void 0:L.message)??r("beachDetail.pleaseTryAgain")}),Y.jsxs(ei,{to:"/",className:"inline-block mt-3 px-3 py-2 rounded-2xl border border-border bg-surface hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",children:[" ",r("back")]})]})});const fe=P.locationName??r("beachDetail.beach"),Pe=P.locationArea??"",Le=P.classification,Me=P.classificationText??r("classification.unknown"),Se=bC(Le??Me),De=P.latestSampleDate?_C(P.latestSampleDate,"short"):"";async function Ye(){if(!b){u("/login",{replace:!1,state:{from:m}});return}try{_e?(await ee.mutateAsync({id:q==null?void 0:q._id,beachId:a}),cu.success(r("favorites.removed"))):(await V.mutateAsync(a),cu.success(r("favorites.added"))),N.invalidateQueries({queryKey:["favorites",b]}),N.invalidateQueries({queryKey:["beach",a]})}catch(ot){const lt=(ot==null?void 0:ot.message)??r("favorites.removed");cu.error(lt)}}return Y.jsxs("section",{className:"p-4 space-y-4",children:[Y.jsxs("header",{className:"space-y-1",children:[Y.jsx("h1",{className:"font-spectral text-2xl leading-tight",children:fe}),Y.jsx("p",{className:"text-ink-muted",children:Pe||""})]}),Y.jsxs("div",{className:"flex items-center gap-2",children:[Y.jsxs("span",{className:`badge ${Se}`,children:[Me," ",P.classificationYear?` ${P.classificationYear}`:""]}),P.euType&&Y.jsx("span",{className:"badge",children:r("beachDetail.euBad")})]}),Y.jsxs("div",{className:"card p-4 space-y-3",children:[Y.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[Y.jsxs("div",{children:[Y.jsx("div",{className:"text-ink-muted",children:r("beachDetail.latestSampleDate")}),Y.jsx("div",{className:"font-medium",children:De})]}),Y.jsxs("div",{children:[Y.jsx("div",{className:"text-ink-muted",children:r("beachDetail.algalBloom")}),Y.jsx("div",{className:"font-medium",children:P.algalText??""})]}),Y.jsxs("div",{children:[Y.jsx("div",{className:"text-ink-muted",children:r("beachDetail.euMotive")}),Y.jsx("div",{className:"font-medium",children:P.euMotive??""})]}),Y.jsxs("div",{children:[Y.jsx("div",{className:"text-ink-muted",children:r("beachDetail.nutsCode")}),Y.jsx("div",{className:"font-medium",children:P.nutsCode})]})]}),Y.jsxs("div",{className:"pt-2 flex items-center gap-2",children:[Y.jsx("button",{className:"px-3 py-2 rounded-2xl border border-border bg-surface hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40 disabled:opacity-60",onClick:Ye,disabled:V.isPending||ee.isPending,children:_e?` ${r("beachDetail.removeFavorite")}`:` ${r("beachDetail.addFavorite")}`}),Y.jsxs(ei,{to:"/",className:"px-3 py-2 rounded-2xl border border-border bg-surface hover:bg-surface-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/40",children:[" ",r("back")]})]})]}),P.bathInformation&&Y.jsxs("article",{className:"card p-4",children:[Y.jsx("h2",{className:"font-spectral text-lg mb-1",children:r("beachDetail.bathInformation")}),Y.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-line",children:P.bathInformation})]}),(P.contactMail||P.contactPhone||P.contactUrl)&&Y.jsxs("div",{className:"card p-4 space-y-1 text-sm",children:[Y.jsx("h3",{className:"font-spectral text-lg",children:r("nav.contact")}),P.contactMail&&Y.jsxs("div",{children:[r("beachDetail.mail")," ",Y.jsx("a",{href:`mailto:${P.contactMail}`,className:"underline text-accent",children:P.contactMail})]}),P.contactPhone&&Y.jsxs("div",{children:[r("beachDetail.phone")," ",P.contactPhone]}),P.contactUrl&&Y.jsxs("div",{children:[r("beachDetail.website")," ",Y.jsx("a",{href:P.contactUrl.startsWith("http")?P.contactUrl:`https://${P.contactUrl}`,target:"_blank",rel:"noreferrer",className:"underline text-accent",children:P.contactUrl})]})]})]})}var xm=r=>r.type==="checkbox",Pd=r=>r instanceof Date,aa=r=>r==null;const Qb=r=>typeof r=="object";var Ai=r=>!aa(r)&&!Array.isArray(r)&&Qb(r)&&!Pd(r),SC=r=>Ai(r)&&r.target?xm(r.target)?r.target.checked:r.target.value:r,TC=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,PC=(r,a)=>r.has(TC(a)),CC=r=>{const a=r.constructor&&r.constructor.prototype;return Ai(a)&&a.hasOwnProperty("isPrototypeOf")},K_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ls(r){let a;const u=Array.isArray(r),m=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)a=new Date(r);else if(!(K_&&(r instanceof Blob||m))&&(u||Ai(r)))if(a=u?[]:Object.create(Object.getPrototypeOf(r)),!u&&!CC(r))a=r;else for(const b in r)r.hasOwnProperty(b)&&(a[b]=ls(r[b]));else return r;return a}var Kg=r=>/^\w*$/.test(r),Mi=r=>r===void 0,X_=r=>Array.isArray(r)?r.filter(Boolean):[],Y_=r=>X_(r.replace(/["|']|\]/g,"").split(/\.|\[/)),Jt=(r,a,u)=>{if(!a||!Ai(r))return u;const m=(Kg(a)?[a]:Y_(a)).reduce((b,P)=>aa(b)?b:b[P],r);return Mi(m)||m===r?Mi(r[a])?u:r[a]:m},rc=r=>typeof r=="boolean",Pn=(r,a,u)=>{let m=-1;const b=Kg(a)?[a]:Y_(a),P=b.length,w=P-1;for(;++m<P;){const l=b[m];let L=u;if(m!==w){const N=r[l];L=Ai(N)||Array.isArray(N)?N:isNaN(+b[m+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=L,r=r[l]}};const qx={BLUR:"blur",FOCUS_OUT:"focusout"},ml={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},nu={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},kC=hn.createContext(null);kC.displayName="HookFormContext";var EC=(r,a,u,m=!0)=>{const b={defaultValues:a._defaultValues};for(const P in r)Object.defineProperty(b,P,{get:()=>{const w=P;return a._proxyFormState[w]!==ml.all&&(a._proxyFormState[w]=!m||ml.all),r[w]}});return b};const IC=typeof window<"u"?hn.useLayoutEffect:hn.useEffect;var ao=r=>typeof r=="string",MC=(r,a,u,m,b)=>ao(r)?(m&&a.watch.add(r),Jt(u,r,b)):Array.isArray(r)?r.map(P=>(m&&a.watch.add(P),Jt(u,P))):(m&&(a.watchAll=!0),u),x_=r=>aa(r)||!Qb(r);function nh(r,a,u=new WeakSet){if(x_(r)||x_(a))return r===a;if(Pd(r)&&Pd(a))return r.getTime()===a.getTime();const m=Object.keys(r),b=Object.keys(a);if(m.length!==b.length)return!1;if(u.has(r)||u.has(a))return!0;u.add(r),u.add(a);for(const P of m){const w=r[P];if(!b.includes(P))return!1;if(P!=="ref"){const l=a[P];if(Pd(w)&&Pd(l)||Ai(w)&&Ai(l)||Array.isArray(w)&&Array.isArray(l)?!nh(w,l,u):w!==l)return!1}}return!0}var Q_=(r,a,u,m,b)=>a?{...u[r],types:{...u[r]&&u[r].types?u[r].types:{},[m]:b||!0}}:{},Hp=r=>Array.isArray(r)?r:[r],Wx=()=>{let r=[];return{get observers(){return r},next:b=>{for(const P of r)P.next&&P.next(b)},subscribe:b=>(r.push(b),{unsubscribe:()=>{r=r.filter(P=>P!==b)}}),unsubscribe:()=>{r=[]}}};function Jb(r,a){const u={};for(const m in r)if(r.hasOwnProperty(m)){const b=r[m],P=a[m];if(b&&Ai(b)&&P){const w=Jb(b,P);Ai(w)&&(u[m]=w)}else r[m]&&(u[m]=P)}return u}var ka=r=>Ai(r)&&!Object.keys(r).length,J_=r=>r.type==="file",gl=r=>typeof r=="function",Dg=r=>{if(!K_)return!1;const a=r?r.ownerDocument:0;return r instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},e1=r=>r.type==="select-multiple",ev=r=>r.type==="radio",AC=r=>ev(r)||xm(r),Ny=r=>Dg(r)&&r.isConnected;function RC(r,a){const u=a.slice(0,-1).length;let m=0;for(;m<u;)r=Mi(r)?m++:r[a[m++]];return r}function zC(r){for(const a in r)if(r.hasOwnProperty(a)&&!Mi(r[a]))return!1;return!0}function Ii(r,a){const u=Array.isArray(a)?a:Kg(a)?[a]:Y_(a),m=u.length===1?r:RC(r,u),b=u.length-1,P=u[b];return m&&delete m[P],b!==0&&(Ai(m)&&ka(m)||Array.isArray(m)&&zC(m))&&Ii(r,u.slice(0,-1)),r}var DC=r=>{for(const a in r)if(gl(r[a]))return!0;return!1};function t1(r){return Array.isArray(r)||Ai(r)&&!DC(r)}function b_(r,a={}){for(const u in r)t1(r[u])?(a[u]=Array.isArray(r[u])?[]:{},b_(r[u],a[u])):aa(r[u])||(a[u]=!0);return a}function Cf(r,a,u){u||(u=b_(a));for(const m in r)t1(r[m])?Mi(a)||x_(u[m])?u[m]=b_(r[m],Array.isArray(r[m])?[]:{}):Cf(r[m],aa(a)?{}:a[m],u[m]):u[m]=!nh(r[m],a[m]);return u}const Hx={value:!1,isValid:!1},Kx={value:!0,isValid:!0};var r1=r=>{if(Array.isArray(r)){if(r.length>1){const a=r.filter(u=>u&&u.checked&&!u.disabled).map(u=>u.value);return{value:a,isValid:!!a.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!Mi(r[0].attributes.value)?Mi(r[0].value)||r[0].value===""?Kx:{value:r[0].value,isValid:!0}:Kx:Hx}return Hx},n1=(r,{valueAsNumber:a,valueAsDate:u,setValueAs:m})=>Mi(r)?r:a?r===""?NaN:r&&+r:u&&ao(r)?new Date(r):m?m(r):r;const Xx={isValid:!1,value:null};var i1=r=>Array.isArray(r)?r.reduce((a,u)=>u&&u.checked&&!u.disabled?{isValid:!0,value:u.value}:a,Xx):Xx;function Yx(r){const a=r.ref;return J_(a)?a.files:ev(a)?i1(r.refs).value:e1(a)?[...a.selectedOptions].map(({value:u})=>u):xm(a)?r1(r.refs).value:n1(Mi(a.value)?r.ref.value:a.value,r)}var LC=(r,a,u,m)=>{const b={};for(const P of r){const w=Jt(a,P);w&&Pn(b,P,w._f)}return{criteriaMode:u,names:[...r],fields:b,shouldUseNativeValidation:m}},Lg=r=>r instanceof RegExp,Zp=r=>Mi(r)?r:Lg(r)?r.source:Ai(r)?Lg(r.value)?r.value.source:r.value:r,Qx=r=>({isOnSubmit:!r||r===ml.onSubmit,isOnBlur:r===ml.onBlur,isOnChange:r===ml.onChange,isOnAll:r===ml.all,isOnTouch:r===ml.onTouched});const Jx="AsyncFunction";var FC=r=>!!r&&!!r.validate&&!!(gl(r.validate)&&r.validate.constructor.name===Jx||Ai(r.validate)&&Object.values(r.validate).find(a=>a.constructor.name===Jx)),OC=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),e0=(r,a,u)=>!u&&(a.watchAll||a.watch.has(r)||[...a.watch].some(m=>r.startsWith(m)&&/^\.\w+/.test(r.slice(m.length))));const Kp=(r,a,u,m)=>{for(const b of u||Object.keys(r)){const P=Jt(r,b);if(P){const{_f:w,...l}=P;if(w){if(w.refs&&w.refs[0]&&a(w.refs[0],b)&&!m)return!0;if(w.ref&&a(w.ref,w.name)&&!m)return!0;if(Kp(l,a))break}else if(Ai(l)&&Kp(l,a))break}}};function t0(r,a,u){const m=Jt(r,u);if(m||Kg(u))return{error:m,name:u};const b=u.split(".");for(;b.length;){const P=b.join("."),w=Jt(a,P),l=Jt(r,P);if(w&&!Array.isArray(w)&&u!==P)return{name:u};if(l&&l.type)return{name:P,error:l};if(l&&l.root&&l.root.type)return{name:`${P}.root`,error:l.root};b.pop()}return{name:u}}var jC=(r,a,u,m)=>{u(r);const{name:b,...P}=r;return ka(P)||Object.keys(P).length>=Object.keys(a).length||Object.keys(P).find(w=>a[w]===(!m||ml.all))},NC=(r,a,u)=>!r||!a||r===a||Hp(r).some(m=>m&&(u?m===a:m.startsWith(a)||a.startsWith(m))),BC=(r,a,u,m,b)=>b.isOnAll?!1:!u&&b.isOnTouch?!(a||r):(u?m.isOnBlur:b.isOnBlur)?!r:(u?m.isOnChange:b.isOnChange)?r:!0,$C=(r,a)=>!X_(Jt(r,a)).length&&Ii(r,a),UC=(r,a,u)=>{const m=Hp(Jt(r,u));return Pn(m,"root",a[u]),Pn(r,u,m),r};function r0(r,a,u="validate"){if(ao(r)||Array.isArray(r)&&r.every(ao)||rc(r)&&!r)return{type:u,message:ao(r)?r:"",ref:a}}var Pf=r=>Ai(r)&&!Lg(r)?r:{value:r,message:""},n0=async(r,a,u,m,b,P)=>{const{ref:w,refs:l,required:L,maxLength:N,minLength:Z,min:V,max:ee,pattern:q,validate:_e,name:fe,valueAsNumber:Pe,mount:Le}=r._f,Me=Jt(u,fe);if(!Le||a.has(fe))return{};const Se=l?l[0]:w,De=Rt=>{b&&Se.reportValidity&&(Se.setCustomValidity(rc(Rt)?"":Rt||""),Se.reportValidity())},Ye={},ot=ev(w),lt=xm(w),ut=ot||lt,Je=(Pe||J_(w))&&Mi(w.value)&&Mi(Me)||Dg(w)&&w.value===""||Me===""||Array.isArray(Me)&&!Me.length,Ke=Q_.bind(null,fe,m,Ye),At=(Rt,Mt,Ht,zr=nu.maxLength,or=nu.minLength)=>{const Zt=Rt?Mt:Ht;Ye[fe]={type:Rt?zr:or,message:Zt,ref:w,...Ke(Rt?zr:or,Zt)}};if(P?!Array.isArray(Me)||!Me.length:L&&(!ut&&(Je||aa(Me))||rc(Me)&&!Me||lt&&!r1(l).isValid||ot&&!i1(l).isValid)){const{value:Rt,message:Mt}=ao(L)?{value:!!L,message:L}:Pf(L);if(Rt&&(Ye[fe]={type:nu.required,message:Mt,ref:Se,...Ke(nu.required,Mt)},!m))return De(Mt),Ye}if(!Je&&(!aa(V)||!aa(ee))){let Rt,Mt;const Ht=Pf(ee),zr=Pf(V);if(!aa(Me)&&!isNaN(Me)){const or=w.valueAsNumber||Me&&+Me;aa(Ht.value)||(Rt=or>Ht.value),aa(zr.value)||(Mt=or<zr.value)}else{const or=w.valueAsDate||new Date(Me),Zt=Ct=>new Date(new Date().toDateString()+" "+Ct),_t=w.type=="time",ft=w.type=="week";ao(Ht.value)&&Me&&(Rt=_t?Zt(Me)>Zt(Ht.value):ft?Me>Ht.value:or>new Date(Ht.value)),ao(zr.value)&&Me&&(Mt=_t?Zt(Me)<Zt(zr.value):ft?Me<zr.value:or<new Date(zr.value))}if((Rt||Mt)&&(At(!!Rt,Ht.message,zr.message,nu.max,nu.min),!m))return De(Ye[fe].message),Ye}if((N||Z)&&!Je&&(ao(Me)||P&&Array.isArray(Me))){const Rt=Pf(N),Mt=Pf(Z),Ht=!aa(Rt.value)&&Me.length>+Rt.value,zr=!aa(Mt.value)&&Me.length<+Mt.value;if((Ht||zr)&&(At(Ht,Rt.message,Mt.message),!m))return De(Ye[fe].message),Ye}if(q&&!Je&&ao(Me)){const{value:Rt,message:Mt}=Pf(q);if(Lg(Rt)&&!Me.match(Rt)&&(Ye[fe]={type:nu.pattern,message:Mt,ref:w,...Ke(nu.pattern,Mt)},!m))return De(Mt),Ye}if(_e){if(gl(_e)){const Rt=await _e(Me,u),Mt=r0(Rt,Se);if(Mt&&(Ye[fe]={...Mt,...Ke(nu.validate,Mt.message)},!m))return De(Mt.message),Ye}else if(Ai(_e)){let Rt={};for(const Mt in _e){if(!ka(Rt)&&!m)break;const Ht=r0(await _e[Mt](Me,u),Se,Mt);Ht&&(Rt={...Ht,...Ke(Mt,Ht.message)},De(Ht.message),m&&(Ye[fe]=Rt))}if(!ka(Rt)&&(Ye[fe]={ref:Se,...Rt},!m))return Ye}}return De(!0),Ye};const VC={mode:ml.onSubmit,reValidateMode:ml.onChange,shouldFocusError:!0};function ZC(r={}){let a={...VC,...r},u={submitCount:0,isDirty:!1,isReady:!1,isLoading:gl(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},m={},b=Ai(a.defaultValues)||Ai(a.values)?ls(a.defaultValues||a.values)||{}:{},P=a.shouldUnregister?{}:ls(b),w={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},L,N=0;const Z={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let V={...Z};const ee={array:Wx(),state:Wx()},q=a.criteriaMode===ml.all,_e=xe=>Be=>{clearTimeout(N),N=setTimeout(xe,Be)},fe=async xe=>{if(!a.disabled&&(Z.isValid||V.isValid||xe)){const Be=a.resolver?ka((await lt()).errors):await Je(m,!0);Be!==u.isValid&&ee.state.next({isValid:Be})}},Pe=(xe,Be)=>{!a.disabled&&(Z.isValidating||Z.validatingFields||V.isValidating||V.validatingFields)&&((xe||Array.from(l.mount)).forEach(Xe=>{Xe&&(Be?Pn(u.validatingFields,Xe,Be):Ii(u.validatingFields,Xe))}),ee.state.next({validatingFields:u.validatingFields,isValidating:!ka(u.validatingFields)}))},Le=(xe,Be=[],Xe,Et,vt=!0,gt=!0)=>{if(Et&&Xe&&!a.disabled){if(w.action=!0,gt&&Array.isArray(Jt(m,xe))){const Bt=Xe(Jt(m,xe),Et.argA,Et.argB);vt&&Pn(m,xe,Bt)}if(gt&&Array.isArray(Jt(u.errors,xe))){const Bt=Xe(Jt(u.errors,xe),Et.argA,Et.argB);vt&&Pn(u.errors,xe,Bt),$C(u.errors,xe)}if((Z.touchedFields||V.touchedFields)&&gt&&Array.isArray(Jt(u.touchedFields,xe))){const Bt=Xe(Jt(u.touchedFields,xe),Et.argA,Et.argB);vt&&Pn(u.touchedFields,xe,Bt)}(Z.dirtyFields||V.dirtyFields)&&(u.dirtyFields=Cf(b,P)),ee.state.next({name:xe,isDirty:At(xe,Be),dirtyFields:u.dirtyFields,errors:u.errors,isValid:u.isValid})}else Pn(P,xe,Be)},Me=(xe,Be)=>{Pn(u.errors,xe,Be),ee.state.next({errors:u.errors})},Se=xe=>{u.errors=xe,ee.state.next({errors:u.errors,isValid:!1})},De=(xe,Be,Xe,Et)=>{const vt=Jt(m,xe);if(vt){const gt=Jt(P,xe,Mi(Xe)?Jt(b,xe):Xe);Mi(gt)||Et&&Et.defaultChecked||Be?Pn(P,xe,Be?gt:Yx(vt._f)):Ht(xe,gt),w.mount&&fe()}},Ye=(xe,Be,Xe,Et,vt)=>{let gt=!1,Bt=!1;const _r={name:xe};if(!a.disabled){if(!Xe||Et){(Z.isDirty||V.isDirty)&&(Bt=u.isDirty,u.isDirty=_r.isDirty=At(),gt=Bt!==_r.isDirty);const Sr=nh(Jt(b,xe),Be);Bt=!!Jt(u.dirtyFields,xe),Sr?Ii(u.dirtyFields,xe):Pn(u.dirtyFields,xe,!0),_r.dirtyFields=u.dirtyFields,gt=gt||(Z.dirtyFields||V.dirtyFields)&&Bt!==!Sr}if(Xe){const Sr=Jt(u.touchedFields,xe);Sr||(Pn(u.touchedFields,xe,Xe),_r.touchedFields=u.touchedFields,gt=gt||(Z.touchedFields||V.touchedFields)&&Sr!==Xe)}gt&&vt&&ee.state.next(_r)}return gt?_r:{}},ot=(xe,Be,Xe,Et)=>{const vt=Jt(u.errors,xe),gt=(Z.isValid||V.isValid)&&rc(Be)&&u.isValid!==Be;if(a.delayError&&Xe?(L=_e(()=>Me(xe,Xe)),L(a.delayError)):(clearTimeout(N),L=null,Xe?Pn(u.errors,xe,Xe):Ii(u.errors,xe)),(Xe?!nh(vt,Xe):vt)||!ka(Et)||gt){const Bt={...Et,...gt&&rc(Be)?{isValid:Be}:{},errors:u.errors,name:xe};u={...u,...Bt},ee.state.next(Bt)}},lt=async xe=>{Pe(xe,!0);const Be=await a.resolver(P,a.context,LC(xe||l.mount,m,a.criteriaMode,a.shouldUseNativeValidation));return Pe(xe),Be},ut=async xe=>{const{errors:Be}=await lt(xe);if(xe)for(const Xe of xe){const Et=Jt(Be,Xe);Et?Pn(u.errors,Xe,Et):Ii(u.errors,Xe)}else u.errors=Be;return Be},Je=async(xe,Be,Xe={valid:!0})=>{for(const Et in xe){const vt=xe[Et];if(vt){const{_f:gt,...Bt}=vt;if(gt){const _r=l.array.has(gt.name),Sr=vt._f&&FC(vt._f);Sr&&Z.validatingFields&&Pe([gt.name],!0);const Te=await n0(vt,l.disabled,P,q,a.shouldUseNativeValidation&&!Be,_r);if(Sr&&Z.validatingFields&&Pe([gt.name]),Te[gt.name]&&(Xe.valid=!1,Be))break;!Be&&(Jt(Te,gt.name)?_r?UC(u.errors,Te,gt.name):Pn(u.errors,gt.name,Te[gt.name]):Ii(u.errors,gt.name))}!ka(Bt)&&await Je(Bt,Be,Xe)}}return Xe.valid},Ke=()=>{for(const xe of l.unMount){const Be=Jt(m,xe);Be&&(Be._f.refs?Be._f.refs.every(Xe=>!Ny(Xe)):!Ny(Be._f.ref))&&Lr(xe)}l.unMount=new Set},At=(xe,Be)=>!a.disabled&&(xe&&Be&&Pn(P,xe,Be),!nh(Ct(),b)),Rt=(xe,Be,Xe)=>MC(xe,l,{...w.mount?P:Mi(Be)?b:ao(xe)?{[xe]:Be}:Be},Xe,Be),Mt=xe=>X_(Jt(w.mount?P:b,xe,a.shouldUnregister?Jt(b,xe,[]):[])),Ht=(xe,Be,Xe={})=>{const Et=Jt(m,xe);let vt=Be;if(Et){const gt=Et._f;gt&&(!gt.disabled&&Pn(P,xe,n1(Be,gt)),vt=Dg(gt.ref)&&aa(Be)?"":Be,e1(gt.ref)?[...gt.ref.options].forEach(Bt=>Bt.selected=vt.includes(Bt.value)):gt.refs?xm(gt.ref)?gt.refs.forEach(Bt=>{(!Bt.defaultChecked||!Bt.disabled)&&(Array.isArray(vt)?Bt.checked=!!vt.find(_r=>_r===Bt.value):Bt.checked=vt===Bt.value||!!vt)}):gt.refs.forEach(Bt=>Bt.checked=Bt.value===vt):J_(gt.ref)?gt.ref.value="":(gt.ref.value=vt,gt.ref.type||ee.state.next({name:xe,values:ls(P)})))}(Xe.shouldDirty||Xe.shouldTouch)&&Ye(xe,vt,Xe.shouldTouch,Xe.shouldDirty,!0),Xe.shouldValidate&&ft(xe)},zr=(xe,Be,Xe)=>{for(const Et in Be){if(!Be.hasOwnProperty(Et))return;const vt=Be[Et],gt=xe+"."+Et,Bt=Jt(m,gt);(l.array.has(xe)||Ai(vt)||Bt&&!Bt._f)&&!Pd(vt)?zr(gt,vt,Xe):Ht(gt,vt,Xe)}},or=(xe,Be,Xe={})=>{const Et=Jt(m,xe),vt=l.array.has(xe),gt=ls(Be);Pn(P,xe,gt),vt?(ee.array.next({name:xe,values:ls(P)}),(Z.isDirty||Z.dirtyFields||V.isDirty||V.dirtyFields)&&Xe.shouldDirty&&ee.state.next({name:xe,dirtyFields:Cf(b,P),isDirty:At(xe,gt)})):Et&&!Et._f&&!aa(gt)?zr(xe,gt,Xe):Ht(xe,gt,Xe),e0(xe,l)&&ee.state.next({...u,name:xe}),ee.state.next({name:w.mount?xe:void 0,values:ls(P)})},Zt=async xe=>{w.mount=!0;const Be=xe.target;let Xe=Be.name,Et=!0;const vt=Jt(m,Xe),gt=Sr=>{Et=Number.isNaN(Sr)||Pd(Sr)&&isNaN(Sr.getTime())||nh(Sr,Jt(P,Xe,Sr))},Bt=Qx(a.mode),_r=Qx(a.reValidateMode);if(vt){let Sr,Te;const K=Be.type?Yx(vt._f):SC(xe),X=xe.type===qx.BLUR||xe.type===qx.FOCUS_OUT,ne=!OC(vt._f)&&!a.resolver&&!Jt(u.errors,Xe)&&!vt._f.deps||BC(X,Jt(u.touchedFields,Xe),u.isSubmitted,_r,Bt),ue=e0(Xe,l,X);Pn(P,Xe,K),X?(!Be||!Be.readOnly)&&(vt._f.onBlur&&vt._f.onBlur(xe),L&&L(0)):vt._f.onChange&&vt._f.onChange(xe);const ve=Ye(Xe,K,X),Ae=!ka(ve)||ue;if(!X&&ee.state.next({name:Xe,type:xe.type,values:ls(P)}),ne)return(Z.isValid||V.isValid)&&(a.mode==="onBlur"?X&&fe():X||fe()),Ae&&ee.state.next({name:Xe,...ue?{}:ve});if(!X&&ue&&ee.state.next({...u}),a.resolver){const{errors:Oe}=await lt([Xe]);if(gt(K),Et){const Re=t0(u.errors,m,Xe),qe=t0(Oe,m,Re.name||Xe);Sr=qe.error,Xe=qe.name,Te=ka(Oe)}}else Pe([Xe],!0),Sr=(await n0(vt,l.disabled,P,q,a.shouldUseNativeValidation))[Xe],Pe([Xe]),gt(K),Et&&(Sr?Te=!1:(Z.isValid||V.isValid)&&(Te=await Je(m,!0)));Et&&(vt._f.deps&&(!Array.isArray(vt._f.deps)||vt._f.deps.length>0)&&ft(vt._f.deps),ot(Xe,Te,Sr,ve))}},_t=(xe,Be)=>{if(Jt(u.errors,Be)&&xe.focus)return xe.focus(),1},ft=async(xe,Be={})=>{let Xe,Et;const vt=Hp(xe);if(a.resolver){const gt=await ut(Mi(xe)?xe:vt);Xe=ka(gt),Et=xe?!vt.some(Bt=>Jt(gt,Bt)):Xe}else xe?(Et=(await Promise.all(vt.map(async gt=>{const Bt=Jt(m,gt);return await Je(Bt&&Bt._f?{[gt]:Bt}:Bt)}))).every(Boolean),!(!Et&&!u.isValid)&&fe()):Et=Xe=await Je(m);return ee.state.next({...!ao(xe)||(Z.isValid||V.isValid)&&Xe!==u.isValid?{}:{name:xe},...a.resolver||!xe?{isValid:Xe}:{},errors:u.errors}),Be.shouldFocus&&!Et&&Kp(m,_t,xe?vt:l.mount),Et},Ct=(xe,Be)=>{let Xe={...w.mount?P:b};return Be&&(Xe=Jb(Be.dirtyFields?u.dirtyFields:u.touchedFields,Xe)),Mi(xe)?Xe:ao(xe)?Jt(Xe,xe):xe.map(Et=>Jt(Xe,Et))},Ie=(xe,Be)=>({invalid:!!Jt((Be||u).errors,xe),isDirty:!!Jt((Be||u).dirtyFields,xe),error:Jt((Be||u).errors,xe),isValidating:!!Jt(u.validatingFields,xe),isTouched:!!Jt((Be||u).touchedFields,xe)}),Qe=xe=>{xe&&Hp(xe).forEach(Be=>Ii(u.errors,Be)),ee.state.next({errors:xe?u.errors:{}})},jt=(xe,Be,Xe)=>{const Et=(Jt(m,xe,{_f:{}})._f||{}).ref,vt=Jt(u.errors,xe)||{},{ref:gt,message:Bt,type:_r,...Sr}=vt;Pn(u.errors,xe,{...Sr,...Be,ref:Et}),ee.state.next({name:xe,errors:u.errors,isValid:!1}),Xe&&Xe.shouldFocus&&Et&&Et.focus&&Et.focus()},tr=(xe,Be)=>gl(xe)?ee.state.subscribe({next:Xe=>"values"in Xe&&xe(Rt(void 0,Be),Xe)}):Rt(xe,Be,!0),fr=xe=>ee.state.subscribe({next:Be=>{NC(xe.name,Be.name,xe.exact)&&jC(Be,xe.formState||Z,Yi,xe.reRenderRoot)&&xe.callback({values:{...P},...u,...Be,defaultValues:b})}}).unsubscribe,Kt=xe=>(w.mount=!0,V={...V,...xe.formState},fr({...xe,formState:V})),Lr=(xe,Be={})=>{for(const Xe of xe?Hp(xe):l.mount)l.mount.delete(Xe),l.array.delete(Xe),Be.keepValue||(Ii(m,Xe),Ii(P,Xe)),!Be.keepError&&Ii(u.errors,Xe),!Be.keepDirty&&Ii(u.dirtyFields,Xe),!Be.keepTouched&&Ii(u.touchedFields,Xe),!Be.keepIsValidating&&Ii(u.validatingFields,Xe),!a.shouldUnregister&&!Be.keepDefaultValue&&Ii(b,Xe);ee.state.next({values:ls(P)}),ee.state.next({...u,...Be.keepDirty?{isDirty:At()}:{}}),!Be.keepIsValid&&fe()},sr=({disabled:xe,name:Be})=>{(rc(xe)&&w.mount||xe||l.disabled.has(Be))&&(xe?l.disabled.add(Be):l.disabled.delete(Be))},yr=(xe,Be={})=>{let Xe=Jt(m,xe);const Et=rc(Be.disabled)||rc(a.disabled);return Pn(m,xe,{...Xe||{},_f:{...Xe&&Xe._f?Xe._f:{ref:{name:xe}},name:xe,mount:!0,...Be}}),l.mount.add(xe),Xe?sr({disabled:rc(Be.disabled)?Be.disabled:a.disabled,name:xe}):De(xe,!0,Be.value),{...Et?{disabled:Be.disabled||a.disabled}:{},...a.progressive?{required:!!Be.required,min:Zp(Be.min),max:Zp(Be.max),minLength:Zp(Be.minLength),maxLength:Zp(Be.maxLength),pattern:Zp(Be.pattern)}:{},name:xe,onChange:Zt,onBlur:Zt,ref:vt=>{if(vt){yr(xe,Be),Xe=Jt(m,xe);const gt=Mi(vt.value)&&vt.querySelectorAll&&vt.querySelectorAll("input,select,textarea")[0]||vt,Bt=AC(gt),_r=Xe._f.refs||[];if(Bt?_r.find(Sr=>Sr===gt):gt===Xe._f.ref)return;Pn(m,xe,{_f:{...Xe._f,...Bt?{refs:[..._r.filter(Ny),gt,...Array.isArray(Jt(b,xe))?[{}]:[]],ref:{type:gt.type,name:xe}}:{ref:gt}}}),De(xe,!1,void 0,gt)}else Xe=Jt(m,xe,{}),Xe._f&&(Xe._f.mount=!1),(a.shouldUnregister||Be.shouldUnregister)&&!(PC(l.array,xe)&&w.action)&&l.unMount.add(xe)}}},lr=()=>a.shouldFocusError&&Kp(m,_t,l.mount),ci=xe=>{rc(xe)&&(ee.state.next({disabled:xe}),Kp(m,(Be,Xe)=>{const Et=Jt(m,Xe);Et&&(Be.disabled=Et._f.disabled||xe,Array.isArray(Et._f.refs)&&Et._f.refs.forEach(vt=>{vt.disabled=Et._f.disabled||xe}))},0,!1))},ln=(xe,Be)=>async Xe=>{let Et;Xe&&(Xe.preventDefault&&Xe.preventDefault(),Xe.persist&&Xe.persist());let vt=ls(P);if(ee.state.next({isSubmitting:!0}),a.resolver){const{errors:gt,values:Bt}=await lt();u.errors=gt,vt=ls(Bt)}else await Je(m);if(l.disabled.size)for(const gt of l.disabled)Ii(vt,gt);if(Ii(u.errors,"root"),ka(u.errors)){ee.state.next({errors:{}});try{await xe(vt,Xe)}catch(gt){Et=gt}}else Be&&await Be({...u.errors},Xe),lr(),setTimeout(lr);if(ee.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ka(u.errors)&&!Et,submitCount:u.submitCount+1,errors:u.errors}),Et)throw Et},Vr=(xe,Be={})=>{Jt(m,xe)&&(Mi(Be.defaultValue)?or(xe,ls(Jt(b,xe))):(or(xe,Be.defaultValue),Pn(b,xe,ls(Be.defaultValue))),Be.keepTouched||Ii(u.touchedFields,xe),Be.keepDirty||(Ii(u.dirtyFields,xe),u.isDirty=Be.defaultValue?At(xe,ls(Jt(b,xe))):At()),Be.keepError||(Ii(u.errors,xe),Z.isValid&&fe()),ee.state.next({...u}))},Nr=(xe,Be={})=>{const Xe=xe?ls(xe):b,Et=ls(Xe),vt=ka(xe),gt=vt?b:Et;if(Be.keepDefaultValues||(b=Xe),!Be.keepValues){if(Be.keepDirtyValues){const Bt=new Set([...l.mount,...Object.keys(Cf(b,P))]);for(const _r of Array.from(Bt))Jt(u.dirtyFields,_r)?Pn(gt,_r,Jt(P,_r)):or(_r,Jt(gt,_r))}else{if(K_&&Mi(xe))for(const Bt of l.mount){const _r=Jt(m,Bt);if(_r&&_r._f){const Sr=Array.isArray(_r._f.refs)?_r._f.refs[0]:_r._f.ref;if(Dg(Sr)){const Te=Sr.closest("form");if(Te){Te.reset();break}}}}if(Be.keepFieldsRef)for(const Bt of l.mount)or(Bt,Jt(gt,Bt));else m={}}P=a.shouldUnregister?Be.keepDefaultValues?ls(b):{}:ls(gt),ee.array.next({values:{...gt}}),ee.state.next({values:{...gt}})}l={mount:Be.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},w.mount=!Z.isValid||!!Be.keepIsValid||!!Be.keepDirtyValues,w.watch=!!a.shouldUnregister,ee.state.next({submitCount:Be.keepSubmitCount?u.submitCount:0,isDirty:vt?!1:Be.keepDirty?u.isDirty:!!(Be.keepDefaultValues&&!nh(xe,b)),isSubmitted:Be.keepIsSubmitted?u.isSubmitted:!1,dirtyFields:vt?{}:Be.keepDirtyValues?Be.keepDefaultValues&&P?Cf(b,P):u.dirtyFields:Be.keepDefaultValues&&xe?Cf(b,xe):Be.keepDirty?u.dirtyFields:{},touchedFields:Be.keepTouched?u.touchedFields:{},errors:Be.keepErrors?u.errors:{},isSubmitSuccessful:Be.keepIsSubmitSuccessful?u.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:b})},Cn=(xe,Be)=>Nr(gl(xe)?xe(P):xe,Be),jn=(xe,Be={})=>{const Xe=Jt(m,xe),Et=Xe&&Xe._f;if(Et){const vt=Et.refs?Et.refs[0]:Et.ref;vt.focus&&(vt.focus(),Be.shouldSelect&&gl(vt.select)&&vt.select())}},Yi=xe=>{u={...u,...xe}},Zn={control:{register:yr,unregister:Lr,getFieldState:Ie,handleSubmit:ln,setError:jt,_subscribe:fr,_runSchema:lt,_focusError:lr,_getWatch:Rt,_getDirty:At,_setValid:fe,_setFieldArray:Le,_setDisabledField:sr,_setErrors:Se,_getFieldArray:Mt,_reset:Nr,_resetDefaultValues:()=>gl(a.defaultValues)&&a.defaultValues().then(xe=>{Cn(xe,a.resetOptions),ee.state.next({isLoading:!1})}),_removeUnmounted:Ke,_disableForm:ci,_subjects:ee,_proxyFormState:Z,get _fields(){return m},get _formValues(){return P},get _state(){return w},set _state(xe){w=xe},get _defaultValues(){return b},get _names(){return l},set _names(xe){l=xe},get _formState(){return u},get _options(){return a},set _options(xe){a={...a,...xe}}},subscribe:Kt,trigger:ft,register:yr,handleSubmit:ln,watch:tr,setValue:or,getValues:Ct,reset:Cn,resetField:Vr,clearErrors:Qe,unregister:Lr,setError:jt,setFocus:jn,getFieldState:Ie};return{...Zn,formControl:Zn}}function s1(r={}){const a=hn.useRef(void 0),u=hn.useRef(void 0),[m,b]=hn.useState({isDirty:!1,isValidating:!1,isLoading:gl(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:gl(r.defaultValues)?void 0:r.defaultValues});if(!a.current)if(r.formControl)a.current={...r.formControl,formState:m},r.defaultValues&&!gl(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions);else{const{formControl:w,...l}=ZC(r);a.current={...l,formState:m}}const P=a.current.control;return P._options=r,IC(()=>{const w=P._subscribe({formState:P._proxyFormState,callback:()=>b({...P._formState}),reRenderRoot:!0});return b(l=>({...l,isReady:!0})),P._formState.isReady=!0,w},[P]),hn.useEffect(()=>P._disableForm(r.disabled),[P,r.disabled]),hn.useEffect(()=>{r.mode&&(P._options.mode=r.mode),r.reValidateMode&&(P._options.reValidateMode=r.reValidateMode)},[P,r.mode,r.reValidateMode]),hn.useEffect(()=>{r.errors&&(P._setErrors(r.errors),P._focusError())},[P,r.errors]),hn.useEffect(()=>{r.shouldUnregister&&P._subjects.state.next({values:P._getWatch()})},[P,r.shouldUnregister]),hn.useEffect(()=>{if(P._proxyFormState.isDirty){const w=P._getDirty();w!==m.isDirty&&P._subjects.state.next({isDirty:w})}},[P,m.isDirty]),hn.useEffect(()=>{r.values&&!nh(r.values,u.current)?(P._reset(r.values,{keepFieldsRef:!0,...P._options.resetOptions}),u.current=r.values,b(w=>({...w}))):P._resetDefaultValues()},[P,r.values]),hn.useEffect(()=>{P._state.mount||(P._setValid(),P._state.mount=!0),P._state.watch&&(P._state.watch=!1,P._subjects.state.next({...P._formState})),P._removeUnmounted()}),a.current.formState=EC(m,P),a.current}function pt(r,a,u){function m(l,L){var N;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(N=l._zod).traits??(N.traits=new Set),l._zod.traits.add(r),a(l,L);for(const Z in w.prototype)Z in l||Object.defineProperty(l,Z,{value:w.prototype[Z].bind(l)});l._zod.constr=w,l._zod.def=L}const b=(u==null?void 0:u.Parent)??Object;class P extends b{}Object.defineProperty(P,"name",{value:r});function w(l){var L;const N=u!=null&&u.Parent?new P:this;m(N,l),(L=N._zod).deferred??(L.deferred=[]);for(const Z of N._zod.deferred)Z();return N}return Object.defineProperty(w,"init",{value:m}),Object.defineProperty(w,Symbol.hasInstance,{value:l=>{var L,N;return u!=null&&u.Parent&&l instanceof u.Parent?!0:(N=(L=l==null?void 0:l._zod)==null?void 0:L.traits)==null?void 0:N.has(r)}}),Object.defineProperty(w,"name",{value:r}),w}class Ef extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class a1 extends Error{constructor(a){super(`Encountered unidirectional transform during encode: ${a}`),this.name="ZodEncodeError"}}const o1={};function jd(r){return o1}function GC(r){const a=Object.values(r).filter(m=>typeof m=="number");return Object.entries(r).filter(([m,b])=>a.indexOf(+m)===-1).map(([m,b])=>b)}function w_(r,a){return typeof a=="bigint"?a.toString():a}function tv(r){return{get value(){{const a=r();return Object.defineProperty(this,"value",{value:a}),a}}}}function rv(r){return r==null}function nv(r){const a=r.startsWith("^")?1:0,u=r.endsWith("$")?r.length-1:r.length;return r.slice(a,u)}const i0=Symbol("evaluating");function An(r,a,u){let m;Object.defineProperty(r,a,{get(){if(m!==i0)return m===void 0&&(m=i0,m=u()),m},set(b){Object.defineProperty(r,a,{value:b})},configurable:!0})}function Ud(r,a,u){Object.defineProperty(r,a,{value:u,writable:!0,enumerable:!0,configurable:!0})}function Vd(...r){const a={};for(const u of r){const m=Object.getOwnPropertyDescriptors(u);Object.assign(a,m)}return Object.defineProperties({},a)}function s0(r){return JSON.stringify(r)}const l1="captureStackTrace"in Error?Error.captureStackTrace:(...r)=>{};function Fg(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}const qC=tv(()=>{var r;if(typeof navigator<"u"&&((r=navigator==null?void 0:navigator.userAgent)!=null&&r.includes("Cloudflare")))return!1;try{const a=Function;return new a(""),!0}catch{return!1}});function sm(r){if(Fg(r)===!1)return!1;const a=r.constructor;if(a===void 0)return!0;const u=a.prototype;return!(Fg(u)===!1||Object.prototype.hasOwnProperty.call(u,"isPrototypeOf")===!1)}function c1(r){return sm(r)?{...r}:Array.isArray(r)?[...r]:r}const WC=new Set(["string","number","symbol"]);function Xg(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function yh(r,a,u){const m=new r._zod.constr(a??r._zod.def);return(!a||u!=null&&u.parent)&&(m._zod.parent=r),m}function Rr(r){const a=r;if(!a)return{};if(typeof a=="string")return{error:()=>a};if((a==null?void 0:a.message)!==void 0){if((a==null?void 0:a.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");a.error=a.message}return delete a.message,typeof a.error=="string"?{...a,error:()=>a.error}:a}function HC(r){return Object.keys(r).filter(a=>r[a]._zod.optin==="optional"&&r[a]._zod.optout==="optional")}function KC(r,a){const u=r._zod.def,m=Vd(r._zod.def,{get shape(){const b={};for(const P in a){if(!(P in u.shape))throw new Error(`Unrecognized key: "${P}"`);a[P]&&(b[P]=u.shape[P])}return Ud(this,"shape",b),b},checks:[]});return yh(r,m)}function XC(r,a){const u=r._zod.def,m=Vd(r._zod.def,{get shape(){const b={...r._zod.def.shape};for(const P in a){if(!(P in u.shape))throw new Error(`Unrecognized key: "${P}"`);a[P]&&delete b[P]}return Ud(this,"shape",b),b},checks:[]});return yh(r,m)}function YC(r,a){if(!sm(a))throw new Error("Invalid input to extend: expected a plain object");const u=r._zod.def.checks;if(u&&u.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const b=Vd(r._zod.def,{get shape(){const P={...r._zod.def.shape,...a};return Ud(this,"shape",P),P},checks:[]});return yh(r,b)}function QC(r,a){if(!sm(a))throw new Error("Invalid input to safeExtend: expected a plain object");const u={...r._zod.def,get shape(){const m={...r._zod.def.shape,...a};return Ud(this,"shape",m),m},checks:r._zod.def.checks};return yh(r,u)}function JC(r,a){const u=Vd(r._zod.def,{get shape(){const m={...r._zod.def.shape,...a._zod.def.shape};return Ud(this,"shape",m),m},get catchall(){return a._zod.def.catchall},checks:[]});return yh(r,u)}function ek(r,a,u){const m=Vd(a._zod.def,{get shape(){const b=a._zod.def.shape,P={...b};if(u)for(const w in u){if(!(w in b))throw new Error(`Unrecognized key: "${w}"`);u[w]&&(P[w]=r?new r({type:"optional",innerType:b[w]}):b[w])}else for(const w in b)P[w]=r?new r({type:"optional",innerType:b[w]}):b[w];return Ud(this,"shape",P),P},checks:[]});return yh(a,m)}function tk(r,a,u){const m=Vd(a._zod.def,{get shape(){const b=a._zod.def.shape,P={...b};if(u)for(const w in u){if(!(w in P))throw new Error(`Unrecognized key: "${w}"`);u[w]&&(P[w]=new r({type:"nonoptional",innerType:b[w]}))}else for(const w in b)P[w]=new r({type:"nonoptional",innerType:b[w]});return Ud(this,"shape",P),P},checks:[]});return yh(a,m)}function kf(r,a=0){var u;if(r.aborted===!0)return!0;for(let m=a;m<r.issues.length;m++)if(((u=r.issues[m])==null?void 0:u.continue)!==!0)return!0;return!1}function u1(r,a){return a.map(u=>{var m;return(m=u).path??(m.path=[]),u.path.unshift(r),u})}function mg(r){return typeof r=="string"?r:r==null?void 0:r.message}function Nd(r,a,u){var b,P,w,l,L,N;const m={...r,path:r.path??[]};if(!r.message){const Z=mg((w=(P=(b=r.inst)==null?void 0:b._zod.def)==null?void 0:P.error)==null?void 0:w.call(P,r))??mg((l=a==null?void 0:a.error)==null?void 0:l.call(a,r))??mg((L=u.customError)==null?void 0:L.call(u,r))??mg((N=u.localeError)==null?void 0:N.call(u,r))??"Invalid input";m.message=Z}return delete m.inst,delete m.continue,a!=null&&a.reportInput||delete m.input,m}function iv(r){return Array.isArray(r)?"array":typeof r=="string"?"string":"unknown"}function am(...r){const[a,u,m]=r;return typeof a=="string"?{message:a,code:"custom",input:u,inst:m}:{...a}}const h1=(r,a)=>{r.name="$ZodError",Object.defineProperty(r,"_zod",{value:r._zod,enumerable:!1}),Object.defineProperty(r,"issues",{value:a,enumerable:!1}),r.message=JSON.stringify(a,w_,2),Object.defineProperty(r,"toString",{value:()=>r.message,enumerable:!1})},sv=pt("$ZodError",h1),Yg=pt("$ZodError",h1,{Parent:Error});function rk(r,a=u=>u.message){const u={},m=[];for(const b of r.issues)b.path.length>0?(u[b.path[0]]=u[b.path[0]]||[],u[b.path[0]].push(a(b))):m.push(a(b));return{formErrors:m,fieldErrors:u}}function nk(r,a){const u=a||function(P){return P.message},m={_errors:[]},b=P=>{for(const w of P.issues)if(w.code==="invalid_union"&&w.errors.length)w.errors.map(l=>b({issues:l}));else if(w.code==="invalid_key")b({issues:w.issues});else if(w.code==="invalid_element")b({issues:w.issues});else if(w.path.length===0)m._errors.push(u(w));else{let l=m,L=0;for(;L<w.path.length;){const N=w.path[L];L===w.path.length-1?(l[N]=l[N]||{_errors:[]},l[N]._errors.push(u(w))):l[N]=l[N]||{_errors:[]},l=l[N],L++}}};return b(r),m}const Qg=r=>(a,u,m,b)=>{const P=m?Object.assign(m,{async:!1}):{async:!1},w=a._zod.run({value:u,issues:[]},P);if(w instanceof Promise)throw new Ef;if(w.issues.length){const l=new((b==null?void 0:b.Err)??r)(w.issues.map(L=>Nd(L,P,jd())));throw l1(l,b==null?void 0:b.callee),l}return w.value},ik=Qg(Yg),Jg=r=>async(a,u,m,b)=>{const P=m?Object.assign(m,{async:!0}):{async:!0};let w=a._zod.run({value:u,issues:[]},P);if(w instanceof Promise&&(w=await w),w.issues.length){const l=new((b==null?void 0:b.Err)??r)(w.issues.map(L=>Nd(L,P,jd())));throw l1(l,b==null?void 0:b.callee),l}return w.value},sk=Jg(Yg),ey=r=>(a,u,m)=>{const b=m?{...m,async:!1}:{async:!1},P=a._zod.run({value:u,issues:[]},b);if(P instanceof Promise)throw new Ef;return P.issues.length?{success:!1,error:new(r??sv)(P.issues.map(w=>Nd(w,b,jd())))}:{success:!0,data:P.value}},ak=ey(Yg),ty=r=>async(a,u,m)=>{const b=m?Object.assign(m,{async:!0}):{async:!0};let P=a._zod.run({value:u,issues:[]},b);return P instanceof Promise&&(P=await P),P.issues.length?{success:!1,error:new r(P.issues.map(w=>Nd(w,b,jd())))}:{success:!0,data:P.value}},ok=ty(Yg),lk=r=>(a,u,m)=>{const b=m?Object.assign(m,{direction:"backward"}):{direction:"backward"};return Qg(r)(a,u,b)},ck=r=>(a,u,m)=>Qg(r)(a,u,m),uk=r=>async(a,u,m)=>{const b=m?Object.assign(m,{direction:"backward"}):{direction:"backward"};return Jg(r)(a,u,b)},hk=r=>async(a,u,m)=>Jg(r)(a,u,m),dk=r=>(a,u,m)=>{const b=m?Object.assign(m,{direction:"backward"}):{direction:"backward"};return ey(r)(a,u,b)},fk=r=>(a,u,m)=>ey(r)(a,u,m),pk=r=>async(a,u,m)=>{const b=m?Object.assign(m,{direction:"backward"}):{direction:"backward"};return ty(r)(a,u,b)},mk=r=>async(a,u,m)=>ty(r)(a,u,m),gk=/^[cC][^\s-]{8,}$/,yk=/^[0-9a-z]+$/,_k=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,vk=/^[0-9a-vA-V]{20}$/,xk=/^[A-Za-z0-9]{27}$/,bk=/^[a-zA-Z0-9_-]{21}$/,wk=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Sk=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,a0=r=>r?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${r}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Tk=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Pk="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Ck(){return new RegExp(Pk,"u")}const kk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ek=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Ik=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Mk=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ak=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,d1=/^[A-Za-z0-9_-]*$/,Rk=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,zk=/^\+(?:[0-9]){6,14}[0-9]$/,f1="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Dk=new RegExp(`^${f1}$`);function p1(r){const a="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof r.precision=="number"?r.precision===-1?`${a}`:r.precision===0?`${a}:[0-5]\\d`:`${a}:[0-5]\\d\\.\\d{${r.precision}}`:`${a}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Lk(r){return new RegExp(`^${p1(r)}$`)}function Fk(r){const a=p1({precision:r.precision}),u=["Z"];r.local&&u.push(""),r.offset&&u.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const m=`${a}(?:${u.join("|")})`;return new RegExp(`^${f1}T(?:${m})$`)}const Ok=r=>{const a=r?`[\\s\\S]{${(r==null?void 0:r.minimum)??0},${(r==null?void 0:r.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${a}$`)},jk=/^[^A-Z]*$/,Nk=/^[^a-z]*$/,uc=pt("$ZodCheck",(r,a)=>{var u;r._zod??(r._zod={}),r._zod.def=a,(u=r._zod).onattach??(u.onattach=[])}),Bk=pt("$ZodCheckMaxLength",(r,a)=>{var u;uc.init(r,a),(u=r._zod.def).when??(u.when=m=>{const b=m.value;return!rv(b)&&b.length!==void 0}),r._zod.onattach.push(m=>{const b=m._zod.bag.maximum??Number.POSITIVE_INFINITY;a.maximum<b&&(m._zod.bag.maximum=a.maximum)}),r._zod.check=m=>{const b=m.value;if(b.length<=a.maximum)return;const w=iv(b);m.issues.push({origin:w,code:"too_big",maximum:a.maximum,inclusive:!0,input:b,inst:r,continue:!a.abort})}}),$k=pt("$ZodCheckMinLength",(r,a)=>{var u;uc.init(r,a),(u=r._zod.def).when??(u.when=m=>{const b=m.value;return!rv(b)&&b.length!==void 0}),r._zod.onattach.push(m=>{const b=m._zod.bag.minimum??Number.NEGATIVE_INFINITY;a.minimum>b&&(m._zod.bag.minimum=a.minimum)}),r._zod.check=m=>{const b=m.value;if(b.length>=a.minimum)return;const w=iv(b);m.issues.push({origin:w,code:"too_small",minimum:a.minimum,inclusive:!0,input:b,inst:r,continue:!a.abort})}}),Uk=pt("$ZodCheckLengthEquals",(r,a)=>{var u;uc.init(r,a),(u=r._zod.def).when??(u.when=m=>{const b=m.value;return!rv(b)&&b.length!==void 0}),r._zod.onattach.push(m=>{const b=m._zod.bag;b.minimum=a.length,b.maximum=a.length,b.length=a.length}),r._zod.check=m=>{const b=m.value,P=b.length;if(P===a.length)return;const w=iv(b),l=P>a.length;m.issues.push({origin:w,...l?{code:"too_big",maximum:a.length}:{code:"too_small",minimum:a.length},inclusive:!0,exact:!0,input:m.value,inst:r,continue:!a.abort})}}),ry=pt("$ZodCheckStringFormat",(r,a)=>{var u,m;uc.init(r,a),r._zod.onattach.push(b=>{const P=b._zod.bag;P.format=a.format,a.pattern&&(P.patterns??(P.patterns=new Set),P.patterns.add(a.pattern))}),a.pattern?(u=r._zod).check??(u.check=b=>{a.pattern.lastIndex=0,!a.pattern.test(b.value)&&b.issues.push({origin:"string",code:"invalid_format",format:a.format,input:b.value,...a.pattern?{pattern:a.pattern.toString()}:{},inst:r,continue:!a.abort})}):(m=r._zod).check??(m.check=()=>{})}),Vk=pt("$ZodCheckRegex",(r,a)=>{ry.init(r,a),r._zod.check=u=>{a.pattern.lastIndex=0,!a.pattern.test(u.value)&&u.issues.push({origin:"string",code:"invalid_format",format:"regex",input:u.value,pattern:a.pattern.toString(),inst:r,continue:!a.abort})}}),Zk=pt("$ZodCheckLowerCase",(r,a)=>{a.pattern??(a.pattern=jk),ry.init(r,a)}),Gk=pt("$ZodCheckUpperCase",(r,a)=>{a.pattern??(a.pattern=Nk),ry.init(r,a)}),qk=pt("$ZodCheckIncludes",(r,a)=>{uc.init(r,a);const u=Xg(a.includes),m=new RegExp(typeof a.position=="number"?`^.{${a.position}}${u}`:u);a.pattern=m,r._zod.onattach.push(b=>{const P=b._zod.bag;P.patterns??(P.patterns=new Set),P.patterns.add(m)}),r._zod.check=b=>{b.value.includes(a.includes,a.position)||b.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:a.includes,input:b.value,inst:r,continue:!a.abort})}}),Wk=pt("$ZodCheckStartsWith",(r,a)=>{uc.init(r,a);const u=new RegExp(`^${Xg(a.prefix)}.*`);a.pattern??(a.pattern=u),r._zod.onattach.push(m=>{const b=m._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(u)}),r._zod.check=m=>{m.value.startsWith(a.prefix)||m.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:a.prefix,input:m.value,inst:r,continue:!a.abort})}}),Hk=pt("$ZodCheckEndsWith",(r,a)=>{uc.init(r,a);const u=new RegExp(`.*${Xg(a.suffix)}$`);a.pattern??(a.pattern=u),r._zod.onattach.push(m=>{const b=m._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(u)}),r._zod.check=m=>{m.value.endsWith(a.suffix)||m.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:a.suffix,input:m.value,inst:r,continue:!a.abort})}}),Kk=pt("$ZodCheckOverwrite",(r,a)=>{uc.init(r,a),r._zod.check=u=>{u.value=a.tx(u.value)}});class Xk{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if(typeof a=="function"){a(this,{execution:"sync"}),a(this,{execution:"async"});return}const m=a.split(`
`).filter(w=>w),b=Math.min(...m.map(w=>w.length-w.trimStart().length)),P=m.map(w=>w.slice(b)).map(w=>" ".repeat(this.indent*2)+w);for(const w of P)this.content.push(w)}compile(){const a=Function,u=this==null?void 0:this.args,b=[...((this==null?void 0:this.content)??[""]).map(P=>`  ${P}`)];return new a(...u,b.join(`
`))}}const Yk={major:4,minor:1,patch:11},Xi=pt("$ZodType",(r,a)=>{var b;var u;r??(r={}),r._zod.def=a,r._zod.bag=r._zod.bag||{},r._zod.version=Yk;const m=[...r._zod.def.checks??[]];r._zod.traits.has("$ZodCheck")&&m.unshift(r);for(const P of m)for(const w of P._zod.onattach)w(r);if(m.length===0)(u=r._zod).deferred??(u.deferred=[]),(b=r._zod.deferred)==null||b.push(()=>{r._zod.run=r._zod.parse});else{const P=(l,L,N)=>{let Z=kf(l),V;for(const ee of L){if(ee._zod.def.when){if(!ee._zod.def.when(l))continue}else if(Z)continue;const q=l.issues.length,_e=ee._zod.check(l);if(_e instanceof Promise&&(N==null?void 0:N.async)===!1)throw new Ef;if(V||_e instanceof Promise)V=(V??Promise.resolve()).then(async()=>{await _e,l.issues.length!==q&&(Z||(Z=kf(l,q)))});else{if(l.issues.length===q)continue;Z||(Z=kf(l,q))}}return V?V.then(()=>l):l},w=(l,L,N)=>{if(kf(l))return l.aborted=!0,l;const Z=P(L,m,N);if(Z instanceof Promise){if(N.async===!1)throw new Ef;return Z.then(V=>r._zod.parse(V,N))}return r._zod.parse(Z,N)};r._zod.run=(l,L)=>{if(L.skipChecks)return r._zod.parse(l,L);if(L.direction==="backward"){const Z=r._zod.parse({value:l.value,issues:[]},{...L,skipChecks:!0});return Z instanceof Promise?Z.then(V=>w(V,l,L)):w(Z,l,L)}const N=r._zod.parse(l,L);if(N instanceof Promise){if(L.async===!1)throw new Ef;return N.then(Z=>P(Z,m,L))}return P(N,m,L)}}r["~standard"]={validate:P=>{var w;try{const l=ak(r,P);return l.success?{value:l.data}:{issues:(w=l.error)==null?void 0:w.issues}}catch{return ok(r,P).then(L=>{var N;return L.success?{value:L.data}:{issues:(N=L.error)==null?void 0:N.issues}})}},vendor:"zod",version:1}}),av=pt("$ZodString",(r,a)=>{var u;Xi.init(r,a),r._zod.pattern=[...((u=r==null?void 0:r._zod.bag)==null?void 0:u.patterns)??[]].pop()??Ok(r._zod.bag),r._zod.parse=(m,b)=>{if(a.coerce)try{m.value=String(m.value)}catch{}return typeof m.value=="string"||m.issues.push({expected:"string",code:"invalid_type",input:m.value,inst:r}),m}}),Vn=pt("$ZodStringFormat",(r,a)=>{ry.init(r,a),av.init(r,a)}),Qk=pt("$ZodGUID",(r,a)=>{a.pattern??(a.pattern=Sk),Vn.init(r,a)}),Jk=pt("$ZodUUID",(r,a)=>{if(a.version){const m={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[a.version];if(m===void 0)throw new Error(`Invalid UUID version: "${a.version}"`);a.pattern??(a.pattern=a0(m))}else a.pattern??(a.pattern=a0());Vn.init(r,a)}),eE=pt("$ZodEmail",(r,a)=>{a.pattern??(a.pattern=Tk),Vn.init(r,a)}),tE=pt("$ZodURL",(r,a)=>{Vn.init(r,a),r._zod.check=u=>{try{const m=u.value.trim(),b=new URL(m);a.hostname&&(a.hostname.lastIndex=0,a.hostname.test(b.hostname)||u.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Rk.source,input:u.value,inst:r,continue:!a.abort})),a.protocol&&(a.protocol.lastIndex=0,a.protocol.test(b.protocol.endsWith(":")?b.protocol.slice(0,-1):b.protocol)||u.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:a.protocol.source,input:u.value,inst:r,continue:!a.abort})),a.normalize?u.value=b.href:u.value=m;return}catch{u.issues.push({code:"invalid_format",format:"url",input:u.value,inst:r,continue:!a.abort})}}}),rE=pt("$ZodEmoji",(r,a)=>{a.pattern??(a.pattern=Ck()),Vn.init(r,a)}),nE=pt("$ZodNanoID",(r,a)=>{a.pattern??(a.pattern=bk),Vn.init(r,a)}),iE=pt("$ZodCUID",(r,a)=>{a.pattern??(a.pattern=gk),Vn.init(r,a)}),sE=pt("$ZodCUID2",(r,a)=>{a.pattern??(a.pattern=yk),Vn.init(r,a)}),aE=pt("$ZodULID",(r,a)=>{a.pattern??(a.pattern=_k),Vn.init(r,a)}),oE=pt("$ZodXID",(r,a)=>{a.pattern??(a.pattern=vk),Vn.init(r,a)}),lE=pt("$ZodKSUID",(r,a)=>{a.pattern??(a.pattern=xk),Vn.init(r,a)}),cE=pt("$ZodISODateTime",(r,a)=>{a.pattern??(a.pattern=Fk(a)),Vn.init(r,a)}),uE=pt("$ZodISODate",(r,a)=>{a.pattern??(a.pattern=Dk),Vn.init(r,a)}),hE=pt("$ZodISOTime",(r,a)=>{a.pattern??(a.pattern=Lk(a)),Vn.init(r,a)}),dE=pt("$ZodISODuration",(r,a)=>{a.pattern??(a.pattern=wk),Vn.init(r,a)}),fE=pt("$ZodIPv4",(r,a)=>{a.pattern??(a.pattern=kk),Vn.init(r,a),r._zod.onattach.push(u=>{const m=u._zod.bag;m.format="ipv4"})}),pE=pt("$ZodIPv6",(r,a)=>{a.pattern??(a.pattern=Ek),Vn.init(r,a),r._zod.onattach.push(u=>{const m=u._zod.bag;m.format="ipv6"}),r._zod.check=u=>{try{new URL(`http://[${u.value}]`)}catch{u.issues.push({code:"invalid_format",format:"ipv6",input:u.value,inst:r,continue:!a.abort})}}}),mE=pt("$ZodCIDRv4",(r,a)=>{a.pattern??(a.pattern=Ik),Vn.init(r,a)}),gE=pt("$ZodCIDRv6",(r,a)=>{a.pattern??(a.pattern=Mk),Vn.init(r,a),r._zod.check=u=>{const m=u.value.split("/");try{if(m.length!==2)throw new Error;const[b,P]=m;if(!P)throw new Error;const w=Number(P);if(`${w}`!==P)throw new Error;if(w<0||w>128)throw new Error;new URL(`http://[${b}]`)}catch{u.issues.push({code:"invalid_format",format:"cidrv6",input:u.value,inst:r,continue:!a.abort})}}});function m1(r){if(r==="")return!0;if(r.length%4!==0)return!1;try{return atob(r),!0}catch{return!1}}const yE=pt("$ZodBase64",(r,a)=>{a.pattern??(a.pattern=Ak),Vn.init(r,a),r._zod.onattach.push(u=>{u._zod.bag.contentEncoding="base64"}),r._zod.check=u=>{m1(u.value)||u.issues.push({code:"invalid_format",format:"base64",input:u.value,inst:r,continue:!a.abort})}});function _E(r){if(!d1.test(r))return!1;const a=r.replace(/[-_]/g,m=>m==="-"?"+":"/"),u=a.padEnd(Math.ceil(a.length/4)*4,"=");return m1(u)}const vE=pt("$ZodBase64URL",(r,a)=>{a.pattern??(a.pattern=d1),Vn.init(r,a),r._zod.onattach.push(u=>{u._zod.bag.contentEncoding="base64url"}),r._zod.check=u=>{_E(u.value)||u.issues.push({code:"invalid_format",format:"base64url",input:u.value,inst:r,continue:!a.abort})}}),xE=pt("$ZodE164",(r,a)=>{a.pattern??(a.pattern=zk),Vn.init(r,a)});function bE(r,a=null){try{const u=r.split(".");if(u.length!==3)return!1;const[m]=u;if(!m)return!1;const b=JSON.parse(atob(m));return!("typ"in b&&(b==null?void 0:b.typ)!=="JWT"||!b.alg||a&&(!("alg"in b)||b.alg!==a))}catch{return!1}}const wE=pt("$ZodJWT",(r,a)=>{Vn.init(r,a),r._zod.check=u=>{bE(u.value,a.alg)||u.issues.push({code:"invalid_format",format:"jwt",input:u.value,inst:r,continue:!a.abort})}}),SE=pt("$ZodUnknown",(r,a)=>{Xi.init(r,a),r._zod.parse=u=>u}),TE=pt("$ZodNever",(r,a)=>{Xi.init(r,a),r._zod.parse=(u,m)=>(u.issues.push({expected:"never",code:"invalid_type",input:u.value,inst:r}),u)});function o0(r,a,u){r.issues.length&&a.issues.push(...u1(u,r.issues)),a.value[u]=r.value}const PE=pt("$ZodArray",(r,a)=>{Xi.init(r,a),r._zod.parse=(u,m)=>{const b=u.value;if(!Array.isArray(b))return u.issues.push({expected:"array",code:"invalid_type",input:b,inst:r}),u;u.value=Array(b.length);const P=[];for(let w=0;w<b.length;w++){const l=b[w],L=a.element._zod.run({value:l,issues:[]},m);L instanceof Promise?P.push(L.then(N=>o0(N,u,w))):o0(L,u,w)}return P.length?Promise.all(P).then(()=>u):u}});function Og(r,a,u,m){r.issues.length&&a.issues.push(...u1(u,r.issues)),r.value===void 0?u in m&&(a.value[u]=void 0):a.value[u]=r.value}function g1(r){var m,b,P,w;const a=Object.keys(r.shape);for(const l of a)if(!((w=(P=(b=(m=r.shape)==null?void 0:m[l])==null?void 0:b._zod)==null?void 0:P.traits)!=null&&w.has("$ZodType")))throw new Error(`Invalid element at key "${l}": expected a Zod schema`);const u=HC(r.shape);return{...r,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(u)}}function y1(r,a,u,m,b,P){const w=[],l=b.keySet,L=b.catchall._zod,N=L.def.type;for(const Z of Object.keys(a)){if(l.has(Z))continue;if(N==="never"){w.push(Z);continue}const V=L.run({value:a[Z],issues:[]},m);V instanceof Promise?r.push(V.then(ee=>Og(ee,u,Z,a))):Og(V,u,Z,a)}return w.length&&u.issues.push({code:"unrecognized_keys",keys:w,input:a,inst:P}),r.length?Promise.all(r).then(()=>u):u}const CE=pt("$ZodObject",(r,a)=>{Xi.init(r,a);const u=Object.getOwnPropertyDescriptor(a,"shape");if(!(u!=null&&u.get)){const l=a.shape;Object.defineProperty(a,"shape",{get:()=>{const L={...l};return Object.defineProperty(a,"shape",{value:L}),L}})}const m=tv(()=>g1(a));An(r._zod,"propValues",()=>{const l=a.shape,L={};for(const N in l){const Z=l[N]._zod;if(Z.values){L[N]??(L[N]=new Set);for(const V of Z.values)L[N].add(V)}}return L});const b=Fg,P=a.catchall;let w;r._zod.parse=(l,L)=>{w??(w=m.value);const N=l.value;if(!b(N))return l.issues.push({expected:"object",code:"invalid_type",input:N,inst:r}),l;l.value={};const Z=[],V=w.shape;for(const ee of w.keys){const _e=V[ee]._zod.run({value:N[ee],issues:[]},L);_e instanceof Promise?Z.push(_e.then(fe=>Og(fe,l,ee,N))):Og(_e,l,ee,N)}return P?y1(Z,N,l,L,m.value,r):Z.length?Promise.all(Z).then(()=>l):l}}),kE=pt("$ZodObjectJIT",(r,a)=>{CE.init(r,a);const u=r._zod.parse,m=tv(()=>g1(a)),b=ee=>{const q=new Xk(["shape","payload","ctx"]),_e=m.value,fe=Se=>{const De=s0(Se);return`shape[${De}]._zod.run({ value: input[${De}], issues: [] }, ctx)`};q.write("const input = payload.value;");const Pe=Object.create(null);let Le=0;for(const Se of _e.keys)Pe[Se]=`key_${Le++}`;q.write("const newResult = {};");for(const Se of _e.keys){const De=Pe[Se],Ye=s0(Se);q.write(`const ${De} = ${fe(Se)};`),q.write(`
        if (${De}.issues.length) {
          payload.issues = payload.issues.concat(${De}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Ye}, ...iss.path] : [${Ye}]
          })));
        }
        
        
        if (${De}.value === undefined) {
          if (${Ye} in input) {
            newResult[${Ye}] = undefined;
          }
        } else {
          newResult[${Ye}] = ${De}.value;
        }
        
      `)}q.write("payload.value = newResult;"),q.write("return payload;");const Me=q.compile();return(Se,De)=>Me(ee,Se,De)};let P;const w=Fg,l=!o1.jitless,N=l&&qC.value,Z=a.catchall;let V;r._zod.parse=(ee,q)=>{V??(V=m.value);const _e=ee.value;return w(_e)?l&&N&&(q==null?void 0:q.async)===!1&&q.jitless!==!0?(P||(P=b(a.shape)),ee=P(ee,q),Z?y1([],_e,ee,q,V,r):ee):u(ee,q):(ee.issues.push({expected:"object",code:"invalid_type",input:_e,inst:r}),ee)}});function l0(r,a,u,m){for(const P of r)if(P.issues.length===0)return a.value=P.value,a;const b=r.filter(P=>!kf(P));return b.length===1?(a.value=b[0].value,b[0]):(a.issues.push({code:"invalid_union",input:a.value,inst:u,errors:r.map(P=>P.issues.map(w=>Nd(w,m,jd())))}),a)}const EE=pt("$ZodUnion",(r,a)=>{Xi.init(r,a),An(r._zod,"optin",()=>a.options.some(b=>b._zod.optin==="optional")?"optional":void 0),An(r._zod,"optout",()=>a.options.some(b=>b._zod.optout==="optional")?"optional":void 0),An(r._zod,"values",()=>{if(a.options.every(b=>b._zod.values))return new Set(a.options.flatMap(b=>Array.from(b._zod.values)))}),An(r._zod,"pattern",()=>{if(a.options.every(b=>b._zod.pattern)){const b=a.options.map(P=>P._zod.pattern);return new RegExp(`^(${b.map(P=>nv(P.source)).join("|")})$`)}});const u=a.options.length===1,m=a.options[0]._zod.run;r._zod.parse=(b,P)=>{if(u)return m(b,P);let w=!1;const l=[];for(const L of a.options){const N=L._zod.run({value:b.value,issues:[]},P);if(N instanceof Promise)l.push(N),w=!0;else{if(N.issues.length===0)return N;l.push(N)}}return w?Promise.all(l).then(L=>l0(L,b,r,P)):l0(l,b,r,P)}}),IE=pt("$ZodIntersection",(r,a)=>{Xi.init(r,a),r._zod.parse=(u,m)=>{const b=u.value,P=a.left._zod.run({value:b,issues:[]},m),w=a.right._zod.run({value:b,issues:[]},m);return P instanceof Promise||w instanceof Promise?Promise.all([P,w]).then(([L,N])=>c0(u,L,N)):c0(u,P,w)}});function S_(r,a){if(r===a)return{valid:!0,data:r};if(r instanceof Date&&a instanceof Date&&+r==+a)return{valid:!0,data:r};if(sm(r)&&sm(a)){const u=Object.keys(a),m=Object.keys(r).filter(P=>u.indexOf(P)!==-1),b={...r,...a};for(const P of m){const w=S_(r[P],a[P]);if(!w.valid)return{valid:!1,mergeErrorPath:[P,...w.mergeErrorPath]};b[P]=w.data}return{valid:!0,data:b}}if(Array.isArray(r)&&Array.isArray(a)){if(r.length!==a.length)return{valid:!1,mergeErrorPath:[]};const u=[];for(let m=0;m<r.length;m++){const b=r[m],P=a[m],w=S_(b,P);if(!w.valid)return{valid:!1,mergeErrorPath:[m,...w.mergeErrorPath]};u.push(w.data)}return{valid:!0,data:u}}return{valid:!1,mergeErrorPath:[]}}function c0(r,a,u){if(a.issues.length&&r.issues.push(...a.issues),u.issues.length&&r.issues.push(...u.issues),kf(r))return r;const m=S_(a.value,u.value);if(!m.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(m.mergeErrorPath)}`);return r.value=m.data,r}const ME=pt("$ZodEnum",(r,a)=>{Xi.init(r,a);const u=GC(a.entries),m=new Set(u);r._zod.values=m,r._zod.pattern=new RegExp(`^(${u.filter(b=>WC.has(typeof b)).map(b=>typeof b=="string"?Xg(b):b.toString()).join("|")})$`),r._zod.parse=(b,P)=>{const w=b.value;return m.has(w)||b.issues.push({code:"invalid_value",values:u,input:w,inst:r}),b}}),AE=pt("$ZodTransform",(r,a)=>{Xi.init(r,a),r._zod.parse=(u,m)=>{if(m.direction==="backward")throw new a1(r.constructor.name);const b=a.transform(u.value,u);if(m.async)return(b instanceof Promise?b:Promise.resolve(b)).then(w=>(u.value=w,u));if(b instanceof Promise)throw new Ef;return u.value=b,u}});function u0(r,a){return r.issues.length&&a===void 0?{issues:[],value:void 0}:r}const RE=pt("$ZodOptional",(r,a)=>{Xi.init(r,a),r._zod.optin="optional",r._zod.optout="optional",An(r._zod,"values",()=>a.innerType._zod.values?new Set([...a.innerType._zod.values,void 0]):void 0),An(r._zod,"pattern",()=>{const u=a.innerType._zod.pattern;return u?new RegExp(`^(${nv(u.source)})?$`):void 0}),r._zod.parse=(u,m)=>{if(a.innerType._zod.optin==="optional"){const b=a.innerType._zod.run(u,m);return b instanceof Promise?b.then(P=>u0(P,u.value)):u0(b,u.value)}return u.value===void 0?u:a.innerType._zod.run(u,m)}}),zE=pt("$ZodNullable",(r,a)=>{Xi.init(r,a),An(r._zod,"optin",()=>a.innerType._zod.optin),An(r._zod,"optout",()=>a.innerType._zod.optout),An(r._zod,"pattern",()=>{const u=a.innerType._zod.pattern;return u?new RegExp(`^(${nv(u.source)}|null)$`):void 0}),An(r._zod,"values",()=>a.innerType._zod.values?new Set([...a.innerType._zod.values,null]):void 0),r._zod.parse=(u,m)=>u.value===null?u:a.innerType._zod.run(u,m)}),DE=pt("$ZodDefault",(r,a)=>{Xi.init(r,a),r._zod.optin="optional",An(r._zod,"values",()=>a.innerType._zod.values),r._zod.parse=(u,m)=>{if(m.direction==="backward")return a.innerType._zod.run(u,m);if(u.value===void 0)return u.value=a.defaultValue,u;const b=a.innerType._zod.run(u,m);return b instanceof Promise?b.then(P=>h0(P,a)):h0(b,a)}});function h0(r,a){return r.value===void 0&&(r.value=a.defaultValue),r}const LE=pt("$ZodPrefault",(r,a)=>{Xi.init(r,a),r._zod.optin="optional",An(r._zod,"values",()=>a.innerType._zod.values),r._zod.parse=(u,m)=>(m.direction==="backward"||u.value===void 0&&(u.value=a.defaultValue),a.innerType._zod.run(u,m))}),FE=pt("$ZodNonOptional",(r,a)=>{Xi.init(r,a),An(r._zod,"values",()=>{const u=a.innerType._zod.values;return u?new Set([...u].filter(m=>m!==void 0)):void 0}),r._zod.parse=(u,m)=>{const b=a.innerType._zod.run(u,m);return b instanceof Promise?b.then(P=>d0(P,r)):d0(b,r)}});function d0(r,a){return!r.issues.length&&r.value===void 0&&r.issues.push({code:"invalid_type",expected:"nonoptional",input:r.value,inst:a}),r}const OE=pt("$ZodCatch",(r,a)=>{Xi.init(r,a),An(r._zod,"optin",()=>a.innerType._zod.optin),An(r._zod,"optout",()=>a.innerType._zod.optout),An(r._zod,"values",()=>a.innerType._zod.values),r._zod.parse=(u,m)=>{if(m.direction==="backward")return a.innerType._zod.run(u,m);const b=a.innerType._zod.run(u,m);return b instanceof Promise?b.then(P=>(u.value=P.value,P.issues.length&&(u.value=a.catchValue({...u,error:{issues:P.issues.map(w=>Nd(w,m,jd()))},input:u.value}),u.issues=[]),u)):(u.value=b.value,b.issues.length&&(u.value=a.catchValue({...u,error:{issues:b.issues.map(P=>Nd(P,m,jd()))},input:u.value}),u.issues=[]),u)}}),jE=pt("$ZodPipe",(r,a)=>{Xi.init(r,a),An(r._zod,"values",()=>a.in._zod.values),An(r._zod,"optin",()=>a.in._zod.optin),An(r._zod,"optout",()=>a.out._zod.optout),An(r._zod,"propValues",()=>a.in._zod.propValues),r._zod.parse=(u,m)=>{if(m.direction==="backward"){const P=a.out._zod.run(u,m);return P instanceof Promise?P.then(w=>gg(w,a.in,m)):gg(P,a.in,m)}const b=a.in._zod.run(u,m);return b instanceof Promise?b.then(P=>gg(P,a.out,m)):gg(b,a.out,m)}});function gg(r,a,u){return r.issues.length?(r.aborted=!0,r):a._zod.run({value:r.value,issues:r.issues},u)}const NE=pt("$ZodReadonly",(r,a)=>{Xi.init(r,a),An(r._zod,"propValues",()=>a.innerType._zod.propValues),An(r._zod,"values",()=>a.innerType._zod.values),An(r._zod,"optin",()=>a.innerType._zod.optin),An(r._zod,"optout",()=>a.innerType._zod.optout),r._zod.parse=(u,m)=>{if(m.direction==="backward")return a.innerType._zod.run(u,m);const b=a.innerType._zod.run(u,m);return b instanceof Promise?b.then(f0):f0(b)}});function f0(r){return r.value=Object.freeze(r.value),r}const BE=pt("$ZodCustom",(r,a)=>{uc.init(r,a),Xi.init(r,a),r._zod.parse=(u,m)=>u,r._zod.check=u=>{const m=u.value,b=a.fn(m);if(b instanceof Promise)return b.then(P=>p0(P,u,m,r));p0(b,u,m,r)}});function p0(r,a,u,m){if(!r){const b={code:"custom",input:u,inst:m,path:[...m._zod.def.path??[]],continue:!m._zod.def.abort};m._zod.def.params&&(b.params=m._zod.def.params),a.issues.push(am(b))}}class $E{constructor(){this._map=new WeakMap,this._idmap=new Map}add(a,...u){const m=u[0];if(this._map.set(a,m),m&&typeof m=="object"&&"id"in m){if(this._idmap.has(m.id))throw new Error(`ID ${m.id} already exists in the registry`);this._idmap.set(m.id,a)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(a){const u=this._map.get(a);return u&&typeof u=="object"&&"id"in u&&this._idmap.delete(u.id),this._map.delete(a),this}get(a){const u=a._zod.parent;if(u){const m={...this.get(u)??{}};delete m.id;const b={...m,...this._map.get(a)};return Object.keys(b).length?b:void 0}return this._map.get(a)}has(a){return this._map.has(a)}}function UE(){return new $E}const yg=UE();function VE(r,a){return new r({type:"string",...Rr(a)})}function ZE(r,a){return new r({type:"string",format:"email",check:"string_format",abort:!1,...Rr(a)})}function m0(r,a){return new r({type:"string",format:"guid",check:"string_format",abort:!1,...Rr(a)})}function GE(r,a){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,...Rr(a)})}function qE(r,a){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Rr(a)})}function WE(r,a){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Rr(a)})}function HE(r,a){return new r({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Rr(a)})}function KE(r,a){return new r({type:"string",format:"url",check:"string_format",abort:!1,...Rr(a)})}function XE(r,a){return new r({type:"string",format:"emoji",check:"string_format",abort:!1,...Rr(a)})}function YE(r,a){return new r({type:"string",format:"nanoid",check:"string_format",abort:!1,...Rr(a)})}function QE(r,a){return new r({type:"string",format:"cuid",check:"string_format",abort:!1,...Rr(a)})}function JE(r,a){return new r({type:"string",format:"cuid2",check:"string_format",abort:!1,...Rr(a)})}function eI(r,a){return new r({type:"string",format:"ulid",check:"string_format",abort:!1,...Rr(a)})}function tI(r,a){return new r({type:"string",format:"xid",check:"string_format",abort:!1,...Rr(a)})}function rI(r,a){return new r({type:"string",format:"ksuid",check:"string_format",abort:!1,...Rr(a)})}function nI(r,a){return new r({type:"string",format:"ipv4",check:"string_format",abort:!1,...Rr(a)})}function iI(r,a){return new r({type:"string",format:"ipv6",check:"string_format",abort:!1,...Rr(a)})}function sI(r,a){return new r({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Rr(a)})}function aI(r,a){return new r({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Rr(a)})}function oI(r,a){return new r({type:"string",format:"base64",check:"string_format",abort:!1,...Rr(a)})}function lI(r,a){return new r({type:"string",format:"base64url",check:"string_format",abort:!1,...Rr(a)})}function cI(r,a){return new r({type:"string",format:"e164",check:"string_format",abort:!1,...Rr(a)})}function uI(r,a){return new r({type:"string",format:"jwt",check:"string_format",abort:!1,...Rr(a)})}function hI(r,a){return new r({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Rr(a)})}function dI(r,a){return new r({type:"string",format:"date",check:"string_format",...Rr(a)})}function fI(r,a){return new r({type:"string",format:"time",check:"string_format",precision:null,...Rr(a)})}function pI(r,a){return new r({type:"string",format:"duration",check:"string_format",...Rr(a)})}function mI(r){return new r({type:"unknown"})}function gI(r,a){return new r({type:"never",...Rr(a)})}function _1(r,a){return new Bk({check:"max_length",...Rr(a),maximum:r})}function jg(r,a){return new $k({check:"min_length",...Rr(a),minimum:r})}function v1(r,a){return new Uk({check:"length_equals",...Rr(a),length:r})}function yI(r,a){return new Vk({check:"string_format",format:"regex",...Rr(a),pattern:r})}function _I(r){return new Zk({check:"string_format",format:"lowercase",...Rr(r)})}function vI(r){return new Gk({check:"string_format",format:"uppercase",...Rr(r)})}function xI(r,a){return new qk({check:"string_format",format:"includes",...Rr(a),includes:r})}function bI(r,a){return new Wk({check:"string_format",format:"starts_with",...Rr(a),prefix:r})}function wI(r,a){return new Hk({check:"string_format",format:"ends_with",...Rr(a),suffix:r})}function bm(r){return new Kk({check:"overwrite",tx:r})}function SI(r){return bm(a=>a.normalize(r))}function TI(){return bm(r=>r.trim())}function PI(){return bm(r=>r.toLowerCase())}function CI(){return bm(r=>r.toUpperCase())}function kI(r,a,u){return new r({type:"array",element:a,...Rr(u)})}function EI(r,a,u){return new r({type:"custom",check:"custom",fn:a,...Rr(u)})}function II(r){const a=MI(u=>(u.addIssue=m=>{if(typeof m=="string")u.issues.push(am(m,u.value,a._zod.def));else{const b=m;b.fatal&&(b.continue=!1),b.code??(b.code="custom"),b.input??(b.input=u.value),b.inst??(b.inst=a),b.continue??(b.continue=!a._zod.def.abort),u.issues.push(am(b))}},r(u.value,u)));return a}function MI(r,a){const u=new uc({check:"custom",...Rr(a)});return u._zod.check=r,u}const AI=pt("ZodISODateTime",(r,a)=>{cE.init(r,a),ti.init(r,a)});function RI(r){return hI(AI,r)}const zI=pt("ZodISODate",(r,a)=>{uE.init(r,a),ti.init(r,a)});function DI(r){return dI(zI,r)}const LI=pt("ZodISOTime",(r,a)=>{hE.init(r,a),ti.init(r,a)});function FI(r){return fI(LI,r)}const OI=pt("ZodISODuration",(r,a)=>{dE.init(r,a),ti.init(r,a)});function jI(r){return pI(OI,r)}const NI=(r,a)=>{sv.init(r,a),r.name="ZodError",Object.defineProperties(r,{format:{value:u=>nk(r,u)},flatten:{value:u=>rk(r,u)},addIssue:{value:u=>{r.issues.push(u),r.message=JSON.stringify(r.issues,w_,2)}},addIssues:{value:u=>{r.issues.push(...u),r.message=JSON.stringify(r.issues,w_,2)}},isEmpty:{get(){return r.issues.length===0}}})},jo=pt("ZodError",NI,{Parent:Error}),BI=Qg(jo),$I=Jg(jo),UI=ey(jo),VI=ty(jo),ZI=lk(jo),GI=ck(jo),qI=uk(jo),WI=hk(jo),HI=dk(jo),KI=fk(jo),XI=pk(jo),YI=mk(jo),hs=pt("ZodType",(r,a)=>(Xi.init(r,a),r.def=a,r.type=a.type,Object.defineProperty(r,"_def",{value:a}),r.check=(...u)=>r.clone(Vd(a,{checks:[...a.checks??[],...u.map(m=>typeof m=="function"?{_zod:{check:m,def:{check:"custom"},onattach:[]}}:m)]})),r.clone=(u,m)=>yh(r,u,m),r.brand=()=>r,r.register=((u,m)=>(u.add(r,m),r)),r.parse=(u,m)=>BI(r,u,m,{callee:r.parse}),r.safeParse=(u,m)=>UI(r,u,m),r.parseAsync=async(u,m)=>$I(r,u,m,{callee:r.parseAsync}),r.safeParseAsync=async(u,m)=>VI(r,u,m),r.spa=r.safeParseAsync,r.encode=(u,m)=>ZI(r,u,m),r.decode=(u,m)=>GI(r,u,m),r.encodeAsync=async(u,m)=>qI(r,u,m),r.decodeAsync=async(u,m)=>WI(r,u,m),r.safeEncode=(u,m)=>HI(r,u,m),r.safeDecode=(u,m)=>KI(r,u,m),r.safeEncodeAsync=async(u,m)=>XI(r,u,m),r.safeDecodeAsync=async(u,m)=>YI(r,u,m),r.refine=(u,m)=>r.check($M(u,m)),r.superRefine=u=>r.check(UM(u)),r.overwrite=u=>r.check(bm(u)),r.optional=()=>_0(r),r.nullable=()=>v0(r),r.nullish=()=>_0(v0(r)),r.nonoptional=u=>DM(r,u),r.array=()=>xM(r),r.or=u=>SM([r,u]),r.and=u=>PM(r,u),r.transform=u=>x0(r,EM(u)),r.default=u=>AM(r,u),r.prefault=u=>zM(r,u),r.catch=u=>FM(r,u),r.pipe=u=>x0(r,u),r.readonly=()=>NM(r),r.describe=u=>{const m=r.clone();return yg.add(m,{description:u}),m},Object.defineProperty(r,"description",{get(){var u;return(u=yg.get(r))==null?void 0:u.description},configurable:!0}),r.meta=(...u)=>{if(u.length===0)return yg.get(r);const m=r.clone();return yg.add(m,u[0]),m},r.isOptional=()=>r.safeParse(void 0).success,r.isNullable=()=>r.safeParse(null).success,r)),x1=pt("_ZodString",(r,a)=>{av.init(r,a),hs.init(r,a);const u=r._zod.bag;r.format=u.format??null,r.minLength=u.minimum??null,r.maxLength=u.maximum??null,r.regex=(...m)=>r.check(yI(...m)),r.includes=(...m)=>r.check(xI(...m)),r.startsWith=(...m)=>r.check(bI(...m)),r.endsWith=(...m)=>r.check(wI(...m)),r.min=(...m)=>r.check(jg(...m)),r.max=(...m)=>r.check(_1(...m)),r.length=(...m)=>r.check(v1(...m)),r.nonempty=(...m)=>r.check(jg(1,...m)),r.lowercase=m=>r.check(_I(m)),r.uppercase=m=>r.check(vI(m)),r.trim=()=>r.check(TI()),r.normalize=(...m)=>r.check(SI(...m)),r.toLowerCase=()=>r.check(PI()),r.toUpperCase=()=>r.check(CI())}),QI=pt("ZodString",(r,a)=>{av.init(r,a),x1.init(r,a),r.email=u=>r.check(ZE(JI,u)),r.url=u=>r.check(KE(eM,u)),r.jwt=u=>r.check(uI(mM,u)),r.emoji=u=>r.check(XE(tM,u)),r.guid=u=>r.check(m0(g0,u)),r.uuid=u=>r.check(GE(_g,u)),r.uuidv4=u=>r.check(qE(_g,u)),r.uuidv6=u=>r.check(WE(_g,u)),r.uuidv7=u=>r.check(HE(_g,u)),r.nanoid=u=>r.check(YE(rM,u)),r.guid=u=>r.check(m0(g0,u)),r.cuid=u=>r.check(QE(nM,u)),r.cuid2=u=>r.check(JE(iM,u)),r.ulid=u=>r.check(eI(sM,u)),r.base64=u=>r.check(oI(dM,u)),r.base64url=u=>r.check(lI(fM,u)),r.xid=u=>r.check(tI(aM,u)),r.ksuid=u=>r.check(rI(oM,u)),r.ipv4=u=>r.check(nI(lM,u)),r.ipv6=u=>r.check(iI(cM,u)),r.cidrv4=u=>r.check(sI(uM,u)),r.cidrv6=u=>r.check(aI(hM,u)),r.e164=u=>r.check(cI(pM,u)),r.datetime=u=>r.check(RI(u)),r.date=u=>r.check(DI(u)),r.time=u=>r.check(FI(u)),r.duration=u=>r.check(jI(u))});function Xp(r){return VE(QI,r)}const ti=pt("ZodStringFormat",(r,a)=>{Vn.init(r,a),x1.init(r,a)}),JI=pt("ZodEmail",(r,a)=>{eE.init(r,a),ti.init(r,a)}),g0=pt("ZodGUID",(r,a)=>{Qk.init(r,a),ti.init(r,a)}),_g=pt("ZodUUID",(r,a)=>{Jk.init(r,a),ti.init(r,a)}),eM=pt("ZodURL",(r,a)=>{tE.init(r,a),ti.init(r,a)}),tM=pt("ZodEmoji",(r,a)=>{rE.init(r,a),ti.init(r,a)}),rM=pt("ZodNanoID",(r,a)=>{nE.init(r,a),ti.init(r,a)}),nM=pt("ZodCUID",(r,a)=>{iE.init(r,a),ti.init(r,a)}),iM=pt("ZodCUID2",(r,a)=>{sE.init(r,a),ti.init(r,a)}),sM=pt("ZodULID",(r,a)=>{aE.init(r,a),ti.init(r,a)}),aM=pt("ZodXID",(r,a)=>{oE.init(r,a),ti.init(r,a)}),oM=pt("ZodKSUID",(r,a)=>{lE.init(r,a),ti.init(r,a)}),lM=pt("ZodIPv4",(r,a)=>{fE.init(r,a),ti.init(r,a)}),cM=pt("ZodIPv6",(r,a)=>{pE.init(r,a),ti.init(r,a)}),uM=pt("ZodCIDRv4",(r,a)=>{mE.init(r,a),ti.init(r,a)}),hM=pt("ZodCIDRv6",(r,a)=>{gE.init(r,a),ti.init(r,a)}),dM=pt("ZodBase64",(r,a)=>{yE.init(r,a),ti.init(r,a)}),fM=pt("ZodBase64URL",(r,a)=>{vE.init(r,a),ti.init(r,a)}),pM=pt("ZodE164",(r,a)=>{xE.init(r,a),ti.init(r,a)}),mM=pt("ZodJWT",(r,a)=>{wE.init(r,a),ti.init(r,a)}),gM=pt("ZodUnknown",(r,a)=>{SE.init(r,a),hs.init(r,a)});function y0(){return mI(gM)}const yM=pt("ZodNever",(r,a)=>{TE.init(r,a),hs.init(r,a)});function _M(r){return gI(yM,r)}const vM=pt("ZodArray",(r,a)=>{PE.init(r,a),hs.init(r,a),r.element=a.element,r.min=(u,m)=>r.check(jg(u,m)),r.nonempty=u=>r.check(jg(1,u)),r.max=(u,m)=>r.check(_1(u,m)),r.length=(u,m)=>r.check(v1(u,m)),r.unwrap=()=>r.element});function xM(r,a){return kI(vM,r,a)}const bM=pt("ZodObject",(r,a)=>{kE.init(r,a),hs.init(r,a),An(r,"shape",()=>a.shape),r.keyof=()=>CM(Object.keys(r._zod.def.shape)),r.catchall=u=>r.clone({...r._zod.def,catchall:u}),r.passthrough=()=>r.clone({...r._zod.def,catchall:y0()}),r.loose=()=>r.clone({...r._zod.def,catchall:y0()}),r.strict=()=>r.clone({...r._zod.def,catchall:_M()}),r.strip=()=>r.clone({...r._zod.def,catchall:void 0}),r.extend=u=>YC(r,u),r.safeExtend=u=>QC(r,u),r.merge=u=>JC(r,u),r.pick=u=>KC(r,u),r.omit=u=>XC(r,u),r.partial=(...u)=>ek(w1,r,u[0]),r.required=(...u)=>tk(S1,r,u[0])});function b1(r,a){const u={type:"object",shape:r??{},...Rr(a)};return new bM(u)}const wM=pt("ZodUnion",(r,a)=>{EE.init(r,a),hs.init(r,a),r.options=a.options});function SM(r,a){return new wM({type:"union",options:r,...Rr(a)})}const TM=pt("ZodIntersection",(r,a)=>{IE.init(r,a),hs.init(r,a)});function PM(r,a){return new TM({type:"intersection",left:r,right:a})}const T_=pt("ZodEnum",(r,a)=>{ME.init(r,a),hs.init(r,a),r.enum=a.entries,r.options=Object.values(a.entries);const u=new Set(Object.keys(a.entries));r.extract=(m,b)=>{const P={};for(const w of m)if(u.has(w))P[w]=a.entries[w];else throw new Error(`Key ${w} not found in enum`);return new T_({...a,checks:[],...Rr(b),entries:P})},r.exclude=(m,b)=>{const P={...a.entries};for(const w of m)if(u.has(w))delete P[w];else throw new Error(`Key ${w} not found in enum`);return new T_({...a,checks:[],...Rr(b),entries:P})}});function CM(r,a){const u=Array.isArray(r)?Object.fromEntries(r.map(m=>[m,m])):r;return new T_({type:"enum",entries:u,...Rr(a)})}const kM=pt("ZodTransform",(r,a)=>{AE.init(r,a),hs.init(r,a),r._zod.parse=(u,m)=>{if(m.direction==="backward")throw new a1(r.constructor.name);u.addIssue=P=>{if(typeof P=="string")u.issues.push(am(P,u.value,a));else{const w=P;w.fatal&&(w.continue=!1),w.code??(w.code="custom"),w.input??(w.input=u.value),w.inst??(w.inst=r),u.issues.push(am(w))}};const b=a.transform(u.value,u);return b instanceof Promise?b.then(P=>(u.value=P,u)):(u.value=b,u)}});function EM(r){return new kM({type:"transform",transform:r})}const w1=pt("ZodOptional",(r,a)=>{RE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType});function _0(r){return new w1({type:"optional",innerType:r})}const IM=pt("ZodNullable",(r,a)=>{zE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType});function v0(r){return new IM({type:"nullable",innerType:r})}const MM=pt("ZodDefault",(r,a)=>{DE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType,r.removeDefault=r.unwrap});function AM(r,a){return new MM({type:"default",innerType:r,get defaultValue(){return typeof a=="function"?a():c1(a)}})}const RM=pt("ZodPrefault",(r,a)=>{LE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType});function zM(r,a){return new RM({type:"prefault",innerType:r,get defaultValue(){return typeof a=="function"?a():c1(a)}})}const S1=pt("ZodNonOptional",(r,a)=>{FE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType});function DM(r,a){return new S1({type:"nonoptional",innerType:r,...Rr(a)})}const LM=pt("ZodCatch",(r,a)=>{OE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType,r.removeCatch=r.unwrap});function FM(r,a){return new LM({type:"catch",innerType:r,catchValue:typeof a=="function"?a:()=>a})}const OM=pt("ZodPipe",(r,a)=>{jE.init(r,a),hs.init(r,a),r.in=a.in,r.out=a.out});function x0(r,a){return new OM({type:"pipe",in:r,out:a})}const jM=pt("ZodReadonly",(r,a)=>{NE.init(r,a),hs.init(r,a),r.unwrap=()=>r._zod.def.innerType});function NM(r){return new jM({type:"readonly",innerType:r})}const BM=pt("ZodCustom",(r,a)=>{BE.init(r,a),hs.init(r,a)});function $M(r,a={}){return EI(BM,r,a)}function UM(r){return II(r)}const b0=(r,a,u)=>{if(r&&"reportValidity"in r){const m=Jt(u,a);r.setCustomValidity(m&&m.message||""),r.reportValidity()}},P_=(r,a)=>{for(const u in a.fields){const m=a.fields[u];m&&m.ref&&"reportValidity"in m.ref?b0(m.ref,u,r):m&&m.refs&&m.refs.forEach(b=>b0(b,u,r))}},w0=(r,a)=>{a.shouldUseNativeValidation&&P_(r,a);const u={};for(const m in r){const b=Jt(a.fields,m),P=Object.assign(r[m]||{},{ref:b&&b.ref});if(VM(a.names||Object.keys(r),m)){const w=Object.assign({},Jt(u,m));Pn(w,"root",P),Pn(u,m,w)}else Pn(u,m,P)}return u},VM=(r,a)=>{const u=S0(a);return r.some(m=>S0(m).match(`^${u}\\.\\d+`))};function S0(r){return r.replace(/\]|\[/g,"")}function T0(r,a){try{var u=r()}catch(m){return a(m)}return u&&u.then?u.then(void 0,a):u}function ZM(r,a){for(var u={};r.length;){var m=r[0],b=m.code,P=m.message,w=m.path.join(".");if(!u[w])if("unionErrors"in m){var l=m.unionErrors[0].errors[0];u[w]={message:l.message,type:l.code}}else u[w]={message:P,type:b};if("unionErrors"in m&&m.unionErrors.forEach(function(Z){return Z.errors.forEach(function(V){return r.push(V)})}),a){var L=u[w].types,N=L&&L[m.code];u[w]=Q_(w,a,u,b,N?[].concat(N,m.message):m.message)}r.shift()}return u}function GM(r,a){for(var u={};r.length;){var m=r[0],b=m.code,P=m.message,w=m.path.join(".");if(!u[w])if(m.code==="invalid_union"&&m.errors.length>0){var l=m.errors[0][0];u[w]={message:l.message,type:l.code}}else u[w]={message:P,type:b};if(m.code==="invalid_union"&&m.errors.forEach(function(Z){return Z.forEach(function(V){return r.push(V)})}),a){var L=u[w].types,N=L&&L[m.code];u[w]=Q_(w,a,u,b,N?[].concat(N,m.message):m.message)}r.shift()}return u}function T1(r,a,u){if(u===void 0&&(u={}),(function(m){return"_def"in m&&typeof m._def=="object"&&"typeName"in m._def})(r))return function(m,b,P){try{return Promise.resolve(T0(function(){return Promise.resolve(r[u.mode==="sync"?"parse":"parseAsync"](m,a)).then(function(w){return P.shouldUseNativeValidation&&P_({},P),{errors:{},values:u.raw?Object.assign({},m):w}})},function(w){if((function(l){return Array.isArray(l==null?void 0:l.issues)})(w))return{values:{},errors:w0(ZM(w.errors,!P.shouldUseNativeValidation&&P.criteriaMode==="all"),P)};throw w}))}catch(w){return Promise.reject(w)}};if((function(m){return"_zod"in m&&typeof m._zod=="object"})(r))return function(m,b,P){try{return Promise.resolve(T0(function(){return Promise.resolve((u.mode==="sync"?ik:sk)(r,m,a)).then(function(w){return P.shouldUseNativeValidation&&P_({},P),{errors:{},values:u.raw?Object.assign({},m):w}})},function(w){if((function(l){return l instanceof sv})(w))return{values:{},errors:w0(GM(w.issues,!P.shouldUseNativeValidation&&P.criteriaMode==="all"),P)};throw w}))}catch(w){return Promise.reject(w)}};throw new Error("Invalid input: not a Zod schema")}function qM(){var ee,q;const{t:r}=Ea(),{setToken:a}=cc(),u=Bd(),b=((q=(ee=Oo().state)==null?void 0:ee.from)==null?void 0:q.pathname)||"/",P=te.useMemo(()=>b1({email:Xp().email(r("auth.invalidEmail")),password:Xp().min(8,r("auth.passwordTooShort"))}),[r]),{register:w,handleSubmit:l,formState:{errors:L,isSubmitting:N},setError:Z}=s1({resolver:T1(P)});async function V(_e){try{const fe=await fetch("https://bada-backend.vercel.app/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!fe.ok){const Le=await fe.json().catch(()=>null),Me=(Le==null?void 0:Le.error)??fe.statusText;Z("root",{message:Me}),cu.error(Me);return}const Pe=await fe.json();a(Pe.token),cu.success(r("auth.signInSuccess")),u(b,{replace:!0})}catch(fe){const Pe=fe.message??r("auth.signInFailed");Z("root",{message:Pe}),cu.error(Pe)}}return Y.jsxs("main",{className:"max-w-md mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-2xl",children:r("auth.signInTitle")}),Y.jsxs("form",{onSubmit:l(V),className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"login-email",className:"block text-sm mb-1",children:r("auth.email")}),Y.jsx("input",{id:"login-email",type:"email",...w("email"),className:"w-full rounded-lg border border-border px-3 py-2"}),L.email&&Y.jsx("p",{className:"text-red-600 text-sm",children:L.email.message})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"login-password",className:"block text-sm mb-1",children:r("auth.password")}),Y.jsx("input",{id:"login-password",type:"password",...w("password"),className:"w-full rounded-lg border border-border px-3 py-2"}),L.password&&Y.jsx("p",{className:"text-red-600 text-sm",children:L.password.message})]}),L.root&&Y.jsx("p",{className:"text-red-600 text-sm",children:L.root.message}),Y.jsx("button",{type:"submit",disabled:N,className:"w-full rounded-lg bg-accent text-white py-2 hover:bg-accent/90 disabled:opacity-50",children:r(N?"auth.signInProgress":"auth.signIn")})]}),Y.jsxs("p",{className:"text-sm text-ink-muted",children:[r("auth.noAccount")," ",Y.jsx(ei,{to:"/register",className:"text-accent underline",children:r("auth.registerHere")})]})]})}function WM(){const{t:r}=Ea(),a=Bd(),u=te.useMemo(()=>b1({email:Xp().email(r("auth.invalidEmail")),password:Xp().min(8,r("auth.passwordTooShort")),confirmPassword:Xp()}).refine(N=>N.password===N.confirmPassword,{message:r("auth.passwordsMustMatch"),path:["confirmPassword"]}),[r]),{register:m,handleSubmit:b,formState:{errors:P,isSubmitting:w},setError:l}=s1({resolver:T1(u)});async function L(N){try{const Z=await fetch("https://bada-backend.vercel.app/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:N.email,password:N.password})});if(!Z.ok){const V=await Z.json().catch(()=>null),ee=(V==null?void 0:V.error)??Z.statusText;l("root",{message:ee}),cu.error(ee);return}cu.success(r("auth.registerSuccess")),a("/login",{replace:!0})}catch(Z){const V=Z.message??r("auth.registerFailed");l("root",{message:V}),cu.error(V)}}return Y.jsxs("main",{className:"max-w-md mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-2xl",children:r("auth.registerTitle")}),Y.jsxs("form",{onSubmit:b(L),className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"register-email",className:"block text-sm mb-1",children:r("auth.email")}),Y.jsx("input",{id:"register-email",type:"email",...m("email"),className:"w-full rounded-lg border border-border px-3 py-2"}),P.email&&Y.jsx("p",{className:"text-red-600 text-sm",children:P.email.message})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"register-password",className:"block text-sm mb-1",children:r("auth.password")}),Y.jsx("input",{id:"register-password",type:"password",...m("password"),className:"w-full rounded-lg border border-border px-3 py-2"}),P.password&&Y.jsx("p",{className:"text-red-600 text-sm",children:P.password.message})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"register-confirm-password",className:"block text-sm mb-1",children:r("auth.confirmPassword")}),Y.jsx("input",{id:"register-confirm-password",type:"password",...m("confirmPassword"),className:"w-full rounded-lg border border-border px-3 py-2"}),P.confirmPassword&&Y.jsx("p",{className:"text-red-600 text-sm",children:P.confirmPassword.message})]}),P.root&&Y.jsx("p",{className:"text-red-600 text-sm",children:P.root.message}),Y.jsx("button",{type:"submit",disabled:w,className:"w-full rounded-lg bg-accent text-white py-2 hover:bg-accent/90 disabled:opacity-50",children:r(w?"auth.registerProgress":"auth.register")})]}),Y.jsxs("p",{className:"text-sm text-ink-muted",children:[r("auth.alreadyHaveAccount")," ",Y.jsx(ei,{to:"/login",className:"text-accent underline",children:r("auth.signInHere")})]})]})}function HM(r){const a=KS({queries:(r??[]).map(m=>({queryKey:["beach",m],queryFn:()=>Lb(m),enabled:!!m,staleTime:3e5}))}),u=new Map;return a.forEach((m,b)=>{const P=r==null?void 0:r[b];P&&m.data&&u.set(P,m.data)}),{byId:u,isLoading:a.some(m=>m.isLoading),isError:a.some(m=>m.isError)}}function KM(){for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return te.useMemo(()=>m=>{a.forEach(b=>b(m))},a)}const ny=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Kf(r){const a=Object.prototype.toString.call(r);return a==="[object Window]"||a==="[object global]"}function ov(r){return"nodeType"in r}function Ia(r){var a,u;return r?Kf(r)?r:ov(r)&&(a=(u=r.ownerDocument)==null?void 0:u.defaultView)!=null?a:window:window}function lv(r){const{Document:a}=Ia(r);return r instanceof a}function wm(r){return Kf(r)?!1:r instanceof Ia(r).HTMLElement}function P1(r){return r instanceof Ia(r).SVGElement}function Xf(r){return r?Kf(r)?r.document:ov(r)?lv(r)?r:wm(r)||P1(r)?r.ownerDocument:document:document:document}const lc=ny?te.useLayoutEffect:te.useEffect;function cv(r){const a=te.useRef(r);return lc(()=>{a.current=r}),te.useCallback(function(){for(var u=arguments.length,m=new Array(u),b=0;b<u;b++)m[b]=arguments[b];return a.current==null?void 0:a.current(...m)},[])}function XM(){const r=te.useRef(null),a=te.useCallback((m,b)=>{r.current=setInterval(m,b)},[]),u=te.useCallback(()=>{r.current!==null&&(clearInterval(r.current),r.current=null)},[]);return[a,u]}function om(r,a){a===void 0&&(a=[r]);const u=te.useRef(r);return lc(()=>{u.current!==r&&(u.current=r)},a),u}function Sm(r,a){const u=te.useRef();return te.useMemo(()=>{const m=r(u.current);return u.current=m,m},[...a])}function Ng(r){const a=cv(r),u=te.useRef(null),m=te.useCallback(b=>{b!==u.current&&(a==null||a(b,u.current)),u.current=b},[]);return[u,m]}function C_(r){const a=te.useRef();return te.useEffect(()=>{a.current=r},[r]),a.current}let By={};function Tm(r,a){return te.useMemo(()=>{if(a)return a;const u=By[r]==null?0:By[r]+1;return By[r]=u,r+"-"+u},[r,a])}function C1(r){return function(a){for(var u=arguments.length,m=new Array(u>1?u-1:0),b=1;b<u;b++)m[b-1]=arguments[b];return m.reduce((P,w)=>{const l=Object.entries(w);for(const[L,N]of l){const Z=P[L];Z!=null&&(P[L]=Z+r*N)}return P},{...a})}}const If=C1(1),Bg=C1(-1);function YM(r){return"clientX"in r&&"clientY"in r}function uv(r){if(!r)return!1;const{KeyboardEvent:a}=Ia(r.target);return a&&r instanceof a}function QM(r){if(!r)return!1;const{TouchEvent:a}=Ia(r.target);return a&&r instanceof a}function k_(r){if(QM(r)){if(r.touches&&r.touches.length){const{clientX:a,clientY:u}=r.touches[0];return{x:a,y:u}}else if(r.changedTouches&&r.changedTouches.length){const{clientX:a,clientY:u}=r.changedTouches[0];return{x:a,y:u}}}return YM(r)?{x:r.clientX,y:r.clientY}:null}const lm=Object.freeze({Translate:{toString(r){if(!r)return;const{x:a,y:u}=r;return"translate3d("+(a?Math.round(a):0)+"px, "+(u?Math.round(u):0)+"px, 0)"}},Scale:{toString(r){if(!r)return;const{scaleX:a,scaleY:u}=r;return"scaleX("+a+") scaleY("+u+")"}},Transform:{toString(r){if(r)return[lm.Translate.toString(r),lm.Scale.toString(r)].join(" ")}},Transition:{toString(r){let{property:a,duration:u,easing:m}=r;return a+" "+u+"ms "+m}}}),P0="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function JM(r){return r.matches(P0)?r:r.querySelector(P0)}const eA={display:"none"};function tA(r){let{id:a,value:u}=r;return hn.createElement("div",{id:a,style:eA},u)}function rA(r){let{id:a,announcement:u,ariaLiveType:m="assertive"}=r;const b={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return hn.createElement("div",{id:a,style:b,role:"status","aria-live":m,"aria-atomic":!0},u)}function nA(){const[r,a]=te.useState("");return{announce:te.useCallback(m=>{m!=null&&a(m)},[]),announcement:r}}const k1=te.createContext(null);function iA(r){const a=te.useContext(k1);te.useEffect(()=>{if(!a)throw new Error("useDndMonitor must be used within a children of <DndContext>");return a(r)},[r,a])}function sA(){const[r]=te.useState(()=>new Set),a=te.useCallback(m=>(r.add(m),()=>r.delete(m)),[r]);return[te.useCallback(m=>{let{type:b,event:P}=m;r.forEach(w=>{var l;return(l=w[b])==null?void 0:l.call(w,P)})},[r]),a]}const aA={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},oA={onDragStart(r){let{active:a}=r;return"Picked up draggable item "+a.id+"."},onDragOver(r){let{active:a,over:u}=r;return u?"Draggable item "+a.id+" was moved over droppable area "+u.id+".":"Draggable item "+a.id+" is no longer over a droppable area."},onDragEnd(r){let{active:a,over:u}=r;return u?"Draggable item "+a.id+" was dropped over droppable area "+u.id:"Draggable item "+a.id+" was dropped."},onDragCancel(r){let{active:a}=r;return"Dragging was cancelled. Draggable item "+a.id+" was dropped."}};function lA(r){let{announcements:a=oA,container:u,hiddenTextDescribedById:m,screenReaderInstructions:b=aA}=r;const{announce:P,announcement:w}=nA(),l=Tm("DndLiveRegion"),[L,N]=te.useState(!1);if(te.useEffect(()=>{N(!0)},[]),iA(te.useMemo(()=>({onDragStart(V){let{active:ee}=V;P(a.onDragStart({active:ee}))},onDragMove(V){let{active:ee,over:q}=V;a.onDragMove&&P(a.onDragMove({active:ee,over:q}))},onDragOver(V){let{active:ee,over:q}=V;P(a.onDragOver({active:ee,over:q}))},onDragEnd(V){let{active:ee,over:q}=V;P(a.onDragEnd({active:ee,over:q}))},onDragCancel(V){let{active:ee,over:q}=V;P(a.onDragCancel({active:ee,over:q}))}}),[P,a])),!L)return null;const Z=hn.createElement(hn.Fragment,null,hn.createElement(tA,{id:m,value:b.draggable}),hn.createElement(rA,{id:l,announcement:w}));return u?Gp.createPortal(Z,u):Z}var Wi;(function(r){r.DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable"})(Wi||(Wi={}));function $g(){}function cA(r,a){return te.useMemo(()=>({sensor:r,options:a??{}}),[r,a])}function uA(){for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return te.useMemo(()=>[...a].filter(m=>m!=null),[...a])}const _l=Object.freeze({x:0,y:0});function hA(r,a){return Math.sqrt(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2))}function dA(r,a){let{data:{value:u}}=r,{data:{value:m}}=a;return u-m}function fA(r,a){let{data:{value:u}}=r,{data:{value:m}}=a;return m-u}function pA(r,a){if(!r||r.length===0)return null;const[u]=r;return u[a]}function C0(r,a,u){return a===void 0&&(a=r.left),u===void 0&&(u=r.top),{x:a+r.width*.5,y:u+r.height*.5}}const mA=r=>{let{collisionRect:a,droppableRects:u,droppableContainers:m}=r;const b=C0(a,a.left,a.top),P=[];for(const w of m){const{id:l}=w,L=u.get(l);if(L){const N=hA(C0(L),b);P.push({id:l,data:{droppableContainer:w,value:N}})}}return P.sort(dA)};function gA(r,a){const u=Math.max(a.top,r.top),m=Math.max(a.left,r.left),b=Math.min(a.left+a.width,r.left+r.width),P=Math.min(a.top+a.height,r.top+r.height),w=b-m,l=P-u;if(m<b&&u<P){const L=a.width*a.height,N=r.width*r.height,Z=w*l,V=Z/(L+N-Z);return Number(V.toFixed(4))}return 0}const yA=r=>{let{collisionRect:a,droppableRects:u,droppableContainers:m}=r;const b=[];for(const P of m){const{id:w}=P,l=u.get(w);if(l){const L=gA(l,a);L>0&&b.push({id:w,data:{droppableContainer:P,value:L}})}}return b.sort(fA)};function _A(r,a,u){return{...r,scaleX:a&&u?a.width/u.width:1,scaleY:a&&u?a.height/u.height:1}}function E1(r,a){return r&&a?{x:r.left-a.left,y:r.top-a.top}:_l}function vA(r){return function(u){for(var m=arguments.length,b=new Array(m>1?m-1:0),P=1;P<m;P++)b[P-1]=arguments[P];return b.reduce((w,l)=>({...w,top:w.top+r*l.y,bottom:w.bottom+r*l.y,left:w.left+r*l.x,right:w.right+r*l.x}),{...u})}}const xA=vA(1);function bA(r){if(r.startsWith("matrix3d(")){const a=r.slice(9,-1).split(/, /);return{x:+a[12],y:+a[13],scaleX:+a[0],scaleY:+a[5]}}else if(r.startsWith("matrix(")){const a=r.slice(7,-1).split(/, /);return{x:+a[4],y:+a[5],scaleX:+a[0],scaleY:+a[3]}}return null}function wA(r,a,u){const m=bA(a);if(!m)return r;const{scaleX:b,scaleY:P,x:w,y:l}=m,L=r.left-w-(1-b)*parseFloat(u),N=r.top-l-(1-P)*parseFloat(u.slice(u.indexOf(" ")+1)),Z=b?r.width/b:r.width,V=P?r.height/P:r.height;return{width:Z,height:V,top:N,right:L+Z,bottom:N+V,left:L}}const SA={ignoreTransform:!1};function Yf(r,a){a===void 0&&(a=SA);let u=r.getBoundingClientRect();if(a.ignoreTransform){const{transform:N,transformOrigin:Z}=Ia(r).getComputedStyle(r);N&&(u=wA(u,N,Z))}const{top:m,left:b,width:P,height:w,bottom:l,right:L}=u;return{top:m,left:b,width:P,height:w,bottom:l,right:L}}function k0(r){return Yf(r,{ignoreTransform:!0})}function TA(r){const a=r.innerWidth,u=r.innerHeight;return{top:0,left:0,right:a,bottom:u,width:a,height:u}}function PA(r,a){return a===void 0&&(a=Ia(r).getComputedStyle(r)),a.position==="fixed"}function CA(r,a){a===void 0&&(a=Ia(r).getComputedStyle(r));const u=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(b=>{const P=a[b];return typeof P=="string"?u.test(P):!1})}function hv(r,a){const u=[];function m(b){if(a!=null&&u.length>=a||!b)return u;if(lv(b)&&b.scrollingElement!=null&&!u.includes(b.scrollingElement))return u.push(b.scrollingElement),u;if(!wm(b)||P1(b)||u.includes(b))return u;const P=Ia(r).getComputedStyle(b);return b!==r&&CA(b,P)&&u.push(b),PA(b,P)?u:m(b.parentNode)}return r?m(r):u}function I1(r){const[a]=hv(r,1);return a??null}function $y(r){return!ny||!r?null:Kf(r)?r:ov(r)?lv(r)||r===Xf(r).scrollingElement?window:wm(r)?r:null:null}function M1(r){return Kf(r)?r.scrollX:r.scrollLeft}function A1(r){return Kf(r)?r.scrollY:r.scrollTop}function E_(r){return{x:M1(r),y:A1(r)}}var us;(function(r){r[r.Forward=1]="Forward",r[r.Backward=-1]="Backward"})(us||(us={}));function R1(r){return!ny||!r?!1:r===document.scrollingElement}function z1(r){const a={x:0,y:0},u=R1(r)?{height:window.innerHeight,width:window.innerWidth}:{height:r.clientHeight,width:r.clientWidth},m={x:r.scrollWidth-u.width,y:r.scrollHeight-u.height},b=r.scrollTop<=a.y,P=r.scrollLeft<=a.x,w=r.scrollTop>=m.y,l=r.scrollLeft>=m.x;return{isTop:b,isLeft:P,isBottom:w,isRight:l,maxScroll:m,minScroll:a}}const kA={x:.2,y:.2};function EA(r,a,u,m,b){let{top:P,left:w,right:l,bottom:L}=u;m===void 0&&(m=10),b===void 0&&(b=kA);const{isTop:N,isBottom:Z,isLeft:V,isRight:ee}=z1(r),q={x:0,y:0},_e={x:0,y:0},fe={height:a.height*b.y,width:a.width*b.x};return!N&&P<=a.top+fe.height?(q.y=us.Backward,_e.y=m*Math.abs((a.top+fe.height-P)/fe.height)):!Z&&L>=a.bottom-fe.height&&(q.y=us.Forward,_e.y=m*Math.abs((a.bottom-fe.height-L)/fe.height)),!ee&&l>=a.right-fe.width?(q.x=us.Forward,_e.x=m*Math.abs((a.right-fe.width-l)/fe.width)):!V&&w<=a.left+fe.width&&(q.x=us.Backward,_e.x=m*Math.abs((a.left+fe.width-w)/fe.width)),{direction:q,speed:_e}}function IA(r){if(r===document.scrollingElement){const{innerWidth:P,innerHeight:w}=window;return{top:0,left:0,right:P,bottom:w,width:P,height:w}}const{top:a,left:u,right:m,bottom:b}=r.getBoundingClientRect();return{top:a,left:u,right:m,bottom:b,width:r.clientWidth,height:r.clientHeight}}function D1(r){return r.reduce((a,u)=>If(a,E_(u)),_l)}function MA(r){return r.reduce((a,u)=>a+M1(u),0)}function AA(r){return r.reduce((a,u)=>a+A1(u),0)}function RA(r,a){if(a===void 0&&(a=Yf),!r)return;const{top:u,left:m,bottom:b,right:P}=a(r);I1(r)&&(b<=0||P<=0||u>=window.innerHeight||m>=window.innerWidth)&&r.scrollIntoView({block:"center",inline:"center"})}const zA=[["x",["left","right"],MA],["y",["top","bottom"],AA]];class dv{constructor(a,u){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const m=hv(u),b=D1(m);this.rect={...a},this.width=a.width,this.height=a.height;for(const[P,w,l]of zA)for(const L of w)Object.defineProperty(this,L,{get:()=>{const N=l(m),Z=b[P]-N;return this.rect[L]+Z},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Yp{constructor(a){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(u=>{var m;return(m=this.target)==null?void 0:m.removeEventListener(...u)})},this.target=a}add(a,u,m){var b;(b=this.target)==null||b.addEventListener(a,u,m),this.listeners.push([a,u,m])}}function DA(r){const{EventTarget:a}=Ia(r);return r instanceof a?r:Xf(r)}function Uy(r,a){const u=Math.abs(r.x),m=Math.abs(r.y);return typeof a=="number"?Math.sqrt(u**2+m**2)>a:"x"in a&&"y"in a?u>a.x&&m>a.y:"x"in a?u>a.x:"y"in a?m>a.y:!1}var Lo;(function(r){r.Click="click",r.DragStart="dragstart",r.Keydown="keydown",r.ContextMenu="contextmenu",r.Resize="resize",r.SelectionChange="selectionchange",r.VisibilityChange="visibilitychange"})(Lo||(Lo={}));function E0(r){r.preventDefault()}function LA(r){r.stopPropagation()}var mn;(function(r){r.Space="Space",r.Down="ArrowDown",r.Right="ArrowRight",r.Left="ArrowLeft",r.Up="ArrowUp",r.Esc="Escape",r.Enter="Enter",r.Tab="Tab"})(mn||(mn={}));const L1={start:[mn.Space,mn.Enter],cancel:[mn.Esc],end:[mn.Space,mn.Enter,mn.Tab]},FA=(r,a)=>{let{currentCoordinates:u}=a;switch(r.code){case mn.Right:return{...u,x:u.x+25};case mn.Left:return{...u,x:u.x-25};case mn.Down:return{...u,y:u.y+25};case mn.Up:return{...u,y:u.y-25}}};class F1{constructor(a){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=a;const{event:{target:u}}=a;this.props=a,this.listeners=new Yp(Xf(u)),this.windowListeners=new Yp(Ia(u)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Lo.Resize,this.handleCancel),this.windowListeners.add(Lo.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Lo.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:a,onStart:u}=this.props,m=a.node.current;m&&RA(m),u(_l)}handleKeyDown(a){if(uv(a)){const{active:u,context:m,options:b}=this.props,{keyboardCodes:P=L1,coordinateGetter:w=FA,scrollBehavior:l="smooth"}=b,{code:L}=a;if(P.end.includes(L)){this.handleEnd(a);return}if(P.cancel.includes(L)){this.handleCancel(a);return}const{collisionRect:N}=m.current,Z=N?{x:N.left,y:N.top}:_l;this.referenceCoordinates||(this.referenceCoordinates=Z);const V=w(a,{active:u,context:m.current,currentCoordinates:Z});if(V){const ee=Bg(V,Z),q={x:0,y:0},{scrollableAncestors:_e}=m.current;for(const fe of _e){const Pe=a.code,{isTop:Le,isRight:Me,isLeft:Se,isBottom:De,maxScroll:Ye,minScroll:ot}=z1(fe),lt=IA(fe),ut={x:Math.min(Pe===mn.Right?lt.right-lt.width/2:lt.right,Math.max(Pe===mn.Right?lt.left:lt.left+lt.width/2,V.x)),y:Math.min(Pe===mn.Down?lt.bottom-lt.height/2:lt.bottom,Math.max(Pe===mn.Down?lt.top:lt.top+lt.height/2,V.y))},Je=Pe===mn.Right&&!Me||Pe===mn.Left&&!Se,Ke=Pe===mn.Down&&!De||Pe===mn.Up&&!Le;if(Je&&ut.x!==V.x){const At=fe.scrollLeft+ee.x,Rt=Pe===mn.Right&&At<=Ye.x||Pe===mn.Left&&At>=ot.x;if(Rt&&!ee.y){fe.scrollTo({left:At,behavior:l});return}Rt?q.x=fe.scrollLeft-At:q.x=Pe===mn.Right?fe.scrollLeft-Ye.x:fe.scrollLeft-ot.x,q.x&&fe.scrollBy({left:-q.x,behavior:l});break}else if(Ke&&ut.y!==V.y){const At=fe.scrollTop+ee.y,Rt=Pe===mn.Down&&At<=Ye.y||Pe===mn.Up&&At>=ot.y;if(Rt&&!ee.x){fe.scrollTo({top:At,behavior:l});return}Rt?q.y=fe.scrollTop-At:q.y=Pe===mn.Down?fe.scrollTop-Ye.y:fe.scrollTop-ot.y,q.y&&fe.scrollBy({top:-q.y,behavior:l});break}}this.handleMove(a,If(Bg(V,this.referenceCoordinates),q))}}}handleMove(a,u){const{onMove:m}=this.props;a.preventDefault(),m(u)}handleEnd(a){const{onEnd:u}=this.props;a.preventDefault(),this.detach(),u()}handleCancel(a){const{onCancel:u}=this.props;a.preventDefault(),this.detach(),u()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}F1.activators=[{eventName:"onKeyDown",handler:(r,a,u)=>{let{keyboardCodes:m=L1,onActivation:b}=a,{active:P}=u;const{code:w}=r.nativeEvent;if(m.start.includes(w)){const l=P.activatorNode.current;return l&&r.target!==l?!1:(r.preventDefault(),b==null||b({event:r.nativeEvent}),!0)}return!1}}];function I0(r){return!!(r&&"distance"in r)}function M0(r){return!!(r&&"delay"in r)}class fv{constructor(a,u,m){var b;m===void 0&&(m=DA(a.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=a,this.events=u;const{event:P}=a,{target:w}=P;this.props=a,this.events=u,this.document=Xf(w),this.documentListeners=new Yp(this.document),this.listeners=new Yp(m),this.windowListeners=new Yp(Ia(w)),this.initialCoordinates=(b=k_(P))!=null?b:_l,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:a,props:{options:{activationConstraint:u,bypassActivationConstraint:m}}}=this;if(this.listeners.add(a.move.name,this.handleMove,{passive:!1}),this.listeners.add(a.end.name,this.handleEnd),a.cancel&&this.listeners.add(a.cancel.name,this.handleCancel),this.windowListeners.add(Lo.Resize,this.handleCancel),this.windowListeners.add(Lo.DragStart,E0),this.windowListeners.add(Lo.VisibilityChange,this.handleCancel),this.windowListeners.add(Lo.ContextMenu,E0),this.documentListeners.add(Lo.Keydown,this.handleKeydown),u){if(m!=null&&m({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(M0(u)){this.timeoutId=setTimeout(this.handleStart,u.delay),this.handlePending(u);return}if(I0(u)){this.handlePending(u);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(a,u){const{active:m,onPending:b}=this.props;b(m,a,this.initialCoordinates,u)}handleStart(){const{initialCoordinates:a}=this,{onStart:u}=this.props;a&&(this.activated=!0,this.documentListeners.add(Lo.Click,LA,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Lo.SelectionChange,this.removeTextSelection),u(a))}handleMove(a){var u;const{activated:m,initialCoordinates:b,props:P}=this,{onMove:w,options:{activationConstraint:l}}=P;if(!b)return;const L=(u=k_(a))!=null?u:_l,N=Bg(b,L);if(!m&&l){if(I0(l)){if(l.tolerance!=null&&Uy(N,l.tolerance))return this.handleCancel();if(Uy(N,l.distance))return this.handleStart()}if(M0(l)&&Uy(N,l.tolerance))return this.handleCancel();this.handlePending(l,N);return}a.cancelable&&a.preventDefault(),w(L)}handleEnd(){const{onAbort:a,onEnd:u}=this.props;this.detach(),this.activated||a(this.props.active),u()}handleCancel(){const{onAbort:a,onCancel:u}=this.props;this.detach(),this.activated||a(this.props.active),u()}handleKeydown(a){a.code===mn.Esc&&this.handleCancel()}removeTextSelection(){var a;(a=this.document.getSelection())==null||a.removeAllRanges()}}const OA={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class pv extends fv{constructor(a){const{event:u}=a,m=Xf(u.target);super(a,OA,m)}}pv.activators=[{eventName:"onPointerDown",handler:(r,a)=>{let{nativeEvent:u}=r,{onActivation:m}=a;return!u.isPrimary||u.button!==0?!1:(m==null||m({event:u}),!0)}}];const jA={move:{name:"mousemove"},end:{name:"mouseup"}};var I_;(function(r){r[r.RightClick=2]="RightClick"})(I_||(I_={}));class NA extends fv{constructor(a){super(a,jA,Xf(a.event.target))}}NA.activators=[{eventName:"onMouseDown",handler:(r,a)=>{let{nativeEvent:u}=r,{onActivation:m}=a;return u.button===I_.RightClick?!1:(m==null||m({event:u}),!0)}}];const Vy={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class BA extends fv{constructor(a){super(a,Vy)}static setup(){return window.addEventListener(Vy.move.name,a,{capture:!1,passive:!1}),function(){window.removeEventListener(Vy.move.name,a)};function a(){}}}BA.activators=[{eventName:"onTouchStart",handler:(r,a)=>{let{nativeEvent:u}=r,{onActivation:m}=a;const{touches:b}=u;return b.length>1?!1:(m==null||m({event:u}),!0)}}];var Qp;(function(r){r[r.Pointer=0]="Pointer",r[r.DraggableRect=1]="DraggableRect"})(Qp||(Qp={}));var Ug;(function(r){r[r.TreeOrder=0]="TreeOrder",r[r.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ug||(Ug={}));function $A(r){let{acceleration:a,activator:u=Qp.Pointer,canScroll:m,draggingRect:b,enabled:P,interval:w=5,order:l=Ug.TreeOrder,pointerCoordinates:L,scrollableAncestors:N,scrollableAncestorRects:Z,delta:V,threshold:ee}=r;const q=VA({delta:V,disabled:!P}),[_e,fe]=XM(),Pe=te.useRef({x:0,y:0}),Le=te.useRef({x:0,y:0}),Me=te.useMemo(()=>{switch(u){case Qp.Pointer:return L?{top:L.y,bottom:L.y,left:L.x,right:L.x}:null;case Qp.DraggableRect:return b}},[u,b,L]),Se=te.useRef(null),De=te.useCallback(()=>{const ot=Se.current;if(!ot)return;const lt=Pe.current.x*Le.current.x,ut=Pe.current.y*Le.current.y;ot.scrollBy(lt,ut)},[]),Ye=te.useMemo(()=>l===Ug.TreeOrder?[...N].reverse():N,[l,N]);te.useEffect(()=>{if(!P||!N.length||!Me){fe();return}for(const ot of Ye){if((m==null?void 0:m(ot))===!1)continue;const lt=N.indexOf(ot),ut=Z[lt];if(!ut)continue;const{direction:Je,speed:Ke}=EA(ot,ut,Me,a,ee);for(const At of["x","y"])q[At][Je[At]]||(Ke[At]=0,Je[At]=0);if(Ke.x>0||Ke.y>0){fe(),Se.current=ot,_e(De,w),Pe.current=Ke,Le.current=Je;return}}Pe.current={x:0,y:0},Le.current={x:0,y:0},fe()},[a,De,m,fe,P,w,JSON.stringify(Me),JSON.stringify(q),_e,N,Ye,Z,JSON.stringify(ee)])}const UA={x:{[us.Backward]:!1,[us.Forward]:!1},y:{[us.Backward]:!1,[us.Forward]:!1}};function VA(r){let{delta:a,disabled:u}=r;const m=C_(a);return Sm(b=>{if(u||!m||!b)return UA;const P={x:Math.sign(a.x-m.x),y:Math.sign(a.y-m.y)};return{x:{[us.Backward]:b.x[us.Backward]||P.x===-1,[us.Forward]:b.x[us.Forward]||P.x===1},y:{[us.Backward]:b.y[us.Backward]||P.y===-1,[us.Forward]:b.y[us.Forward]||P.y===1}}},[u,a,m])}function ZA(r,a){const u=a!=null?r.get(a):void 0,m=u?u.node.current:null;return Sm(b=>{var P;return a==null?null:(P=m??b)!=null?P:null},[m,a])}function GA(r,a){return te.useMemo(()=>r.reduce((u,m)=>{const{sensor:b}=m,P=b.activators.map(w=>({eventName:w.eventName,handler:a(w.handler,m)}));return[...u,...P]},[]),[r,a])}var cm;(function(r){r[r.Always=0]="Always",r[r.BeforeDragging=1]="BeforeDragging",r[r.WhileDragging=2]="WhileDragging"})(cm||(cm={}));var M_;(function(r){r.Optimized="optimized"})(M_||(M_={}));const A0=new Map;function qA(r,a){let{dragging:u,dependencies:m,config:b}=a;const[P,w]=te.useState(null),{frequency:l,measure:L,strategy:N}=b,Z=te.useRef(r),V=Pe(),ee=om(V),q=te.useCallback(function(Le){Le===void 0&&(Le=[]),!ee.current&&w(Me=>Me===null?Le:Me.concat(Le.filter(Se=>!Me.includes(Se))))},[ee]),_e=te.useRef(null),fe=Sm(Le=>{if(V&&!u)return A0;if(!Le||Le===A0||Z.current!==r||P!=null){const Me=new Map;for(let Se of r){if(!Se)continue;if(P&&P.length>0&&!P.includes(Se.id)&&Se.rect.current){Me.set(Se.id,Se.rect.current);continue}const De=Se.node.current,Ye=De?new dv(L(De),De):null;Se.rect.current=Ye,Ye&&Me.set(Se.id,Ye)}return Me}return Le},[r,P,u,V,L]);return te.useEffect(()=>{Z.current=r},[r]),te.useEffect(()=>{V||q()},[u,V]),te.useEffect(()=>{P&&P.length>0&&w(null)},[JSON.stringify(P)]),te.useEffect(()=>{V||typeof l!="number"||_e.current!==null||(_e.current=setTimeout(()=>{q(),_e.current=null},l))},[l,V,q,...m]),{droppableRects:fe,measureDroppableContainers:q,measuringScheduled:P!=null};function Pe(){switch(N){case cm.Always:return!1;case cm.BeforeDragging:return u;default:return!u}}}function O1(r,a){return Sm(u=>r?u||(typeof a=="function"?a(r):r):null,[a,r])}function WA(r,a){return O1(r,a)}function HA(r){let{callback:a,disabled:u}=r;const m=cv(a),b=te.useMemo(()=>{if(u||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:P}=window;return new P(m)},[m,u]);return te.useEffect(()=>()=>b==null?void 0:b.disconnect(),[b]),b}function iy(r){let{callback:a,disabled:u}=r;const m=cv(a),b=te.useMemo(()=>{if(u||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:P}=window;return new P(m)},[u]);return te.useEffect(()=>()=>b==null?void 0:b.disconnect(),[b]),b}function KA(r){return new dv(Yf(r),r)}function R0(r,a,u){a===void 0&&(a=KA);const[m,b]=te.useState(null);function P(){b(L=>{if(!r)return null;if(r.isConnected===!1){var N;return(N=L??u)!=null?N:null}const Z=a(r);return JSON.stringify(L)===JSON.stringify(Z)?L:Z})}const w=HA({callback(L){if(r)for(const N of L){const{type:Z,target:V}=N;if(Z==="childList"&&V instanceof HTMLElement&&V.contains(r)){P();break}}}}),l=iy({callback:P});return lc(()=>{P(),r?(l==null||l.observe(r),w==null||w.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),w==null||w.disconnect())},[r]),m}function XA(r){const a=O1(r);return E1(r,a)}const z0=[];function YA(r){const a=te.useRef(r),u=Sm(m=>r?m&&m!==z0&&r&&a.current&&r.parentNode===a.current.parentNode?m:hv(r):z0,[r]);return te.useEffect(()=>{a.current=r},[r]),u}function QA(r){const[a,u]=te.useState(null),m=te.useRef(r),b=te.useCallback(P=>{const w=$y(P.target);w&&u(l=>l?(l.set(w,E_(w)),new Map(l)):null)},[]);return te.useEffect(()=>{const P=m.current;if(r!==P){w(P);const l=r.map(L=>{const N=$y(L);return N?(N.addEventListener("scroll",b,{passive:!0}),[N,E_(N)]):null}).filter(L=>L!=null);u(l.length?new Map(l):null),m.current=r}return()=>{w(r),w(P)};function w(l){l.forEach(L=>{const N=$y(L);N==null||N.removeEventListener("scroll",b)})}},[b,r]),te.useMemo(()=>r.length?a?Array.from(a.values()).reduce((P,w)=>If(P,w),_l):D1(r):_l,[r,a])}function D0(r,a){a===void 0&&(a=[]);const u=te.useRef(null);return te.useEffect(()=>{u.current=null},a),te.useEffect(()=>{const m=r!==_l;m&&!u.current&&(u.current=r),!m&&u.current&&(u.current=null)},[r]),u.current?Bg(r,u.current):_l}function JA(r){te.useEffect(()=>{if(!ny)return;const a=r.map(u=>{let{sensor:m}=u;return m.setup==null?void 0:m.setup()});return()=>{for(const u of a)u==null||u()}},r.map(a=>{let{sensor:u}=a;return u}))}function eR(r,a){return te.useMemo(()=>r.reduce((u,m)=>{let{eventName:b,handler:P}=m;return u[b]=w=>{P(w,a)},u},{}),[r,a])}function j1(r){return te.useMemo(()=>r?TA(r):null,[r])}const L0=[];function tR(r,a){a===void 0&&(a=Yf);const[u]=r,m=j1(u?Ia(u):null),[b,P]=te.useState(L0);function w(){P(()=>r.length?r.map(L=>R1(L)?m:new dv(a(L),L)):L0)}const l=iy({callback:w});return lc(()=>{l==null||l.disconnect(),w(),r.forEach(L=>l==null?void 0:l.observe(L))},[r]),b}function rR(r){if(!r)return null;if(r.children.length>1)return r;const a=r.children[0];return wm(a)?a:r}function nR(r){let{measure:a}=r;const[u,m]=te.useState(null),b=te.useCallback(N=>{for(const{target:Z}of N)if(wm(Z)){m(V=>{const ee=a(Z);return V?{...V,width:ee.width,height:ee.height}:ee});break}},[a]),P=iy({callback:b}),w=te.useCallback(N=>{const Z=rR(N);P==null||P.disconnect(),Z&&(P==null||P.observe(Z)),m(Z?a(Z):null)},[a,P]),[l,L]=Ng(w);return te.useMemo(()=>({nodeRef:l,rect:u,setRef:L}),[u,l,L])}const iR=[{sensor:pv,options:{}},{sensor:F1,options:{}}],sR={current:{}},Cg={draggable:{measure:k0},droppable:{measure:k0,strategy:cm.WhileDragging,frequency:M_.Optimized},dragOverlay:{measure:Yf}};class Jp extends Map{get(a){var u;return a!=null&&(u=super.get(a))!=null?u:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(a=>{let{disabled:u}=a;return!u})}getNodeFor(a){var u,m;return(u=(m=this.get(a))==null?void 0:m.node.current)!=null?u:void 0}}const aR={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Jp,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:$g},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Cg,measureDroppableContainers:$g,windowRect:null,measuringScheduled:!1},oR={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:$g,draggableNodes:new Map,over:null,measureDroppableContainers:$g},sy=te.createContext(oR),N1=te.createContext(aR);function lR(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Jp}}}function cR(r,a){switch(a.type){case Wi.DragStart:return{...r,draggable:{...r.draggable,initialCoordinates:a.initialCoordinates,active:a.active}};case Wi.DragMove:return r.draggable.active==null?r:{...r,draggable:{...r.draggable,translate:{x:a.coordinates.x-r.draggable.initialCoordinates.x,y:a.coordinates.y-r.draggable.initialCoordinates.y}}};case Wi.DragEnd:case Wi.DragCancel:return{...r,draggable:{...r.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Wi.RegisterDroppable:{const{element:u}=a,{id:m}=u,b=new Jp(r.droppable.containers);return b.set(m,u),{...r,droppable:{...r.droppable,containers:b}}}case Wi.SetDroppableDisabled:{const{id:u,key:m,disabled:b}=a,P=r.droppable.containers.get(u);if(!P||m!==P.key)return r;const w=new Jp(r.droppable.containers);return w.set(u,{...P,disabled:b}),{...r,droppable:{...r.droppable,containers:w}}}case Wi.UnregisterDroppable:{const{id:u,key:m}=a,b=r.droppable.containers.get(u);if(!b||m!==b.key)return r;const P=new Jp(r.droppable.containers);return P.delete(u),{...r,droppable:{...r.droppable,containers:P}}}default:return r}}function uR(r){let{disabled:a}=r;const{active:u,activatorEvent:m,draggableNodes:b}=te.useContext(sy),P=C_(m),w=C_(u==null?void 0:u.id);return te.useEffect(()=>{if(!a&&!m&&P&&w!=null){if(!uv(P)||document.activeElement===P.target)return;const l=b.get(w);if(!l)return;const{activatorNode:L,node:N}=l;if(!L.current&&!N.current)return;requestAnimationFrame(()=>{for(const Z of[L.current,N.current]){if(!Z)continue;const V=JM(Z);if(V){V.focus();break}}})}},[m,a,b,w,P]),null}function hR(r,a){let{transform:u,...m}=a;return r!=null&&r.length?r.reduce((b,P)=>P({transform:b,...m}),u):u}function dR(r){return te.useMemo(()=>({draggable:{...Cg.draggable,...r==null?void 0:r.draggable},droppable:{...Cg.droppable,...r==null?void 0:r.droppable},dragOverlay:{...Cg.dragOverlay,...r==null?void 0:r.dragOverlay}}),[r==null?void 0:r.draggable,r==null?void 0:r.droppable,r==null?void 0:r.dragOverlay])}function fR(r){let{activeNode:a,measure:u,initialRect:m,config:b=!0}=r;const P=te.useRef(!1),{x:w,y:l}=typeof b=="boolean"?{x:b,y:b}:b;lc(()=>{if(!w&&!l||!a){P.current=!1;return}if(P.current||!m)return;const N=a==null?void 0:a.node.current;if(!N||N.isConnected===!1)return;const Z=u(N),V=E1(Z,m);if(w||(V.x=0),l||(V.y=0),P.current=!0,Math.abs(V.x)>0||Math.abs(V.y)>0){const ee=I1(N);ee&&ee.scrollBy({top:V.y,left:V.x})}},[a,w,l,m,u])}const B1=te.createContext({..._l,scaleX:1,scaleY:1});var th;(function(r){r[r.Uninitialized=0]="Uninitialized",r[r.Initializing=1]="Initializing",r[r.Initialized=2]="Initialized"})(th||(th={}));const pR=te.memo(function(a){var u,m,b,P;let{id:w,accessibility:l,autoScroll:L=!0,children:N,sensors:Z=iR,collisionDetection:V=yA,measuring:ee,modifiers:q,..._e}=a;const fe=te.useReducer(cR,void 0,lR),[Pe,Le]=fe,[Me,Se]=sA(),[De,Ye]=te.useState(th.Uninitialized),ot=De===th.Initialized,{draggable:{active:lt,nodes:ut,translate:Je},droppable:{containers:Ke}}=Pe,At=lt!=null?ut.get(lt):null,Rt=te.useRef({initial:null,translated:null}),Mt=te.useMemo(()=>{var Ce;return lt!=null?{id:lt,data:(Ce=At==null?void 0:At.data)!=null?Ce:sR,rect:Rt}:null},[lt,At]),Ht=te.useRef(null),[zr,or]=te.useState(null),[Zt,_t]=te.useState(null),ft=om(_e,Object.values(_e)),Ct=Tm("DndDescribedBy",w),Ie=te.useMemo(()=>Ke.getEnabled(),[Ke]),Qe=dR(ee),{droppableRects:jt,measureDroppableContainers:tr,measuringScheduled:fr}=qA(Ie,{dragging:ot,dependencies:[Je.x,Je.y],config:Qe.droppable}),Kt=ZA(ut,lt),Lr=te.useMemo(()=>Zt?k_(Zt):null,[Zt]),sr=zt(),yr=WA(Kt,Qe.draggable.measure);fR({activeNode:lt!=null?ut.get(lt):null,config:sr.layoutShiftCompensation,initialRect:yr,measure:Qe.draggable.measure});const lr=R0(Kt,Qe.draggable.measure,yr),ci=R0(Kt?Kt.parentElement:null),ln=te.useRef({activatorEvent:null,active:null,activeNode:Kt,collisionRect:null,collisions:null,droppableRects:jt,draggableNodes:ut,draggingNode:null,draggingNodeRect:null,droppableContainers:Ke,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Vr=Ke.getNodeFor((u=ln.current.over)==null?void 0:u.id),Nr=nR({measure:Qe.dragOverlay.measure}),Cn=(m=Nr.nodeRef.current)!=null?m:Kt,jn=ot?(b=Nr.rect)!=null?b:lr:null,Yi=!!(Nr.nodeRef.current&&Nr.rect),Ri=XA(Yi?null:lr),Zn=j1(Cn?Ia(Cn):null),xe=YA(ot?Vr??Kt:null),Be=tR(xe),Xe=hR(q,{transform:{x:Je.x-Ri.x,y:Je.y-Ri.y,scaleX:1,scaleY:1},activatorEvent:Zt,active:Mt,activeNodeRect:lr,containerNodeRect:ci,draggingNodeRect:jn,over:ln.current.over,overlayNodeRect:Nr.rect,scrollableAncestors:xe,scrollableAncestorRects:Be,windowRect:Zn}),Et=Lr?If(Lr,Je):null,vt=QA(xe),gt=D0(vt),Bt=D0(vt,[lr]),_r=If(Xe,gt),Sr=jn?xA(jn,Xe):null,Te=Mt&&Sr?V({active:Mt,collisionRect:Sr,droppableRects:jt,droppableContainers:Ie,pointerCoordinates:Et}):null,K=pA(Te,"id"),[X,ne]=te.useState(null),ue=Yi?Xe:If(Xe,Bt),ve=_A(ue,(P=X==null?void 0:X.rect)!=null?P:null,lr),Ae=te.useRef(null),Oe=te.useCallback((Ce,$t)=>{let{sensor:rr,options:Dt}=$t;if(Ht.current==null)return;const Xt=ut.get(Ht.current);if(!Xt)return;const Cr=Ce.nativeEvent,Kr=new rr({active:Ht.current,activeNode:Xt,event:Cr,options:Dt,context:ln,onAbort(Tr){if(!ut.get(Tr))return;const{onDragAbort:ar}=ft.current,en={id:Tr};ar==null||ar(en),Me({type:"onDragAbort",event:en})},onPending(Tr,cr,ar,en){if(!ut.get(Tr))return;const{onDragPending:_n}=ft.current,$r={id:Tr,constraint:cr,initialCoordinates:ar,offset:en};_n==null||_n($r),Me({type:"onDragPending",event:$r})},onStart(Tr){const cr=Ht.current;if(cr==null)return;const ar=ut.get(cr);if(!ar)return;const{onDragStart:en}=ft.current,st={activatorEvent:Cr,active:{id:cr,data:ar.data,rect:Rt}};Gp.unstable_batchedUpdates(()=>{en==null||en(st),Ye(th.Initializing),Le({type:Wi.DragStart,initialCoordinates:Tr,active:cr}),Me({type:"onDragStart",event:st}),or(Ae.current),_t(Cr)})},onMove(Tr){Le({type:Wi.DragMove,coordinates:Tr})},onEnd:dn(Wi.DragEnd),onCancel:dn(Wi.DragCancel)});Ae.current=Kr;function dn(Tr){return async function(){const{active:ar,collisions:en,over:st,scrollAdjustedTranslate:_n}=ln.current;let $r=null;if(ar&&_n){const{cancelDrop:vi}=ft.current;$r={activatorEvent:Cr,active:ar,collisions:en,delta:_n,over:st},Tr===Wi.DragEnd&&typeof vi=="function"&&await Promise.resolve(vi($r))&&(Tr=Wi.DragCancel)}Ht.current=null,Gp.unstable_batchedUpdates(()=>{Le({type:Tr}),Ye(th.Uninitialized),ne(null),or(null),_t(null),Ae.current=null;const vi=Tr===Wi.DragEnd?"onDragEnd":"onDragCancel";if($r){const oa=ft.current[vi];oa==null||oa($r),Me({type:vi,event:$r})}})}}},[ut]),Re=te.useCallback((Ce,$t)=>(rr,Dt)=>{const Xt=rr.nativeEvent,Cr=ut.get(Dt);if(Ht.current!==null||!Cr||Xt.dndKit||Xt.defaultPrevented)return;const Kr={active:Cr};Ce(rr,$t.options,Kr)===!0&&(Xt.dndKit={capturedBy:$t.sensor},Ht.current=Dt,Oe(rr,$t))},[ut,Oe]),qe=GA(Z,Re);JA(Z),lc(()=>{lr&&De===th.Initializing&&Ye(th.Initialized)},[lr,De]),te.useEffect(()=>{const{onDragMove:Ce}=ft.current,{active:$t,activatorEvent:rr,collisions:Dt,over:Xt}=ln.current;if(!$t||!rr)return;const Cr={active:$t,activatorEvent:rr,collisions:Dt,delta:{x:_r.x,y:_r.y},over:Xt};Gp.unstable_batchedUpdates(()=>{Ce==null||Ce(Cr),Me({type:"onDragMove",event:Cr})})},[_r.x,_r.y]),te.useEffect(()=>{const{active:Ce,activatorEvent:$t,collisions:rr,droppableContainers:Dt,scrollAdjustedTranslate:Xt}=ln.current;if(!Ce||Ht.current==null||!$t||!Xt)return;const{onDragOver:Cr}=ft.current,Kr=Dt.get(K),dn=Kr&&Kr.rect.current?{id:Kr.id,rect:Kr.rect.current,data:Kr.data,disabled:Kr.disabled}:null,Tr={active:Ce,activatorEvent:$t,collisions:rr,delta:{x:Xt.x,y:Xt.y},over:dn};Gp.unstable_batchedUpdates(()=>{ne(dn),Cr==null||Cr(Tr),Me({type:"onDragOver",event:Tr})})},[K]),lc(()=>{ln.current={activatorEvent:Zt,active:Mt,activeNode:Kt,collisionRect:Sr,collisions:Te,droppableRects:jt,draggableNodes:ut,draggingNode:Cn,draggingNodeRect:jn,droppableContainers:Ke,over:X,scrollableAncestors:xe,scrollAdjustedTranslate:_r},Rt.current={initial:jn,translated:Sr}},[Mt,Kt,Te,Sr,ut,Cn,jn,jt,Ke,X,xe,_r]),$A({...sr,delta:Je,draggingRect:Sr,pointerCoordinates:Et,scrollableAncestors:xe,scrollableAncestorRects:Be});const nt=te.useMemo(()=>({active:Mt,activeNode:Kt,activeNodeRect:lr,activatorEvent:Zt,collisions:Te,containerNodeRect:ci,dragOverlay:Nr,draggableNodes:ut,droppableContainers:Ke,droppableRects:jt,over:X,measureDroppableContainers:tr,scrollableAncestors:xe,scrollableAncestorRects:Be,measuringConfiguration:Qe,measuringScheduled:fr,windowRect:Zn}),[Mt,Kt,lr,Zt,Te,ci,Nr,ut,Ke,jt,X,tr,xe,Be,Qe,fr,Zn]),et=te.useMemo(()=>({activatorEvent:Zt,activators:qe,active:Mt,activeNodeRect:lr,ariaDescribedById:{draggable:Ct},dispatch:Le,draggableNodes:ut,over:X,measureDroppableContainers:tr}),[Zt,qe,Mt,lr,Le,Ct,ut,X,tr]);return hn.createElement(k1.Provider,{value:Se},hn.createElement(sy.Provider,{value:et},hn.createElement(N1.Provider,{value:nt},hn.createElement(B1.Provider,{value:ve},N)),hn.createElement(uR,{disabled:(l==null?void 0:l.restoreFocus)===!1})),hn.createElement(lA,{...l,hiddenTextDescribedById:Ct}));function zt(){const Ce=(zr==null?void 0:zr.autoScrollEnabled)===!1,$t=typeof L=="object"?L.enabled===!1:L===!1,rr=ot&&!Ce&&!$t;return typeof L=="object"?{...L,enabled:rr}:{enabled:rr}}}),mR=te.createContext(null),F0="button",gR="Draggable";function yR(r){let{id:a,data:u,disabled:m=!1,attributes:b}=r;const P=Tm(gR),{activators:w,activatorEvent:l,active:L,activeNodeRect:N,ariaDescribedById:Z,draggableNodes:V,over:ee}=te.useContext(sy),{role:q=F0,roleDescription:_e="draggable",tabIndex:fe=0}=b??{},Pe=(L==null?void 0:L.id)===a,Le=te.useContext(Pe?B1:mR),[Me,Se]=Ng(),[De,Ye]=Ng(),ot=eR(w,a),lt=om(u);lc(()=>(V.set(a,{id:a,key:P,node:Me,activatorNode:De,data:lt}),()=>{const Je=V.get(a);Je&&Je.key===P&&V.delete(a)}),[V,a]);const ut=te.useMemo(()=>({role:q,tabIndex:fe,"aria-disabled":m,"aria-pressed":Pe&&q===F0?!0:void 0,"aria-roledescription":_e,"aria-describedby":Z.draggable}),[m,q,fe,Pe,_e,Z.draggable]);return{active:L,activatorEvent:l,activeNodeRect:N,attributes:ut,isDragging:Pe,listeners:m?void 0:ot,node:Me,over:ee,setNodeRef:Se,setActivatorNodeRef:Ye,transform:Le}}function _R(){return te.useContext(N1)}const vR="Droppable",xR={timeout:25};function bR(r){let{data:a,disabled:u=!1,id:m,resizeObserverConfig:b}=r;const P=Tm(vR),{active:w,dispatch:l,over:L,measureDroppableContainers:N}=te.useContext(sy),Z=te.useRef({disabled:u}),V=te.useRef(!1),ee=te.useRef(null),q=te.useRef(null),{disabled:_e,updateMeasurementsFor:fe,timeout:Pe}={...xR,...b},Le=om(fe??m),Me=te.useCallback(()=>{if(!V.current){V.current=!0;return}q.current!=null&&clearTimeout(q.current),q.current=setTimeout(()=>{N(Array.isArray(Le.current)?Le.current:[Le.current]),q.current=null},Pe)},[Pe]),Se=iy({callback:Me,disabled:_e||!w}),De=te.useCallback((ut,Je)=>{Se&&(Je&&(Se.unobserve(Je),V.current=!1),ut&&Se.observe(ut))},[Se]),[Ye,ot]=Ng(De),lt=om(a);return te.useEffect(()=>{!Se||!Ye.current||(Se.disconnect(),V.current=!1,Se.observe(Ye.current))},[Ye,Se]),te.useEffect(()=>(l({type:Wi.RegisterDroppable,element:{id:m,key:P,disabled:u,node:Ye,rect:ee,data:lt}}),()=>l({type:Wi.UnregisterDroppable,key:P,id:m})),[m]),te.useEffect(()=>{u!==Z.current.disabled&&(l({type:Wi.SetDroppableDisabled,id:m,key:P,disabled:u}),Z.current.disabled=u)},[m,P,u,l]),{active:w,rect:ee,isOver:(L==null?void 0:L.id)===m,node:Ye,over:L,setNodeRef:ot}}function mv(r,a,u){const m=r.slice();return m.splice(u<0?m.length+u:u,0,m.splice(a,1)[0]),m}function wR(r,a){return r.reduce((u,m,b)=>{const P=a.get(m);return P&&(u[b]=P),u},Array(r.length))}function vg(r){return r!==null&&r>=0}function SR(r,a){if(r===a)return!0;if(r.length!==a.length)return!1;for(let u=0;u<r.length;u++)if(r[u]!==a[u])return!1;return!0}function TR(r){return typeof r=="boolean"?{draggable:r,droppable:r}:r}const $1=r=>{let{rects:a,activeIndex:u,overIndex:m,index:b}=r;const P=mv(a,m,u),w=a[b],l=P[b];return!l||!w?null:{x:l.left-w.left,y:l.top-w.top,scaleX:l.width/w.width,scaleY:l.height/w.height}},xg={scaleX:1,scaleY:1},PR=r=>{var a;let{activeIndex:u,activeNodeRect:m,index:b,rects:P,overIndex:w}=r;const l=(a=P[u])!=null?a:m;if(!l)return null;if(b===u){const N=P[w];return N?{x:0,y:u<w?N.top+N.height-(l.top+l.height):N.top-l.top,...xg}:null}const L=CR(P,b,u);return b>u&&b<=w?{x:0,y:-l.height-L,...xg}:b<u&&b>=w?{x:0,y:l.height+L,...xg}:{x:0,y:0,...xg}};function CR(r,a,u){const m=r[a],b=r[a-1],P=r[a+1];return m?u<a?b?m.top-(b.top+b.height):P?P.top-(m.top+m.height):0:P?P.top-(m.top+m.height):b?m.top-(b.top+b.height):0:0}const U1="Sortable",V1=hn.createContext({activeIndex:-1,containerId:U1,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:$1,disabled:{draggable:!1,droppable:!1}});function kR(r){let{children:a,id:u,items:m,strategy:b=$1,disabled:P=!1}=r;const{active:w,dragOverlay:l,droppableRects:L,over:N,measureDroppableContainers:Z}=_R(),V=Tm(U1,u),ee=l.rect!==null,q=te.useMemo(()=>m.map(ot=>typeof ot=="object"&&"id"in ot?ot.id:ot),[m]),_e=w!=null,fe=w?q.indexOf(w.id):-1,Pe=N?q.indexOf(N.id):-1,Le=te.useRef(q),Me=!SR(q,Le.current),Se=Pe!==-1&&fe===-1||Me,De=TR(P);lc(()=>{Me&&_e&&Z(q)},[Me,q,_e,Z]),te.useEffect(()=>{Le.current=q},[q]);const Ye=te.useMemo(()=>({activeIndex:fe,containerId:V,disabled:De,disableTransforms:Se,items:q,overIndex:Pe,useDragOverlay:ee,sortedRects:wR(q,L),strategy:b}),[fe,V,De.draggable,De.droppable,Se,q,Pe,L,ee,b]);return hn.createElement(V1.Provider,{value:Ye},a)}const ER=r=>{let{id:a,items:u,activeIndex:m,overIndex:b}=r;return mv(u,m,b).indexOf(a)},IR=r=>{let{containerId:a,isSorting:u,wasDragging:m,index:b,items:P,newIndex:w,previousItems:l,previousContainerId:L,transition:N}=r;return!N||!m||l!==P&&b===w?!1:u?!0:w!==b&&a===L},MR={duration:200,easing:"ease"},Z1="transform",AR=lm.Transition.toString({property:Z1,duration:0,easing:"linear"}),RR={roleDescription:"sortable"};function zR(r){let{disabled:a,index:u,node:m,rect:b}=r;const[P,w]=te.useState(null),l=te.useRef(u);return lc(()=>{if(!a&&u!==l.current&&m.current){const L=b.current;if(L){const N=Yf(m.current,{ignoreTransform:!0}),Z={x:L.left-N.left,y:L.top-N.top,scaleX:L.width/N.width,scaleY:L.height/N.height};(Z.x||Z.y)&&w(Z)}}u!==l.current&&(l.current=u)},[a,u,m,b]),te.useEffect(()=>{P&&w(null)},[P]),P}function DR(r){let{animateLayoutChanges:a=IR,attributes:u,disabled:m,data:b,getNewIndex:P=ER,id:w,strategy:l,resizeObserverConfig:L,transition:N=MR}=r;const{items:Z,containerId:V,activeIndex:ee,disabled:q,disableTransforms:_e,sortedRects:fe,overIndex:Pe,useDragOverlay:Le,strategy:Me}=te.useContext(V1),Se=LR(m,q),De=Z.indexOf(w),Ye=te.useMemo(()=>({sortable:{containerId:V,index:De,items:Z},...b}),[V,b,De,Z]),ot=te.useMemo(()=>Z.slice(Z.indexOf(w)),[Z,w]),{rect:lt,node:ut,isOver:Je,setNodeRef:Ke}=bR({id:w,data:Ye,disabled:Se.droppable,resizeObserverConfig:{updateMeasurementsFor:ot,...L}}),{active:At,activatorEvent:Rt,activeNodeRect:Mt,attributes:Ht,setNodeRef:zr,listeners:or,isDragging:Zt,over:_t,setActivatorNodeRef:ft,transform:Ct}=yR({id:w,data:Ye,attributes:{...RR,...u},disabled:Se.draggable}),Ie=KM(Ke,zr),Qe=!!At,jt=Qe&&!_e&&vg(ee)&&vg(Pe),tr=!Le&&Zt,fr=tr&&jt?Ct:null,Lr=jt?fr??(l??Me)({rects:fe,activeNodeRect:Mt,activeIndex:ee,overIndex:Pe,index:De}):null,sr=vg(ee)&&vg(Pe)?P({id:w,items:Z,activeIndex:ee,overIndex:Pe}):De,yr=At==null?void 0:At.id,lr=te.useRef({activeId:yr,items:Z,newIndex:sr,containerId:V}),ci=Z!==lr.current.items,ln=a({active:At,containerId:V,isDragging:Zt,isSorting:Qe,id:w,index:De,items:Z,newIndex:lr.current.newIndex,previousItems:lr.current.items,previousContainerId:lr.current.containerId,transition:N,wasDragging:lr.current.activeId!=null}),Vr=zR({disabled:!ln,index:De,node:ut,rect:lt});return te.useEffect(()=>{Qe&&lr.current.newIndex!==sr&&(lr.current.newIndex=sr),V!==lr.current.containerId&&(lr.current.containerId=V),Z!==lr.current.items&&(lr.current.items=Z)},[Qe,sr,V,Z]),te.useEffect(()=>{if(yr===lr.current.activeId)return;if(yr!=null&&lr.current.activeId==null){lr.current.activeId=yr;return}const Cn=setTimeout(()=>{lr.current.activeId=yr},50);return()=>clearTimeout(Cn)},[yr]),{active:At,activeIndex:ee,attributes:Ht,data:Ye,rect:lt,index:De,newIndex:sr,items:Z,isOver:Je,isSorting:Qe,isDragging:Zt,listeners:or,node:ut,overIndex:Pe,over:_t,setNodeRef:Ie,setActivatorNodeRef:ft,setDroppableNodeRef:Ke,setDraggableNodeRef:zr,transform:Vr??Lr,transition:Nr()};function Nr(){if(Vr||ci&&lr.current.newIndex===De)return AR;if(!(tr&&!uv(Rt)||!N)&&(Qe||ln))return lm.Transition.toString({...N,property:Z1})}}function LR(r,a){var u,m;return typeof r=="boolean"?{draggable:r,droppable:!1}:{draggable:(u=r==null?void 0:r.draggable)!=null?u:a.draggable,droppable:(m=r==null?void 0:r.droppable)!=null?m:a.droppable}}mn.Down,mn.Right,mn.Up,mn.Left;function FR({id:r,name:a,muni:u,classificationText:m,classificationClass:b,onRemove:P,disabled:w}){const{t:l}=Ea(),{attributes:L,listeners:N,setNodeRef:Z,transform:V,transition:ee,isDragging:q}=DR({id:r,disabled:w}),_e={transform:lm.Transform.toString(V),transition:ee,opacity:q?.85:1};return Y.jsxs("li",{ref:Z,style:_e,className:"w-full card p-4 flex items-start justify-between gap-4",children:[Y.jsxs("div",{className:"min-w-0 flex-1",children:[Y.jsxs("div",{className:"flex items-center gap-2",children:[!w&&Y.jsx("button",{"aria-label":l("favorites.dragToReorder"),className:"shrink-0 w-6 h-6 grid place-items-center cursor-grab active:cursor-grabbing rounded hover:bg-surface-muted",...L,...N,children:Y.jsxs("span",{className:"grid grid-cols-2 gap-0.5","aria-hidden":!0,children:[Y.jsx("span",{className:"w-1.5 h-1.5 bg-ink/60 rounded-sm"}),Y.jsx("span",{className:"w-1.5 h-1.5 bg-ink/60 rounded-sm"}),Y.jsx("span",{className:"w-1.5 h-1.5 bg-ink/60 rounded-sm"}),Y.jsx("span",{className:"w-1.5 h-1.5 bg-ink/60 rounded-sm"})]})}),Y.jsx(ei,{to:`/beach/${r}`,className:"font-medium hover:underline block truncate max-w-[200px] sm:max-w-none",title:a,children:a})]}),Y.jsx("div",{className:"text-sm text-ink-muted truncate",children:u||""}),Y.jsx("div",{className:"mt-1",children:Y.jsx("span",{className:`badge ${b}`,children:m})})]}),Y.jsxs("div",{className:"flex items-center gap-2 shrink-0 flex-wrap justify-end",children:[Y.jsx(ei,{to:`/beach/${r}`,className:"px-3 py-1.5 rounded-lg border border-border hover:bg-surface-muted text-sm",children:l("favorites.view")}),Y.jsx("button",{className:"px-3 py-1.5 rounded-lg border border-border hover:bg-surface-muted text-sm",onClick:P,"aria-label":`${l("favorites.remove")} ${a}`,children:l("favorites.remove")})]})]})}function OR(r){if(typeof r=="number")return["kpi-excellent","kpi-good","kpi-sufficient","kpi-poor"][r-1]??"kpi-unknown";const a=String(r??"").toLowerCase();return a.includes("utmrkt")?"kpi-excellent":a.includes("bra")?"kpi-good":a.includes("tillfreds")||a.includes("sufficient")?"kpi-sufficient":a.includes("dlig")||a.includes("poor")?"kpi-poor":"kpi-unknown"}const O0="favoritesSort",j0="favoritesOrder:v1";function jR(){const{t:r}=Ea(),{data:a,isLoading:u,isError:m,error:b}=Xb(),P=a==null?void 0:a.map(Le=>Le.beachId),w=HM(P),l=Yb(),L=xC(),[N,Z]=te.useState(()=>localStorage.getItem(O0)??"name");te.useEffect(()=>{localStorage.setItem(O0,N)},[N]);const[V,ee]=te.useState(()=>{try{const Le=localStorage.getItem(j0);return Le?JSON.parse(Le):[]}catch{return[]}});te.useEffect(()=>{if(!a)return;const Le=a.map(Ye=>Ye.beachId),Me=new Set(V),De=[...V,...Le.filter(Ye=>!Me.has(Ye))].filter(Ye=>Le.includes(Ye));JSON.stringify(De)!==JSON.stringify(V)&&ee(De)},[a]),te.useEffect(()=>{localStorage.setItem(j0,JSON.stringify(V))},[V]);const q=te.useMemo(()=>{const Le=new Map;if(!a)return Le;for(const Me of a){const Se=w.byId.get(Me.beachId);Le.set(Me.beachId,{fav:Me,name:(Se==null?void 0:Se.locationName)??Me.beachId,muni:(Se==null?void 0:Se.locationArea)??"",classification:(Se==null?void 0:Se.classification)??(Se==null?void 0:Se.classificationText),classificationText:(Se==null?void 0:Se.classificationText)??r("classification.unknown")})}return Le},[a,w.byId,r]),_e=te.useMemo(()=>{if(!a)return[];const Le=a.map(De=>De.beachId);if(N==="custom"&&V.length)return V.filter(De=>Le.includes(De));const Me=Le.slice(),Se=new Intl.Collator(void 0,{sensitivity:"base"});return Me.sort((De,Ye)=>{const ot=q.get(De),lt=q.get(Ye);return!ot||!lt?0:N==="name"?Se.compare(ot.name,lt.name):Se.compare(ot.muni,lt.muni)}),Me},[a,N,V,q]),fe=uA(cA(pv,{activationConstraint:{distance:5}}));function Pe(Le){if(N!=="custom")return;const{active:Me,over:Se}=Le;if(!Se||Me.id===Se.id)return;const De=V.indexOf(String(Me.id)),Ye=V.indexOf(String(Se.id));if(De===-1||Ye===-1)return;const ot=mv(V,De,Ye);ee(ot),L.mutate(ot,{onError:()=>{ee(V)}})}return u?Y.jsxs("main",{className:"max-w-screen-lg mx-auto p-6",children:[Y.jsx("h1",{className:"font-spectral text-2xl mb-4",children:r("favorites.title")}),Y.jsx("div",{className:"space-y-3",children:[...Array(3)].map((Le,Me)=>Y.jsxs("div",{className:"card p-4 animate-pulse",children:[Y.jsx("div",{className:"h-5 w-1/2 bg-surface-muted rounded mb-2"}),Y.jsx("div",{className:"h-4 w-1/3 bg-surface-muted rounded"})]},Me))})]}):m?Y.jsxs("main",{className:"max-w-screen-lg mx-auto p-6",children:[Y.jsx("h1",{className:"font-spectral text-2xl mb-4",children:r("favorites.title")}),Y.jsx("p",{className:"text-red-600",children:(b==null?void 0:b.message)??r("loadError")})]}):Y.jsxs("main",{className:"max-w-screen-lg mx-auto p-6 space-y-6",children:[Y.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between sm:gap-4",children:[Y.jsx("h1",{className:"font-spectral text-2xl",children:r("favorites.title")}),Y.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[Y.jsxs("label",{className:"text-sm",children:[r("favorites.sortBy")," ",Y.jsxs("select",{value:N,onChange:Le=>Z(Le.target.value),className:"ml-1 border rounded px-2 py-1 text-sm","aria-label":r("favorites.sortBy"),children:[Y.jsx("option",{value:"custom",children:r("favorites.sortOptions.custom")}),Y.jsx("option",{value:"name",children:r("favorites.sortOptions.name")}),Y.jsx("option",{value:"municipality",children:r("favorites.sortOptions.municipality")})]})]}),Y.jsx(ei,{to:"/",className:"underline text-accent block",children:r("favorites.browseAll")})]})]}),a&&a.length===0&&Y.jsxs("div",{className:"card p-6",children:[Y.jsx("h2",{className:"font-spectral text-lg mb-1",children:r("favorites.empty")}),Y.jsx("p",{className:"text-sm text-ink-muted mb-3",children:r("favorites.addFavorites")}),Y.jsx(ei,{to:"/",className:"inline-block px-3 py-2 rounded-2xl border border-border hover:bg-surface-muted",children:r("beachesList.modeDefault")})]}),Y.jsx(pR,{sensors:fe,collisionDetection:mA,onDragEnd:Pe,children:Y.jsx(kR,{items:_e,strategy:PR,children:Y.jsx("ul",{className:"flex flex-col gap-3 list-none",children:_e.map(Le=>{const Me=q.get(Le);if(!Me)return null;const{fav:Se,name:De,muni:Ye,classification:ot,classificationText:lt}=Me,ut=OR(ot??lt);return Y.jsx(FR,{id:Le,name:De,muni:Ye,classificationText:lt,classificationClass:ut,disabled:N!=="custom",onRemove:()=>l.mutateAsync({id:Se._id,beachId:Se.beachId}).then(()=>{ee(Je=>Je.filter(Ke=>Ke!==Le))})},Se._id)})})})})]})}function NR(){const{t:r}=Ea();return Y.jsxs("main",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:r("pages.about.title")}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.about.whatIsBADA")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.about.whatIsBADADesc")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.about.whatIsBADAMission")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.about.dataSource")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.about.dataSourceDesc")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.about.dataSourceDirective")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.about.features")}),Y.jsxs("ul",{className:"space-y-2 list-disc list-inside text-ink",children:[Y.jsx("li",{children:r("pages.about.featureMap")}),Y.jsx("li",{children:r("pages.about.featureLocation")}),Y.jsx("li",{children:r("pages.about.featureQuality")}),Y.jsx("li",{children:r("pages.about.featureFavorites")}),Y.jsx("li",{children:r("pages.about.featureDarkMode")}),Y.jsx("li",{children:r("pages.about.featureLang")})]})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.about.builtWith")}),Y.jsxs("p",{className:"text-ink",children:[r("pages.about.builtWithDesc")," ",Y.jsx("a",{href:"https://github.com/govargas/bada",target:"_blank",rel:"noopener noreferrer",className:"text-accent underline",children:r("pages.about.githubRepo")})," ",r("pages.about.builtWithDesc2")]})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:r("pages.backToMap")})})]})}function BR(){const{t:r}=Ea();return Y.jsxs("main",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:r("pages.whatIsEUBeach.title")}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.whatIsEUBeach.directive")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.whatIsEUBeach.directiveDesc")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.whatIsEUBeach.directiveDesc2")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.whatIsEUBeach.classifications")}),Y.jsxs("div",{className:"space-y-3",children:[Y.jsxs("div",{className:"card p-4",children:[Y.jsx("div",{className:"flex items-center gap-3 mb-2",children:Y.jsx("span",{className:"badge kpi-excellent",children:r("classification.excellent")})}),Y.jsx("p",{className:"text-sm text-ink-muted",children:r("pages.whatIsEUBeach.excellentDesc")})]}),Y.jsxs("div",{className:"card p-4",children:[Y.jsx("div",{className:"flex items-center gap-3 mb-2",children:Y.jsx("span",{className:"badge kpi-good",children:r("classification.good")})}),Y.jsx("p",{className:"text-sm text-ink-muted",children:r("pages.whatIsEUBeach.goodDesc")})]}),Y.jsxs("div",{className:"card p-4",children:[Y.jsx("div",{className:"flex items-center gap-3 mb-2",children:Y.jsx("span",{className:"badge kpi-sufficient",children:r("classification.sufficient")})}),Y.jsx("p",{className:"text-sm text-ink-muted",children:r("pages.whatIsEUBeach.sufficientDesc")})]}),Y.jsxs("div",{className:"card p-4",children:[Y.jsx("div",{className:"flex items-center gap-3 mb-2",children:Y.jsx("span",{className:"badge kpi-poor",children:r("classification.poor")})}),Y.jsx("p",{className:"text-sm text-ink-muted",children:r("pages.whatIsEUBeach.poorDesc")})]})]})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.whatIsEUBeach.monitoring")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.whatIsEUBeach.monitoringDesc")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.whatIsEUBeach.monitoringDesc2")})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:r("pages.backToMap")})})]})}function $R(){const{t:r}=Ea();return Y.jsxs("main",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:r("pages.terms.title")}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.acceptance")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.acceptanceDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.service")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.serviceDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.disclaimer")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.disclaimerDesc")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.disclaimerDesc2")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.accounts")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.accountsDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.ip")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.ipDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.changes")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.terms.changesDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.terms.contact")}),Y.jsxs("p",{className:"text-ink leading-relaxed",children:[r("pages.terms.contactDesc")," ",Y.jsx(ei,{to:"/contact",className:"text-accent underline",children:r("pages.terms.contactUs")}),"."]})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:r("pages.backToMap")})})]})}function UR(){const{t:r}=Ea();return Y.jsxs("main",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:r("pages.contact.title")}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.contact.getInTouch")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.contact.getInTouchDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.contact.github")}),Y.jsxs("p",{className:"text-ink leading-relaxed",children:[r("pages.contact.githubDesc")," ",Y.jsx("a",{href:"https://github.com/govargas/bada",target:"_blank",rel:"noopener noreferrer",className:"text-accent underline",children:r("pages.contact.githubRepo")}),"."]})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.contact.feedback")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.contact.feedbackDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.contact.accuracy")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.contact.accuracyDesc")})]}),Y.jsxs("section",{className:"space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-2xl",children:r("pages.contact.privacy")}),Y.jsx("p",{className:"text-ink leading-relaxed",children:r("pages.contact.privacyDesc")})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:r("pages.backToMap")})})]})}function VR(){const{t:r}=Ea(),{token:a,clearToken:u}=cc(),m=Bd(),b=fu(),P=()=>{u(),b.clear(),m("/")};return Y.jsxs("main",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:r("pages.profile.title")}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl",children:"Account Information"}),Y.jsx("p",{className:"text-ink-muted",children:"You are currently signed in. Your account allows you to save favorite beaches and access them from any device."})]}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl",children:"Your Favorites"}),Y.jsx("p",{className:"text-ink-muted",children:"Manage your saved beaches and keep track of your favorite swimming spots."}),Y.jsx(ei,{to:"/favorites",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:"View My Favorites"})]}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl text-red-600",children:"Sign Out"}),Y.jsx("p",{className:"text-ink-muted",children:"Sign out of your account. You'll need to sign in again to access your favorites."}),Y.jsx("button",{onClick:P,className:"px-4 py-2 rounded-lg border border-red-600 text-red-600 hover:bg-red-50 dark:hover:bg-red-950",children:"Sign Out"})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:r("pages.backToMap")})})]})}function ZR(){const{t:r}=Ea();return Y.jsxs("main",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[Y.jsx("h1",{className:"font-spectral text-3xl",children:"Settings"}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl",children:"Language"}),Y.jsx("p",{className:"text-ink-muted",children:"Choose your preferred language for BADA."}),Y.jsx(Fb,{})]}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl",children:"Dark Mode"}),Y.jsx("p",{className:"text-ink-muted",children:"Toggle dark mode from the user menu in the header."})]}),Y.jsxs("section",{className:"card p-6 space-y-4",children:[Y.jsx("h2",{className:"font-spectral text-xl",children:"Notifications"}),Y.jsx("p",{className:"text-ink-muted",children:"Notification preferences will be available in a future update."})]}),Y.jsx("div",{className:"pt-6",children:Y.jsx(ei,{to:"/",className:"inline-block px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/90",children:" Back to map"})})]})}function GR(){return Y.jsx(fP,{children:Y.jsxs("div",{className:"min-h-screen",children:[Y.jsx(rT,{languageSwitcher:Y.jsx(Fb,{})}),Y.jsx("main",{id:"main-content",className:"p-4",children:Y.jsxs(S2,{children:[Y.jsx(io,{path:"/",element:Y.jsx(IP,{})}),Y.jsx(io,{path:"/beach/:id",element:Y.jsx(wC,{})}),Y.jsx(io,{path:"/login",element:Y.jsx(qM,{})}),Y.jsx(io,{path:"/register",element:Y.jsx(WM,{})}),Y.jsx(io,{path:"/about",element:Y.jsx(NR,{})}),Y.jsx(io,{path:"/what-is-eu-beach",element:Y.jsx(BR,{})}),Y.jsx(io,{path:"/terms",element:Y.jsx($R,{})}),Y.jsx(io,{path:"/contact",element:Y.jsx(UR,{})}),Y.jsxs(io,{element:Y.jsx(pP,{}),children:[Y.jsx(io,{path:"/favorites",element:Y.jsx(jR,{})}),Y.jsx(io,{path:"/profile",element:Y.jsx(VR,{})}),Y.jsx(io,{path:"/settings",element:Y.jsx(ZR,{})})]})]})})]})})}const qR=new GS;Ki.on("languageChanged",r=>{document.documentElement.lang=r});document.documentElement.lang=Ki.language;Ew.createRoot(document.getElementById("root")).render(Y.jsx(hn.StrictMode,{children:Y.jsx(qS,{client:qR,children:Y.jsxs(q2,{children:[Y.jsx(GR,{}),Y.jsx(yC,{position:"top-center",toastOptions:{duration:3e3,style:{background:"var(--color-surface-muted)",color:"var(--color-ink)",border:"1px solid var(--color-border)",borderRadius:"16px"},success:{iconTheme:{primary:"var(--color-accent)",secondary:"var(--color-surface-muted)"}},error:{iconTheme:{primary:"var(--color-quality-poor)",secondary:"var(--color-surface-muted)"}}}})]})})}));
